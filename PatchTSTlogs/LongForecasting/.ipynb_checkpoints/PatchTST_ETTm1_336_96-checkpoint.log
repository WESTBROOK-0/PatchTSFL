Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4379977
	speed: 0.0501s/iter; left time: 1326.7649s
	iters: 200, epoch: 1 | loss: 0.3602854
	speed: 0.0441s/iter; left time: 1163.6921s
Epoch: 1 cost time: 12.469811916351318
Epoch: 1, Steps: 266 | Train Loss: 0.4423500 Vali Loss: 0.4747151 Test Loss: 0.3763783
Validation loss decreased (inf --> 0.474715).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.3629648
	speed: 0.1265s/iter; left time: 3317.4344s
	iters: 200, epoch: 2 | loss: 0.3357480
	speed: 0.0445s/iter; left time: 1162.8841s
Epoch: 2 cost time: 12.4486403465271
Epoch: 2, Steps: 266 | Train Loss: 0.3440822 Vali Loss: 0.4228938 Test Loss: 0.3367479
Validation loss decreased (0.474715 --> 0.422894).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2920102
	speed: 0.1283s/iter; left time: 3331.9117s
	iters: 200, epoch: 3 | loss: 0.3198263
	speed: 0.0442s/iter; left time: 1144.2478s
Epoch: 3 cost time: 12.529362916946411
Epoch: 3, Steps: 266 | Train Loss: 0.3157572 Vali Loss: 0.4046506 Test Loss: 0.3218923
Validation loss decreased (0.422894 --> 0.404651).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3164176
	speed: 0.1288s/iter; left time: 3311.5663s
	iters: 200, epoch: 4 | loss: 0.3112857
	speed: 0.0444s/iter; left time: 1136.5035s
Epoch: 4 cost time: 12.639684677124023
Epoch: 4, Steps: 266 | Train Loss: 0.2996904 Vali Loss: 0.3952736 Test Loss: 0.3135292
Validation loss decreased (0.404651 --> 0.395274).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2816320
	speed: 0.1277s/iter; left time: 3249.2119s
	iters: 200, epoch: 5 | loss: 0.3025644
	speed: 0.0444s/iter; left time: 1125.9847s
Epoch: 5 cost time: 12.44597578048706
Epoch: 5, Steps: 266 | Train Loss: 0.2898858 Vali Loss: 0.3915199 Test Loss: 0.3074253
Validation loss decreased (0.395274 --> 0.391520).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2769573
	speed: 0.1296s/iter; left time: 3263.1979s
	iters: 200, epoch: 6 | loss: 0.2942591
	speed: 0.0446s/iter; left time: 1118.5875s
Epoch: 6 cost time: 12.674470663070679
Epoch: 6, Steps: 266 | Train Loss: 0.2831797 Vali Loss: 0.3879026 Test Loss: 0.3045387
Validation loss decreased (0.391520 --> 0.387903).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2592134
	speed: 0.1265s/iter; left time: 3150.8495s
	iters: 200, epoch: 7 | loss: 0.3007387
	speed: 0.0446s/iter; left time: 1106.6843s
Epoch: 7 cost time: 12.495044231414795
Epoch: 7, Steps: 266 | Train Loss: 0.2775631 Vali Loss: 0.3853077 Test Loss: 0.3019348
Validation loss decreased (0.387903 --> 0.385308).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2720900
	speed: 0.1274s/iter; left time: 3139.0153s
	iters: 200, epoch: 8 | loss: 0.2821254
	speed: 0.0447s/iter; left time: 1095.8974s
Epoch: 8 cost time: 12.511880159378052
Epoch: 8, Steps: 266 | Train Loss: 0.2714178 Vali Loss: 0.3832868 Test Loss: 0.2986252
Validation loss decreased (0.385308 --> 0.383287).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2600410
	speed: 0.1282s/iter; left time: 3125.5777s
	iters: 200, epoch: 9 | loss: 0.2489452
	speed: 0.0446s/iter; left time: 1082.8636s
Epoch: 9 cost time: 12.651441812515259
Epoch: 9, Steps: 266 | Train Loss: 0.2660230 Vali Loss: 0.3777218 Test Loss: 0.2960912
Validation loss decreased (0.383287 --> 0.377722).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.2397519
	speed: 0.1273s/iter; left time: 3069.9975s
	iters: 200, epoch: 10 | loss: 0.2597667
	speed: 0.0445s/iter; left time: 1069.1412s
Epoch: 10 cost time: 12.507282018661499
Epoch: 10, Steps: 266 | Train Loss: 0.2622913 Vali Loss: 0.3825051 Test Loss: 0.2940346
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2855416
	speed: 0.1297s/iter; left time: 3092.1546s
	iters: 200, epoch: 11 | loss: 0.2510072
	speed: 0.0446s/iter; left time: 1058.6032s
Epoch: 11 cost time: 12.572788715362549
Epoch: 11, Steps: 266 | Train Loss: 0.2590336 Vali Loss: 0.3749239 Test Loss: 0.2923239
Validation loss decreased (0.377722 --> 0.374924).  Saving model ...
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.2771975
	speed: 0.1293s/iter; left time: 3048.9149s
	iters: 200, epoch: 12 | loss: 0.2730140
	speed: 0.0446s/iter; left time: 1047.9003s
Epoch: 12 cost time: 12.634088277816772
Epoch: 12, Steps: 266 | Train Loss: 0.2558122 Vali Loss: 0.3775824 Test Loss: 0.2916627
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.2295446
	speed: 0.1301s/iter; left time: 3031.4458s
	iters: 200, epoch: 13 | loss: 0.2292975
	speed: 0.0447s/iter; left time: 1036.7166s
Epoch: 13 cost time: 12.553542613983154
Epoch: 13, Steps: 266 | Train Loss: 0.2531429 Vali Loss: 0.3761532 Test Loss: 0.2903837
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2521552
	speed: 0.1266s/iter; left time: 2916.1558s
	iters: 200, epoch: 14 | loss: 0.2433271
	speed: 0.0446s/iter; left time: 1023.2656s
Epoch: 14 cost time: 12.560274124145508
Epoch: 14, Steps: 266 | Train Loss: 0.2502404 Vali Loss: 0.3708757 Test Loss: 0.2914602
Validation loss decreased (0.374924 --> 0.370876).  Saving model ...
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.2709353
	speed: 0.1286s/iter; left time: 2928.1102s
	iters: 200, epoch: 15 | loss: 0.2423625
	speed: 0.0446s/iter; left time: 1011.0135s
Epoch: 15 cost time: 12.611168146133423
Epoch: 15, Steps: 266 | Train Loss: 0.2482291 Vali Loss: 0.3748589 Test Loss: 0.2900252
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2682067
	speed: 0.1273s/iter; left time: 2865.8167s
	iters: 200, epoch: 16 | loss: 0.2620708
	speed: 0.0448s/iter; left time: 1004.4976s
Epoch: 16 cost time: 12.539591789245605
Epoch: 16, Steps: 266 | Train Loss: 0.2460945 Vali Loss: 0.3683462 Test Loss: 0.2907857
Validation loss decreased (0.370876 --> 0.368346).  Saving model ...
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2913205
	speed: 0.1281s/iter; left time: 2848.8820s
	iters: 200, epoch: 17 | loss: 0.2389192
	speed: 0.0448s/iter; left time: 992.2231s
Epoch: 17 cost time: 12.533226251602173
Epoch: 17, Steps: 266 | Train Loss: 0.2437769 Vali Loss: 0.3704594 Test Loss: 0.2905652
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2607147
	speed: 0.1305s/iter; left time: 2867.5061s
	iters: 200, epoch: 18 | loss: 0.2235380
	speed: 0.0447s/iter; left time: 977.8779s
Epoch: 18 cost time: 12.636016130447388
Epoch: 18, Steps: 266 | Train Loss: 0.2416256 Vali Loss: 0.3669641 Test Loss: 0.2927173
Validation loss decreased (0.368346 --> 0.366964).  Saving model ...
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.2496118
	speed: 0.1292s/iter; left time: 2804.4039s
	iters: 200, epoch: 19 | loss: 0.2310676
	speed: 0.0448s/iter; left time: 968.2232s
Epoch: 19 cost time: 12.636930227279663
Epoch: 19, Steps: 266 | Train Loss: 0.2398755 Vali Loss: 0.3660288 Test Loss: 0.2888149
Validation loss decreased (0.366964 --> 0.366029).  Saving model ...
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2527545
	speed: 0.1302s/iter; left time: 2793.4245s
	iters: 200, epoch: 20 | loss: 0.2464481
	speed: 0.0448s/iter; left time: 956.8055s
Epoch: 20 cost time: 12.646603107452393
Epoch: 20, Steps: 266 | Train Loss: 0.2375379 Vali Loss: 0.3714075 Test Loss: 0.2910737
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.2315578
	speed: 0.1282s/iter; left time: 2714.5150s
	iters: 200, epoch: 21 | loss: 0.2231940
	speed: 0.0447s/iter; left time: 941.9384s
Epoch: 21 cost time: 12.62205457687378
Epoch: 21, Steps: 266 | Train Loss: 0.2354388 Vali Loss: 0.3653413 Test Loss: 0.2918053
Validation loss decreased (0.366029 --> 0.365341).  Saving model ...
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.2466518
	speed: 0.1303s/iter; left time: 2725.9910s
	iters: 200, epoch: 22 | loss: 0.2457744
	speed: 0.0448s/iter; left time: 933.1926s
Epoch: 22 cost time: 12.770519733428955
Epoch: 22, Steps: 266 | Train Loss: 0.2331548 Vali Loss: 0.3646484 Test Loss: 0.2920666
Validation loss decreased (0.365341 --> 0.364648).  Saving model ...
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.2572101
	speed: 0.1311s/iter; left time: 2707.5486s
	iters: 200, epoch: 23 | loss: 0.2219703
	speed: 0.0448s/iter; left time: 920.6244s
Epoch: 23 cost time: 12.608879566192627
Epoch: 23, Steps: 266 | Train Loss: 0.2310483 Vali Loss: 0.3737268 Test Loss: 0.2943476
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.2488031
	speed: 0.1283s/iter; left time: 2615.1727s
	iters: 200, epoch: 24 | loss: 0.2176460
	speed: 0.0447s/iter; left time: 907.3986s
Epoch: 24 cost time: 12.498755693435669
Epoch: 24, Steps: 266 | Train Loss: 0.2288362 Vali Loss: 0.3732906 Test Loss: 0.2938066
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.2295129
	speed: 0.1293s/iter; left time: 2601.0358s
	iters: 200, epoch: 25 | loss: 0.2137563
	speed: 0.0448s/iter; left time: 895.8617s
Epoch: 25 cost time: 12.620010137557983
Epoch: 25, Steps: 266 | Train Loss: 0.2265007 Vali Loss: 0.3734655 Test Loss: 0.2894315
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.2110775
	speed: 0.1282s/iter; left time: 2544.9263s
	iters: 200, epoch: 26 | loss: 0.2295746
	speed: 0.0448s/iter; left time: 885.6668s
Epoch: 26 cost time: 12.62206745147705
Epoch: 26, Steps: 266 | Train Loss: 0.2247171 Vali Loss: 0.3683606 Test Loss: 0.2895700
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.2252685
	speed: 0.1300s/iter; left time: 2546.1510s
	iters: 200, epoch: 27 | loss: 0.2106588
	speed: 0.0448s/iter; left time: 872.0615s
Epoch: 27 cost time: 12.734051942825317
Epoch: 27, Steps: 266 | Train Loss: 0.2223949 Vali Loss: 0.3797721 Test Loss: 0.2920645
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.2094378
	speed: 0.1292s/iter; left time: 2495.9678s
	iters: 200, epoch: 28 | loss: 0.2194099
	speed: 0.0447s/iter; left time: 859.5769s
Epoch: 28 cost time: 12.625913381576538
Epoch: 28, Steps: 266 | Train Loss: 0.2204465 Vali Loss: 0.3796251 Test Loss: 0.2944006
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.2337323
	speed: 0.1274s/iter; left time: 2427.0622s
	iters: 200, epoch: 29 | loss: 0.2137957
	speed: 0.0450s/iter; left time: 852.2059s
Epoch: 29 cost time: 12.588148355484009
Epoch: 29, Steps: 266 | Train Loss: 0.2181911 Vali Loss: 0.3859583 Test Loss: 0.2965272
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.2246517
	speed: 0.1280s/iter; left time: 2403.9150s
	iters: 200, epoch: 30 | loss: 0.2113444
	speed: 0.0447s/iter; left time: 834.6861s
Epoch: 30 cost time: 12.51322317123413
Epoch: 30, Steps: 266 | Train Loss: 0.2167447 Vali Loss: 0.3720530 Test Loss: 0.2918621
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.59486415263404e-05
	iters: 100, epoch: 31 | loss: 0.2264289
	speed: 0.1294s/iter; left time: 2397.1989s
	iters: 200, epoch: 31 | loss: 0.2025295
	speed: 0.0447s/iter; left time: 824.0417s
Epoch: 31 cost time: 12.653167247772217
Epoch: 31, Steps: 266 | Train Loss: 0.2143759 Vali Loss: 0.3737859 Test Loss: 0.2928614
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.850661944740828e-05
	iters: 100, epoch: 32 | loss: 0.2291307
	speed: 0.1291s/iter; left time: 2356.7609s
	iters: 200, epoch: 32 | loss: 0.1849902
	speed: 0.0447s/iter; left time: 811.8731s
Epoch: 32 cost time: 12.744810581207275
Epoch: 32, Steps: 266 | Train Loss: 0.2123215 Vali Loss: 0.3805163 Test Loss: 0.2946692
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.083947962827694e-05
	iters: 100, epoch: 33 | loss: 0.2307338
	speed: 0.1293s/iter; left time: 2326.5212s
	iters: 200, epoch: 33 | loss: 0.2095326
	speed: 0.0448s/iter; left time: 801.8396s
Epoch: 33 cost time: 12.622849225997925
Epoch: 33, Steps: 266 | Train Loss: 0.2103864 Vali Loss: 0.3781520 Test Loss: 0.2929467
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.293283650764084e-05
	iters: 100, epoch: 34 | loss: 0.2166783
	speed: 0.1294s/iter; left time: 2293.3823s
	iters: 200, epoch: 34 | loss: 0.1921115
	speed: 0.0448s/iter; left time: 788.7953s
Epoch: 34 cost time: 12.603172779083252
Epoch: 34, Steps: 266 | Train Loss: 0.2082446 Vali Loss: 0.3819180 Test Loss: 0.2955117
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.477378141914727e-05
	iters: 100, epoch: 35 | loss: 0.2088395
	speed: 0.1282s/iter; left time: 2238.4035s
	iters: 200, epoch: 35 | loss: 0.1908201
	speed: 0.0446s/iter; left time: 773.5614s
Epoch: 35 cost time: 12.536065340042114
Epoch: 35, Steps: 266 | Train Loss: 0.2060383 Vali Loss: 0.3884024 Test Loss: 0.2980848
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.635096219257111e-05
	iters: 100, epoch: 36 | loss: 0.1909236
	speed: 0.1302s/iter; left time: 2238.0110s
	iters: 200, epoch: 36 | loss: 0.2225695
	speed: 0.0446s/iter; left time: 762.3837s
Epoch: 36 cost time: 12.72995138168335
Epoch: 36, Steps: 266 | Train Loss: 0.2043395 Vali Loss: 0.4031172 Test Loss: 0.2985431
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.765465315687045e-05
	iters: 100, epoch: 37 | loss: 0.2107165
	speed: 0.1288s/iter; left time: 2179.2692s
	iters: 200, epoch: 37 | loss: 0.1945733
	speed: 0.0446s/iter; left time: 749.6788s
Epoch: 37 cost time: 12.548905372619629
Epoch: 37, Steps: 266 | Train Loss: 0.2025025 Vali Loss: 0.4023935 Test Loss: 0.3013499
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.867681511344941e-05
	iters: 100, epoch: 38 | loss: 0.2054364
	speed: 0.1281s/iter; left time: 2134.3898s
	iters: 200, epoch: 38 | loss: 0.2049472
	speed: 0.0447s/iter; left time: 740.3340s
Epoch: 38 cost time: 12.736990690231323
Epoch: 38, Steps: 266 | Train Loss: 0.2002964 Vali Loss: 0.3893291 Test Loss: 0.3034744
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.941114490980398e-05
	iters: 100, epoch: 39 | loss: 0.2044517
	speed: 0.1283s/iter; left time: 2103.3670s
	iters: 200, epoch: 39 | loss: 0.2024376
	speed: 0.0446s/iter; left time: 726.2137s
Epoch: 39 cost time: 12.629047632217407
Epoch: 39, Steps: 266 | Train Loss: 0.1982663 Vali Loss: 0.3885067 Test Loss: 0.3023095
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.98531143078552e-05
	iters: 100, epoch: 40 | loss: 0.2136452
	speed: 0.1273s/iter; left time: 2053.0322s
	iters: 200, epoch: 40 | loss: 0.1834337
	speed: 0.0445s/iter; left time: 713.6589s
Epoch: 40 cost time: 12.50215768814087
Epoch: 40, Steps: 266 | Train Loss: 0.1964004 Vali Loss: 0.4001693 Test Loss: 0.3073577
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.999999903133806e-05
	iters: 100, epoch: 41 | loss: 0.1758545
	speed: 0.1275s/iter; left time: 2022.1828s
	iters: 200, epoch: 41 | loss: 0.1911044
	speed: 0.0446s/iter; left time: 702.6053s
Epoch: 41 cost time: 12.632740259170532
Epoch: 41, Steps: 266 | Train Loss: 0.1946364 Vali Loss: 0.3916986 Test Loss: 0.3025696
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.993096095176514e-05
	iters: 100, epoch: 42 | loss: 0.1738115
	speed: 0.1286s/iter; left time: 2005.7042s
	iters: 200, epoch: 42 | loss: 0.1919353
	speed: 0.0446s/iter; left time: 690.4481s
Epoch: 42 cost time: 12.631814241409302
Epoch: 42, Steps: 266 | Train Loss: 0.1927720 Vali Loss: 0.3943358 Test Loss: 0.3052715
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.2920665442943573, mae:0.3427962064743042, rse:0.5140772461891174
