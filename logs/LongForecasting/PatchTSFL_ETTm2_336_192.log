Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : 336_192_PatchTSFL_ETTm2_ftM_sl336_ll48_pl192_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3967634
	speed: 0.0924s/iter; left time: 2439.0938s
	iters: 200, epoch: 1 | loss: 0.6081997
	speed: 0.0718s/iter; left time: 1889.6337s
Epoch: 1 cost time: 21.270065546035767
Epoch: 1, Steps: 265 | Train Loss: 0.4817521 Vali Loss: 0.2320118 Test Loss: 0.3111463
Validation loss decreased (inf --> 0.232012).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.5666745
	speed: 0.2159s/iter; left time: 5642.9531s
	iters: 200, epoch: 2 | loss: 0.4035610
	speed: 0.0714s/iter; left time: 1859.9223s
Epoch: 2 cost time: 21.15788435935974
Epoch: 2, Steps: 265 | Train Loss: 0.4537577 Vali Loss: 0.2240304 Test Loss: 0.3003412
Validation loss decreased (0.232012 --> 0.224030).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.4569080
	speed: 0.2367s/iter; left time: 6123.7253s
	iters: 200, epoch: 3 | loss: 0.4979171
	speed: 0.0742s/iter; left time: 1911.3998s
Epoch: 3 cost time: 22.280863523483276
Epoch: 3, Steps: 265 | Train Loss: 0.4356583 Vali Loss: 0.2099222 Test Loss: 0.2808003
Validation loss decreased (0.224030 --> 0.209922).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3567094
	speed: 0.2287s/iter; left time: 5856.0359s
	iters: 200, epoch: 4 | loss: 0.2910641
	speed: 0.0744s/iter; left time: 1897.2010s
Epoch: 4 cost time: 21.854711055755615
Epoch: 4, Steps: 265 | Train Loss: 0.3874425 Vali Loss: 0.1809792 Test Loss: 0.2553467
Validation loss decreased (0.209922 --> 0.180979).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.2490284
	speed: 0.2340s/iter; left time: 5930.7301s
	iters: 200, epoch: 5 | loss: 0.4042793
	speed: 0.0709s/iter; left time: 1789.6138s
Epoch: 5 cost time: 21.458791494369507
Epoch: 5, Steps: 265 | Train Loss: 0.3482070 Vali Loss: 0.1734247 Test Loss: 0.2496993
Validation loss decreased (0.180979 --> 0.173425).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.4007172
	speed: 0.2068s/iter; left time: 5185.3472s
	iters: 200, epoch: 6 | loss: 0.2727356
	speed: 0.0732s/iter; left time: 1827.2261s
Epoch: 6 cost time: 20.94038963317871
Epoch: 6, Steps: 265 | Train Loss: 0.3351644 Vali Loss: 0.1705574 Test Loss: 0.2441045
Validation loss decreased (0.173425 --> 0.170557).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.5919885
	speed: 0.2160s/iter; left time: 5360.1064s
	iters: 200, epoch: 7 | loss: 0.2084074
	speed: 0.0713s/iter; left time: 1761.3006s
Epoch: 7 cost time: 21.25883722305298
Epoch: 7, Steps: 265 | Train Loss: 0.3257704 Vali Loss: 0.1690656 Test Loss: 0.2429332
Validation loss decreased (0.170557 --> 0.169066).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.3537225
	speed: 0.2095s/iter; left time: 5142.5479s
	iters: 200, epoch: 8 | loss: 0.5123077
	speed: 0.0719s/iter; left time: 1758.4377s
Epoch: 8 cost time: 20.900415658950806
Epoch: 8, Steps: 265 | Train Loss: 0.3184573 Vali Loss: 0.1676876 Test Loss: 0.2411580
Validation loss decreased (0.169066 --> 0.167688).  Saving model ...
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.2703106
	speed: 0.2161s/iter; left time: 5246.6895s
	iters: 200, epoch: 9 | loss: 0.2949842
	speed: 0.0713s/iter; left time: 1723.4222s
Epoch: 9 cost time: 21.01691198348999
Epoch: 9, Steps: 265 | Train Loss: 0.3116552 Vali Loss: 0.1669824 Test Loss: 0.2397578
Validation loss decreased (0.167688 --> 0.166982).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.3434795
	speed: 0.2105s/iter; left time: 5056.3073s
	iters: 200, epoch: 10 | loss: 0.2762150
	speed: 0.0713s/iter; left time: 1704.5513s
Epoch: 10 cost time: 20.809186697006226
Epoch: 10, Steps: 265 | Train Loss: 0.3065445 Vali Loss: 0.1657816 Test Loss: 0.2369519
Validation loss decreased (0.166982 --> 0.165782).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.3407656
	speed: 0.2144s/iter; left time: 5092.0324s
	iters: 200, epoch: 11 | loss: 0.2638289
	speed: 0.0718s/iter; left time: 1698.8826s
Epoch: 11 cost time: 21.072126150131226
Epoch: 11, Steps: 265 | Train Loss: 0.3017728 Vali Loss: 0.1657917 Test Loss: 0.2353262
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3376047
	speed: 0.2112s/iter; left time: 4961.2297s
	iters: 200, epoch: 12 | loss: 0.2300678
	speed: 0.0709s/iter; left time: 1658.4811s
Epoch: 12 cost time: 21.19344687461853
Epoch: 12, Steps: 265 | Train Loss: 0.2964455 Vali Loss: 0.1644664 Test Loss: 0.2349767
Validation loss decreased (0.165782 --> 0.164466).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2077308
	speed: 0.2114s/iter; left time: 4908.5816s
	iters: 200, epoch: 13 | loss: 0.1881950
	speed: 0.0707s/iter; left time: 1635.0175s
Epoch: 13 cost time: 20.908004760742188
Epoch: 13, Steps: 265 | Train Loss: 0.2918819 Vali Loss: 0.1649806 Test Loss: 0.2352198
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.2718545
	speed: 0.2091s/iter; left time: 4799.0006s
	iters: 200, epoch: 14 | loss: 0.2762462
	speed: 0.0708s/iter; left time: 1619.3037s
Epoch: 14 cost time: 20.847572803497314
Epoch: 14, Steps: 265 | Train Loss: 0.2860282 Vali Loss: 0.1631295 Test Loss: 0.2325044
Validation loss decreased (0.164466 --> 0.163129).  Saving model ...
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.3305913
	speed: 0.2137s/iter; left time: 4849.5241s
	iters: 200, epoch: 15 | loss: 0.3316286
	speed: 0.0718s/iter; left time: 1622.3138s
Epoch: 15 cost time: 21.145777463912964
Epoch: 15, Steps: 265 | Train Loss: 0.2820774 Vali Loss: 0.1632347 Test Loss: 0.2326002
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2748239
	speed: 0.2169s/iter; left time: 4865.2752s
	iters: 200, epoch: 16 | loss: 0.3277129
	speed: 0.0707s/iter; left time: 1578.5964s
Epoch: 16 cost time: 21.37063503265381
Epoch: 16, Steps: 265 | Train Loss: 0.2774934 Vali Loss: 0.1635413 Test Loss: 0.2310306
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2725505
	speed: 0.2106s/iter; left time: 4667.3349s
	iters: 200, epoch: 17 | loss: 0.2895344
	speed: 0.0712s/iter; left time: 1569.6567s
Epoch: 17 cost time: 20.82027840614319
Epoch: 17, Steps: 265 | Train Loss: 0.2719463 Vali Loss: 0.1617167 Test Loss: 0.2368078
Validation loss decreased (0.163129 --> 0.161717).  Saving model ...
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.3127464
	speed: 0.2161s/iter; left time: 4731.5500s
	iters: 200, epoch: 18 | loss: 0.2038883
	speed: 0.0706s/iter; left time: 1539.3156s
Epoch: 18 cost time: 20.983911514282227
Epoch: 18, Steps: 265 | Train Loss: 0.2655927 Vali Loss: 0.1616936 Test Loss: 0.2336463
Validation loss decreased (0.161717 --> 0.161694).  Saving model ...
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2313200
	speed: 0.2178s/iter; left time: 4711.2055s
	iters: 200, epoch: 19 | loss: 0.2537350
	speed: 0.0715s/iter; left time: 1538.7354s
Epoch: 19 cost time: 21.74442172050476
Epoch: 19, Steps: 265 | Train Loss: 0.2605204 Vali Loss: 0.1612620 Test Loss: 0.2366367
Validation loss decreased (0.161694 --> 0.161262).  Saving model ...
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2951918
	speed: 0.2093s/iter; left time: 4472.5031s
	iters: 200, epoch: 20 | loss: 0.2329875
	speed: 0.0707s/iter; left time: 1502.7558s
Epoch: 20 cost time: 21.023760557174683
Epoch: 20, Steps: 265 | Train Loss: 0.2559369 Vali Loss: 0.1618837 Test Loss: 0.2367028
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2802572
	speed: 0.2117s/iter; left time: 4467.6134s
	iters: 200, epoch: 21 | loss: 0.2005118
	speed: 0.0708s/iter; left time: 1487.4035s
Epoch: 21 cost time: 21.191468000411987
Epoch: 21, Steps: 265 | Train Loss: 0.2516985 Vali Loss: 0.1638746 Test Loss: 0.2355527
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2951266
	speed: 0.2209s/iter; left time: 4602.6217s
	iters: 200, epoch: 22 | loss: 0.2701832
	speed: 0.0713s/iter; left time: 1478.9142s
Epoch: 22 cost time: 21.167927265167236
Epoch: 22, Steps: 265 | Train Loss: 0.2474732 Vali Loss: 0.1632796 Test Loss: 0.2366807
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2132490
	speed: 0.2158s/iter; left time: 4438.8274s
	iters: 200, epoch: 23 | loss: 0.2658288
	speed: 0.0716s/iter; left time: 1466.6100s
Epoch: 23 cost time: 21.25879216194153
Epoch: 23, Steps: 265 | Train Loss: 0.2438536 Vali Loss: 0.1632265 Test Loss: 0.2389902
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.3088675
	speed: 0.2207s/iter; left time: 4480.5407s
	iters: 200, epoch: 24 | loss: 0.2624931
	speed: 0.0738s/iter; left time: 1491.1878s
Epoch: 24 cost time: 22.07341241836548
Epoch: 24, Steps: 265 | Train Loss: 0.2400606 Vali Loss: 0.1643157 Test Loss: 0.2363806
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2337222
	speed: 0.2222s/iter; left time: 4453.8533s
	iters: 200, epoch: 25 | loss: 0.1756684
	speed: 0.0711s/iter; left time: 1417.2391s
Epoch: 25 cost time: 21.552861213684082
Epoch: 25, Steps: 265 | Train Loss: 0.2371707 Vali Loss: 0.1635162 Test Loss: 0.2391664
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2651241
	speed: 0.2173s/iter; left time: 4297.2558s
	iters: 200, epoch: 26 | loss: 0.2267885
	speed: 0.0726s/iter; left time: 1427.6258s
Epoch: 26 cost time: 21.862072706222534
Epoch: 26, Steps: 265 | Train Loss: 0.2339574 Vali Loss: 0.1646425 Test Loss: 0.2398698
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2602905
	speed: 0.2133s/iter; left time: 4161.0117s
	iters: 200, epoch: 27 | loss: 0.2439998
	speed: 0.0712s/iter; left time: 1383.0283s
Epoch: 27 cost time: 21.247437477111816
Epoch: 27, Steps: 265 | Train Loss: 0.2313745 Vali Loss: 0.1651591 Test Loss: 0.2393963
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2315586
	speed: 0.2192s/iter; left time: 4218.8190s
	iters: 200, epoch: 28 | loss: 0.2213312
	speed: 0.0705s/iter; left time: 1348.8747s
Epoch: 28 cost time: 21.2359139919281
Epoch: 28, Steps: 265 | Train Loss: 0.2282344 Vali Loss: 0.1650021 Test Loss: 0.2423261
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.2468811
	speed: 0.2122s/iter; left time: 4027.9070s
	iters: 200, epoch: 29 | loss: 0.1731010
	speed: 0.0738s/iter; left time: 1393.6136s
Epoch: 29 cost time: 21.613102912902832
Epoch: 29, Steps: 265 | Train Loss: 0.2256861 Vali Loss: 0.1654124 Test Loss: 0.2394363
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.2368061
	speed: 0.2199s/iter; left time: 4115.9937s
	iters: 200, epoch: 30 | loss: 0.2077224
	speed: 0.0698s/iter; left time: 1299.3847s
Epoch: 30 cost time: 21.90772247314453
Epoch: 30, Steps: 265 | Train Loss: 0.2235111 Vali Loss: 0.1663907 Test Loss: 0.2404409
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.1981493
	speed: 0.2109s/iter; left time: 3891.9579s
	iters: 200, epoch: 31 | loss: 0.1682715
	speed: 0.0715s/iter; left time: 1312.7488s
Epoch: 31 cost time: 21.37255072593689
Epoch: 31, Steps: 265 | Train Loss: 0.2208694 Vali Loss: 0.1662190 Test Loss: 0.2409499
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.2516565
	speed: 0.2268s/iter; left time: 4124.1101s
	iters: 200, epoch: 32 | loss: 0.2217530
	speed: 0.0712s/iter; left time: 1287.1277s
Epoch: 32 cost time: 22.081823110580444
Epoch: 32, Steps: 265 | Train Loss: 0.2185038 Vali Loss: 0.1673596 Test Loss: 0.2420319
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.2809517
	speed: 0.2177s/iter; left time: 3900.5375s
	iters: 200, epoch: 33 | loss: 0.2722625
	speed: 0.0723s/iter; left time: 1288.4984s
Epoch: 33 cost time: 21.423619508743286
Epoch: 33, Steps: 265 | Train Loss: 0.2168626 Vali Loss: 0.1693651 Test Loss: 0.2453548
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.2484466
	speed: 0.2194s/iter; left time: 3873.1445s
	iters: 200, epoch: 34 | loss: 0.2155590
	speed: 0.0711s/iter; left time: 1247.9456s
Epoch: 34 cost time: 21.423335075378418
Epoch: 34, Steps: 265 | Train Loss: 0.2141988 Vali Loss: 0.1671512 Test Loss: 0.2436388
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.477380205092656e-05
	iters: 100, epoch: 35 | loss: 0.1757199
	speed: 0.2200s/iter; left time: 3826.5216s
	iters: 200, epoch: 35 | loss: 0.2057528
	speed: 0.0717s/iter; left time: 1239.0916s
Epoch: 35 cost time: 21.589351415634155
Epoch: 35, Steps: 265 | Train Loss: 0.2115676 Vali Loss: 0.1705111 Test Loss: 0.2431662
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.635098009292423e-05
	iters: 100, epoch: 36 | loss: 0.2013057
	speed: 0.2161s/iter; left time: 3700.6252s
	iters: 200, epoch: 36 | loss: 0.2290440
	speed: 0.0713s/iter; left time: 1214.1325s
Epoch: 36 cost time: 21.681522607803345
Epoch: 36, Steps: 265 | Train Loss: 0.2099623 Vali Loss: 0.1691596 Test Loss: 0.2443355
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.765466802150444e-05
	iters: 100, epoch: 37 | loss: 0.2300678
	speed: 0.2207s/iter; left time: 3721.1273s
	iters: 200, epoch: 37 | loss: 0.1745679
	speed: 0.0715s/iter; left time: 1198.6260s
Epoch: 37 cost time: 21.39773678779602
Epoch: 37, Steps: 265 | Train Loss: 0.2079586 Vali Loss: 0.1715873 Test Loss: 0.2450729
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.867682665109111e-05
	iters: 100, epoch: 38 | loss: 0.2022022
	speed: 0.2207s/iter; left time: 3663.1663s
	iters: 200, epoch: 38 | loss: 0.1747788
	speed: 0.0713s/iter; left time: 1175.7885s
Epoch: 38 cost time: 21.888272047042847
Epoch: 38, Steps: 265 | Train Loss: 0.2061200 Vali Loss: 0.1706464 Test Loss: 0.2465118
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.941115284522702e-05
	iters: 100, epoch: 39 | loss: 0.1468470
	speed: 0.2124s/iter; left time: 3469.2458s
	iters: 200, epoch: 39 | loss: 0.1608444
	speed: 0.0709s/iter; left time: 1150.9809s
Epoch: 39 cost time: 21.09966731071472
Epoch: 39, Steps: 265 | Train Loss: 0.2041740 Vali Loss: 0.1707454 Test Loss: 0.2502564
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTSFL_ETTm2_ftM_sl336_ll48_pl192_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23663681745529175, mae:0.30195513367652893, rse:0.3931421935558319
