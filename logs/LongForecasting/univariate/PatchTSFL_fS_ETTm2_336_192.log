Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm2_336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm2_336_192_PatchTSFL_ETTm2_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2619918
	speed: 0.0680s/iter; left time: 1794.7815s
	iters: 200, epoch: 1 | loss: 0.1879590
	speed: 0.0471s/iter; left time: 1239.9762s
Epoch: 1 cost time: 14.758295059204102
Epoch: 1, Steps: 265 | Train Loss: 0.2431760 Vali Loss: 0.2095451 Test Loss: 0.1361131
Validation loss decreased (inf --> 0.209545).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.1867454
	speed: 0.1728s/iter; left time: 4515.0152s
	iters: 200, epoch: 2 | loss: 0.1822416
	speed: 0.0498s/iter; left time: 1296.4825s
Epoch: 2 cost time: 15.251527786254883
Epoch: 2, Steps: 265 | Train Loss: 0.2170983 Vali Loss: 0.2036366 Test Loss: 0.1301594
Validation loss decreased (0.209545 --> 0.203637).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.2103785
	speed: 0.1709s/iter; left time: 4422.0170s
	iters: 200, epoch: 3 | loss: 0.1937883
	speed: 0.0472s/iter; left time: 1216.6998s
Epoch: 3 cost time: 14.822897672653198
Epoch: 3, Steps: 265 | Train Loss: 0.2092370 Vali Loss: 0.1947372 Test Loss: 0.1238191
Validation loss decreased (0.203637 --> 0.194737).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.1819740
	speed: 0.1750s/iter; left time: 4481.0288s
	iters: 200, epoch: 4 | loss: 0.1869710
	speed: 0.0466s/iter; left time: 1188.0695s
Epoch: 4 cost time: 14.702797889709473
Epoch: 4, Steps: 265 | Train Loss: 0.1963369 Vali Loss: 0.1734717 Test Loss: 0.1119678
Validation loss decreased (0.194737 --> 0.173472).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.1516131
	speed: 0.1713s/iter; left time: 4341.6060s
	iters: 200, epoch: 5 | loss: 0.1622306
	speed: 0.0492s/iter; left time: 1241.0553s
Epoch: 5 cost time: 15.117952108383179
Epoch: 5, Steps: 265 | Train Loss: 0.1710380 Vali Loss: 0.1637676 Test Loss: 0.1124881
Validation loss decreased (0.173472 --> 0.163768).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.1662008
	speed: 0.1761s/iter; left time: 4416.8077s
	iters: 200, epoch: 6 | loss: 0.1727896
	speed: 0.0469s/iter; left time: 1170.4270s
Epoch: 6 cost time: 14.905564308166504
Epoch: 6, Steps: 265 | Train Loss: 0.1570730 Vali Loss: 0.1564826 Test Loss: 0.1112225
Validation loss decreased (0.163768 --> 0.156483).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.1672986
	speed: 0.1698s/iter; left time: 4213.7424s
	iters: 200, epoch: 7 | loss: 0.1418752
	speed: 0.0475s/iter; left time: 1174.8352s
Epoch: 7 cost time: 14.881036043167114
Epoch: 7, Steps: 265 | Train Loss: 0.1502589 Vali Loss: 0.1532703 Test Loss: 0.1093237
Validation loss decreased (0.156483 --> 0.153270).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.1411994
	speed: 0.1789s/iter; left time: 4390.2841s
	iters: 200, epoch: 8 | loss: 0.1408769
	speed: 0.0463s/iter; left time: 1131.8223s
Epoch: 8 cost time: 14.386621952056885
Epoch: 8, Steps: 265 | Train Loss: 0.1450576 Vali Loss: 0.1520553 Test Loss: 0.1082359
Validation loss decreased (0.153270 --> 0.152055).  Saving model ...
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.1493603
	speed: 0.1698s/iter; left time: 4121.8340s
	iters: 200, epoch: 9 | loss: 0.1249512
	speed: 0.0475s/iter; left time: 1148.4627s
Epoch: 9 cost time: 14.893053770065308
Epoch: 9, Steps: 265 | Train Loss: 0.1406298 Vali Loss: 0.1492791 Test Loss: 0.1059318
Validation loss decreased (0.152055 --> 0.149279).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.1195242
	speed: 0.1716s/iter; left time: 4122.1533s
	iters: 200, epoch: 10 | loss: 0.1378563
	speed: 0.0454s/iter; left time: 1086.3235s
Epoch: 10 cost time: 14.362650632858276
Epoch: 10, Steps: 265 | Train Loss: 0.1371247 Vali Loss: 0.1484660 Test Loss: 0.1049532
Validation loss decreased (0.149279 --> 0.148466).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.1287058
	speed: 0.1675s/iter; left time: 3978.7220s
	iters: 200, epoch: 11 | loss: 0.1360045
	speed: 0.0475s/iter; left time: 1123.5825s
Epoch: 11 cost time: 14.62578797340393
Epoch: 11, Steps: 265 | Train Loss: 0.1340124 Vali Loss: 0.1483004 Test Loss: 0.1040309
Validation loss decreased (0.148466 --> 0.148300).  Saving model ...
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.1157859
	speed: 0.1695s/iter; left time: 3981.5667s
	iters: 200, epoch: 12 | loss: 0.1378468
	speed: 0.0424s/iter; left time: 992.6650s
Epoch: 12 cost time: 13.93547773361206
Epoch: 12, Steps: 265 | Train Loss: 0.1316034 Vali Loss: 0.1460521 Test Loss: 0.1024548
Validation loss decreased (0.148300 --> 0.146052).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.1144801
	speed: 0.1701s/iter; left time: 3950.6678s
	iters: 200, epoch: 13 | loss: 0.1142040
	speed: 0.0497s/iter; left time: 1148.6918s
Epoch: 13 cost time: 15.258444547653198
Epoch: 13, Steps: 265 | Train Loss: 0.1297140 Vali Loss: 0.1448662 Test Loss: 0.1030180
Validation loss decreased (0.146052 --> 0.144866).  Saving model ...
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.1305566
	speed: 0.1696s/iter; left time: 3892.3347s
	iters: 200, epoch: 14 | loss: 0.1303098
	speed: 0.0468s/iter; left time: 1070.4134s
Epoch: 14 cost time: 14.626092910766602
Epoch: 14, Steps: 265 | Train Loss: 0.1274364 Vali Loss: 0.1444893 Test Loss: 0.1010029
Validation loss decreased (0.144866 --> 0.144489).  Saving model ...
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.1224464
	speed: 0.1710s/iter; left time: 3879.1705s
	iters: 200, epoch: 15 | loss: 0.1305816
	speed: 0.0473s/iter; left time: 1069.2750s
Epoch: 15 cost time: 14.884269714355469
Epoch: 15, Steps: 265 | Train Loss: 0.1258657 Vali Loss: 0.1441105 Test Loss: 0.1023035
Validation loss decreased (0.144489 --> 0.144111).  Saving model ...
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.1236656
	speed: 0.1705s/iter; left time: 3822.9266s
	iters: 200, epoch: 16 | loss: 0.1232021
	speed: 0.0474s/iter; left time: 1057.1667s
Epoch: 16 cost time: 14.708169937133789
Epoch: 16, Steps: 265 | Train Loss: 0.1245467 Vali Loss: 0.1451624 Test Loss: 0.1036719
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.1373466
	speed: 0.1721s/iter; left time: 3813.8714s
	iters: 200, epoch: 17 | loss: 0.1506147
	speed: 0.0474s/iter; left time: 1044.8960s
Epoch: 17 cost time: 14.428594589233398
Epoch: 17, Steps: 265 | Train Loss: 0.1228085 Vali Loss: 0.1431809 Test Loss: 0.1027573
Validation loss decreased (0.144111 --> 0.143181).  Saving model ...
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.1264867
	speed: 0.1703s/iter; left time: 3728.6606s
	iters: 200, epoch: 18 | loss: 0.1003659
	speed: 0.0476s/iter; left time: 1037.7657s
Epoch: 18 cost time: 15.047881364822388
Epoch: 18, Steps: 265 | Train Loss: 0.1211822 Vali Loss: 0.1431688 Test Loss: 0.1029818
Validation loss decreased (0.143181 --> 0.143169).  Saving model ...
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.0903709
	speed: 0.1714s/iter; left time: 3707.3297s
	iters: 200, epoch: 19 | loss: 0.1186814
	speed: 0.0465s/iter; left time: 1002.1784s
Epoch: 19 cost time: 14.679941892623901
Epoch: 19, Steps: 265 | Train Loss: 0.1198576 Vali Loss: 0.1416257 Test Loss: 0.1042203
Validation loss decreased (0.143169 --> 0.141626).  Saving model ...
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.1218324
	speed: 0.1701s/iter; left time: 3635.0953s
	iters: 200, epoch: 20 | loss: 0.1453785
	speed: 0.0476s/iter; left time: 1011.2240s
Epoch: 20 cost time: 14.806504726409912
Epoch: 20, Steps: 265 | Train Loss: 0.1181042 Vali Loss: 0.1429711 Test Loss: 0.1079412
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.1117937
	speed: 0.1758s/iter; left time: 3708.6314s
	iters: 200, epoch: 21 | loss: 0.1295501
	speed: 0.0470s/iter; left time: 986.7082s
Epoch: 21 cost time: 15.03447437286377
Epoch: 21, Steps: 265 | Train Loss: 0.1170326 Vali Loss: 0.1445562 Test Loss: 0.1057838
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.1106557
	speed: 0.1715s/iter; left time: 3573.4587s
	iters: 200, epoch: 22 | loss: 0.1337919
	speed: 0.0457s/iter; left time: 948.5335s
Epoch: 22 cost time: 14.656420707702637
Epoch: 22, Steps: 265 | Train Loss: 0.1155835 Vali Loss: 0.1398814 Test Loss: 0.1079438
Validation loss decreased (0.141626 --> 0.139881).  Saving model ...
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.1070626
	speed: 0.1656s/iter; left time: 3407.0987s
	iters: 200, epoch: 23 | loss: 0.1058083
	speed: 0.0481s/iter; left time: 984.0126s
Epoch: 23 cost time: 14.846494197845459
Epoch: 23, Steps: 265 | Train Loss: 0.1136185 Vali Loss: 0.1430350 Test Loss: 0.1074823
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.1085564
	speed: 0.1704s/iter; left time: 3459.9840s
	iters: 200, epoch: 24 | loss: 0.1205694
	speed: 0.0473s/iter; left time: 956.5850s
Epoch: 24 cost time: 14.704516410827637
Epoch: 24, Steps: 265 | Train Loss: 0.1117275 Vali Loss: 0.1422772 Test Loss: 0.1100416
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.1155988
	speed: 0.1646s/iter; left time: 3299.2409s
	iters: 200, epoch: 25 | loss: 0.1191971
	speed: 0.0486s/iter; left time: 968.4955s
Epoch: 25 cost time: 14.832391500473022
Epoch: 25, Steps: 265 | Train Loss: 0.1102825 Vali Loss: 0.1440472 Test Loss: 0.1127676
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.1083829
	speed: 0.1729s/iter; left time: 3420.1133s
	iters: 200, epoch: 26 | loss: 0.1144709
	speed: 0.0490s/iter; left time: 963.4195s
Epoch: 26 cost time: 15.159138679504395
Epoch: 26, Steps: 265 | Train Loss: 0.1085346 Vali Loss: 0.1466555 Test Loss: 0.1141744
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.0987375
	speed: 0.1651s/iter; left time: 3221.9807s
	iters: 200, epoch: 27 | loss: 0.1266609
	speed: 0.0451s/iter; left time: 874.6772s
Epoch: 27 cost time: 14.3847815990448
Epoch: 27, Steps: 265 | Train Loss: 0.1068556 Vali Loss: 0.1487120 Test Loss: 0.1148109
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.1031848
	speed: 0.1615s/iter; left time: 3107.9900s
	iters: 200, epoch: 28 | loss: 0.1016868
	speed: 0.0480s/iter; left time: 919.3574s
Epoch: 28 cost time: 14.414712905883789
Epoch: 28, Steps: 265 | Train Loss: 0.1049943 Vali Loss: 0.1487200 Test Loss: 0.1160940
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.1023578
	speed: 0.1658s/iter; left time: 3147.9421s
	iters: 200, epoch: 29 | loss: 0.1084333
	speed: 0.0478s/iter; left time: 903.4194s
Epoch: 29 cost time: 14.512022495269775
Epoch: 29, Steps: 265 | Train Loss: 0.1033584 Vali Loss: 0.1484930 Test Loss: 0.1150217
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.1028579
	speed: 0.1748s/iter; left time: 3270.8377s
	iters: 200, epoch: 30 | loss: 0.1030668
	speed: 0.0465s/iter; left time: 865.6748s
Epoch: 30 cost time: 15.395804405212402
Epoch: 30, Steps: 265 | Train Loss: 0.1012350 Vali Loss: 0.1489063 Test Loss: 0.1153560
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.1006975
	speed: 0.1665s/iter; left time: 3071.9949s
	iters: 200, epoch: 31 | loss: 0.0950657
	speed: 0.0453s/iter; left time: 832.1699s
Epoch: 31 cost time: 14.265536546707153
Epoch: 31, Steps: 265 | Train Loss: 0.1000857 Vali Loss: 0.1519998 Test Loss: 0.1177790
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.1008587
	speed: 0.1611s/iter; left time: 2929.9767s
	iters: 200, epoch: 32 | loss: 0.0803873
	speed: 0.0465s/iter; left time: 840.1038s
Epoch: 32 cost time: 14.172242641448975
Epoch: 32, Steps: 265 | Train Loss: 0.0982903 Vali Loss: 0.1560679 Test Loss: 0.1228527
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.0859058
	speed: 0.1623s/iter; left time: 2907.7174s
	iters: 200, epoch: 33 | loss: 0.0878961
	speed: 0.0440s/iter; left time: 783.7850s
Epoch: 33 cost time: 14.280129194259644
Epoch: 33, Steps: 265 | Train Loss: 0.0964726 Vali Loss: 0.1544881 Test Loss: 0.1212412
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.1066584
	speed: 0.1616s/iter; left time: 2853.3556s
	iters: 200, epoch: 34 | loss: 0.0789123
	speed: 0.0472s/iter; left time: 828.3818s
Epoch: 34 cost time: 14.762412071228027
Epoch: 34, Steps: 265 | Train Loss: 0.0947478 Vali Loss: 0.1596124 Test Loss: 0.1222218
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.477380205092656e-05
	iters: 100, epoch: 35 | loss: 0.0871551
	speed: 0.1710s/iter; left time: 2974.0788s
	iters: 200, epoch: 35 | loss: 0.0903730
	speed: 0.0449s/iter; left time: 776.1470s
Epoch: 35 cost time: 14.172481060028076
Epoch: 35, Steps: 265 | Train Loss: 0.0932488 Vali Loss: 0.1567913 Test Loss: 0.1220421
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.635098009292423e-05
	iters: 100, epoch: 36 | loss: 0.0951338
	speed: 0.1702s/iter; left time: 2914.6744s
	iters: 200, epoch: 36 | loss: 0.0909330
	speed: 0.0476s/iter; left time: 809.8462s
Epoch: 36 cost time: 14.938019752502441
Epoch: 36, Steps: 265 | Train Loss: 0.0922427 Vali Loss: 0.1570119 Test Loss: 0.1227243
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.765466802150444e-05
	iters: 100, epoch: 37 | loss: 0.0794248
	speed: 0.1805s/iter; left time: 3042.6260s
	iters: 200, epoch: 37 | loss: 0.1075242
	speed: 0.0464s/iter; left time: 777.0074s
Epoch: 37 cost time: 15.077495098114014
Epoch: 37, Steps: 265 | Train Loss: 0.0900281 Vali Loss: 0.1576474 Test Loss: 0.1231554
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.867682665109111e-05
	iters: 100, epoch: 38 | loss: 0.0861210
	speed: 0.1642s/iter; left time: 2725.8833s
	iters: 200, epoch: 38 | loss: 0.0755350
	speed: 0.0463s/iter; left time: 764.1970s
Epoch: 38 cost time: 14.549945831298828
Epoch: 38, Steps: 265 | Train Loss: 0.0889878 Vali Loss: 0.1583333 Test Loss: 0.1210962
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.941115284522702e-05
	iters: 100, epoch: 39 | loss: 0.1074950
	speed: 0.1621s/iter; left time: 2646.4559s
	iters: 200, epoch: 39 | loss: 0.1011247
	speed: 0.0473s/iter; left time: 767.7540s
Epoch: 39 cost time: 14.4633469581604
Epoch: 39, Steps: 265 | Train Loss: 0.0878023 Vali Loss: 0.1643830 Test Loss: 0.1260989
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.985311838483566e-05
	iters: 100, epoch: 40 | loss: 0.1096220
	speed: 0.1625s/iter; left time: 2610.2794s
	iters: 200, epoch: 40 | loss: 0.0773686
	speed: 0.0449s/iter; left time: 716.8981s
Epoch: 40 cost time: 14.12372875213623
Epoch: 40, Steps: 265 | Train Loss: 0.0864245 Vali Loss: 0.1623084 Test Loss: 0.1234523
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.99999990240136e-05
	iters: 100, epoch: 41 | loss: 0.0791748
	speed: 0.1578s/iter; left time: 2493.9626s
	iters: 200, epoch: 41 | loss: 0.0739367
	speed: 0.0481s/iter; left time: 755.1518s
Epoch: 41 cost time: 14.467623949050903
Epoch: 41, Steps: 265 | Train Loss: 0.0851906 Vali Loss: 0.1610823 Test Loss: 0.1253653
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.993095900070463e-05
	iters: 100, epoch: 42 | loss: 0.0770308
	speed: 0.1684s/iter; left time: 2616.5445s
	iters: 200, epoch: 42 | loss: 0.0697922
	speed: 0.0467s/iter; left time: 720.2663s
Epoch: 42 cost time: 14.664873838424683
Epoch: 42, Steps: 265 | Train Loss: 0.0838710 Vali Loss: 0.1641620 Test Loss: 0.1247931
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_192_PatchTSFL_ETTm2_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.10794377326965332, mae:0.24520422518253326, rse:0.5341019034385681
