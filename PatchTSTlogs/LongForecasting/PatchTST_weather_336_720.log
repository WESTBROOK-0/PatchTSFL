Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7666508
	speed: 0.1446s/iter; left time: 4019.8295s
	iters: 200, epoch: 1 | loss: 0.7272367
	speed: 0.1319s/iter; left time: 3653.6682s
Epoch: 1 cost time: 38.260976791381836
Epoch: 1, Steps: 279 | Train Loss: 0.8809124 Vali Loss: 0.7657149 Test Loss: 0.3630114
Validation loss decreased (inf --> 0.765715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7214640
	speed: 0.3575s/iter; left time: 9839.7238s
	iters: 200, epoch: 2 | loss: 0.6158687
	speed: 0.1320s/iter; left time: 3619.9764s
Epoch: 2 cost time: 38.60745930671692
Epoch: 2, Steps: 279 | Train Loss: 0.6560369 Vali Loss: 0.6773762 Test Loss: 0.3299652
Validation loss decreased (0.765715 --> 0.677376).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5378044
	speed: 0.3620s/iter; left time: 9861.7046s
	iters: 200, epoch: 3 | loss: 0.5987226
	speed: 0.1318s/iter; left time: 3577.1915s
Epoch: 3 cost time: 38.8448052406311
Epoch: 3, Steps: 279 | Train Loss: 0.6285128 Vali Loss: 0.6652461 Test Loss: 0.3252564
Validation loss decreased (0.677376 --> 0.665246).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6208027
	speed: 0.3525s/iter; left time: 9503.9973s
	iters: 200, epoch: 4 | loss: 0.6668232
	speed: 0.1314s/iter; left time: 3529.5865s
Epoch: 4 cost time: 38.196388959884644
Epoch: 4, Steps: 279 | Train Loss: 0.6222854 Vali Loss: 0.6606341 Test Loss: 0.3224489
Validation loss decreased (0.665246 --> 0.660634).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6965525
	speed: 0.3554s/iter; left time: 9484.2569s
	iters: 200, epoch: 5 | loss: 0.4887238
	speed: 0.1317s/iter; left time: 3501.7710s
Epoch: 5 cost time: 38.51406526565552
Epoch: 5, Steps: 279 | Train Loss: 0.6168068 Vali Loss: 0.6600542 Test Loss: 0.3217631
Validation loss decreased (0.660634 --> 0.660054).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5900833
	speed: 0.3447s/iter; left time: 9103.2894s
	iters: 200, epoch: 6 | loss: 0.6007920
	speed: 0.1318s/iter; left time: 3465.8654s
Epoch: 6 cost time: 38.28324508666992
Epoch: 6, Steps: 279 | Train Loss: 0.6137615 Vali Loss: 0.6557099 Test Loss: 0.3201952
Validation loss decreased (0.660054 --> 0.655710).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5627395
	speed: 0.3534s/iter; left time: 9232.3422s
	iters: 200, epoch: 7 | loss: 0.5906234
	speed: 0.1315s/iter; left time: 3421.3956s
Epoch: 7 cost time: 38.2860803604126
Epoch: 7, Steps: 279 | Train Loss: 0.6109966 Vali Loss: 0.6518393 Test Loss: 0.3195884
Validation loss decreased (0.655710 --> 0.651839).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5662389
	speed: 0.3547s/iter; left time: 9168.9675s
	iters: 200, epoch: 8 | loss: 0.6079954
	speed: 0.1312s/iter; left time: 3379.2493s
Epoch: 8 cost time: 38.30341911315918
Epoch: 8, Steps: 279 | Train Loss: 0.6094199 Vali Loss: 0.6565452 Test Loss: 0.3200300
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6251298
	speed: 0.3525s/iter; left time: 9014.1172s
	iters: 200, epoch: 9 | loss: 0.6851711
	speed: 0.1317s/iter; left time: 3354.9928s
Epoch: 9 cost time: 38.38958549499512
Epoch: 9, Steps: 279 | Train Loss: 0.6072647 Vali Loss: 0.6572505 Test Loss: 0.3199307
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5970393
	speed: 0.3636s/iter; left time: 9194.7232s
	iters: 200, epoch: 10 | loss: 0.7279502
	speed: 0.1321s/iter; left time: 3326.7690s
Epoch: 10 cost time: 38.90028524398804
Epoch: 10, Steps: 279 | Train Loss: 0.6050210 Vali Loss: 0.6567619 Test Loss: 0.3198670
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5883632
	speed: 0.3512s/iter; left time: 8783.9238s
	iters: 200, epoch: 11 | loss: 0.6533380
	speed: 0.1316s/iter; left time: 3278.3177s
Epoch: 11 cost time: 38.32887554168701
Epoch: 11, Steps: 279 | Train Loss: 0.6030786 Vali Loss: 0.6560925 Test Loss: 0.3197496
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5073985
	speed: 0.3447s/iter; left time: 8524.9489s
	iters: 200, epoch: 12 | loss: 0.6283964
	speed: 0.1316s/iter; left time: 3240.9870s
Epoch: 12 cost time: 38.213324546813965
Epoch: 12, Steps: 279 | Train Loss: 0.6011582 Vali Loss: 0.6557571 Test Loss: 0.3200224
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6413038
	speed: 0.3451s/iter; left time: 8438.1062s
	iters: 200, epoch: 13 | loss: 0.5714406
	speed: 0.1315s/iter; left time: 3201.6793s
Epoch: 13 cost time: 38.09601354598999
Epoch: 13, Steps: 279 | Train Loss: 0.5995905 Vali Loss: 0.6519435 Test Loss: 0.3197701
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7063909
	speed: 0.3437s/iter; left time: 8308.9170s
	iters: 200, epoch: 14 | loss: 0.5345545
	speed: 0.1314s/iter; left time: 3163.6349s
Epoch: 14 cost time: 38.009636878967285
Epoch: 14, Steps: 279 | Train Loss: 0.5979810 Vali Loss: 0.6534354 Test Loss: 0.3191381
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7051504
	speed: 0.3443s/iter; left time: 8226.3622s
	iters: 200, epoch: 15 | loss: 0.5318527
	speed: 0.1316s/iter; left time: 3132.5611s
Epoch: 15 cost time: 38.311845541000366
Epoch: 15, Steps: 279 | Train Loss: 0.5966592 Vali Loss: 0.6503747 Test Loss: 0.3195538
Validation loss decreased (0.651839 --> 0.650375).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5941631
	speed: 0.3470s/iter; left time: 8195.3661s
	iters: 200, epoch: 16 | loss: 0.6272526
	speed: 0.1318s/iter; left time: 3098.2569s
Epoch: 16 cost time: 38.317760944366455
Epoch: 16, Steps: 279 | Train Loss: 0.5958150 Vali Loss: 0.6540636 Test Loss: 0.3211452
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.5870048
	speed: 0.3426s/iter; left time: 7994.7803s
	iters: 200, epoch: 17 | loss: 0.6198922
	speed: 0.1318s/iter; left time: 3061.7606s
Epoch: 17 cost time: 38.13334918022156
Epoch: 17, Steps: 279 | Train Loss: 0.5950086 Vali Loss: 0.6515115 Test Loss: 0.3202115
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.5515088
	speed: 0.3446s/iter; left time: 7945.3517s
	iters: 200, epoch: 18 | loss: 0.6220740
	speed: 0.1316s/iter; left time: 3020.5812s
Epoch: 18 cost time: 38.11266565322876
Epoch: 18, Steps: 279 | Train Loss: 0.5946097 Vali Loss: 0.6522666 Test Loss: 0.3203858
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5101938
	speed: 0.3445s/iter; left time: 7846.3601s
	iters: 200, epoch: 19 | loss: 0.5875286
	speed: 0.1316s/iter; left time: 2983.7330s
Epoch: 19 cost time: 38.23184299468994
Epoch: 19, Steps: 279 | Train Loss: 0.5938671 Vali Loss: 0.6510521 Test Loss: 0.3206619
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.5714304
	speed: 0.3475s/iter; left time: 7817.9282s
	iters: 200, epoch: 20 | loss: 0.6696218
	speed: 0.1316s/iter; left time: 2947.8344s
Epoch: 20 cost time: 38.27237272262573
Epoch: 20, Steps: 279 | Train Loss: 0.5932210 Vali Loss: 0.6526759 Test Loss: 0.3204865
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6785656
	speed: 0.3464s/iter; left time: 7697.5248s
	iters: 200, epoch: 21 | loss: 0.5684450
	speed: 0.1316s/iter; left time: 2911.1779s
Epoch: 21 cost time: 38.10538387298584
Epoch: 21, Steps: 279 | Train Loss: 0.5926599 Vali Loss: 0.6533720 Test Loss: 0.3212128
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.5842305
	speed: 0.3470s/iter; left time: 7613.4641s
	iters: 200, epoch: 22 | loss: 0.5901673
	speed: 0.1315s/iter; left time: 2871.8905s
Epoch: 22 cost time: 38.19862627983093
Epoch: 22, Steps: 279 | Train Loss: 0.5924028 Vali Loss: 0.6524995 Test Loss: 0.3212506
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6221759
	speed: 0.3437s/iter; left time: 7445.2361s
	iters: 200, epoch: 23 | loss: 0.6192393
	speed: 0.1314s/iter; left time: 2834.0886s
Epoch: 23 cost time: 38.00093126296997
Epoch: 23, Steps: 279 | Train Loss: 0.5915134 Vali Loss: 0.6522685 Test Loss: 0.3213558
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5540571
	speed: 0.3446s/iter; left time: 7369.3918s
	iters: 200, epoch: 24 | loss: 0.5777647
	speed: 0.1315s/iter; left time: 2798.7904s
Epoch: 24 cost time: 38.21194410324097
Epoch: 24, Steps: 279 | Train Loss: 0.5913870 Vali Loss: 0.6534895 Test Loss: 0.3215554
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.8127357
	speed: 0.3455s/iter; left time: 7292.0162s
	iters: 200, epoch: 25 | loss: 0.5682836
	speed: 0.1314s/iter; left time: 2760.9419s
Epoch: 25 cost time: 38.1731595993042
Epoch: 25, Steps: 279 | Train Loss: 0.5909689 Vali Loss: 0.6526564 Test Loss: 0.3215400
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.5954890
	speed: 0.3455s/iter; left time: 7195.4431s
	iters: 200, epoch: 26 | loss: 0.6241432
	speed: 0.1315s/iter; left time: 2725.8596s
Epoch: 26 cost time: 38.169387102127075
Epoch: 26, Steps: 279 | Train Loss: 0.5907828 Vali Loss: 0.6534712 Test Loss: 0.3213616
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6316953
	speed: 0.3434s/iter; left time: 7056.3974s
	iters: 200, epoch: 27 | loss: 0.5496267
	speed: 0.1316s/iter; left time: 2690.1231s
Epoch: 27 cost time: 38.06743144989014
Epoch: 27, Steps: 279 | Train Loss: 0.5901222 Vali Loss: 0.6537868 Test Loss: 0.3219802
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.7302797
	speed: 0.3496s/iter; left time: 7086.1946s
	iters: 200, epoch: 28 | loss: 0.5742143
	speed: 0.1316s/iter; left time: 2653.6640s
Epoch: 28 cost time: 38.27653741836548
Epoch: 28, Steps: 279 | Train Loss: 0.5904067 Vali Loss: 0.6514665 Test Loss: 0.3221102
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.5818064
	speed: 0.3474s/iter; left time: 6943.5856s
	iters: 200, epoch: 29 | loss: 0.6611590
	speed: 0.1314s/iter; left time: 2614.1872s
Epoch: 29 cost time: 38.06342577934265
Epoch: 29, Steps: 279 | Train Loss: 0.5897753 Vali Loss: 0.6520706 Test Loss: 0.3221334
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.5921252
	speed: 0.3447s/iter; left time: 6794.4168s
	iters: 200, epoch: 30 | loss: 0.5040072
	speed: 0.1315s/iter; left time: 2579.2951s
Epoch: 30 cost time: 38.09664607048035
Epoch: 30, Steps: 279 | Train Loss: 0.5895179 Vali Loss: 0.6532520 Test Loss: 0.3221706
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.5822840
	speed: 0.3474s/iter; left time: 6749.8493s
	iters: 200, epoch: 31 | loss: 0.5413070
	speed: 0.1316s/iter; left time: 2543.2597s
Epoch: 31 cost time: 38.23558330535889
Epoch: 31, Steps: 279 | Train Loss: 0.5894755 Vali Loss: 0.6524510 Test Loss: 0.3220941
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6380607
	speed: 0.3448s/iter; left time: 6604.2463s
	iters: 200, epoch: 32 | loss: 0.5279662
	speed: 0.1317s/iter; left time: 2509.8911s
Epoch: 32 cost time: 38.151511907577515
Epoch: 32, Steps: 279 | Train Loss: 0.5889801 Vali Loss: 0.6525057 Test Loss: 0.3225681
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.7161353
	speed: 0.3480s/iter; left time: 6568.0715s
	iters: 200, epoch: 33 | loss: 0.5755450
	speed: 0.1317s/iter; left time: 2472.1910s
Epoch: 33 cost time: 38.35266995429993
Epoch: 33, Steps: 279 | Train Loss: 0.5889766 Vali Loss: 0.6524724 Test Loss: 0.3221020
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.5432985
	speed: 0.3449s/iter; left time: 6412.4696s
	iters: 200, epoch: 34 | loss: 0.5628246
	speed: 0.1317s/iter; left time: 2436.5788s
Epoch: 34 cost time: 38.30130743980408
Epoch: 34, Steps: 279 | Train Loss: 0.5887982 Vali Loss: 0.6525283 Test Loss: 0.3221780
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.5797110
	speed: 0.3448s/iter; left time: 6315.4321s
	iters: 200, epoch: 35 | loss: 0.5318502
	speed: 0.1319s/iter; left time: 2402.3266s
Epoch: 35 cost time: 38.16669750213623
Epoch: 35, Steps: 279 | Train Loss: 0.5889103 Vali Loss: 0.6514553 Test Loss: 0.3221627
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3195534944534302, mae:0.3345138430595398, rse:0.7457432150840759
