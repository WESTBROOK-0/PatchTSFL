Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.05, loss='mse', lradj='type3', model='DLinear', model_id='ETTh2_336_720', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_336_720_DLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6942276
	speed: 0.0124s/iter; left time: 292.5378s
	iters: 200, epoch: 1 | loss: 0.7319641
	speed: 0.0044s/iter; left time: 103.0684s
Epoch: 1 cost time: 1.9625942707061768
Epoch: 1, Steps: 237 | Train Loss: 0.7488309 Vali Loss: 0.6847393 Test Loss: 0.7524789
Validation loss decreased (inf --> 0.684739).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 4.7248139
	speed: 0.0361s/iter; left time: 844.1282s
	iters: 200, epoch: 2 | loss: 1.9198347
	speed: 0.0045s/iter; left time: 105.5473s
Epoch: 2 cost time: 1.885788917541504
Epoch: 2, Steps: 237 | Train Loss: 2.8838726 Vali Loss: 1.6588514 Test Loss: 3.1645737
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.05
	iters: 100, epoch: 3 | loss: 2.0165234
	speed: 0.0356s/iter; left time: 823.5258s
	iters: 200, epoch: 3 | loss: 1.5474155
	speed: 0.0047s/iter; left time: 107.9015s
Epoch: 3 cost time: 1.8927347660064697
Epoch: 3, Steps: 237 | Train Loss: 1.4742648 Vali Loss: 1.0539429 Test Loss: 1.3300714
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.05
	iters: 100, epoch: 4 | loss: 1.4467715
	speed: 0.0345s/iter; left time: 789.1131s
	iters: 200, epoch: 4 | loss: 1.9980328
	speed: 0.0048s/iter; left time: 108.9057s
Epoch: 4 cost time: 1.8363597393035889
Epoch: 4, Steps: 237 | Train Loss: 1.4943887 Vali Loss: 1.3528385 Test Loss: 1.6224260
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.045000000000000005
	iters: 100, epoch: 5 | loss: 1.4280161
	speed: 0.0367s/iter; left time: 830.3591s
	iters: 200, epoch: 5 | loss: 1.6130866
	speed: 0.0047s/iter; left time: 105.7022s
Epoch: 5 cost time: 1.950092077255249
Epoch: 5, Steps: 237 | Train Loss: 1.5156741 Vali Loss: 1.2625618 Test Loss: 2.3177798
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.04050000000000001
	iters: 100, epoch: 6 | loss: 1.0578560
	speed: 0.0377s/iter; left time: 845.9033s
	iters: 200, epoch: 6 | loss: 0.8390487
	speed: 0.0045s/iter; left time: 100.6518s
Epoch: 6 cost time: 1.8867383003234863
Epoch: 6, Steps: 237 | Train Loss: 1.2866889 Vali Loss: 1.0648474 Test Loss: 1.7325511
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.03645
	iters: 100, epoch: 7 | loss: 1.3074987
	speed: 0.0363s/iter; left time: 804.8827s
	iters: 200, epoch: 7 | loss: 1.0095803
	speed: 0.0047s/iter; left time: 102.7414s
Epoch: 7 cost time: 1.879455804824829
Epoch: 7, Steps: 237 | Train Loss: 1.0766278 Vali Loss: 1.0834820 Test Loss: 1.9233854
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.032805
	iters: 100, epoch: 8 | loss: 1.4304024
	speed: 0.0353s/iter; left time: 774.5055s
	iters: 200, epoch: 8 | loss: 1.2629060
	speed: 0.0046s/iter; left time: 100.4438s
Epoch: 8 cost time: 1.754425287246704
Epoch: 8, Steps: 237 | Train Loss: 1.1740854 Vali Loss: 0.9336452 Test Loss: 1.3164321
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.029524500000000006
	iters: 100, epoch: 9 | loss: 0.6838933
	speed: 0.0381s/iter; left time: 827.7615s
	iters: 200, epoch: 9 | loss: 1.1281283
	speed: 0.0047s/iter; left time: 101.6476s
Epoch: 9 cost time: 1.9087939262390137
Epoch: 9, Steps: 237 | Train Loss: 1.0884075 Vali Loss: 1.3502047 Test Loss: 2.8215353
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.026572050000000003
	iters: 100, epoch: 10 | loss: 0.9116866
	speed: 0.0366s/iter; left time: 784.7013s
	iters: 200, epoch: 10 | loss: 2.1274979
	speed: 0.0046s/iter; left time: 98.6827s
Epoch: 10 cost time: 1.8744127750396729
Epoch: 10, Steps: 237 | Train Loss: 1.1384717 Vali Loss: 1.2436762 Test Loss: 3.0319014
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.023914845000000004
	iters: 100, epoch: 11 | loss: 1.0787487
	speed: 0.0364s/iter; left time: 772.4899s
	iters: 200, epoch: 11 | loss: 1.1669290
	speed: 0.0048s/iter; left time: 100.9406s
Epoch: 11 cost time: 1.9449880123138428
Epoch: 11, Steps: 237 | Train Loss: 1.0283616 Vali Loss: 0.8665679 Test Loss: 1.3891131
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.021523360500000005
	iters: 100, epoch: 12 | loss: 1.0787859
	speed: 0.0374s/iter; left time: 785.8170s
	iters: 200, epoch: 12 | loss: 1.0451726
	speed: 0.0047s/iter; left time: 98.2298s
Epoch: 12 cost time: 1.9599428176879883
Epoch: 12, Steps: 237 | Train Loss: 0.9387849 Vali Loss: 0.7910948 Test Loss: 1.0264956
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.019371024450000007
	iters: 100, epoch: 13 | loss: 0.9349923
	speed: 0.0389s/iter; left time: 807.0682s
	iters: 200, epoch: 13 | loss: 0.7046984
	speed: 0.0044s/iter; left time: 91.2679s
Epoch: 13 cost time: 1.9729576110839844
Epoch: 13, Steps: 237 | Train Loss: 0.8922901 Vali Loss: 0.7866734 Test Loss: 1.0898246
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.017433922005000005
	iters: 100, epoch: 14 | loss: 0.6743404
	speed: 0.0386s/iter; left time: 791.4248s
	iters: 200, epoch: 14 | loss: 0.7743719
	speed: 0.0045s/iter; left time: 91.1399s
Epoch: 14 cost time: 1.9278814792633057
Epoch: 14, Steps: 237 | Train Loss: 0.9022813 Vali Loss: 0.9075397 Test Loss: 1.5160536
EarlyStopping counter: 13 out of 100
Updating learning rate to 0.015690529804500003
	iters: 100, epoch: 15 | loss: 0.7651469
	speed: 0.0343s/iter; left time: 695.4697s
	iters: 200, epoch: 15 | loss: 1.3615053
	speed: 0.0046s/iter; left time: 92.9470s
Epoch: 15 cost time: 1.8273327350616455
Epoch: 15, Steps: 237 | Train Loss: 0.8993884 Vali Loss: 0.7511562 Test Loss: 0.8362314
EarlyStopping counter: 14 out of 100
Updating learning rate to 0.014121476824050006
	iters: 100, epoch: 16 | loss: 0.5438894
	speed: 0.0381s/iter; left time: 763.6435s
	iters: 200, epoch: 16 | loss: 1.0171856
	speed: 0.0045s/iter; left time: 90.5031s
Epoch: 16 cost time: 1.9245808124542236
Epoch: 16, Steps: 237 | Train Loss: 0.8601569 Vali Loss: 0.7691323 Test Loss: 1.0213227
EarlyStopping counter: 15 out of 100
Updating learning rate to 0.012709329141645005
	iters: 100, epoch: 17 | loss: 0.7366826
	speed: 0.0375s/iter; left time: 742.2566s
	iters: 200, epoch: 17 | loss: 0.5963584
	speed: 0.0048s/iter; left time: 95.1959s
Epoch: 17 cost time: 2.006131887435913
Epoch: 17, Steps: 237 | Train Loss: 0.8373834 Vali Loss: 0.7411285 Test Loss: 0.6444689
EarlyStopping counter: 16 out of 100
Updating learning rate to 0.011438396227480505
	iters: 100, epoch: 18 | loss: 0.5557907
	speed: 0.0374s/iter; left time: 731.9495s
	iters: 200, epoch: 18 | loss: 1.0322415
	speed: 0.0046s/iter; left time: 89.8134s
Epoch: 18 cost time: 1.8670063018798828
Epoch: 18, Steps: 237 | Train Loss: 0.8313456 Vali Loss: 0.6795303 Test Loss: 0.6445494
Validation loss decreased (0.684739 --> 0.679530).  Saving model ...
Updating learning rate to 0.010294556604732455
	iters: 100, epoch: 19 | loss: 0.9672864
	speed: 0.0357s/iter; left time: 690.8849s
	iters: 200, epoch: 19 | loss: 0.7327306
	speed: 0.0048s/iter; left time: 92.6036s
Epoch: 19 cost time: 1.85658860206604
Epoch: 19, Steps: 237 | Train Loss: 0.8166456 Vali Loss: 0.8302924 Test Loss: 1.2582384
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.009265100944259209
	iters: 100, epoch: 20 | loss: 0.8904637
	speed: 0.0385s/iter; left time: 736.0348s
	iters: 200, epoch: 20 | loss: 0.8935409
	speed: 0.0047s/iter; left time: 89.3483s
Epoch: 20 cost time: 1.9204561710357666
Epoch: 20, Steps: 237 | Train Loss: 0.7997023 Vali Loss: 0.7564571 Test Loss: 0.9461464
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.008338590849833289
	iters: 100, epoch: 21 | loss: 0.9641957
	speed: 0.0392s/iter; left time: 739.8313s
	iters: 200, epoch: 21 | loss: 0.7389475
	speed: 0.0049s/iter; left time: 92.0515s
Epoch: 21 cost time: 1.970905065536499
Epoch: 21, Steps: 237 | Train Loss: 0.7995478 Vali Loss: 0.7518646 Test Loss: 1.1081401
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.007504731764849959
	iters: 100, epoch: 22 | loss: 0.7651554
	speed: 0.0361s/iter; left time: 671.4572s
	iters: 200, epoch: 22 | loss: 1.2196913
	speed: 0.0046s/iter; left time: 84.8951s
Epoch: 22 cost time: 1.7620117664337158
Epoch: 22, Steps: 237 | Train Loss: 0.7869174 Vali Loss: 0.6579880 Test Loss: 0.6570019
Validation loss decreased (0.679530 --> 0.657988).  Saving model ...
Updating learning rate to 0.006754258588364964
	iters: 100, epoch: 23 | loss: 0.9907496
	speed: 0.0376s/iter; left time: 692.0608s
	iters: 200, epoch: 23 | loss: 0.6683447
	speed: 0.0046s/iter; left time: 84.0777s
Epoch: 23 cost time: 1.872427225112915
Epoch: 23, Steps: 237 | Train Loss: 0.7762589 Vali Loss: 0.7679566 Test Loss: 0.9346315
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.006078832729528468
	iters: 100, epoch: 24 | loss: 0.5032350
	speed: 0.0370s/iter; left time: 671.1905s
	iters: 200, epoch: 24 | loss: 0.5221316
	speed: 0.0048s/iter; left time: 87.4526s
Epoch: 24 cost time: 1.9552981853485107
Epoch: 24, Steps: 237 | Train Loss: 0.7680038 Vali Loss: 0.7795750 Test Loss: 1.0842432
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.005470949456575621
	iters: 100, epoch: 25 | loss: 0.7443628
	speed: 0.0373s/iter; left time: 668.1032s
	iters: 200, epoch: 25 | loss: 0.7241132
	speed: 0.0045s/iter; left time: 80.8914s
Epoch: 25 cost time: 1.920902967453003
Epoch: 25, Steps: 237 | Train Loss: 0.7632394 Vali Loss: 0.6841287 Test Loss: 0.7190732
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00492385451091806
	iters: 100, epoch: 26 | loss: 0.6891946
	speed: 0.0377s/iter; left time: 665.9499s
	iters: 200, epoch: 26 | loss: 0.8731401
	speed: 0.0052s/iter; left time: 92.1919s
Epoch: 26 cost time: 2.043689012527466
Epoch: 26, Steps: 237 | Train Loss: 0.7629650 Vali Loss: 0.7730707 Test Loss: 1.0219914
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.004431469059826254
	iters: 100, epoch: 27 | loss: 0.9317433
	speed: 0.0388s/iter; left time: 675.8030s
	iters: 200, epoch: 27 | loss: 0.7258892
	speed: 0.0050s/iter; left time: 87.5052s
Epoch: 27 cost time: 2.042945623397827
Epoch: 27, Steps: 237 | Train Loss: 0.7484789 Vali Loss: 0.6514748 Test Loss: 0.6392549
Validation loss decreased (0.657988 --> 0.651475).  Saving model ...
Updating learning rate to 0.003988322153843628
	iters: 100, epoch: 28 | loss: 0.6342113
	speed: 0.0379s/iter; left time: 652.4788s
	iters: 200, epoch: 28 | loss: 0.7041438
	speed: 0.0045s/iter; left time: 77.7093s
Epoch: 28 cost time: 1.8477108478546143
Epoch: 28, Steps: 237 | Train Loss: 0.7470775 Vali Loss: 0.7239017 Test Loss: 1.0071626
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.003589489938459265
	iters: 100, epoch: 29 | loss: 0.4436816
	speed: 0.0364s/iter; left time: 616.7643s
	iters: 200, epoch: 29 | loss: 0.9632596
	speed: 0.0047s/iter; left time: 79.3002s
Epoch: 29 cost time: 1.9001195430755615
Epoch: 29, Steps: 237 | Train Loss: 0.7417956 Vali Loss: 0.6991881 Test Loss: 0.8092673
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.003230540944613339
	iters: 100, epoch: 30 | loss: 0.7660349
	speed: 0.0362s/iter; left time: 604.9335s
	iters: 200, epoch: 30 | loss: 0.9379752
	speed: 0.0045s/iter; left time: 75.5521s
Epoch: 30 cost time: 1.8372745513916016
Epoch: 30, Steps: 237 | Train Loss: 0.7414662 Vali Loss: 0.6987290 Test Loss: 0.7910745
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.002907486850152005
	iters: 100, epoch: 31 | loss: 0.5771433
	speed: 0.0390s/iter; left time: 643.0287s
	iters: 200, epoch: 31 | loss: 0.4292777
	speed: 0.0045s/iter; left time: 74.1334s
Epoch: 31 cost time: 1.9736580848693848
Epoch: 31, Steps: 237 | Train Loss: 0.7325854 Vali Loss: 0.6531815 Test Loss: 0.6619942
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.002616738165136805
