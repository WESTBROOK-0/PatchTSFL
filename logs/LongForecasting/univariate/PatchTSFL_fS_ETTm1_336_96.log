Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm1_336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm1_336_96_PatchTSFL_ETTm1_ftS_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1957992
	speed: 0.0673s/iter; left time: 1782.5880s
	iters: 200, epoch: 1 | loss: 0.1488164
	speed: 0.0484s/iter; left time: 1278.0962s
Epoch: 1 cost time: 15.068159341812134
Epoch: 1, Steps: 266 | Train Loss: 0.1767503 Vali Loss: 0.0932344 Test Loss: 0.0489566
Validation loss decreased (inf --> 0.093234).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.1850196
	speed: 0.1733s/iter; left time: 4547.4343s
	iters: 200, epoch: 2 | loss: 0.1538698
	speed: 0.0488s/iter; left time: 1275.1357s
Epoch: 2 cost time: 15.161000490188599
Epoch: 2, Steps: 266 | Train Loss: 0.1654045 Vali Loss: 0.0890149 Test Loss: 0.0474476
Validation loss decreased (0.093234 --> 0.089015).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.1636583
	speed: 0.1698s/iter; left time: 4410.4445s
	iters: 200, epoch: 3 | loss: 0.1633441
	speed: 0.0474s/iter; left time: 1227.3678s
Epoch: 3 cost time: 15.012416362762451
Epoch: 3, Steps: 266 | Train Loss: 0.1578000 Vali Loss: 0.0812101 Test Loss: 0.0436521
Validation loss decreased (0.089015 --> 0.081210).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.1442448
	speed: 0.1674s/iter; left time: 4302.0519s
	iters: 200, epoch: 4 | loss: 0.1088037
	speed: 0.0465s/iter; left time: 1190.4171s
Epoch: 4 cost time: 14.602579832077026
Epoch: 4, Steps: 266 | Train Loss: 0.1373494 Vali Loss: 0.0647703 Test Loss: 0.0344283
Validation loss decreased (0.081210 --> 0.064770).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.1069715
	speed: 0.1676s/iter; left time: 4262.3647s
	iters: 200, epoch: 5 | loss: 0.0995096
	speed: 0.0470s/iter; left time: 1191.7102s
Epoch: 5 cost time: 14.734087944030762
Epoch: 5, Steps: 266 | Train Loss: 0.1070607 Vali Loss: 0.0627846 Test Loss: 0.0339027
Validation loss decreased (0.064770 --> 0.062785).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.0998731
	speed: 0.1703s/iter; left time: 4286.6259s
	iters: 200, epoch: 6 | loss: 0.0971537
	speed: 0.0477s/iter; left time: 1196.9742s
Epoch: 6 cost time: 15.311034202575684
Epoch: 6, Steps: 266 | Train Loss: 0.0980986 Vali Loss: 0.0610402 Test Loss: 0.0333772
Validation loss decreased (0.062785 --> 0.061040).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.0931827
	speed: 0.1692s/iter; left time: 4213.4784s
	iters: 200, epoch: 7 | loss: 0.1247762
	speed: 0.0491s/iter; left time: 1217.2155s
Epoch: 7 cost time: 15.173683643341064
Epoch: 7, Steps: 266 | Train Loss: 0.0944596 Vali Loss: 0.0600217 Test Loss: 0.0327277
Validation loss decreased (0.061040 --> 0.060022).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.0855342
	speed: 0.1727s/iter; left time: 4256.2936s
	iters: 200, epoch: 8 | loss: 0.1021534
	speed: 0.0483s/iter; left time: 1184.1411s
Epoch: 8 cost time: 15.543286561965942
Epoch: 8, Steps: 266 | Train Loss: 0.0920769 Vali Loss: 0.0584162 Test Loss: 0.0317428
Validation loss decreased (0.060022 --> 0.058416).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.1019965
	speed: 0.1726s/iter; left time: 4206.3307s
	iters: 200, epoch: 9 | loss: 0.0913880
	speed: 0.0487s/iter; left time: 1181.9558s
Epoch: 9 cost time: 15.397498369216919
Epoch: 9, Steps: 266 | Train Loss: 0.0897938 Vali Loss: 0.0572779 Test Loss: 0.0311026
Validation loss decreased (0.058416 --> 0.057278).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.0905986
	speed: 0.1816s/iter; left time: 4377.7014s
	iters: 200, epoch: 10 | loss: 0.0925602
	speed: 0.0481s/iter; left time: 1153.9642s
Epoch: 10 cost time: 15.621181011199951
Epoch: 10, Steps: 266 | Train Loss: 0.0879756 Vali Loss: 0.0553921 Test Loss: 0.0295465
Validation loss decreased (0.057278 --> 0.055392).  Saving model ...
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.0978889
	speed: 0.1729s/iter; left time: 4122.8690s
	iters: 200, epoch: 11 | loss: 0.0779926
	speed: 0.0471s/iter; left time: 1118.2090s
Epoch: 11 cost time: 15.251077651977539
Epoch: 11, Steps: 266 | Train Loss: 0.0858850 Vali Loss: 0.0542691 Test Loss: 0.0289644
Validation loss decreased (0.055392 --> 0.054269).  Saving model ...
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.1011801
	speed: 0.1827s/iter; left time: 4307.8304s
	iters: 200, epoch: 12 | loss: 0.0939912
	speed: 0.0437s/iter; left time: 1025.8526s
Epoch: 12 cost time: 14.387371063232422
Epoch: 12, Steps: 266 | Train Loss: 0.0839608 Vali Loss: 0.0537329 Test Loss: 0.0281898
Validation loss decreased (0.054269 --> 0.053733).  Saving model ...
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.0770008
	speed: 0.1725s/iter; left time: 4019.7717s
	iters: 200, epoch: 13 | loss: 0.0962754
	speed: 0.0475s/iter; left time: 1102.1212s
Epoch: 13 cost time: 15.331047534942627
Epoch: 13, Steps: 266 | Train Loss: 0.0823927 Vali Loss: 0.0532868 Test Loss: 0.0275622
Validation loss decreased (0.053733 --> 0.053287).  Saving model ...
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.0661325
	speed: 0.1711s/iter; left time: 3941.9363s
	iters: 200, epoch: 14 | loss: 0.0691832
	speed: 0.0475s/iter; left time: 1089.4262s
Epoch: 14 cost time: 14.951800107955933
Epoch: 14, Steps: 266 | Train Loss: 0.0810904 Vali Loss: 0.0532289 Test Loss: 0.0273292
Validation loss decreased (0.053287 --> 0.053229).  Saving model ...
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.0798634
	speed: 0.1745s/iter; left time: 3974.6575s
	iters: 200, epoch: 15 | loss: 0.0751852
	speed: 0.0495s/iter; left time: 1122.3829s
Epoch: 15 cost time: 15.370107650756836
Epoch: 15, Steps: 266 | Train Loss: 0.0799695 Vali Loss: 0.0525172 Test Loss: 0.0271394
Validation loss decreased (0.053229 --> 0.052517).  Saving model ...
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.0727476
	speed: 0.1760s/iter; left time: 3961.6625s
	iters: 200, epoch: 16 | loss: 0.1070763
	speed: 0.0468s/iter; left time: 1049.2667s
Epoch: 16 cost time: 15.043626070022583
Epoch: 16, Steps: 266 | Train Loss: 0.0788544 Vali Loss: 0.0529235 Test Loss: 0.0275429
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.0857505
	speed: 0.1767s/iter; left time: 3931.5986s
	iters: 200, epoch: 17 | loss: 0.0758441
	speed: 0.0483s/iter; left time: 1069.6984s
Epoch: 17 cost time: 15.41175103187561
Epoch: 17, Steps: 266 | Train Loss: 0.0776469 Vali Loss: 0.0528301 Test Loss: 0.0274667
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.0746823
	speed: 0.1885s/iter; left time: 4142.2799s
	iters: 200, epoch: 18 | loss: 0.0790442
	speed: 0.0491s/iter; left time: 1074.1508s
Epoch: 18 cost time: 16.603930950164795
Epoch: 18, Steps: 266 | Train Loss: 0.0768905 Vali Loss: 0.0529847 Test Loss: 0.0273848
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.0603087
	speed: 0.1812s/iter; left time: 3935.1906s
	iters: 200, epoch: 19 | loss: 0.0674764
	speed: 0.0479s/iter; left time: 1035.6616s
Epoch: 19 cost time: 15.88125228881836
Epoch: 19, Steps: 266 | Train Loss: 0.0760594 Vali Loss: 0.0532348 Test Loss: 0.0276097
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.0678886
	speed: 0.1804s/iter; left time: 3868.4728s
	iters: 200, epoch: 20 | loss: 0.0803239
	speed: 0.0474s/iter; left time: 1012.2827s
Epoch: 20 cost time: 15.033554792404175
Epoch: 20, Steps: 266 | Train Loss: 0.0748204 Vali Loss: 0.0533143 Test Loss: 0.0278613
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.0713793
	speed: 0.1789s/iter; left time: 3790.3030s
	iters: 200, epoch: 21 | loss: 0.0788462
	speed: 0.0470s/iter; left time: 991.5530s
Epoch: 21 cost time: 15.313870191574097
Epoch: 21, Steps: 266 | Train Loss: 0.0740193 Vali Loss: 0.0534641 Test Loss: 0.0278052
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.0650945
	speed: 0.1717s/iter; left time: 3590.6403s
	iters: 200, epoch: 22 | loss: 0.1068519
	speed: 0.0466s/iter; left time: 970.6370s
Epoch: 22 cost time: 14.716064214706421
Epoch: 22, Steps: 266 | Train Loss: 0.0728968 Vali Loss: 0.0535906 Test Loss: 0.0275548
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.0794454
	speed: 0.1684s/iter; left time: 3476.6714s
	iters: 200, epoch: 23 | loss: 0.0796510
	speed: 0.0476s/iter; left time: 977.3789s
Epoch: 23 cost time: 14.840142250061035
Epoch: 23, Steps: 266 | Train Loss: 0.0717952 Vali Loss: 0.0554126 Test Loss: 0.0284476
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.0614732
	speed: 0.1750s/iter; left time: 3567.4337s
	iters: 200, epoch: 24 | loss: 0.0641383
	speed: 0.0474s/iter; left time: 962.4071s
Epoch: 24 cost time: 15.366408824920654
Epoch: 24, Steps: 266 | Train Loss: 0.0705253 Vali Loss: 0.0548525 Test Loss: 0.0285470
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.0647888
	speed: 0.1744s/iter; left time: 3508.5475s
	iters: 200, epoch: 25 | loss: 0.0720665
	speed: 0.0468s/iter; left time: 936.3109s
Epoch: 25 cost time: 15.014021158218384
Epoch: 25, Steps: 266 | Train Loss: 0.0692499 Vali Loss: 0.0567183 Test Loss: 0.0294082
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.0835480
	speed: 0.1940s/iter; left time: 3850.6797s
	iters: 200, epoch: 26 | loss: 0.0628455
	speed: 0.0524s/iter; left time: 1034.0062s
Epoch: 26 cost time: 17.636585235595703
Epoch: 26, Steps: 266 | Train Loss: 0.0676717 Vali Loss: 0.0567194 Test Loss: 0.0286771
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.0584084
	speed: 0.1765s/iter; left time: 3456.3489s
	iters: 200, epoch: 27 | loss: 0.0690888
	speed: 0.0469s/iter; left time: 913.7023s
Epoch: 27 cost time: 15.147313117980957
Epoch: 27, Steps: 266 | Train Loss: 0.0663247 Vali Loss: 0.0579335 Test Loss: 0.0296650
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.0631206
	speed: 0.1764s/iter; left time: 3408.6615s
	iters: 200, epoch: 28 | loss: 0.0575111
	speed: 0.0500s/iter; left time: 960.8065s
Epoch: 28 cost time: 15.642274141311646
Epoch: 28, Steps: 266 | Train Loss: 0.0650620 Vali Loss: 0.0589420 Test Loss: 0.0299023
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.0657654
	speed: 0.1732s/iter; left time: 3299.6665s
	iters: 200, epoch: 29 | loss: 0.0744021
	speed: 0.0473s/iter; left time: 897.0535s
Epoch: 29 cost time: 15.241374254226685
Epoch: 29, Steps: 266 | Train Loss: 0.0632776 Vali Loss: 0.0609315 Test Loss: 0.0305199
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.0586799
	speed: 0.1720s/iter; left time: 3230.5957s
	iters: 200, epoch: 30 | loss: 0.0550010
	speed: 0.0483s/iter; left time: 902.8287s
Epoch: 30 cost time: 15.11591625213623
Epoch: 30, Steps: 266 | Train Loss: 0.0618297 Vali Loss: 0.0616296 Test Loss: 0.0311221
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.59486415263404e-05
	iters: 100, epoch: 31 | loss: 0.0508774
	speed: 0.1792s/iter; left time: 3318.5514s
	iters: 200, epoch: 31 | loss: 0.0664020
	speed: 0.0477s/iter; left time: 878.0675s
Epoch: 31 cost time: 15.285793781280518
Epoch: 31, Steps: 266 | Train Loss: 0.0600327 Vali Loss: 0.0630600 Test Loss: 0.0313373
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.850661944740828e-05
	iters: 100, epoch: 32 | loss: 0.0589003
	speed: 0.1760s/iter; left time: 3213.1886s
	iters: 200, epoch: 32 | loss: 0.0534493
	speed: 0.0488s/iter; left time: 885.5319s
Epoch: 32 cost time: 15.315181016921997
Epoch: 32, Steps: 266 | Train Loss: 0.0585539 Vali Loss: 0.0643041 Test Loss: 0.0311628
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.083947962827694e-05
	iters: 100, epoch: 33 | loss: 0.0512321
	speed: 0.1767s/iter; left time: 3178.6736s
	iters: 200, epoch: 33 | loss: 0.0526600
	speed: 0.0470s/iter; left time: 841.2458s
Epoch: 33 cost time: 15.383086681365967
Epoch: 33, Steps: 266 | Train Loss: 0.0568271 Vali Loss: 0.0659869 Test Loss: 0.0324689
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.293283650764084e-05
	iters: 100, epoch: 34 | loss: 0.0562552
	speed: 0.1758s/iter; left time: 3116.2560s
	iters: 200, epoch: 34 | loss: 0.0574440
	speed: 0.0477s/iter; left time: 840.0921s
Epoch: 34 cost time: 14.896934509277344
Epoch: 34, Steps: 266 | Train Loss: 0.0551720 Vali Loss: 0.0662820 Test Loss: 0.0320875
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.477378141914727e-05
	iters: 100, epoch: 35 | loss: 0.0636673
	speed: 0.1755s/iter; left time: 3063.2966s
	iters: 200, epoch: 35 | loss: 0.0507692
	speed: 0.0488s/iter; left time: 846.5942s
Epoch: 35 cost time: 15.389321565628052
Epoch: 35, Steps: 266 | Train Loss: 0.0537969 Vali Loss: 0.0680424 Test Loss: 0.0333603
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_96_PatchTSFL_ETTm1_ftS_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.02713938243687153, mae:0.12456076592206955, rse:0.48240453004837036
