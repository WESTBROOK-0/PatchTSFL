Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_192', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4973355
	speed: 0.0495s/iter; left time: 1305.6092s
	iters: 200, epoch: 1 | loss: 0.4339063
	speed: 0.0448s/iter; left time: 1178.3522s
Epoch: 1 cost time: 12.451562643051147
Epoch: 1, Steps: 265 | Train Loss: 0.4660653 Vali Loss: 0.5813959 Test Loss: 0.4027696
Validation loss decreased (inf --> 0.581396).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3737380
	speed: 0.1253s/iter; left time: 3275.0368s
	iters: 200, epoch: 2 | loss: 0.3635292
	speed: 0.0450s/iter; left time: 1172.3638s
Epoch: 2 cost time: 12.462621450424194
Epoch: 2, Steps: 265 | Train Loss: 0.3729558 Vali Loss: 0.5329515 Test Loss: 0.3677355
Validation loss decreased (0.581396 --> 0.532952).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.3386301
	speed: 0.1308s/iter; left time: 3384.4741s
	iters: 200, epoch: 3 | loss: 0.3361784
	speed: 0.0451s/iter; left time: 1163.0368s
Epoch: 3 cost time: 12.903740167617798
Epoch: 3, Steps: 265 | Train Loss: 0.3470021 Vali Loss: 0.5201705 Test Loss: 0.3543423
Validation loss decreased (0.532952 --> 0.520170).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3095584
	speed: 0.1251s/iter; left time: 3204.2407s
	iters: 200, epoch: 4 | loss: 0.3206321
	speed: 0.0451s/iter; left time: 1150.5799s
Epoch: 4 cost time: 12.471262454986572
Epoch: 4, Steps: 265 | Train Loss: 0.3338155 Vali Loss: 0.5124028 Test Loss: 0.3479075
Validation loss decreased (0.520170 --> 0.512403).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3376969
	speed: 0.1318s/iter; left time: 3340.8866s
	iters: 200, epoch: 5 | loss: 0.2994665
	speed: 0.0453s/iter; left time: 1142.7862s
Epoch: 5 cost time: 12.84677791595459
Epoch: 5, Steps: 265 | Train Loss: 0.3262959 Vali Loss: 0.5093786 Test Loss: 0.3449050
Validation loss decreased (0.512403 --> 0.509379).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3171561
	speed: 0.1275s/iter; left time: 3197.0841s
	iters: 200, epoch: 6 | loss: 0.3063610
	speed: 0.0451s/iter; left time: 1127.0910s
Epoch: 6 cost time: 12.577081441879272
Epoch: 6, Steps: 265 | Train Loss: 0.3215140 Vali Loss: 0.5046202 Test Loss: 0.3422104
Validation loss decreased (0.509379 --> 0.504620).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.3089236
	speed: 0.1250s/iter; left time: 3100.3629s
	iters: 200, epoch: 7 | loss: 0.3000346
	speed: 0.0451s/iter; left time: 1113.4021s
Epoch: 7 cost time: 12.497872829437256
Epoch: 7, Steps: 265 | Train Loss: 0.3177242 Vali Loss: 0.5040405 Test Loss: 0.3406758
Validation loss decreased (0.504620 --> 0.504040).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.3305494
	speed: 0.1270s/iter; left time: 3116.2907s
	iters: 200, epoch: 8 | loss: 0.2925770
	speed: 0.0452s/iter; left time: 1105.7991s
Epoch: 8 cost time: 12.773478031158447
Epoch: 8, Steps: 265 | Train Loss: 0.3137810 Vali Loss: 0.5036507 Test Loss: 0.3366352
Validation loss decreased (0.504040 --> 0.503651).  Saving model ...
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.3433467
	speed: 0.1298s/iter; left time: 3152.8202s
	iters: 200, epoch: 9 | loss: 0.3200965
	speed: 0.0451s/iter; left time: 1091.0989s
Epoch: 9 cost time: 12.802597761154175
Epoch: 9, Steps: 265 | Train Loss: 0.3092332 Vali Loss: 0.5011405 Test Loss: 0.3365476
Validation loss decreased (0.503651 --> 0.501141).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.3067284
	speed: 0.1286s/iter; left time: 3088.3807s
	iters: 200, epoch: 10 | loss: 0.2931865
	speed: 0.0451s/iter; left time: 1077.6257s
Epoch: 10 cost time: 12.80726170539856
Epoch: 10, Steps: 265 | Train Loss: 0.3053170 Vali Loss: 0.4994680 Test Loss: 0.3341743
Validation loss decreased (0.501141 --> 0.499468).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.3105087
	speed: 0.1309s/iter; left time: 3109.5383s
	iters: 200, epoch: 11 | loss: 0.2704705
	speed: 0.0451s/iter; left time: 1066.1829s
Epoch: 11 cost time: 12.855182409286499
Epoch: 11, Steps: 265 | Train Loss: 0.3019894 Vali Loss: 0.4976251 Test Loss: 0.3338487
Validation loss decreased (0.499468 --> 0.497625).  Saving model ...
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3018360
	speed: 0.1262s/iter; left time: 2962.9799s
	iters: 200, epoch: 12 | loss: 0.2821611
	speed: 0.0450s/iter; left time: 1052.1566s
Epoch: 12 cost time: 12.64943528175354
Epoch: 12, Steps: 265 | Train Loss: 0.2985768 Vali Loss: 0.4933044 Test Loss: 0.3333057
Validation loss decreased (0.497625 --> 0.493304).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2976241
	speed: 0.1249s/iter; left time: 2901.3239s
	iters: 200, epoch: 13 | loss: 0.3000674
	speed: 0.0450s/iter; left time: 1040.8791s
Epoch: 13 cost time: 12.536792278289795
Epoch: 13, Steps: 265 | Train Loss: 0.2953414 Vali Loss: 0.4983129 Test Loss: 0.3310635
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.3214639
	speed: 0.1280s/iter; left time: 2937.8533s
	iters: 200, epoch: 14 | loss: 0.2770393
	speed: 0.0451s/iter; left time: 1030.3537s
Epoch: 14 cost time: 12.544455289840698
Epoch: 14, Steps: 265 | Train Loss: 0.2926812 Vali Loss: 0.4985572 Test Loss: 0.3300626
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2775426
	speed: 0.1249s/iter; left time: 2833.6714s
	iters: 200, epoch: 15 | loss: 0.2919878
	speed: 0.0450s/iter; left time: 1016.4792s
Epoch: 15 cost time: 12.514421224594116
Epoch: 15, Steps: 265 | Train Loss: 0.2901892 Vali Loss: 0.4991897 Test Loss: 0.3321550
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2907971
	speed: 0.1280s/iter; left time: 2869.5199s
	iters: 200, epoch: 16 | loss: 0.3002535
	speed: 0.0451s/iter; left time: 1006.3664s
Epoch: 16 cost time: 12.522095680236816
Epoch: 16, Steps: 265 | Train Loss: 0.2880234 Vali Loss: 0.4943681 Test Loss: 0.3321328
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2541550
	speed: 0.1280s/iter; left time: 2837.6531s
	iters: 200, epoch: 17 | loss: 0.2957917
	speed: 0.0450s/iter; left time: 993.8470s
Epoch: 17 cost time: 12.519255638122559
Epoch: 17, Steps: 265 | Train Loss: 0.2858549 Vali Loss: 0.4895494 Test Loss: 0.3305425
Validation loss decreased (0.493304 --> 0.489549).  Saving model ...
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2570256
	speed: 0.1249s/iter; left time: 2734.6234s
	iters: 200, epoch: 18 | loss: 0.2650428
	speed: 0.0450s/iter; left time: 980.4385s
Epoch: 18 cost time: 12.492548942565918
Epoch: 18, Steps: 265 | Train Loss: 0.2841031 Vali Loss: 0.4901126 Test Loss: 0.3313464
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2784317
	speed: 0.1324s/iter; left time: 2863.4892s
	iters: 200, epoch: 19 | loss: 0.2710950
	speed: 0.0452s/iter; left time: 972.4589s
Epoch: 19 cost time: 12.719914674758911
Epoch: 19, Steps: 265 | Train Loss: 0.2821145 Vali Loss: 0.4936541 Test Loss: 0.3319399
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2545416
	speed: 0.1284s/iter; left time: 2743.7219s
	iters: 200, epoch: 20 | loss: 0.2759384
	speed: 0.0450s/iter; left time: 956.7473s
Epoch: 20 cost time: 12.635459661483765
Epoch: 20, Steps: 265 | Train Loss: 0.2801528 Vali Loss: 0.4916144 Test Loss: 0.3308076
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2905846
	speed: 0.1302s/iter; left time: 2747.0537s
	iters: 200, epoch: 21 | loss: 0.2591413
	speed: 0.0450s/iter; left time: 945.8578s
Epoch: 21 cost time: 12.516263484954834
Epoch: 21, Steps: 265 | Train Loss: 0.2778395 Vali Loss: 0.4873407 Test Loss: 0.3299401
Validation loss decreased (0.489549 --> 0.487341).  Saving model ...
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2772621
	speed: 0.1257s/iter; left time: 2618.6047s
	iters: 200, epoch: 22 | loss: 0.3039434
	speed: 0.0451s/iter; left time: 935.6604s
Epoch: 22 cost time: 12.558442831039429
Epoch: 22, Steps: 265 | Train Loss: 0.2762919 Vali Loss: 0.4885080 Test Loss: 0.3339080
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2662299
	speed: 0.1312s/iter; left time: 2698.3410s
	iters: 200, epoch: 23 | loss: 0.3050697
	speed: 0.0452s/iter; left time: 925.7911s
Epoch: 23 cost time: 12.55545687675476
Epoch: 23, Steps: 265 | Train Loss: 0.2742003 Vali Loss: 0.4887954 Test Loss: 0.3328561
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2923789
	speed: 0.1286s/iter; left time: 2611.8030s
	iters: 200, epoch: 24 | loss: 0.2787264
	speed: 0.0451s/iter; left time: 910.3278s
Epoch: 24 cost time: 12.552855968475342
Epoch: 24, Steps: 265 | Train Loss: 0.2720061 Vali Loss: 0.4902651 Test Loss: 0.3361864
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2641590
	speed: 0.1269s/iter; left time: 2543.8043s
	iters: 200, epoch: 25 | loss: 0.2625351
	speed: 0.0451s/iter; left time: 900.3325s
Epoch: 25 cost time: 12.793772220611572
Epoch: 25, Steps: 265 | Train Loss: 0.2698995 Vali Loss: 0.4939359 Test Loss: 0.3354148
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2535886
	speed: 0.1251s/iter; left time: 2473.3447s
	iters: 200, epoch: 26 | loss: 0.2837620
	speed: 0.0452s/iter; left time: 888.4807s
Epoch: 26 cost time: 12.506320238113403
Epoch: 26, Steps: 265 | Train Loss: 0.2673635 Vali Loss: 0.4880842 Test Loss: 0.3355622
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2683981
	speed: 0.1268s/iter; left time: 2473.9027s
	iters: 200, epoch: 27 | loss: 0.2968538
	speed: 0.0451s/iter; left time: 875.6377s
Epoch: 27 cost time: 12.52193832397461
Epoch: 27, Steps: 265 | Train Loss: 0.2649679 Vali Loss: 0.4994767 Test Loss: 0.3367816
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2444889
	speed: 0.1238s/iter; left time: 2381.7211s
	iters: 200, epoch: 28 | loss: 0.2436389
	speed: 0.0450s/iter; left time: 861.8137s
Epoch: 28 cost time: 12.471949577331543
Epoch: 28, Steps: 265 | Train Loss: 0.2625721 Vali Loss: 0.5005250 Test Loss: 0.3355744
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.2698990
	speed: 0.1271s/iter; left time: 2411.7409s
	iters: 200, epoch: 29 | loss: 0.2511233
	speed: 0.0450s/iter; left time: 849.1615s
Epoch: 29 cost time: 12.663190126419067
Epoch: 29, Steps: 265 | Train Loss: 0.2599159 Vali Loss: 0.4991495 Test Loss: 0.3347357
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.2171383
	speed: 0.1269s/iter; left time: 2374.2419s
	iters: 200, epoch: 30 | loss: 0.2580580
	speed: 0.0450s/iter; left time: 837.2970s
Epoch: 30 cost time: 12.472691059112549
Epoch: 30, Steps: 265 | Train Loss: 0.2579902 Vali Loss: 0.5100420 Test Loss: 0.3409572
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.2390052
	speed: 0.1240s/iter; left time: 2288.3922s
	iters: 200, epoch: 31 | loss: 0.2908409
	speed: 0.0450s/iter; left time: 825.6500s
Epoch: 31 cost time: 12.464706420898438
Epoch: 31, Steps: 265 | Train Loss: 0.2554838 Vali Loss: 0.4998692 Test Loss: 0.3385577
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.2451010
	speed: 0.1271s/iter; left time: 2311.2322s
	iters: 200, epoch: 32 | loss: 0.2579027
	speed: 0.0449s/iter; left time: 812.9530s
Epoch: 32 cost time: 12.485867023468018
Epoch: 32, Steps: 265 | Train Loss: 0.2525898 Vali Loss: 0.5143302 Test Loss: 0.3407588
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.2276722
	speed: 0.1249s/iter; left time: 2237.8074s
	iters: 200, epoch: 33 | loss: 0.2570155
	speed: 0.0449s/iter; left time: 800.4742s
Epoch: 33 cost time: 12.46433424949646
Epoch: 33, Steps: 265 | Train Loss: 0.2501892 Vali Loss: 0.5169413 Test Loss: 0.3398649
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.2437078
	speed: 0.1243s/iter; left time: 2194.2475s
	iters: 200, epoch: 34 | loss: 0.2243919
	speed: 0.0449s/iter; left time: 788.9815s
Epoch: 34 cost time: 12.482531309127808
Epoch: 34, Steps: 265 | Train Loss: 0.2474094 Vali Loss: 0.5130285 Test Loss: 0.3391661
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.477380205092656e-05
	iters: 100, epoch: 35 | loss: 0.2459967
	speed: 0.1250s/iter; left time: 2174.0994s
	iters: 200, epoch: 35 | loss: 0.2287649
	speed: 0.0449s/iter; left time: 776.8569s
Epoch: 35 cost time: 12.46717619895935
Epoch: 35, Steps: 265 | Train Loss: 0.2443483 Vali Loss: 0.5109540 Test Loss: 0.3421269
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.635098009292423e-05
	iters: 100, epoch: 36 | loss: 0.2228657
	speed: 0.1240s/iter; left time: 2124.2698s
	iters: 200, epoch: 36 | loss: 0.2254222
	speed: 0.0450s/iter; left time: 765.6349s
Epoch: 36 cost time: 12.427278995513916
Epoch: 36, Steps: 265 | Train Loss: 0.2418845 Vali Loss: 0.5072752 Test Loss: 0.3422561
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.765466802150444e-05
	iters: 100, epoch: 37 | loss: 0.2786803
	speed: 0.1249s/iter; left time: 2106.1232s
	iters: 200, epoch: 37 | loss: 0.2437277
	speed: 0.0450s/iter; left time: 754.8281s
Epoch: 37 cost time: 12.49172592163086
Epoch: 37, Steps: 265 | Train Loss: 0.2388545 Vali Loss: 0.5201216 Test Loss: 0.3474245
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.867682665109111e-05
	iters: 100, epoch: 38 | loss: 0.2338438
	speed: 0.1252s/iter; left time: 2078.5364s
	iters: 200, epoch: 38 | loss: 0.2286608
	speed: 0.0449s/iter; left time: 740.7195s
Epoch: 38 cost time: 12.458807229995728
Epoch: 38, Steps: 265 | Train Loss: 0.2360707 Vali Loss: 0.5282549 Test Loss: 0.3482576
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.941115284522702e-05
	iters: 100, epoch: 39 | loss: 0.2405278
	speed: 0.1250s/iter; left time: 2041.8880s
	iters: 200, epoch: 39 | loss: 0.2138173
	speed: 0.0449s/iter; left time: 728.9059s
Epoch: 39 cost time: 12.518903493881226
Epoch: 39, Steps: 265 | Train Loss: 0.2334273 Vali Loss: 0.5272400 Test Loss: 0.3510049
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.985311838483566e-05
	iters: 100, epoch: 40 | loss: 0.2149200
	speed: 0.1240s/iter; left time: 1991.7706s
	iters: 200, epoch: 40 | loss: 0.2392997
	speed: 0.0449s/iter; left time: 717.0460s
Epoch: 40 cost time: 12.452824831008911
Epoch: 40, Steps: 265 | Train Loss: 0.2307165 Vali Loss: 0.5342513 Test Loss: 0.3480680
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.99999990240136e-05
	iters: 100, epoch: 41 | loss: 0.2278429
	speed: 0.1242s/iter; left time: 1962.0743s
	iters: 200, epoch: 41 | loss: 0.2320138
	speed: 0.0449s/iter; left time: 705.6813s
Epoch: 41 cost time: 12.468960762023926
Epoch: 41, Steps: 265 | Train Loss: 0.2279157 Vali Loss: 0.5377569 Test Loss: 0.3518674
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.32994070649147034, mae:0.36859041452407837, rse:0.5463392734527588
