Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_192_Autoformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8511286
	speed: 0.0675s/iter; left time: 1219.7775s
	iters: 200, epoch: 1 | loss: 0.8142325
	speed: 0.0505s/iter; left time: 908.0681s
	iters: 300, epoch: 1 | loss: 0.4274815
	speed: 0.0479s/iter; left time: 855.8383s
	iters: 400, epoch: 1 | loss: 0.7333551
	speed: 0.0455s/iter; left time: 809.0604s
	iters: 500, epoch: 1 | loss: 0.7026453
	speed: 0.0445s/iter; left time: 787.6150s
	iters: 600, epoch: 1 | loss: 0.5609863
	speed: 0.0448s/iter; left time: 787.9785s
	iters: 700, epoch: 1 | loss: 0.6022424
	speed: 0.0474s/iter; left time: 828.1063s
	iters: 800, epoch: 1 | loss: 0.5720120
	speed: 0.0461s/iter; left time: 801.2910s
	iters: 900, epoch: 1 | loss: 0.5669467
	speed: 0.0487s/iter; left time: 841.4565s
	iters: 1000, epoch: 1 | loss: 0.3433834
	speed: 0.0486s/iter; left time: 835.7740s
	iters: 1100, epoch: 1 | loss: 0.5981359
	speed: 0.0462s/iter; left time: 789.5091s
	iters: 1200, epoch: 1 | loss: 0.5791261
	speed: 0.0469s/iter; left time: 795.5794s
	iters: 1300, epoch: 1 | loss: 0.4002411
	speed: 0.0473s/iter; left time: 798.9080s
	iters: 1400, epoch: 1 | loss: 0.5915678
	speed: 0.0467s/iter; left time: 783.0310s
	iters: 1500, epoch: 1 | loss: 4.1540341
	speed: 0.0449s/iter; left time: 748.3616s
	iters: 1600, epoch: 1 | loss: 0.5844044
	speed: 0.0448s/iter; left time: 742.0338s
	iters: 1700, epoch: 1 | loss: 4.1732841
	speed: 0.0462s/iter; left time: 762.2399s
	iters: 1800, epoch: 1 | loss: 0.5103594
	speed: 0.0496s/iter; left time: 812.8596s
	iters: 1900, epoch: 1 | loss: 0.5572440
	speed: 0.0505s/iter; left time: 822.9945s
	iters: 2000, epoch: 1 | loss: 0.4128065
	speed: 0.0471s/iter; left time: 761.3427s
	iters: 2100, epoch: 1 | loss: 0.5562106
	speed: 0.0427s/iter; left time: 686.9567s
	iters: 2200, epoch: 1 | loss: 0.5278191
	speed: 0.0432s/iter; left time: 690.9282s
	iters: 2300, epoch: 1 | loss: 0.3666252
	speed: 0.0467s/iter; left time: 741.0220s
	iters: 2400, epoch: 1 | loss: 0.5661622
	speed: 0.0454s/iter; left time: 716.2900s
	iters: 2500, epoch: 1 | loss: 1.3450418
	speed: 0.0454s/iter; left time: 711.9215s
	iters: 2600, epoch: 1 | loss: 0.6102821
	speed: 0.0500s/iter; left time: 779.8194s
	iters: 2700, epoch: 1 | loss: 0.4516369
	speed: 0.0463s/iter; left time: 716.4989s
	iters: 2800, epoch: 1 | loss: 0.4810140
	speed: 0.0456s/iter; left time: 702.0165s
	iters: 2900, epoch: 1 | loss: 0.4307980
	speed: 0.0460s/iter; left time: 703.3429s
	iters: 3000, epoch: 1 | loss: 0.7280993
	speed: 0.0464s/iter; left time: 704.8645s
	iters: 3100, epoch: 1 | loss: 0.5328906
	speed: 0.0459s/iter; left time: 692.8379s
	iters: 3200, epoch: 1 | loss: 0.5215890
	speed: 0.0457s/iter; left time: 684.3888s
	iters: 3300, epoch: 1 | loss: 0.4156256
	speed: 0.0457s/iter; left time: 680.6017s
	iters: 3400, epoch: 1 | loss: 4.3606000
	speed: 0.0436s/iter; left time: 644.4312s
	iters: 3500, epoch: 1 | loss: 0.5557172
	speed: 0.0454s/iter; left time: 665.8211s
	iters: 3600, epoch: 1 | loss: 0.5308784
	speed: 0.0459s/iter; left time: 669.5044s
	iters: 3700, epoch: 1 | loss: 0.3721618
	speed: 0.0471s/iter; left time: 682.3436s
	iters: 3800, epoch: 1 | loss: 0.4368922
	speed: 0.0465s/iter; left time: 668.9985s
	iters: 3900, epoch: 1 | loss: 0.7269273
	speed: 0.0537s/iter; left time: 766.4798s
	iters: 4000, epoch: 1 | loss: 0.6542236
	speed: 0.0489s/iter; left time: 692.9892s
	iters: 4100, epoch: 1 | loss: 0.5985036
	speed: 0.0487s/iter; left time: 685.9728s
	iters: 4200, epoch: 1 | loss: 0.3484805
	speed: 0.0532s/iter; left time: 743.5853s
	iters: 4300, epoch: 1 | loss: 0.4849276
	speed: 0.0472s/iter; left time: 655.3833s
	iters: 4400, epoch: 1 | loss: 0.7192566
	speed: 0.0455s/iter; left time: 626.9932s
	iters: 4500, epoch: 1 | loss: 0.4136640
	speed: 0.0501s/iter; left time: 685.8774s
	iters: 4600, epoch: 1 | loss: 0.4802438
	speed: 0.0545s/iter; left time: 740.7126s
	iters: 4700, epoch: 1 | loss: 0.7023742
	speed: 0.0471s/iter; left time: 634.8118s
	iters: 4800, epoch: 1 | loss: 0.5032643
	speed: 0.0452s/iter; left time: 605.4507s
	iters: 4900, epoch: 1 | loss: 0.4257577
	speed: 0.0449s/iter; left time: 596.4875s
	iters: 5000, epoch: 1 | loss: 0.6798595
	speed: 0.0458s/iter; left time: 603.2324s
	iters: 5100, epoch: 1 | loss: 0.5413013
	speed: 0.0457s/iter; left time: 597.2851s
	iters: 5200, epoch: 1 | loss: 0.3874018
	speed: 0.0462s/iter; left time: 599.3586s
	iters: 5300, epoch: 1 | loss: 0.4728086
	speed: 0.0457s/iter; left time: 588.0332s
	iters: 5400, epoch: 1 | loss: 0.4102528
	speed: 0.0449s/iter; left time: 573.4781s
	iters: 5500, epoch: 1 | loss: 0.3308102
	speed: 0.0447s/iter; left time: 566.9954s
	iters: 5600, epoch: 1 | loss: 0.4136367
	speed: 0.0459s/iter; left time: 577.7521s
	iters: 5700, epoch: 1 | loss: 0.4371694
	speed: 0.0475s/iter; left time: 592.4149s
	iters: 5800, epoch: 1 | loss: 0.4830361
	speed: 0.0467s/iter; left time: 578.6548s
	iters: 5900, epoch: 1 | loss: 0.5965295
	speed: 0.0455s/iter; left time: 559.2609s
	iters: 6000, epoch: 1 | loss: 0.8139659
	speed: 0.0455s/iter; left time: 554.5559s
	iters: 6100, epoch: 1 | loss: 0.6773195
	speed: 0.0461s/iter; left time: 557.4001s
	iters: 6200, epoch: 1 | loss: 0.3288215
	speed: 0.0455s/iter; left time: 544.8493s
	iters: 6300, epoch: 1 | loss: 0.4759194
	speed: 0.0465s/iter; left time: 552.5320s
	iters: 6400, epoch: 1 | loss: 0.4408481
	speed: 0.0477s/iter; left time: 561.5887s
	iters: 6500, epoch: 1 | loss: 0.6127784
	speed: 0.0470s/iter; left time: 549.0434s
	iters: 6600, epoch: 1 | loss: 0.4488037
	speed: 0.0523s/iter; left time: 605.7010s
	iters: 6700, epoch: 1 | loss: 0.4863168
	speed: 0.0518s/iter; left time: 594.4441s
	iters: 6800, epoch: 1 | loss: 0.6497281
	speed: 0.0506s/iter; left time: 576.1625s
	iters: 6900, epoch: 1 | loss: 0.4115206
	speed: 0.0474s/iter; left time: 534.6650s
	iters: 7000, epoch: 1 | loss: 0.5244368
	speed: 0.0471s/iter; left time: 527.0751s
	iters: 7100, epoch: 1 | loss: 0.4337773
	speed: 0.0455s/iter; left time: 503.7757s
	iters: 7200, epoch: 1 | loss: 0.5211870
	speed: 0.0468s/iter; left time: 514.1767s
	iters: 7300, epoch: 1 | loss: 0.3944670
	speed: 0.0487s/iter; left time: 530.0351s
	iters: 7400, epoch: 1 | loss: 0.6195769
	speed: 0.0512s/iter; left time: 551.6011s
	iters: 7500, epoch: 1 | loss: 0.6153915
	speed: 0.0502s/iter; left time: 536.5806s
	iters: 7600, epoch: 1 | loss: 0.3615155
	speed: 0.0480s/iter; left time: 508.1714s
	iters: 7700, epoch: 1 | loss: 0.4662991
	speed: 0.0457s/iter; left time: 479.0823s
	iters: 7800, epoch: 1 | loss: 0.3350710
	speed: 0.0454s/iter; left time: 471.7694s
	iters: 7900, epoch: 1 | loss: 4.5484767
	speed: 0.0454s/iter; left time: 467.0085s
	iters: 8000, epoch: 1 | loss: 0.6566344
	speed: 0.0453s/iter; left time: 461.5418s
	iters: 8100, epoch: 1 | loss: 0.4629104
	speed: 0.0453s/iter; left time: 457.1043s
	iters: 8200, epoch: 1 | loss: 0.7569590
	speed: 0.0447s/iter; left time: 446.0040s
	iters: 8300, epoch: 1 | loss: 0.5024980
	speed: 0.0454s/iter; left time: 448.1954s
	iters: 8400, epoch: 1 | loss: 0.4888331
	speed: 0.0455s/iter; left time: 445.1795s
	iters: 8500, epoch: 1 | loss: 0.2856712
	speed: 0.0466s/iter; left time: 451.2078s
	iters: 8600, epoch: 1 | loss: 0.3911682
	speed: 0.0446s/iter; left time: 426.9241s
	iters: 8700, epoch: 1 | loss: 1.0145500
	speed: 0.0455s/iter; left time: 431.0778s
	iters: 8800, epoch: 1 | loss: 0.4357820
	speed: 0.0455s/iter; left time: 426.4555s
	iters: 8900, epoch: 1 | loss: 0.6004528
	speed: 0.0455s/iter; left time: 422.3599s
	iters: 9000, epoch: 1 | loss: 0.9742813
	speed: 0.0446s/iter; left time: 409.0172s
Epoch: 1 cost time: 427.66436648368835
Epoch: 1, Steps: 9090 | Train Loss: 0.6647291 Vali Loss: 0.6446614 Test Loss: 0.3451653
Validation loss decreased (inf --> 0.644661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4675548
	speed: 0.7637s/iter; left time: 6866.6022s
	iters: 200, epoch: 2 | loss: 0.5386521
	speed: 0.0479s/iter; left time: 425.6976s
	iters: 300, epoch: 2 | loss: 0.5623837
	speed: 0.0452s/iter; left time: 397.3691s
	iters: 400, epoch: 2 | loss: 0.7493224
	speed: 0.0462s/iter; left time: 401.5199s
	iters: 500, epoch: 2 | loss: 0.5202917
	speed: 0.0446s/iter; left time: 383.1949s
	iters: 600, epoch: 2 | loss: 0.6265085
	speed: 0.0439s/iter; left time: 372.6298s
	iters: 700, epoch: 2 | loss: 0.6394452
	speed: 0.0449s/iter; left time: 376.7856s
	iters: 800, epoch: 2 | loss: 0.4580085
	speed: 0.0445s/iter; left time: 368.8995s
	iters: 900, epoch: 2 | loss: 0.3200228
	speed: 0.0457s/iter; left time: 374.6965s
	iters: 1000, epoch: 2 | loss: 0.5751900
	speed: 0.0435s/iter; left time: 351.7407s
	iters: 1100, epoch: 2 | loss: 0.5795743
	speed: 0.0442s/iter; left time: 353.2496s
	iters: 1200, epoch: 2 | loss: 3.8863299
	speed: 0.0464s/iter; left time: 365.8170s
	iters: 1300, epoch: 2 | loss: 0.5277744
	speed: 0.0448s/iter; left time: 348.7646s
	iters: 1400, epoch: 2 | loss: 1.0790783
	speed: 0.0452s/iter; left time: 347.9113s
	iters: 1500, epoch: 2 | loss: 0.4298427
	speed: 0.0450s/iter; left time: 341.2379s
	iters: 1600, epoch: 2 | loss: 0.3309113
	speed: 0.0454s/iter; left time: 340.1351s
	iters: 1700, epoch: 2 | loss: 0.2952031
	speed: 0.0499s/iter; left time: 369.0337s
	iters: 1800, epoch: 2 | loss: 0.5694578
	speed: 0.0485s/iter; left time: 353.8788s
	iters: 1900, epoch: 2 | loss: 0.4409283
	speed: 0.0463s/iter; left time: 332.9928s
	iters: 2000, epoch: 2 | loss: 0.3875131
	speed: 0.0494s/iter; left time: 350.5731s
	iters: 2100, epoch: 2 | loss: 0.3419636
	speed: 0.0476s/iter; left time: 332.6852s
	iters: 2200, epoch: 2 | loss: 0.3316387
	speed: 0.0458s/iter; left time: 315.8011s
	iters: 2300, epoch: 2 | loss: 0.8623881
	speed: 0.0446s/iter; left time: 302.7895s
	iters: 2400, epoch: 2 | loss: 0.6170242
	speed: 0.0470s/iter; left time: 314.3638s
	iters: 2500, epoch: 2 | loss: 0.4392613
	speed: 0.0513s/iter; left time: 338.3015s
	iters: 2600, epoch: 2 | loss: 0.3851077
	speed: 0.0446s/iter; left time: 289.7798s
	iters: 2700, epoch: 2 | loss: 0.4732108
	speed: 0.0458s/iter; left time: 292.5564s
	iters: 2800, epoch: 2 | loss: 0.5162353
	speed: 0.0461s/iter; left time: 289.8437s
	iters: 2900, epoch: 2 | loss: 0.5172746
	speed: 0.0482s/iter; left time: 298.1466s
	iters: 3000, epoch: 2 | loss: 0.4780246
	speed: 0.0493s/iter; left time: 300.0468s
	iters: 3100, epoch: 2 | loss: 0.4119227
	speed: 0.0497s/iter; left time: 297.6081s
	iters: 3200, epoch: 2 | loss: 4.3165569
	speed: 0.0479s/iter; left time: 282.4133s
	iters: 3300, epoch: 2 | loss: 0.3284039
	speed: 0.0462s/iter; left time: 267.4192s
	iters: 3400, epoch: 2 | loss: 0.4490192
	speed: 0.0455s/iter; left time: 259.0093s
	iters: 3500, epoch: 2 | loss: 0.4168794
	speed: 0.0449s/iter; left time: 251.1562s
	iters: 3600, epoch: 2 | loss: 0.3880062
	speed: 0.0481s/iter; left time: 264.2733s
	iters: 3700, epoch: 2 | loss: 1.0016218
	speed: 0.0466s/iter; left time: 251.2459s
	iters: 3800, epoch: 2 | loss: 0.3957232
	speed: 0.0471s/iter; left time: 249.0755s
	iters: 3900, epoch: 2 | loss: 0.3886322
	speed: 0.0476s/iter; left time: 246.9222s
	iters: 4000, epoch: 2 | loss: 0.3971474
	speed: 0.0445s/iter; left time: 226.5454s
	iters: 4100, epoch: 2 | loss: 0.3138068
	speed: 0.0455s/iter; left time: 227.0537s
	iters: 4200, epoch: 2 | loss: 0.3389159
	speed: 0.0453s/iter; left time: 221.7981s
	iters: 4300, epoch: 2 | loss: 3.9512548
	speed: 0.0445s/iter; left time: 213.0700s
	iters: 4400, epoch: 2 | loss: 0.5893143
	speed: 0.0457s/iter; left time: 214.5222s
	iters: 4500, epoch: 2 | loss: 0.3816937
	speed: 0.0459s/iter; left time: 210.5638s
	iters: 4600, epoch: 2 | loss: 0.5356587
	speed: 0.0439s/iter; left time: 197.2794s
	iters: 4700, epoch: 2 | loss: 0.4061874
	speed: 0.0446s/iter; left time: 195.8951s
	iters: 4800, epoch: 2 | loss: 0.5603025
	speed: 0.0433s/iter; left time: 185.6392s
	iters: 4900, epoch: 2 | loss: 0.4644060
	speed: 0.0427s/iter; left time: 178.7737s
	iters: 5000, epoch: 2 | loss: 0.3443409
	speed: 0.0459s/iter; left time: 187.7658s
	iters: 5100, epoch: 2 | loss: 0.5219072
	speed: 0.0475s/iter; left time: 189.4508s
	iters: 5200, epoch: 2 | loss: 0.3521662
	speed: 0.0454s/iter; left time: 176.7991s
	iters: 5300, epoch: 2 | loss: 0.3124653
	speed: 0.0466s/iter; left time: 176.6356s
	iters: 5400, epoch: 2 | loss: 0.2561323
	speed: 0.0471s/iter; left time: 173.8007s
	iters: 5500, epoch: 2 | loss: 0.1727876
	speed: 0.0489s/iter; left time: 175.4774s
	iters: 5600, epoch: 2 | loss: 0.4480897
	speed: 0.0474s/iter; left time: 165.3114s
	iters: 5700, epoch: 2 | loss: 0.3897198
	speed: 0.0444s/iter; left time: 150.4477s
	iters: 5800, epoch: 2 | loss: 0.3758282
	speed: 0.0487s/iter; left time: 160.1215s
	iters: 5900, epoch: 2 | loss: 0.2844619
	speed: 0.0481s/iter; left time: 153.6134s
	iters: 6000, epoch: 2 | loss: 0.4964154
	speed: 0.0452s/iter; left time: 139.7093s
	iters: 6100, epoch: 2 | loss: 0.3013473
	speed: 0.0447s/iter; left time: 133.8463s
	iters: 6200, epoch: 2 | loss: 0.3060813
	speed: 0.0463s/iter; left time: 133.9541s
	iters: 6300, epoch: 2 | loss: 0.8297628
	speed: 0.0458s/iter; left time: 127.7385s
	iters: 6400, epoch: 2 | loss: 0.4023845
	speed: 0.0450s/iter; left time: 121.1706s
	iters: 6500, epoch: 2 | loss: 0.4170274
	speed: 0.0447s/iter; left time: 115.7240s
	iters: 6600, epoch: 2 | loss: 0.3376659
	speed: 0.0449s/iter; left time: 111.8204s
	iters: 6700, epoch: 2 | loss: 0.3937503
	speed: 0.0519s/iter; left time: 123.9772s
	iters: 6800, epoch: 2 | loss: 0.4186901
	speed: 0.0474s/iter; left time: 108.6001s
	iters: 6900, epoch: 2 | loss: 0.3557726
	speed: 0.0455s/iter; left time: 99.7302s
	iters: 7000, epoch: 2 | loss: 0.1872010
	speed: 0.0458s/iter; left time: 95.8089s
	iters: 7100, epoch: 2 | loss: 0.3512434
	speed: 0.0457s/iter; left time: 90.9278s
	iters: 7200, epoch: 2 | loss: 0.2000948
	speed: 0.0472s/iter; left time: 89.2987s
	iters: 7300, epoch: 2 | loss: 0.2799740
	speed: 0.0460s/iter; left time: 82.3364s
	iters: 7400, epoch: 2 | loss: 0.3317044
	speed: 0.0490s/iter; left time: 82.9089s
	iters: 7500, epoch: 2 | loss: 0.3567342
	speed: 0.0445s/iter; left time: 70.8438s
	iters: 7600, epoch: 2 | loss: 0.5709882
	speed: 0.0462s/iter; left time: 68.9294s
	iters: 7700, epoch: 2 | loss: 0.2499048
	speed: 0.0438s/iter; left time: 60.9621s
	iters: 7800, epoch: 2 | loss: 0.2164742
	speed: 0.0453s/iter; left time: 58.5256s
	iters: 7900, epoch: 2 | loss: 0.2393578
	speed: 0.0489s/iter; left time: 58.2275s
	iters: 8000, epoch: 2 | loss: 0.2892781
	speed: 0.0525s/iter; left time: 57.2370s
	iters: 8100, epoch: 2 | loss: 0.3189317
	speed: 0.0474s/iter; left time: 47.0134s
	iters: 8200, epoch: 2 | loss: 0.3283786
	speed: 0.0442s/iter; left time: 39.3763s
	iters: 8300, epoch: 2 | loss: 0.2033787
	speed: 0.0455s/iter; left time: 36.0147s
	iters: 8400, epoch: 2 | loss: 0.2266539
	speed: 0.0456s/iter; left time: 31.4860s
	iters: 8500, epoch: 2 | loss: 0.3807438
	speed: 0.0431s/iter; left time: 25.4776s
	iters: 8600, epoch: 2 | loss: 0.2831785
	speed: 0.0420s/iter; left time: 20.6226s
	iters: 8700, epoch: 2 | loss: 0.3581452
	speed: 0.0470s/iter; left time: 18.3820s
	iters: 8800, epoch: 2 | loss: 0.5579240
	speed: 0.0503s/iter; left time: 14.6507s
	iters: 8900, epoch: 2 | loss: 0.5549117
	speed: 0.0470s/iter; left time: 8.9828s
	iters: 9000, epoch: 2 | loss: 0.5022503
	speed: 0.0443s/iter; left time: 4.0348s
Epoch: 2 cost time: 421.9974584579468
Epoch: 2, Steps: 9090 | Train Loss: 0.4988953 Vali Loss: 0.6088457 Test Loss: 0.3301755
Validation loss decreased (0.644661 --> 0.608846).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_192_Autoformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.33017539978027344, mae:0.3894916772842407, rse:0.7563807964324951
