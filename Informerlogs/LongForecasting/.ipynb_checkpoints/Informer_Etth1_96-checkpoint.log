Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='ETTh1_96_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_96_Informer_ETTh1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Epoch: 1 cost time: 6.833050966262817
Epoch: 1, Steps: 66 | Train Loss: 0.9507897 Vali Loss: 1.3970947 Test Loss: 1.1218398
Validation loss decreased (inf --> 1.397095).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 6.8872339725494385
Epoch: 2, Steps: 66 | Train Loss: 0.6057838 Vali Loss: 1.1548865 Test Loss: 0.8449124
Validation loss decreased (1.397095 --> 1.154886).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 6.7525811195373535
Epoch: 3, Steps: 66 | Train Loss: 0.5070589 Vali Loss: 1.1479241 Test Loss: 0.8446764
Validation loss decreased (1.154886 --> 1.147924).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 6.790234565734863
Epoch: 4, Steps: 66 | Train Loss: 0.4774877 Vali Loss: 1.2226801 Test Loss: 0.8833826
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
Epoch: 5 cost time: 6.763058662414551
Epoch: 5, Steps: 66 | Train Loss: 0.4449698 Vali Loss: 1.3255008 Test Loss: 0.9562256
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 6.602932453155518
Epoch: 6, Steps: 66 | Train Loss: 0.4221398 Vali Loss: 1.2924014 Test Loss: 0.9180132
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 6.6491522789001465
Epoch: 7, Steps: 66 | Train Loss: 0.4058456 Vali Loss: 1.3296311 Test Loss: 1.0213954
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 6.856030225753784
Epoch: 8, Steps: 66 | Train Loss: 0.3914079 Vali Loss: 1.3424181 Test Loss: 0.9710283
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 6.80445671081543
Epoch: 9, Steps: 66 | Train Loss: 0.3791706 Vali Loss: 1.3838190 Test Loss: 1.2198489
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 6.851804733276367
Epoch: 10, Steps: 66 | Train Loss: 0.3691470 Vali Loss: 1.3631296 Test Loss: 1.1330799
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 6.63100528717041
Epoch: 11, Steps: 66 | Train Loss: 0.3616965 Vali Loss: 1.3886181 Test Loss: 1.1666497
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 6.498783588409424
Epoch: 12, Steps: 66 | Train Loss: 0.3542343 Vali Loss: 1.4547763 Test Loss: 1.2729518
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 6.501631498336792
Epoch: 13, Steps: 66 | Train Loss: 0.3482385 Vali Loss: 1.4567341 Test Loss: 1.2069997
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 6.592631578445435
Epoch: 14, Steps: 66 | Train Loss: 0.3426859 Vali Loss: 1.4493581 Test Loss: 1.2353454
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 6.577210426330566
Epoch: 15, Steps: 66 | Train Loss: 0.3384260 Vali Loss: 1.4486283 Test Loss: 1.3109004
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 6.59659743309021
Epoch: 16, Steps: 66 | Train Loss: 0.3327503 Vali Loss: 1.4876287 Test Loss: 1.3438228
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 6.579867601394653
Epoch: 17, Steps: 66 | Train Loss: 0.3297589 Vali Loss: 1.4954193 Test Loss: 1.3469483
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 6.587768077850342
Epoch: 18, Steps: 66 | Train Loss: 0.3264566 Vali Loss: 1.4847672 Test Loss: 1.3891469
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 6.62320876121521
Epoch: 19, Steps: 66 | Train Loss: 0.3225934 Vali Loss: 1.4919707 Test Loss: 1.3758171
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 6.6169819831848145
Epoch: 20, Steps: 66 | Train Loss: 0.3188670 Vali Loss: 1.5062402 Test Loss: 1.4001456
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 6.591402530670166
Epoch: 21, Steps: 66 | Train Loss: 0.3168289 Vali Loss: 1.5101980 Test Loss: 1.4202842
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 6.615983486175537
Epoch: 22, Steps: 66 | Train Loss: 0.3137062 Vali Loss: 1.5080730 Test Loss: 1.4459617
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 6.572933673858643
Epoch: 23, Steps: 66 | Train Loss: 0.3106223 Vali Loss: 1.5103405 Test Loss: 1.4308597
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 6.685507535934448
Epoch: 24, Steps: 66 | Train Loss: 0.3080484 Vali Loss: 1.5117403 Test Loss: 1.4085838
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 6.505964517593384
Epoch: 25, Steps: 66 | Train Loss: 0.3062239 Vali Loss: 1.4927671 Test Loss: 1.4239452
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 6.575383901596069
Epoch: 26, Steps: 66 | Train Loss: 0.3040582 Vali Loss: 1.5129079 Test Loss: 1.3986369
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 6.530864477157593
Epoch: 27, Steps: 66 | Train Loss: 0.3005912 Vali Loss: 1.4982574 Test Loss: 1.4216897
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 6.598858833312988
Epoch: 28, Steps: 66 | Train Loss: 0.2982072 Vali Loss: 1.5069406 Test Loss: 1.4328020
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 6.643918037414551
Epoch: 29, Steps: 66 | Train Loss: 0.2963659 Vali Loss: 1.4813948 Test Loss: 1.3981965
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 6.563685417175293
Epoch: 30, Steps: 66 | Train Loss: 0.2943849 Vali Loss: 1.4893363 Test Loss: 1.4212910
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 6.567061901092529
Epoch: 31, Steps: 66 | Train Loss: 0.2924373 Vali Loss: 1.5015312 Test Loss: 1.4330298
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 6.4390974044799805
Epoch: 32, Steps: 66 | Train Loss: 0.2902086 Vali Loss: 1.4984652 Test Loss: 1.4235243
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 6.546515226364136
Epoch: 33, Steps: 66 | Train Loss: 0.2886432 Vali Loss: 1.4869165 Test Loss: 1.4288663
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 6.630232810974121
Epoch: 34, Steps: 66 | Train Loss: 0.2873658 Vali Loss: 1.4841124 Test Loss: 1.4377047
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 6.659740447998047
Epoch: 35, Steps: 66 | Train Loss: 0.2862628 Vali Loss: 1.4952763 Test Loss: 1.4253263
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 6.4399449825286865
Epoch: 36, Steps: 66 | Train Loss: 0.2846246 Vali Loss: 1.4870175 Test Loss: 1.4400442
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 6.565035343170166
Epoch: 37, Steps: 66 | Train Loss: 0.2834531 Vali Loss: 1.4905354 Test Loss: 1.4361608
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 6.65064811706543
Epoch: 38, Steps: 66 | Train Loss: 0.2826468 Vali Loss: 1.4819458 Test Loss: 1.4204284
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 6.566641807556152
Epoch: 39, Steps: 66 | Train Loss: 0.2826031 Vali Loss: 1.4933658 Test Loss: 1.4411649
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 6.65606951713562
Epoch: 40, Steps: 66 | Train Loss: 0.2812755 Vali Loss: 1.4882383 Test Loss: 1.4445963
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 6.571370840072632
Epoch: 41, Steps: 66 | Train Loss: 0.2805365 Vali Loss: 1.4890850 Test Loss: 1.4333229
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 6.609917879104614
Epoch: 42, Steps: 66 | Train Loss: 0.2800290 Vali Loss: 1.4965706 Test Loss: 1.4266754
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 6.555864334106445
Epoch: 43, Steps: 66 | Train Loss: 0.2795535 Vali Loss: 1.4939768 Test Loss: 1.4368324
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 6.61405611038208
Epoch: 44, Steps: 66 | Train Loss: 0.2787563 Vali Loss: 1.4875652 Test Loss: 1.4331332
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 6.623072862625122
Epoch: 45, Steps: 66 | Train Loss: 0.2784898 Vali Loss: 1.4877577 Test Loss: 1.4324170
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 6.549642086029053
Epoch: 46, Steps: 66 | Train Loss: 0.2787323 Vali Loss: 1.4848734 Test Loss: 1.4320796
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 6.552031517028809
Epoch: 47, Steps: 66 | Train Loss: 0.2780236 Vali Loss: 1.4970101 Test Loss: 1.4487616
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 6.464111804962158
Epoch: 48, Steps: 66 | Train Loss: 0.2775468 Vali Loss: 1.4903144 Test Loss: 1.4376358
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 6.601346492767334
Epoch: 49, Steps: 66 | Train Loss: 0.2772184 Vali Loss: 1.4831228 Test Loss: 1.4288661
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 6.724295616149902
Epoch: 50, Steps: 66 | Train Loss: 0.2768733 Vali Loss: 1.4951043 Test Loss: 1.4391277
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 6.557937383651733
Epoch: 51, Steps: 66 | Train Loss: 0.2768087 Vali Loss: 1.4982163 Test Loss: 1.4415134
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 6.5485594272613525
Epoch: 52, Steps: 66 | Train Loss: 0.2765582 Vali Loss: 1.4920779 Test Loss: 1.4382529
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 6.58629846572876
Epoch: 53, Steps: 66 | Train Loss: 0.2764022 Vali Loss: 1.4850657 Test Loss: 1.4405080
EarlyStopping counter: 50 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 6.558157444000244
Epoch: 54, Steps: 66 | Train Loss: 0.2761226 Vali Loss: 1.4863694 Test Loss: 1.4399714
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 6.592891454696655
Epoch: 55, Steps: 66 | Train Loss: 0.2758154 Vali Loss: 1.4886148 Test Loss: 1.4352752
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 6.587017059326172
Epoch: 56, Steps: 66 | Train Loss: 0.2759537 Vali Loss: 1.4938132 Test Loss: 1.4386035
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 6.64481258392334
Epoch: 57, Steps: 66 | Train Loss: 0.2758504 Vali Loss: 1.4897738 Test Loss: 1.4390455
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 6.5749475955963135
Epoch: 58, Steps: 66 | Train Loss: 0.2754761 Vali Loss: 1.4848509 Test Loss: 1.4445921
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 6.759355306625366
Epoch: 59, Steps: 66 | Train Loss: 0.2753363 Vali Loss: 1.4844288 Test Loss: 1.4359438
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 6.5670599937438965
Epoch: 60, Steps: 66 | Train Loss: 0.2754211 Vali Loss: 1.4902246 Test Loss: 1.4402068
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 6.551700592041016
Epoch: 61, Steps: 66 | Train Loss: 0.2757335 Vali Loss: 1.4740320 Test Loss: 1.4368200
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 6.490063190460205
Epoch: 62, Steps: 66 | Train Loss: 0.2754092 Vali Loss: 1.4847698 Test Loss: 1.4452820
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 6.569591522216797
Epoch: 63, Steps: 66 | Train Loss: 0.2755189 Vali Loss: 1.4894096 Test Loss: 1.4565710
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 6.6362364292144775
Epoch: 64, Steps: 66 | Train Loss: 0.2749655 Vali Loss: 1.4884459 Test Loss: 1.4407871
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 6.516650676727295
Epoch: 65, Steps: 66 | Train Loss: 0.2750987 Vali Loss: 1.4866756 Test Loss: 1.4292151
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 6.554125785827637
Epoch: 66, Steps: 66 | Train Loss: 0.2749330 Vali Loss: 1.4820497 Test Loss: 1.4448441
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 6.558175563812256
Epoch: 67, Steps: 66 | Train Loss: 0.2749970 Vali Loss: 1.4914312 Test Loss: 1.4459407
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 6.557894706726074
Epoch: 68, Steps: 66 | Train Loss: 0.2752883 Vali Loss: 1.4909420 Test Loss: 1.4331536
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 6.566338300704956
Epoch: 69, Steps: 66 | Train Loss: 0.2751308 Vali Loss: 1.4852791 Test Loss: 1.4444288
EarlyStopping counter: 66 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 6.522762775421143
Epoch: 70, Steps: 66 | Train Loss: 0.2749232 Vali Loss: 1.4844161 Test Loss: 1.4371080
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 6.5247814655303955
Epoch: 71, Steps: 66 | Train Loss: 0.2753775 Vali Loss: 1.4921119 Test Loss: 1.4486796
EarlyStopping counter: 68 out of 100
Updating learning rate to 7.735540101454298e-08
