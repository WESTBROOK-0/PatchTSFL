Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='traffic_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=3, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 1.1380388
	speed: 0.0646s/iter; left time: 548.7715s
	iters: 200, epoch: 1 | loss: 1.1440367
	speed: 0.0429s/iter; left time: 359.9806s
	iters: 300, epoch: 1 | loss: 1.0785730
	speed: 0.0416s/iter; left time: 345.5913s
	iters: 400, epoch: 1 | loss: 1.0657279
	speed: 0.0423s/iter; left time: 346.5860s
	iters: 500, epoch: 1 | loss: 0.9795086
	speed: 0.0399s/iter; left time: 322.8270s
	iters: 600, epoch: 1 | loss: 1.0976484
	speed: 0.0404s/iter; left time: 323.1824s
	iters: 700, epoch: 1 | loss: 0.9920673
	speed: 0.0415s/iter; left time: 328.0366s
	iters: 800, epoch: 1 | loss: 1.0525228
	speed: 0.0425s/iter; left time: 331.5234s
	iters: 900, epoch: 1 | loss: 0.9530853
	speed: 0.0399s/iter; left time: 306.9229s
	iters: 1000, epoch: 1 | loss: 1.0057074
	speed: 0.0389s/iter; left time: 295.3592s
	iters: 1100, epoch: 1 | loss: 0.9096048
	speed: 0.0407s/iter; left time: 304.8836s
	iters: 1200, epoch: 1 | loss: 0.9866150
	speed: 0.0399s/iter; left time: 295.3708s
	iters: 1300, epoch: 1 | loss: 1.0029873
	speed: 0.0401s/iter; left time: 292.4773s
	iters: 1400, epoch: 1 | loss: 1.0091752
	speed: 0.0408s/iter; left time: 293.8103s
	iters: 1500, epoch: 1 | loss: 1.0031669
	speed: 0.0430s/iter; left time: 305.3734s
	iters: 1600, epoch: 1 | loss: 0.9767944
	speed: 0.0441s/iter; left time: 308.5296s
	iters: 1700, epoch: 1 | loss: 1.0472615
	speed: 0.0423s/iter; left time: 292.0410s
	iters: 1800, epoch: 1 | loss: 0.9745592
	speed: 0.0417s/iter; left time: 283.2731s
	iters: 1900, epoch: 1 | loss: 1.0370474
	speed: 0.0396s/iter; left time: 265.2133s
	iters: 2000, epoch: 1 | loss: 0.9785995
	speed: 0.0400s/iter; left time: 263.9795s
	iters: 2100, epoch: 1 | loss: 1.0573684
	speed: 0.0416s/iter; left time: 270.4279s
	iters: 2200, epoch: 1 | loss: 1.0115892
	speed: 0.0427s/iter; left time: 273.4311s
	iters: 2300, epoch: 1 | loss: 1.0569218
	speed: 0.0425s/iter; left time: 267.7586s
	iters: 2400, epoch: 1 | loss: 1.0518501
	speed: 0.0446s/iter; left time: 276.7530s
	iters: 2500, epoch: 1 | loss: 0.9480058
	speed: 0.0441s/iter; left time: 268.7540s
	iters: 2600, epoch: 1 | loss: 0.9365079
	speed: 0.0429s/iter; left time: 257.5552s
	iters: 2700, epoch: 1 | loss: 1.0393924
	speed: 0.0407s/iter; left time: 240.3726s
	iters: 2800, epoch: 1 | loss: 0.9586490
	speed: 0.0406s/iter; left time: 235.6932s
Epoch: 1 cost time: 121.66584491729736
Epoch: 1, Steps: 2866 | Train Loss: 1.0180616 Vali Loss: 1.2350200 Test Loss: 1.4845960
Validation loss decreased (inf --> 1.235020).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9570758
	speed: 0.3963s/iter; left time: 2232.4338s
	iters: 200, epoch: 2 | loss: 1.0432258
	speed: 0.0433s/iter; left time: 239.6541s
	iters: 300, epoch: 2 | loss: 0.9803658
	speed: 0.0439s/iter; left time: 238.5796s
	iters: 400, epoch: 2 | loss: 0.9191337
	speed: 0.0462s/iter; left time: 246.6511s
	iters: 500, epoch: 2 | loss: 0.9397638
	speed: 0.0469s/iter; left time: 245.2319s
	iters: 600, epoch: 2 | loss: 0.9363931
	speed: 0.0429s/iter; left time: 220.2287s
	iters: 700, epoch: 2 | loss: 0.9649996
	speed: 0.0434s/iter; left time: 218.2570s
	iters: 800, epoch: 2 | loss: 0.8992440
	speed: 0.0437s/iter; left time: 215.8028s
	iters: 900, epoch: 2 | loss: 1.0043550
	speed: 0.0410s/iter; left time: 198.2006s
	iters: 1000, epoch: 2 | loss: 0.9112398
	speed: 0.0427s/iter; left time: 202.2434s
	iters: 1100, epoch: 2 | loss: 1.0030452
	speed: 0.0422s/iter; left time: 195.6068s
	iters: 1200, epoch: 2 | loss: 0.9407530
	speed: 0.0435s/iter; left time: 197.0398s
	iters: 1300, epoch: 2 | loss: 0.8697778
	speed: 0.0442s/iter; left time: 196.0602s
	iters: 1400, epoch: 2 | loss: 0.8860237
	speed: 0.0431s/iter; left time: 186.8337s
	iters: 1500, epoch: 2 | loss: 0.9089097
	speed: 0.0440s/iter; left time: 186.3712s
	iters: 1600, epoch: 2 | loss: 0.9351257
	speed: 0.0434s/iter; left time: 179.3541s
	iters: 1700, epoch: 2 | loss: 0.7860243
	speed: 0.0430s/iter; left time: 173.3195s
	iters: 1800, epoch: 2 | loss: 0.7135968
	speed: 0.0435s/iter; left time: 171.0197s
	iters: 1900, epoch: 2 | loss: 0.5723612
	speed: 0.0447s/iter; left time: 171.4982s
	iters: 2000, epoch: 2 | loss: 0.6059316
	speed: 0.0448s/iter; left time: 167.3390s
	iters: 2100, epoch: 2 | loss: 0.5326669
	speed: 0.0415s/iter; left time: 150.6272s
	iters: 2200, epoch: 2 | loss: 0.4670706
	speed: 0.0434s/iter; left time: 153.1943s
	iters: 2300, epoch: 2 | loss: 0.4522485
	speed: 0.0440s/iter; left time: 151.1928s
	iters: 2400, epoch: 2 | loss: 0.5028283
	speed: 0.0425s/iter; left time: 141.7177s
	iters: 2500, epoch: 2 | loss: 0.4160435
	speed: 0.0412s/iter; left time: 133.0698s
	iters: 2600, epoch: 2 | loss: 0.3943017
	speed: 0.0413s/iter; left time: 129.3853s
	iters: 2700, epoch: 2 | loss: 0.3971331
	speed: 0.0430s/iter; left time: 130.3579s
	iters: 2800, epoch: 2 | loss: 0.4143430
	speed: 0.0434s/iter; left time: 127.3035s
Epoch: 2 cost time: 126.69974565505981
Epoch: 2, Steps: 2866 | Train Loss: 0.7535663 Vali Loss: 0.6926938 Test Loss: 0.9454584
Validation loss decreased (1.235020 --> 0.692694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3644572
	speed: 0.3757s/iter; left time: 1039.4900s
	iters: 200, epoch: 3 | loss: 0.3393371
	speed: 0.0435s/iter; left time: 115.9919s
	iters: 300, epoch: 3 | loss: 0.3262313
	speed: 0.0440s/iter; left time: 112.9111s
	iters: 400, epoch: 3 | loss: 0.3587982
	speed: 0.0433s/iter; left time: 106.8413s
	iters: 500, epoch: 3 | loss: 0.3717482
	speed: 0.0429s/iter; left time: 101.4722s
	iters: 600, epoch: 3 | loss: 0.3515159
	speed: 0.0430s/iter; left time: 97.3896s
	iters: 700, epoch: 3 | loss: 0.3071413
	speed: 0.0401s/iter; left time: 87.0046s
	iters: 800, epoch: 3 | loss: 0.3339317
	speed: 0.0403s/iter; left time: 83.2700s
	iters: 900, epoch: 3 | loss: 0.2993743
	speed: 0.0425s/iter; left time: 83.6544s
	iters: 1000, epoch: 3 | loss: 0.2953417
	speed: 0.0437s/iter; left time: 81.5707s
	iters: 1100, epoch: 3 | loss: 0.3199053
	speed: 0.0430s/iter; left time: 76.0492s
	iters: 1200, epoch: 3 | loss: 0.3115583
	speed: 0.0417s/iter; left time: 69.5678s
	iters: 1300, epoch: 3 | loss: 0.2887194
	speed: 0.0416s/iter; left time: 65.2003s
	iters: 1400, epoch: 3 | loss: 0.3007571
	speed: 0.0427s/iter; left time: 62.7040s
	iters: 1500, epoch: 3 | loss: 0.2964130
	speed: 0.0430s/iter; left time: 58.7599s
	iters: 1600, epoch: 3 | loss: 0.3231613
	speed: 0.0420s/iter; left time: 53.2107s
	iters: 1700, epoch: 3 | loss: 0.2713150
	speed: 0.0393s/iter; left time: 45.8704s
	iters: 1800, epoch: 3 | loss: 0.3429831
	speed: 0.0395s/iter; left time: 42.1799s
	iters: 1900, epoch: 3 | loss: 0.3085990
	speed: 0.0400s/iter; left time: 38.6830s
	iters: 2000, epoch: 3 | loss: 0.2703261
	speed: 0.0426s/iter; left time: 36.9199s
	iters: 2100, epoch: 3 | loss: 0.2912517
	speed: 0.0395s/iter; left time: 30.3173s
	iters: 2200, epoch: 3 | loss: 0.3012943
	speed: 0.0401s/iter; left time: 26.7522s
	iters: 2300, epoch: 3 | loss: 0.2639835
	speed: 0.0396s/iter; left time: 22.4646s
	iters: 2400, epoch: 3 | loss: 0.2803590
	speed: 0.0409s/iter; left time: 19.0873s
	iters: 2500, epoch: 3 | loss: 0.3084722
	speed: 0.0415s/iter; left time: 15.2434s
	iters: 2600, epoch: 3 | loss: 0.2959408
	speed: 0.0406s/iter; left time: 10.8402s
	iters: 2700, epoch: 3 | loss: 0.2740138
	speed: 0.0425s/iter; left time: 7.1032s
	iters: 2800, epoch: 3 | loss: 0.2829649
	speed: 0.0443s/iter; left time: 2.9683s
Epoch: 3 cost time: 122.34434008598328
Epoch: 3, Steps: 2866 | Train Loss: 0.3143555 Vali Loss: 0.6320319 Test Loss: 0.8616264
Validation loss decreased (0.692694 --> 0.632032).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : traffic_96_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.8616213798522949, mae:0.47984522581100464, rse:0.7590097188949585
