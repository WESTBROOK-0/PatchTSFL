Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=1, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='CIPatchTSF', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : weather_336_336_CIPatchTSF_custom_ftM_sl336_ll48_pl336_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6807841
	speed: 0.8108s/iter; left time: 22784.3357s
	iters: 200, epoch: 1 | loss: 0.6661295
	speed: 0.8172s/iter; left time: 22881.8084s
Epoch: 1 cost time: 224.33319568634033
Epoch: 1, Steps: 282 | Train Loss: 0.7062967 Vali Loss: 0.6570191 Test Loss: 0.3156561
Validation loss decreased (inf --> 0.657019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8210264
	speed: 1.7134s/iter; left time: 47664.2892s
	iters: 200, epoch: 2 | loss: 0.4886454
	speed: 0.8128s/iter; left time: 22530.0976s
Epoch: 2 cost time: 230.77641344070435
Epoch: 2, Steps: 282 | Train Loss: 0.5658818 Vali Loss: 0.5400658 Test Loss: 0.2480050
Validation loss decreased (0.657019 --> 0.540066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5017757
	speed: 1.6370s/iter; left time: 45077.0603s
	iters: 200, epoch: 3 | loss: 0.5133707
	speed: 0.6992s/iter; left time: 19184.6536s
Epoch: 3 cost time: 203.19627332687378
Epoch: 3, Steps: 282 | Train Loss: 0.5200977 Vali Loss: 0.5346535 Test Loss: 0.2466754
Validation loss decreased (0.540066 --> 0.534653).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6904676
	speed: 1.6361s/iter; left time: 44592.7980s
	iters: 200, epoch: 4 | loss: 0.6248032
	speed: 0.7598s/iter; left time: 20632.9909s
Epoch: 4 cost time: 216.19257473945618
Epoch: 4, Steps: 282 | Train Loss: 0.5032846 Vali Loss: 0.5424382 Test Loss: 0.2487999
EarlyStopping counter: 1 out of 20
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3936593
	speed: 1.6696s/iter; left time: 45034.2884s
	iters: 200, epoch: 5 | loss: 0.3698414
	speed: 0.7702s/iter; left time: 20697.1082s
Epoch: 5 cost time: 220.49337005615234
Epoch: 5, Steps: 282 | Train Loss: 0.4902439 Vali Loss: 0.5417266 Test Loss: 0.2493018
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4627787
	speed: 1.6152s/iter; left time: 43110.1136s
	iters: 200, epoch: 6 | loss: 0.5475117
	speed: 0.7220s/iter; left time: 19199.3918s
Epoch: 6 cost time: 213.27757382392883
Epoch: 6, Steps: 282 | Train Loss: 0.4803419 Vali Loss: 0.5478778 Test Loss: 0.2536769
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4098872
	speed: 1.6257s/iter; left time: 42931.9251s
	iters: 200, epoch: 7 | loss: 0.3588065
	speed: 0.8378s/iter; left time: 22042.1001s
Epoch: 7 cost time: 225.7971076965332
Epoch: 7, Steps: 282 | Train Loss: 0.4720447 Vali Loss: 0.5500754 Test Loss: 0.2563253
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5558532
	speed: 1.7201s/iter; left time: 44941.7529s
	iters: 200, epoch: 8 | loss: 0.5057966
	speed: 0.7336s/iter; left time: 19092.1870s
Epoch: 8 cost time: 213.43230414390564
Epoch: 8, Steps: 282 | Train Loss: 0.4654310 Vali Loss: 0.5545214 Test Loss: 0.2601027
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5839753
	speed: 1.6148s/iter; left time: 41735.0942s
	iters: 200, epoch: 9 | loss: 0.6458275
	speed: 0.7518s/iter; left time: 19355.6128s
Epoch: 9 cost time: 211.65101194381714
Epoch: 9, Steps: 282 | Train Loss: 0.4587165 Vali Loss: 0.5553998 Test Loss: 0.2599010
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3787327
	speed: 1.6069s/iter; left time: 41076.7423s
	iters: 200, epoch: 10 | loss: 0.4068590
	speed: 0.7118s/iter; left time: 18125.1054s
Epoch: 10 cost time: 205.35783982276917
Epoch: 10, Steps: 282 | Train Loss: 0.4546840 Vali Loss: 0.5572270 Test Loss: 0.2616390
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.4151917
	speed: 1.6485s/iter; left time: 41675.9534s
	iters: 200, epoch: 11 | loss: 0.5407662
	speed: 0.7449s/iter; left time: 18758.4025s
Epoch: 11 cost time: 221.42410612106323
Epoch: 11, Steps: 282 | Train Loss: 0.4496983 Vali Loss: 0.5592520 Test Loss: 0.2619788
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3582591
	speed: 1.6613s/iter; left time: 41531.5416s
	iters: 200, epoch: 12 | loss: 0.4147738
	speed: 0.7345s/iter; left time: 18288.0697s
Epoch: 12 cost time: 207.67944145202637
Epoch: 12, Steps: 282 | Train Loss: 0.4461715 Vali Loss: 0.5640333 Test Loss: 0.2640198
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7009066
	speed: 1.5919s/iter; left time: 39346.8703s
	iters: 200, epoch: 13 | loss: 0.4263194
	speed: 0.6970s/iter; left time: 17158.4029s
Epoch: 13 cost time: 207.36755204200745
Epoch: 13, Steps: 282 | Train Loss: 0.4424945 Vali Loss: 0.5646431 Test Loss: 0.2647570
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3721933
	speed: 1.6551s/iter; left time: 40441.8628s
	iters: 200, epoch: 14 | loss: 0.4060224
	speed: 0.6998s/iter; left time: 17029.7171s
Epoch: 14 cost time: 207.26770687103271
Epoch: 14, Steps: 282 | Train Loss: 0.4397756 Vali Loss: 0.5659586 Test Loss: 0.2668733
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4242302
	speed: 1.5602s/iter; left time: 37683.3303s
	iters: 200, epoch: 15 | loss: 0.4707932
	speed: 0.7116s/iter; left time: 17116.9963s
Epoch: 15 cost time: 201.4324300289154
Epoch: 15, Steps: 282 | Train Loss: 0.4372821 Vali Loss: 0.5707374 Test Loss: 0.2680477
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4186770
	speed: 1.5487s/iter; left time: 36968.5105s
	iters: 200, epoch: 16 | loss: 0.4255962
	speed: 0.7068s/iter; left time: 16801.4294s
Epoch: 16 cost time: 201.0090057849884
Epoch: 16, Steps: 282 | Train Loss: 0.4345616 Vali Loss: 0.5707545 Test Loss: 0.2682887
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.4961686
	speed: 1.6906s/iter; left time: 39878.9825s
	iters: 200, epoch: 17 | loss: 0.4514895
	speed: 0.7082s/iter; left time: 16634.7531s
Epoch: 17 cost time: 222.55635929107666
Epoch: 17, Steps: 282 | Train Loss: 0.4328668 Vali Loss: 0.5693805 Test Loss: 0.2680901
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.4680398
	speed: 1.6178s/iter; left time: 37705.9261s
	iters: 200, epoch: 18 | loss: 0.3796063
	speed: 0.7002s/iter; left time: 16250.0263s
Epoch: 18 cost time: 203.08636832237244
Epoch: 18, Steps: 282 | Train Loss: 0.4308073 Vali Loss: 0.5727223 Test Loss: 0.2690030
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4251206
	speed: 1.6740s/iter; left time: 38543.4334s
	iters: 200, epoch: 19 | loss: 0.3838240
	speed: 0.6757s/iter; left time: 15491.4546s
Epoch: 19 cost time: 206.60363626480103
Epoch: 19, Steps: 282 | Train Loss: 0.4286936 Vali Loss: 0.5760153 Test Loss: 0.2698067
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.4192879
	speed: 1.4822s/iter; left time: 33709.2141s
	iters: 200, epoch: 20 | loss: 0.5160679
	speed: 0.6291s/iter; left time: 14245.6172s
Epoch: 20 cost time: 183.92177724838257
Epoch: 20, Steps: 282 | Train Loss: 0.4274267 Vali Loss: 0.5752522 Test Loss: 0.2714724
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.4443970
	speed: 1.5068s/iter; left time: 33843.8469s
	iters: 200, epoch: 21 | loss: 0.4709876
	speed: 0.7089s/iter; left time: 15851.4818s
Epoch: 21 cost time: 195.03018260002136
Epoch: 21, Steps: 282 | Train Loss: 0.4261754 Vali Loss: 0.5750955 Test Loss: 0.2713927
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.3504324
	speed: 1.5104s/iter; left time: 33499.1028s
	iters: 200, epoch: 22 | loss: 0.3396196
	speed: 0.6613s/iter; left time: 14599.7905s
Epoch: 22 cost time: 193.92391753196716
Epoch: 22, Steps: 282 | Train Loss: 0.4248961 Vali Loss: 0.5766835 Test Loss: 0.2718515
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.3079328
	speed: 1.4804s/iter; left time: 32416.1583s
	iters: 200, epoch: 23 | loss: 0.3433698
	speed: 0.6667s/iter; left time: 14532.4603s
Epoch: 23 cost time: 192.2943253517151
Epoch: 23, Steps: 282 | Train Loss: 0.4235944 Vali Loss: 0.5788620 Test Loss: 0.2724630
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : weather_336_336_CIPatchTSF_custom_ftM_sl336_ll48_pl336_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2466755211353302, mae:0.2860325574874878, rse:0.6524167656898499
