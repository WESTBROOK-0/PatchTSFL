Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.7504034
	speed: 0.0646s/iter; left time: 1171.3346s
	iters: 200, epoch: 1 | loss: 0.5980057
	speed: 0.0433s/iter; left time: 780.6884s
	iters: 300, epoch: 1 | loss: 0.5352521
	speed: 0.0438s/iter; left time: 786.0453s
	iters: 400, epoch: 1 | loss: 0.5509370
	speed: 0.0445s/iter; left time: 792.9648s
	iters: 500, epoch: 1 | loss: 0.4861332
	speed: 0.0454s/iter; left time: 804.3990s
	iters: 600, epoch: 1 | loss: 0.4566877
	speed: 0.0436s/iter; left time: 769.2833s
	iters: 700, epoch: 1 | loss: 0.5182010
	speed: 0.0530s/iter; left time: 928.7196s
	iters: 800, epoch: 1 | loss: 0.4326319
	speed: 0.0454s/iter; left time: 790.6586s
	iters: 900, epoch: 1 | loss: 0.7170463
	speed: 0.0442s/iter; left time: 766.0124s
	iters: 1000, epoch: 1 | loss: 0.8874436
	speed: 0.0484s/iter; left time: 834.0249s
	iters: 1100, epoch: 1 | loss: 0.3637213
	speed: 0.0494s/iter; left time: 846.5298s
	iters: 1200, epoch: 1 | loss: 0.6538365
	speed: 0.0520s/iter; left time: 884.9468s
	iters: 1300, epoch: 1 | loss: 0.6094257
	speed: 0.0453s/iter; left time: 766.3654s
	iters: 1400, epoch: 1 | loss: 0.4757957
	speed: 0.0473s/iter; left time: 795.9667s
	iters: 1500, epoch: 1 | loss: 0.6216438
	speed: 0.0442s/iter; left time: 738.8119s
	iters: 1600, epoch: 1 | loss: 0.4953425
	speed: 0.0431s/iter; left time: 716.0860s
	iters: 1700, epoch: 1 | loss: 0.6290272
	speed: 0.0479s/iter; left time: 791.7102s
	iters: 1800, epoch: 1 | loss: 0.3142097
	speed: 0.0505s/iter; left time: 829.5163s
	iters: 1900, epoch: 1 | loss: 0.4717476
	speed: 0.0461s/iter; left time: 752.3218s
	iters: 2000, epoch: 1 | loss: 0.3570086
	speed: 0.0465s/iter; left time: 755.2621s
	iters: 2100, epoch: 1 | loss: 0.9451508
	speed: 0.0454s/iter; left time: 731.7120s
	iters: 2200, epoch: 1 | loss: 0.5236228
	speed: 0.0461s/iter; left time: 739.0388s
	iters: 2300, epoch: 1 | loss: 0.5290731
	speed: 0.0498s/iter; left time: 793.9091s
	iters: 2400, epoch: 1 | loss: 0.4966249
	speed: 0.0525s/iter; left time: 831.7148s
	iters: 2500, epoch: 1 | loss: 0.4195988
	speed: 0.0518s/iter; left time: 814.2400s
	iters: 2600, epoch: 1 | loss: 0.4850065
	speed: 0.0476s/iter; left time: 744.4759s
	iters: 2700, epoch: 1 | loss: 0.8893160
	speed: 0.0475s/iter; left time: 737.0933s
	iters: 2800, epoch: 1 | loss: 0.4907426
	speed: 0.0484s/iter; left time: 747.1482s
	iters: 2900, epoch: 1 | loss: 0.7756053
	speed: 0.0472s/iter; left time: 723.9414s
	iters: 3000, epoch: 1 | loss: 0.5302141
	speed: 0.0499s/iter; left time: 759.6205s
	iters: 3100, epoch: 1 | loss: 0.5562577
	speed: 0.0470s/iter; left time: 710.3922s
	iters: 3200, epoch: 1 | loss: 0.6432537
	speed: 0.0452s/iter; left time: 678.9376s
	iters: 3300, epoch: 1 | loss: 0.7264786
	speed: 0.0435s/iter; left time: 649.9864s
	iters: 3400, epoch: 1 | loss: 0.6242539
	speed: 0.0430s/iter; left time: 637.6026s
	iters: 3500, epoch: 1 | loss: 0.4277006
	speed: 0.0446s/iter; left time: 656.5345s
	iters: 3600, epoch: 1 | loss: 0.3325011
	speed: 0.0447s/iter; left time: 654.4529s
	iters: 3700, epoch: 1 | loss: 0.4483078
	speed: 0.0471s/iter; left time: 684.5110s
	iters: 3800, epoch: 1 | loss: 0.4621322
	speed: 0.0493s/iter; left time: 710.7839s
	iters: 3900, epoch: 1 | loss: 0.5632858
	speed: 0.0488s/iter; left time: 699.8160s
	iters: 4000, epoch: 1 | loss: 0.3689823
	speed: 0.0487s/iter; left time: 692.7841s
	iters: 4100, epoch: 1 | loss: 0.8729362
	speed: 0.0457s/iter; left time: 645.8968s
	iters: 4200, epoch: 1 | loss: 1.0743086
	speed: 0.0478s/iter; left time: 671.2738s
	iters: 4300, epoch: 1 | loss: 0.5871299
	speed: 0.0459s/iter; left time: 639.7468s
	iters: 4400, epoch: 1 | loss: 0.3903627
	speed: 0.0439s/iter; left time: 607.3697s
	iters: 4500, epoch: 1 | loss: 1.0432210
	speed: 0.0515s/iter; left time: 707.4042s
	iters: 4600, epoch: 1 | loss: 0.4306717
	speed: 0.0539s/iter; left time: 734.5098s
	iters: 4700, epoch: 1 | loss: 0.3858467
	speed: 0.0462s/iter; left time: 625.6273s
	iters: 4800, epoch: 1 | loss: 0.2963152
	speed: 0.0436s/iter; left time: 585.1810s
	iters: 4900, epoch: 1 | loss: 0.3299401
	speed: 0.0455s/iter; left time: 606.0970s
	iters: 5000, epoch: 1 | loss: 0.3823767
	speed: 0.0461s/iter; left time: 609.2273s
	iters: 5100, epoch: 1 | loss: 1.1257646
	speed: 0.0451s/iter; left time: 592.0111s
	iters: 5200, epoch: 1 | loss: 0.4009790
	speed: 0.0425s/iter; left time: 553.8467s
	iters: 5300, epoch: 1 | loss: 0.6343501
	speed: 0.0431s/iter; left time: 556.9847s
	iters: 5400, epoch: 1 | loss: 0.7858530
	speed: 0.0444s/iter; left time: 569.6696s
	iters: 5500, epoch: 1 | loss: 0.6330518
	speed: 0.0455s/iter; left time: 578.8175s
	iters: 5600, epoch: 1 | loss: 0.3915419
	speed: 0.0433s/iter; left time: 547.4189s
	iters: 5700, epoch: 1 | loss: 0.6505314
	speed: 0.0437s/iter; left time: 547.8350s
	iters: 5800, epoch: 1 | loss: 0.3334499
	speed: 0.0439s/iter; left time: 545.3782s
	iters: 5900, epoch: 1 | loss: 0.2688957
	speed: 0.0458s/iter; left time: 564.1990s
	iters: 6000, epoch: 1 | loss: 0.3334134
	speed: 0.0462s/iter; left time: 565.4751s
	iters: 6100, epoch: 1 | loss: 0.4387458
	speed: 0.0447s/iter; left time: 542.3833s
	iters: 6200, epoch: 1 | loss: 0.6169305
	speed: 0.0460s/iter; left time: 552.7510s
	iters: 6300, epoch: 1 | loss: 0.6897563
	speed: 0.0435s/iter; left time: 519.2293s
	iters: 6400, epoch: 1 | loss: 0.5722820
	speed: 0.0425s/iter; left time: 502.5014s
	iters: 6500, epoch: 1 | loss: 0.3932791
	speed: 0.0421s/iter; left time: 494.2704s
	iters: 6600, epoch: 1 | loss: 0.7516066
	speed: 0.0406s/iter; left time: 472.0730s
	iters: 6700, epoch: 1 | loss: 0.4124418
	speed: 0.0391s/iter; left time: 450.5169s
	iters: 6800, epoch: 1 | loss: 0.3855810
	speed: 0.0406s/iter; left time: 464.2183s
	iters: 6900, epoch: 1 | loss: 0.4951028
	speed: 0.0414s/iter; left time: 468.5583s
	iters: 7000, epoch: 1 | loss: 0.3987446
	speed: 0.0451s/iter; left time: 506.4824s
	iters: 7100, epoch: 1 | loss: 0.4130403
	speed: 0.0485s/iter; left time: 539.7009s
	iters: 7200, epoch: 1 | loss: 0.3431919
	speed: 0.0467s/iter; left time: 515.2078s
	iters: 7300, epoch: 1 | loss: 0.3383138
	speed: 0.0443s/iter; left time: 484.4022s
	iters: 7400, epoch: 1 | loss: 0.2707937
	speed: 0.0432s/iter; left time: 467.9110s
	iters: 7500, epoch: 1 | loss: 0.4432616
	speed: 0.0442s/iter; left time: 474.0557s
	iters: 7600, epoch: 1 | loss: 0.3346268
	speed: 0.0462s/iter; left time: 491.4141s
	iters: 7700, epoch: 1 | loss: 0.3709907
	speed: 0.0444s/iter; left time: 468.0061s
	iters: 7800, epoch: 1 | loss: 0.4507432
	speed: 0.0476s/iter; left time: 496.5026s
	iters: 7900, epoch: 1 | loss: 0.6139100
	speed: 0.0504s/iter; left time: 520.8108s
	iters: 8000, epoch: 1 | loss: 0.3161755
	speed: 0.0470s/iter; left time: 480.4189s
	iters: 8100, epoch: 1 | loss: 0.3651337
	speed: 0.0434s/iter; left time: 439.4202s
	iters: 8200, epoch: 1 | loss: 0.3728646
	speed: 0.0437s/iter; left time: 438.4966s
	iters: 8300, epoch: 1 | loss: 0.2906582
	speed: 0.0439s/iter; left time: 436.1403s
	iters: 8400, epoch: 1 | loss: 0.4385921
	speed: 0.0458s/iter; left time: 450.0321s
	iters: 8500, epoch: 1 | loss: 0.4019704
	speed: 0.0445s/iter; left time: 432.4594s
	iters: 8600, epoch: 1 | loss: 0.3953130
	speed: 0.0439s/iter; left time: 422.9904s
	iters: 8700, epoch: 1 | loss: 0.3594362
	speed: 0.0432s/iter; left time: 411.8625s
	iters: 8800, epoch: 1 | loss: 0.5831455
	speed: 0.0444s/iter; left time: 418.6877s
	iters: 8900, epoch: 1 | loss: 0.3298497
	speed: 0.0450s/iter; left time: 419.6759s
	iters: 9000, epoch: 1 | loss: 0.6248981
	speed: 0.0456s/iter; left time: 420.4881s
	iters: 9100, epoch: 1 | loss: 0.5365070
	speed: 0.0460s/iter; left time: 420.1079s
Epoch: 1 cost time: 419.52923011779785
Epoch: 1, Steps: 9114 | Train Loss: 0.6320125 Vali Loss: 0.5910445 Test Loss: 0.3115911
Validation loss decreased (inf --> 0.591044).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5057786
	speed: 0.7296s/iter; left time: 6576.9945s
	iters: 200, epoch: 2 | loss: 0.4031803
	speed: 0.0445s/iter; left time: 397.1022s
	iters: 300, epoch: 2 | loss: 0.6273518
	speed: 0.0454s/iter; left time: 400.5648s
	iters: 400, epoch: 2 | loss: 0.5117624
	speed: 0.0429s/iter; left time: 374.2971s
	iters: 500, epoch: 2 | loss: 0.3839217
	speed: 0.0422s/iter; left time: 363.5734s
	iters: 600, epoch: 2 | loss: 0.4977881
	speed: 0.0440s/iter; left time: 374.6000s
	iters: 700, epoch: 2 | loss: 0.3927094
	speed: 0.0456s/iter; left time: 383.6873s
	iters: 800, epoch: 2 | loss: 0.5785143
	speed: 0.0452s/iter; left time: 375.8620s
	iters: 900, epoch: 2 | loss: 0.4972303
	speed: 0.0464s/iter; left time: 380.9921s
	iters: 1000, epoch: 2 | loss: 0.5677459
	speed: 0.0436s/iter; left time: 353.5431s
	iters: 1100, epoch: 2 | loss: 0.3460616
	speed: 0.0427s/iter; left time: 341.8437s
	iters: 1200, epoch: 2 | loss: 0.3898970
	speed: 0.0424s/iter; left time: 335.9160s
	iters: 1300, epoch: 2 | loss: 0.4673544
	speed: 0.0434s/iter; left time: 339.3283s
	iters: 1400, epoch: 2 | loss: 0.4848407
	speed: 0.0445s/iter; left time: 343.6415s
	iters: 1500, epoch: 2 | loss: 0.2643663
	speed: 0.0468s/iter; left time: 356.2052s
	iters: 1600, epoch: 2 | loss: 0.4961912
	speed: 0.0462s/iter; left time: 347.1210s
	iters: 1700, epoch: 2 | loss: 0.3986527
	speed: 0.0477s/iter; left time: 353.3644s
	iters: 1800, epoch: 2 | loss: 0.3758012
	speed: 0.0461s/iter; left time: 337.1122s
	iters: 1900, epoch: 2 | loss: 0.3506884
	speed: 0.0510s/iter; left time: 368.2621s
	iters: 2000, epoch: 2 | loss: 0.5372370
	speed: 0.0451s/iter; left time: 320.5723s
	iters: 2100, epoch: 2 | loss: 0.4466592
	speed: 0.0436s/iter; left time: 305.5163s
	iters: 2200, epoch: 2 | loss: 0.6611500
	speed: 0.0445s/iter; left time: 307.9160s
	iters: 2300, epoch: 2 | loss: 0.4527012
	speed: 0.0502s/iter; left time: 341.9571s
	iters: 2400, epoch: 2 | loss: 0.3755959
	speed: 0.0480s/iter; left time: 322.0234s
	iters: 2500, epoch: 2 | loss: 0.5964021
	speed: 0.0478s/iter; left time: 315.8766s
	iters: 2600, epoch: 2 | loss: 0.4020053
	speed: 0.0492s/iter; left time: 320.7145s
	iters: 2700, epoch: 2 | loss: 0.2838865
	speed: 0.0430s/iter; left time: 276.0357s
	iters: 2800, epoch: 2 | loss: 0.2464419
	speed: 0.0452s/iter; left time: 285.3262s
	iters: 2900, epoch: 2 | loss: 0.2634778
	speed: 0.0470s/iter; left time: 291.8022s
	iters: 3000, epoch: 2 | loss: 2.8792808
	speed: 0.0457s/iter; left time: 279.2950s
	iters: 3100, epoch: 2 | loss: 0.5994580
	speed: 0.0444s/iter; left time: 267.2680s
	iters: 3200, epoch: 2 | loss: 0.5264010
	speed: 0.0436s/iter; left time: 257.9468s
	iters: 3300, epoch: 2 | loss: 0.2685605
	speed: 0.0434s/iter; left time: 252.1774s
	iters: 3400, epoch: 2 | loss: 0.2605470
	speed: 0.0439s/iter; left time: 251.0022s
	iters: 3500, epoch: 2 | loss: 0.3558172
	speed: 0.0441s/iter; left time: 247.7468s
	iters: 3600, epoch: 2 | loss: 0.4168031
	speed: 0.0443s/iter; left time: 244.1028s
	iters: 3700, epoch: 2 | loss: 0.2748967
	speed: 0.0442s/iter; left time: 239.2620s
	iters: 3800, epoch: 2 | loss: 0.4023341
	speed: 0.0463s/iter; left time: 245.8375s
	iters: 3900, epoch: 2 | loss: 0.3894778
	speed: 0.0410s/iter; left time: 213.7767s
	iters: 4000, epoch: 2 | loss: 0.5811377
	speed: 0.0456s/iter; left time: 233.3544s
	iters: 4100, epoch: 2 | loss: 0.3278903
	speed: 0.0450s/iter; left time: 225.8092s
	iters: 4200, epoch: 2 | loss: 0.3923653
	speed: 0.0425s/iter; left time: 208.8226s
	iters: 4300, epoch: 2 | loss: 0.4341846
	speed: 0.0499s/iter; left time: 240.1402s
	iters: 4400, epoch: 2 | loss: 0.2624833
	speed: 0.0513s/iter; left time: 241.7638s
	iters: 4500, epoch: 2 | loss: 0.3827671
	speed: 0.0464s/iter; left time: 214.3567s
	iters: 4600, epoch: 2 | loss: 0.3188674
	speed: 0.0449s/iter; left time: 202.6118s
	iters: 4700, epoch: 2 | loss: 0.3561036
	speed: 0.0457s/iter; left time: 201.7482s
	iters: 4800, epoch: 2 | loss: 0.4630334
	speed: 0.0443s/iter; left time: 191.0528s
	iters: 4900, epoch: 2 | loss: 0.9716765
	speed: 0.0441s/iter; left time: 185.7992s
	iters: 5000, epoch: 2 | loss: 0.7334647
	speed: 0.0428s/iter; left time: 176.2596s
	iters: 5100, epoch: 2 | loss: 0.6366407
	speed: 0.0453s/iter; left time: 181.7930s
	iters: 5200, epoch: 2 | loss: 0.7912921
	speed: 0.0523s/iter; left time: 204.5926s
	iters: 5300, epoch: 2 | loss: 0.3022323
	speed: 0.0508s/iter; left time: 193.6479s
	iters: 5400, epoch: 2 | loss: 0.3692280
	speed: 0.0456s/iter; left time: 169.4068s
	iters: 5500, epoch: 2 | loss: 0.5060398
	speed: 0.0431s/iter; left time: 155.8811s
	iters: 5600, epoch: 2 | loss: 0.3343607
	speed: 0.0449s/iter; left time: 157.8153s
	iters: 5700, epoch: 2 | loss: 0.3452746
	speed: 0.0438s/iter; left time: 149.4824s
	iters: 5800, epoch: 2 | loss: 0.4991228
	speed: 0.0432s/iter; left time: 143.1892s
	iters: 5900, epoch: 2 | loss: 0.2756227
	speed: 0.0442s/iter; left time: 141.9588s
	iters: 6000, epoch: 2 | loss: 0.4037252
	speed: 0.0449s/iter; left time: 139.8186s
	iters: 6100, epoch: 2 | loss: 1.0247694
	speed: 0.0438s/iter; left time: 132.0047s
	iters: 6200, epoch: 2 | loss: 0.4962009
	speed: 0.0438s/iter; left time: 127.7448s
	iters: 6300, epoch: 2 | loss: 0.4573431
	speed: 0.0444s/iter; left time: 124.9195s
	iters: 6400, epoch: 2 | loss: 0.4731877
	speed: 0.0473s/iter; left time: 128.4374s
	iters: 6500, epoch: 2 | loss: 0.6890296
	speed: 0.0447s/iter; left time: 116.9275s
	iters: 6600, epoch: 2 | loss: 0.4855596
	speed: 0.0454s/iter; left time: 114.0602s
	iters: 6700, epoch: 2 | loss: 0.2182859
	speed: 0.0420s/iter; left time: 101.4604s
	iters: 6800, epoch: 2 | loss: 0.3713672
	speed: 0.0386s/iter; left time: 89.3124s
	iters: 6900, epoch: 2 | loss: 0.3649881
	speed: 0.0411s/iter; left time: 91.0463s
	iters: 7000, epoch: 2 | loss: 0.2567003
	speed: 0.0420s/iter; left time: 88.9076s
	iters: 7100, epoch: 2 | loss: 0.4190226
	speed: 0.0396s/iter; left time: 79.7016s
	iters: 7200, epoch: 2 | loss: 1.3681875
	speed: 0.0431s/iter; left time: 82.5017s
	iters: 7300, epoch: 2 | loss: 0.2444896
	speed: 0.0504s/iter; left time: 91.5585s
	iters: 7400, epoch: 2 | loss: 0.4235218
	speed: 0.0509s/iter; left time: 87.3123s
	iters: 7500, epoch: 2 | loss: 0.4868936
	speed: 0.0463s/iter; left time: 74.8275s
	iters: 7600, epoch: 2 | loss: 0.3395323
	speed: 0.0480s/iter; left time: 72.6768s
	iters: 7700, epoch: 2 | loss: 0.2979576
	speed: 0.0500s/iter; left time: 70.6963s
	iters: 7800, epoch: 2 | loss: 0.1959126
	speed: 0.0461s/iter; left time: 60.6610s
	iters: 7900, epoch: 2 | loss: 0.2466836
	speed: 0.0431s/iter; left time: 52.3795s
	iters: 8000, epoch: 2 | loss: 0.3323042
	speed: 0.0452s/iter; left time: 50.3732s
	iters: 8100, epoch: 2 | loss: 0.9901653
	speed: 0.0451s/iter; left time: 45.7584s
	iters: 8200, epoch: 2 | loss: 0.2549708
	speed: 0.0467s/iter; left time: 42.6950s
	iters: 8300, epoch: 2 | loss: 0.4490561
	speed: 0.0433s/iter; left time: 35.3295s
	iters: 8400, epoch: 2 | loss: 0.3284831
	speed: 0.0442s/iter; left time: 31.5849s
	iters: 8500, epoch: 2 | loss: 0.2391434
	speed: 0.0468s/iter; left time: 28.7599s
	iters: 8600, epoch: 2 | loss: 0.3773689
	speed: 0.0481s/iter; left time: 24.7905s
	iters: 8700, epoch: 2 | loss: 0.3640406
	speed: 0.0509s/iter; left time: 21.1288s
	iters: 8800, epoch: 2 | loss: 0.2913494
	speed: 0.0468s/iter; left time: 14.7546s
	iters: 8900, epoch: 2 | loss: 0.5837433
	speed: 0.0442s/iter; left time: 9.5085s
	iters: 9000, epoch: 2 | loss: 0.2673628
	speed: 0.0449s/iter; left time: 5.1579s
	iters: 9100, epoch: 2 | loss: 0.3162944
	speed: 0.0442s/iter; left time: 0.6632s
Epoch: 2 cost time: 414.3481619358063
Epoch: 2, Steps: 9114 | Train Loss: 0.5247771 Vali Loss: 0.5253085 Test Loss: 0.2628416
Validation loss decreased (0.591044 --> 0.525309).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
