Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : 336_336_PatchTSFL_ETTm2_ftM_sl336_ll48_pl336_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5202807
	speed: 0.0941s/iter; left time: 2475.8702s
	iters: 200, epoch: 1 | loss: 0.4300978
	speed: 0.0708s/iter; left time: 1855.3455s
Epoch: 1 cost time: 21.195439338684082
Epoch: 1, Steps: 264 | Train Loss: 0.5386711 Vali Loss: 0.2632072 Test Loss: 0.3478493
Validation loss decreased (inf --> 0.263207).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.4620375
	speed: 0.2226s/iter; left time: 5796.2179s
	iters: 200, epoch: 2 | loss: 0.6033440
	speed: 0.0713s/iter; left time: 1848.9638s
Epoch: 2 cost time: 21.51572871208191
Epoch: 2, Steps: 264 | Train Loss: 0.5140113 Vali Loss: 0.2560367 Test Loss: 0.3382927
Validation loss decreased (0.263207 --> 0.256037).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.4801855
	speed: 0.2183s/iter; left time: 5625.9182s
	iters: 200, epoch: 3 | loss: 0.6025953
	speed: 0.0712s/iter; left time: 1827.3312s
Epoch: 3 cost time: 21.330605506896973
Epoch: 3, Steps: 264 | Train Loss: 0.5004394 Vali Loss: 0.2458283 Test Loss: 0.3248063
Validation loss decreased (0.256037 --> 0.245828).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.4574288
	speed: 0.2140s/iter; left time: 5458.3776s
	iters: 200, epoch: 4 | loss: 0.4861062
	speed: 0.0717s/iter; left time: 1821.6438s
Epoch: 4 cost time: 21.151389598846436
Epoch: 4, Steps: 264 | Train Loss: 0.4677776 Vali Loss: 0.2221255 Test Loss: 0.3045834
Validation loss decreased (0.245828 --> 0.222126).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.4963670
	speed: 0.2166s/iter; left time: 5469.1334s
	iters: 200, epoch: 5 | loss: 0.5953778
	speed: 0.0710s/iter; left time: 1784.1317s
Epoch: 5 cost time: 21.269479036331177
Epoch: 5, Steps: 264 | Train Loss: 0.4370625 Vali Loss: 0.2156107 Test Loss: 0.3006223
Validation loss decreased (0.222126 --> 0.215611).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.4962078
	speed: 0.2137s/iter; left time: 5338.0982s
	iters: 200, epoch: 6 | loss: 0.4108824
	speed: 0.0717s/iter; left time: 1784.0216s
Epoch: 6 cost time: 21.265602111816406
Epoch: 6, Steps: 264 | Train Loss: 0.4258447 Vali Loss: 0.2118690 Test Loss: 0.2957782
Validation loss decreased (0.215611 --> 0.211869).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.3823809
	speed: 0.2174s/iter; left time: 5372.4259s
	iters: 200, epoch: 7 | loss: 0.3610925
	speed: 0.0712s/iter; left time: 1751.8818s
Epoch: 7 cost time: 21.39256191253662
Epoch: 7, Steps: 264 | Train Loss: 0.4171063 Vali Loss: 0.2101353 Test Loss: 0.2930511
Validation loss decreased (0.211869 --> 0.210135).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3616986
	speed: 0.2271s/iter; left time: 5552.5520s
	iters: 200, epoch: 8 | loss: 0.4211665
	speed: 0.0728s/iter; left time: 1773.1846s
Epoch: 8 cost time: 21.65357518196106
Epoch: 8, Steps: 264 | Train Loss: 0.4099411 Vali Loss: 0.2089245 Test Loss: 0.2924575
Validation loss decreased (0.210135 --> 0.208925).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.3966191
	speed: 0.2289s/iter; left time: 5536.7858s
	iters: 200, epoch: 9 | loss: 0.4061017
	speed: 0.0711s/iter; left time: 1713.8028s
Epoch: 9 cost time: 22.052809476852417
Epoch: 9, Steps: 264 | Train Loss: 0.4030853 Vali Loss: 0.2090531 Test Loss: 0.2892679
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.4139940
	speed: 0.2106s/iter; left time: 5037.6352s
	iters: 200, epoch: 10 | loss: 0.4410466
	speed: 0.0732s/iter; left time: 1744.5418s
Epoch: 10 cost time: 21.414235591888428
Epoch: 10, Steps: 264 | Train Loss: 0.3980838 Vali Loss: 0.2091218 Test Loss: 0.2915236
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.4266818
	speed: 0.2225s/iter; left time: 5263.9455s
	iters: 200, epoch: 11 | loss: 0.3617190
	speed: 0.0717s/iter; left time: 1689.6535s
Epoch: 11 cost time: 21.23078751564026
Epoch: 11, Steps: 264 | Train Loss: 0.3922882 Vali Loss: 0.2075805 Test Loss: 0.2848786
Validation loss decreased (0.208925 --> 0.207580).  Saving model ...
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3247796
	speed: 0.2076s/iter; left time: 4856.2782s
	iters: 200, epoch: 12 | loss: 0.4287090
	speed: 0.0710s/iter; left time: 1653.9903s
Epoch: 12 cost time: 20.721560955047607
Epoch: 12, Steps: 264 | Train Loss: 0.3863948 Vali Loss: 0.2083071 Test Loss: 0.2847437
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.5688438
	speed: 0.2134s/iter; left time: 4936.7914s
	iters: 200, epoch: 13 | loss: 0.3309329
	speed: 0.0716s/iter; left time: 1648.5305s
Epoch: 13 cost time: 21.492455005645752
Epoch: 13, Steps: 264 | Train Loss: 0.3809755 Vali Loss: 0.2083859 Test Loss: 0.2875150
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3629522
	speed: 0.2150s/iter; left time: 4916.7807s
	iters: 200, epoch: 14 | loss: 0.3169566
	speed: 0.0713s/iter; left time: 1623.8164s
Epoch: 14 cost time: 21.284857988357544
Epoch: 14, Steps: 264 | Train Loss: 0.3748008 Vali Loss: 0.2088149 Test Loss: 0.2869609
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.4215883
	speed: 0.2204s/iter; left time: 4981.2357s
	iters: 200, epoch: 15 | loss: 0.3130842
	speed: 0.0714s/iter; left time: 1607.6922s
Epoch: 15 cost time: 21.299899101257324
Epoch: 15, Steps: 264 | Train Loss: 0.3671352 Vali Loss: 0.2088636 Test Loss: 0.2850967
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.4690365
	speed: 0.2174s/iter; left time: 4856.2817s
	iters: 200, epoch: 16 | loss: 0.4763357
	speed: 0.0712s/iter; left time: 1583.9531s
Epoch: 16 cost time: 21.415709972381592
Epoch: 16, Steps: 264 | Train Loss: 0.3598890 Vali Loss: 0.2083822 Test Loss: 0.2882414
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.3647989
	speed: 0.2409s/iter; left time: 5317.5610s
	iters: 200, epoch: 17 | loss: 0.2636119
	speed: 0.0714s/iter; left time: 1569.8945s
Epoch: 17 cost time: 22.080097436904907
Epoch: 17, Steps: 264 | Train Loss: 0.3520845 Vali Loss: 0.2092656 Test Loss: 0.2927481
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.3145590
	speed: 0.2277s/iter; left time: 4967.5785s
	iters: 200, epoch: 18 | loss: 0.3010364
	speed: 0.0714s/iter; left time: 1549.5495s
Epoch: 18 cost time: 21.304818391799927
Epoch: 18, Steps: 264 | Train Loss: 0.3455074 Vali Loss: 0.2093346 Test Loss: 0.2894768
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3433878
	speed: 0.2190s/iter; left time: 4719.1728s
	iters: 200, epoch: 19 | loss: 0.3471778
	speed: 0.0735s/iter; left time: 1576.3235s
Epoch: 19 cost time: 21.83630061149597
Epoch: 19, Steps: 264 | Train Loss: 0.3399071 Vali Loss: 0.2092103 Test Loss: 0.2907316
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.2750739
	speed: 0.2357s/iter; left time: 5017.7670s
	iters: 200, epoch: 20 | loss: 0.3857636
	speed: 0.0715s/iter; left time: 1515.1233s
Epoch: 20 cost time: 21.769351720809937
Epoch: 20, Steps: 264 | Train Loss: 0.3332590 Vali Loss: 0.2063896 Test Loss: 0.2911462
Validation loss decreased (0.207580 --> 0.206390).  Saving model ...
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.2540458
	speed: 0.2238s/iter; left time: 4703.5496s
	iters: 200, epoch: 21 | loss: 0.3255557
	speed: 0.0736s/iter; left time: 1538.9242s
Epoch: 21 cost time: 21.61068296432495
Epoch: 21, Steps: 264 | Train Loss: 0.3286016 Vali Loss: 0.2060616 Test Loss: 0.2906916
Validation loss decreased (0.206390 --> 0.206062).  Saving model ...
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.4018607
	speed: 0.2359s/iter; left time: 4896.8924s
	iters: 200, epoch: 22 | loss: 0.3202559
	speed: 0.0715s/iter; left time: 1477.0435s
Epoch: 22 cost time: 21.562637090682983
Epoch: 22, Steps: 264 | Train Loss: 0.3223497 Vali Loss: 0.2075088 Test Loss: 0.2905337
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.2706064
	speed: 0.2151s/iter; left time: 4408.9525s
	iters: 200, epoch: 23 | loss: 0.2999186
	speed: 0.0709s/iter; left time: 1445.5691s
Epoch: 23 cost time: 21.192931652069092
Epoch: 23, Steps: 264 | Train Loss: 0.3178477 Vali Loss: 0.2076182 Test Loss: 0.2924753
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.3165185
	speed: 0.2269s/iter; left time: 4590.0840s
	iters: 200, epoch: 24 | loss: 0.3371183
	speed: 0.0708s/iter; left time: 1424.8858s
Epoch: 24 cost time: 21.959631204605103
Epoch: 24, Steps: 264 | Train Loss: 0.3123262 Vali Loss: 0.2097927 Test Loss: 0.2981445
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.2990139
	speed: 0.2209s/iter; left time: 4410.6699s
	iters: 200, epoch: 25 | loss: 0.3240303
	speed: 0.0710s/iter; left time: 1410.6883s
Epoch: 25 cost time: 21.34118914604187
Epoch: 25, Steps: 264 | Train Loss: 0.3080075 Vali Loss: 0.2093687 Test Loss: 0.2924086
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.3367704
	speed: 0.2323s/iter; left time: 4576.0850s
	iters: 200, epoch: 26 | loss: 0.3489428
	speed: 0.0734s/iter; left time: 1438.9284s
Epoch: 26 cost time: 22.17419457435608
Epoch: 26, Steps: 264 | Train Loss: 0.3034094 Vali Loss: 0.2097615 Test Loss: 0.2890928
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.3233496
	speed: 0.2502s/iter; left time: 4862.6503s
	iters: 200, epoch: 27 | loss: 0.2320151
	speed: 0.0762s/iter; left time: 1472.8568s
Epoch: 27 cost time: 22.77631449699402
Epoch: 27, Steps: 264 | Train Loss: 0.2996720 Vali Loss: 0.2110799 Test Loss: 0.2903991
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.2732144
	speed: 0.2187s/iter; left time: 4192.7002s
	iters: 200, epoch: 28 | loss: 0.2827432
	speed: 0.0705s/iter; left time: 1344.5187s
Epoch: 28 cost time: 21.21359419822693
Epoch: 28, Steps: 264 | Train Loss: 0.2958999 Vali Loss: 0.2120491 Test Loss: 0.2962957
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.3074873
	speed: 0.2112s/iter; left time: 3992.8053s
	iters: 200, epoch: 29 | loss: 0.2949486
	speed: 0.0720s/iter; left time: 1353.4302s
Epoch: 29 cost time: 21.18361258506775
Epoch: 29, Steps: 264 | Train Loss: 0.2919267 Vali Loss: 0.2113138 Test Loss: 0.2952208
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.318137880466269e-05
	iters: 100, epoch: 30 | loss: 0.2656174
	speed: 0.2297s/iter; left time: 4282.8909s
	iters: 200, epoch: 30 | loss: 0.2970148
	speed: 0.0731s/iter; left time: 1355.2055s
Epoch: 30 cost time: 22.67123532295227
Epoch: 30, Steps: 264 | Train Loss: 0.2889233 Vali Loss: 0.2119176 Test Loss: 0.2916459
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.594869846499432e-05
	iters: 100, epoch: 31 | loss: 0.3478814
	speed: 0.2233s/iter; left time: 4104.4661s
	iters: 200, epoch: 31 | loss: 0.3353127
	speed: 0.0740s/iter; left time: 1352.5383s
Epoch: 31 cost time: 22.340657711029053
Epoch: 31, Steps: 264 | Train Loss: 0.2853413 Vali Loss: 0.2134560 Test Loss: 0.2936278
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.85066734838546e-05
	iters: 100, epoch: 32 | loss: 0.3052260
	speed: 0.2439s/iter; left time: 4418.2239s
	iters: 200, epoch: 32 | loss: 0.2845146
	speed: 0.0736s/iter; left time: 1326.4410s
Epoch: 32 cost time: 21.935898303985596
Epoch: 32, Steps: 264 | Train Loss: 0.2822965 Vali Loss: 0.2152570 Test Loss: 0.2974156
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.083953010886336e-05
	iters: 100, epoch: 33 | loss: 0.2873988
	speed: 0.2407s/iter; left time: 4296.4917s
	iters: 200, epoch: 33 | loss: 0.3565207
	speed: 0.0732s/iter; left time: 1299.0611s
Epoch: 33 cost time: 22.812347173690796
Epoch: 33, Steps: 264 | Train Loss: 0.2789020 Vali Loss: 0.2156611 Test Loss: 0.2966916
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.29328827801656e-05
	iters: 100, epoch: 34 | loss: 0.2406628
	speed: 0.2106s/iter; left time: 3704.5041s
	iters: 200, epoch: 34 | loss: 0.3347640
	speed: 0.0730s/iter; left time: 1276.2749s
Epoch: 34 cost time: 21.575395822525024
Epoch: 34, Steps: 264 | Train Loss: 0.2757962 Vali Loss: 0.2174540 Test Loss: 0.2964447
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.477382283898318e-05
	iters: 100, epoch: 35 | loss: 0.2473507
	speed: 0.2429s/iter; left time: 4207.6958s
	iters: 200, epoch: 35 | loss: 0.2127743
	speed: 0.0736s/iter; left time: 1268.0985s
Epoch: 35 cost time: 22.609164714813232
Epoch: 35, Steps: 264 | Train Loss: 0.2731092 Vali Loss: 0.2180339 Test Loss: 0.2986790
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.635099812885627e-05
	iters: 100, epoch: 36 | loss: 0.2132898
	speed: 0.2313s/iter; left time: 3946.3122s
	iters: 200, epoch: 36 | loss: 0.2986714
	speed: 0.0741s/iter; left time: 1256.4722s
Epoch: 36 cost time: 21.865304708480835
Epoch: 36, Steps: 264 | Train Loss: 0.2699282 Vali Loss: 0.2159971 Test Loss: 0.2973530
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.765468299871352e-05
	iters: 100, epoch: 37 | loss: 0.3035931
	speed: 0.2408s/iter; left time: 4045.3098s
	iters: 200, epoch: 37 | loss: 0.2386075
	speed: 0.0732s/iter; left time: 1222.3372s
Epoch: 37 cost time: 22.401240587234497
Epoch: 37, Steps: 264 | Train Loss: 0.2674356 Vali Loss: 0.2208195 Test Loss: 0.3034019
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.86768382760973e-05
	iters: 100, epoch: 38 | loss: 0.2717150
	speed: 0.2166s/iter; left time: 3580.7546s
	iters: 200, epoch: 38 | loss: 0.2979762
	speed: 0.0730s/iter; left time: 1200.3177s
Epoch: 38 cost time: 21.26035499572754
Epoch: 38, Steps: 264 | Train Loss: 0.2651462 Vali Loss: 0.2195763 Test Loss: 0.2993532
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.941116084071886e-05
	iters: 100, epoch: 39 | loss: 0.2635775
	speed: 0.2163s/iter; left time: 3518.5704s
	iters: 200, epoch: 39 | loss: 0.2533009
	speed: 0.0716s/iter; left time: 1157.0530s
Epoch: 39 cost time: 21.190585613250732
Epoch: 39, Steps: 264 | Train Loss: 0.2626817 Vali Loss: 0.2208678 Test Loss: 0.3013954
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.985312249264813e-05
	iters: 100, epoch: 40 | loss: 0.2070476
	speed: 0.2170s/iter; left time: 3473.6275s
	iters: 200, epoch: 40 | loss: 0.2171177
	speed: 0.0713s/iter; left time: 1133.2748s
Epoch: 40 cost time: 20.9564950466156
Epoch: 40, Steps: 264 | Train Loss: 0.2600231 Vali Loss: 0.2216388 Test Loss: 0.2979245
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.999999901660576e-05
	iters: 100, epoch: 41 | loss: 0.2472411
	speed: 0.2293s/iter; left time: 3609.8450s
	iters: 200, epoch: 41 | loss: 0.2847849
	speed: 0.0715s/iter; left time: 1118.6301s
Epoch: 41 cost time: 21.620884895324707
Epoch: 41, Steps: 264 | Train Loss: 0.2573414 Vali Loss: 0.2215232 Test Loss: 0.3031343
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTSFL_ETTm2_ftM_sl336_ll48_pl336_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2906917929649353, mae:0.33992999792099, rse:0.43499118089675903
