Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm1_336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm1_336_720_PatchTSFL_ETTm1_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2472350
	speed: 0.0689s/iter; left time: 1790.6713s
	iters: 200, epoch: 1 | loss: 0.2182482
	speed: 0.0477s/iter; left time: 1235.2185s
Epoch: 1 cost time: 14.55350136756897
Epoch: 1, Steps: 261 | Train Loss: 0.2430470 Vali Loss: 0.1351829 Test Loss: 0.0831652
Validation loss decreased (inf --> 0.135183).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.2335712
	speed: 0.1662s/iter; left time: 4278.9035s
	iters: 200, epoch: 2 | loss: 0.2045623
	speed: 0.0492s/iter; left time: 1261.1723s
Epoch: 2 cost time: 15.1347336769104
Epoch: 2, Steps: 261 | Train Loss: 0.2335977 Vali Loss: 0.1330995 Test Loss: 0.0823809
Validation loss decreased (0.135183 --> 0.133100).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.2591409
	speed: 0.1719s/iter; left time: 4380.0535s
	iters: 200, epoch: 3 | loss: 0.2176031
	speed: 0.0467s/iter; left time: 1185.8084s
Epoch: 3 cost time: 14.682287693023682
Epoch: 3, Steps: 261 | Train Loss: 0.2299330 Vali Loss: 0.1307323 Test Loss: 0.0813668
Validation loss decreased (0.133100 --> 0.130732).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.2307834
	speed: 0.1684s/iter; left time: 4245.7827s
	iters: 200, epoch: 4 | loss: 0.2191811
	speed: 0.0497s/iter; left time: 1248.0883s
Epoch: 4 cost time: 14.93291711807251
Epoch: 4, Steps: 261 | Train Loss: 0.2247982 Vali Loss: 0.1263307 Test Loss: 0.0786025
Validation loss decreased (0.130732 --> 0.126331).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.2334931
	speed: 0.1729s/iter; left time: 4314.2925s
	iters: 200, epoch: 5 | loss: 0.2258290
	speed: 0.0423s/iter; left time: 1051.7246s
Epoch: 5 cost time: 13.956385850906372
Epoch: 5, Steps: 261 | Train Loss: 0.2140387 Vali Loss: 0.1239347 Test Loss: 0.0761420
Validation loss decreased (0.126331 --> 0.123935).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.1939712
	speed: 0.1645s/iter; left time: 4061.3487s
	iters: 200, epoch: 6 | loss: 0.2272887
	speed: 0.0421s/iter; left time: 1035.1429s
Epoch: 6 cost time: 13.90068531036377
Epoch: 6, Steps: 261 | Train Loss: 0.2076852 Vali Loss: 0.1238671 Test Loss: 0.0759415
Validation loss decreased (0.123935 --> 0.123867).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.2123516
	speed: 0.1627s/iter; left time: 3976.4707s
	iters: 200, epoch: 7 | loss: 0.2206129
	speed: 0.0412s/iter; left time: 1002.4037s
Epoch: 7 cost time: 13.619778871536255
Epoch: 7, Steps: 261 | Train Loss: 0.2049103 Vali Loss: 0.1230986 Test Loss: 0.0754289
Validation loss decreased (0.123867 --> 0.123099).  Saving model ...
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.2154203
	speed: 0.1582s/iter; left time: 3824.5293s
	iters: 200, epoch: 8 | loss: 0.1879906
	speed: 0.0418s/iter; left time: 1006.4909s
Epoch: 8 cost time: 13.369488954544067
Epoch: 8, Steps: 261 | Train Loss: 0.2021823 Vali Loss: 0.1221756 Test Loss: 0.0749160
Validation loss decreased (0.123099 --> 0.122176).  Saving model ...
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.1730711
	speed: 0.1647s/iter; left time: 3939.0068s
	iters: 200, epoch: 9 | loss: 0.1776673
	speed: 0.0413s/iter; left time: 983.7287s
Epoch: 9 cost time: 13.621360540390015
Epoch: 9, Steps: 261 | Train Loss: 0.1996959 Vali Loss: 0.1216122 Test Loss: 0.0743422
Validation loss decreased (0.122176 --> 0.121612).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.2161764
	speed: 0.1679s/iter; left time: 3971.1940s
	iters: 200, epoch: 10 | loss: 0.1928113
	speed: 0.0464s/iter; left time: 1091.7290s
Epoch: 10 cost time: 14.604567289352417
Epoch: 10, Steps: 261 | Train Loss: 0.1968486 Vali Loss: 0.1201044 Test Loss: 0.0737168
Validation loss decreased (0.121612 --> 0.120104).  Saving model ...
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.1729843
	speed: 0.1726s/iter; left time: 4036.2845s
	iters: 200, epoch: 11 | loss: 0.1900163
	speed: 0.0480s/iter; left time: 1118.9465s
Epoch: 11 cost time: 14.807127237319946
Epoch: 11, Steps: 261 | Train Loss: 0.1938658 Vali Loss: 0.1187532 Test Loss: 0.0734280
Validation loss decreased (0.120104 --> 0.118753).  Saving model ...
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.1822415
	speed: 0.1722s/iter; left time: 3983.3614s
	iters: 200, epoch: 12 | loss: 0.1821534
	speed: 0.0472s/iter; left time: 1087.3333s
Epoch: 12 cost time: 14.95689082145691
Epoch: 12, Steps: 261 | Train Loss: 0.1908447 Vali Loss: 0.1174601 Test Loss: 0.0734199
Validation loss decreased (0.118753 --> 0.117460).  Saving model ...
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.1900034
	speed: 0.1652s/iter; left time: 3778.1126s
	iters: 200, epoch: 13 | loss: 0.1685880
	speed: 0.0430s/iter; left time: 978.2806s
Epoch: 13 cost time: 13.903356313705444
Epoch: 13, Steps: 261 | Train Loss: 0.1870137 Vali Loss: 0.1161204 Test Loss: 0.0732780
Validation loss decreased (0.117460 --> 0.116120).  Saving model ...
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.1884253
	speed: 0.1703s/iter; left time: 3850.5188s
	iters: 200, epoch: 14 | loss: 0.2264772
	speed: 0.0482s/iter; left time: 1084.5074s
Epoch: 14 cost time: 14.57236123085022
Epoch: 14, Steps: 261 | Train Loss: 0.1837186 Vali Loss: 0.1149638 Test Loss: 0.0729438
Validation loss decreased (0.116120 --> 0.114964).  Saving model ...
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.2103186
	speed: 0.1682s/iter; left time: 3759.8129s
	iters: 200, epoch: 15 | loss: 0.1936610
	speed: 0.0476s/iter; left time: 1059.4334s
Epoch: 15 cost time: 14.758045673370361
Epoch: 15, Steps: 261 | Train Loss: 0.1810269 Vali Loss: 0.1139043 Test Loss: 0.0728411
Validation loss decreased (0.114964 --> 0.113904).  Saving model ...
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.2130584
	speed: 0.1694s/iter; left time: 3741.1669s
	iters: 200, epoch: 16 | loss: 0.1641278
	speed: 0.0426s/iter; left time: 937.2149s
Epoch: 16 cost time: 13.950016260147095
Epoch: 16, Steps: 261 | Train Loss: 0.1786944 Vali Loss: 0.1140451 Test Loss: 0.0737408
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.1661828
	speed: 0.1650s/iter; left time: 3600.6883s
	iters: 200, epoch: 17 | loss: 0.1570512
	speed: 0.0444s/iter; left time: 965.4224s
Epoch: 17 cost time: 14.097150564193726
Epoch: 17, Steps: 261 | Train Loss: 0.1762956 Vali Loss: 0.1140497 Test Loss: 0.0736511
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.1717476
	speed: 0.1634s/iter; left time: 3524.4450s
	iters: 200, epoch: 18 | loss: 0.1722722
	speed: 0.0478s/iter; left time: 1025.8557s
Epoch: 18 cost time: 14.677189588546753
Epoch: 18, Steps: 261 | Train Loss: 0.1743046 Vali Loss: 0.1144648 Test Loss: 0.0742075
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.1584476
	speed: 0.1618s/iter; left time: 3447.0442s
	iters: 200, epoch: 19 | loss: 0.1778737
	speed: 0.0416s/iter; left time: 881.4330s
Epoch: 19 cost time: 13.524131059646606
Epoch: 19, Steps: 261 | Train Loss: 0.1720375 Vali Loss: 0.1130949 Test Loss: 0.0741757
Validation loss decreased (0.113904 --> 0.113095).  Saving model ...
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.1630210
	speed: 0.1626s/iter; left time: 3420.5008s
	iters: 200, epoch: 20 | loss: 0.1491513
	speed: 0.0460s/iter; left time: 964.1763s
Epoch: 20 cost time: 14.427351474761963
Epoch: 20, Steps: 261 | Train Loss: 0.1692275 Vali Loss: 0.1128850 Test Loss: 0.0752773
Validation loss decreased (0.113095 --> 0.112885).  Saving model ...
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.1624404
	speed: 0.1632s/iter; left time: 3392.4125s
	iters: 200, epoch: 21 | loss: 0.1460779
	speed: 0.0495s/iter; left time: 1023.7535s
Epoch: 21 cost time: 14.476155519485474
Epoch: 21, Steps: 261 | Train Loss: 0.1663643 Vali Loss: 0.1135603 Test Loss: 0.0745161
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.1716506
	speed: 0.1627s/iter; left time: 3338.1353s
	iters: 200, epoch: 22 | loss: 0.1629655
	speed: 0.0444s/iter; left time: 907.5093s
Epoch: 22 cost time: 13.764122247695923
Epoch: 22, Steps: 261 | Train Loss: 0.1634118 Vali Loss: 0.1132901 Test Loss: 0.0762786
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.1497774
	speed: 0.1582s/iter; left time: 3205.0323s
	iters: 200, epoch: 23 | loss: 0.1563357
	speed: 0.0475s/iter; left time: 956.6348s
Epoch: 23 cost time: 14.48331332206726
Epoch: 23, Steps: 261 | Train Loss: 0.1597093 Vali Loss: 0.1133246 Test Loss: 0.0768137
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.1446597
	speed: 0.1680s/iter; left time: 3358.8728s
	iters: 200, epoch: 24 | loss: 0.1637653
	speed: 0.0462s/iter; left time: 920.2628s
Epoch: 24 cost time: 14.465384006500244
Epoch: 24, Steps: 261 | Train Loss: 0.1562472 Vali Loss: 0.1148164 Test Loss: 0.0771023
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.1514841
	speed: 0.1637s/iter; left time: 3230.5100s
	iters: 200, epoch: 25 | loss: 0.1434411
	speed: 0.0419s/iter; left time: 823.1268s
Epoch: 25 cost time: 13.487931489944458
Epoch: 25, Steps: 261 | Train Loss: 0.1521404 Vali Loss: 0.1134134 Test Loss: 0.0773980
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.1603038
	speed: 0.1643s/iter; left time: 3200.3711s
	iters: 200, epoch: 26 | loss: 0.1548193
	speed: 0.0423s/iter; left time: 819.0657s
Epoch: 26 cost time: 13.751246929168701
Epoch: 26, Steps: 261 | Train Loss: 0.1483539 Vali Loss: 0.1140997 Test Loss: 0.0794660
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.1326589
	speed: 0.1641s/iter; left time: 3152.2962s
	iters: 200, epoch: 27 | loss: 0.1434348
	speed: 0.0434s/iter; left time: 830.0499s
Epoch: 27 cost time: 14.108136892318726
Epoch: 27, Steps: 261 | Train Loss: 0.1448318 Vali Loss: 0.1150973 Test Loss: 0.0807393
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.1361968
	speed: 0.1656s/iter; left time: 3138.0326s
	iters: 200, epoch: 28 | loss: 0.1533118
	speed: 0.0471s/iter; left time: 888.2832s
Epoch: 28 cost time: 14.510457277297974
Epoch: 28, Steps: 261 | Train Loss: 0.1412375 Vali Loss: 0.1178531 Test Loss: 0.0819547
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.1363897
	speed: 0.1632s/iter; left time: 3050.4688s
	iters: 200, epoch: 29 | loss: 0.1490375
	speed: 0.0449s/iter; left time: 834.0296s
Epoch: 29 cost time: 14.026189088821411
Epoch: 29, Steps: 261 | Train Loss: 0.1378927 Vali Loss: 0.1186163 Test Loss: 0.0828583
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.318146929322795e-05
	iters: 100, epoch: 30 | loss: 0.1480075
	speed: 0.1656s/iter; left time: 3051.7207s
	iters: 200, epoch: 30 | loss: 0.1253151
	speed: 0.0457s/iter; left time: 837.0780s
Epoch: 30 cost time: 14.04993724822998
Epoch: 30, Steps: 261 | Train Loss: 0.1347872 Vali Loss: 0.1185686 Test Loss: 0.0830302
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.59487855091154e-05
	iters: 100, epoch: 31 | loss: 0.1339281
	speed: 0.1656s/iter; left time: 3009.3215s
	iters: 200, epoch: 31 | loss: 0.1354067
	speed: 0.0444s/iter; left time: 801.6339s
Epoch: 31 cost time: 13.74397587776184
Epoch: 31, Steps: 261 | Train Loss: 0.1314919 Vali Loss: 0.1194381 Test Loss: 0.0848870
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.850675609123214e-05
	iters: 100, epoch: 32 | loss: 0.1175271
	speed: 0.1601s/iter; left time: 2867.7704s
	iters: 200, epoch: 32 | loss: 0.1302805
	speed: 0.0461s/iter; left time: 820.1829s
Epoch: 32 cost time: 14.20711612701416
Epoch: 32, Steps: 261 | Train Loss: 0.1287336 Vali Loss: 0.1204300 Test Loss: 0.0859168
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.083960728023302e-05
	iters: 100, epoch: 33 | loss: 0.1125342
	speed: 0.1640s/iter; left time: 2893.8005s
	iters: 200, epoch: 33 | loss: 0.1266547
	speed: 0.0457s/iter; left time: 802.5459s
Epoch: 33 cost time: 14.280237674713135
Epoch: 33, Steps: 261 | Train Loss: 0.1258522 Vali Loss: 0.1215268 Test Loss: 0.0841674
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.293295351848083e-05
	iters: 100, epoch: 34 | loss: 0.1202733
	speed: 0.1633s/iter; left time: 2839.8797s
	iters: 200, epoch: 34 | loss: 0.1416782
	speed: 0.0461s/iter; left time: 796.2788s
Epoch: 34 cost time: 14.401602745056152
Epoch: 34, Steps: 261 | Train Loss: 0.1235165 Vali Loss: 0.1240416 Test Loss: 0.0865263
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.47738861587773e-05
	iters: 100, epoch: 35 | loss: 0.1141120
	speed: 0.1612s/iter; left time: 2761.5990s
	iters: 200, epoch: 35 | loss: 0.1230972
	speed: 0.0410s/iter; left time: 698.1535s
Epoch: 35 cost time: 13.592732906341553
Epoch: 35, Steps: 261 | Train Loss: 0.1208745 Vali Loss: 0.1252618 Test Loss: 0.0860434
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.635105306570629e-05
	iters: 100, epoch: 36 | loss: 0.1218144
	speed: 0.1638s/iter; left time: 2763.0411s
	iters: 200, epoch: 36 | loss: 0.1123832
	speed: 0.0462s/iter; left time: 774.0716s
Epoch: 36 cost time: 14.368938207626343
Epoch: 36, Steps: 261 | Train Loss: 0.1191217 Vali Loss: 0.1238633 Test Loss: 0.0870991
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.765472861872672e-05
	iters: 100, epoch: 37 | loss: 0.1155332
	speed: 0.1710s/iter; left time: 2839.0442s
	iters: 200, epoch: 37 | loss: 0.1145538
	speed: 0.0429s/iter; left time: 707.2756s
Epoch: 37 cost time: 14.168467283248901
Epoch: 37, Steps: 261 | Train Loss: 0.1171032 Vali Loss: 0.1261182 Test Loss: 0.0896930
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.867687368533986e-05
	iters: 100, epoch: 38 | loss: 0.1131920
	speed: 0.1613s/iter; left time: 2635.9677s
	iters: 200, epoch: 38 | loss: 0.1253664
	speed: 0.0464s/iter; left time: 753.1248s
Epoch: 38 cost time: 14.219807624816895
Epoch: 38, Steps: 261 | Train Loss: 0.1151659 Vali Loss: 0.1265000 Test Loss: 0.0869658
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.941118519450599e-05
	iters: 100, epoch: 39 | loss: 0.1097895
	speed: 0.1631s/iter; left time: 2622.6033s
	iters: 200, epoch: 39 | loss: 0.1211997
	speed: 0.0475s/iter; left time: 759.9335s
Epoch: 39 cost time: 14.478434562683105
Epoch: 39, Steps: 261 | Train Loss: 0.1132152 Vali Loss: 0.1295651 Test Loss: 0.0879060
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.985313500461516e-05
	iters: 100, epoch: 40 | loss: 0.1128300
	speed: 0.1679s/iter; left time: 2657.0885s
	iters: 200, epoch: 40 | loss: 0.1138560
	speed: 0.0482s/iter; left time: 758.0855s
Epoch: 40 cost time: 14.875083446502686
Epoch: 40, Steps: 261 | Train Loss: 0.1114579 Vali Loss: 0.1292843 Test Loss: 0.0876216
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_720_PatchTSFL_ETTm1_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.07527730613946915, mae:0.20974954962730408, rse:0.8253825902938843
