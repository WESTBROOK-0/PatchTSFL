Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_336', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_336_PatchTSFL_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5306279
	speed: 0.0125s/iter; left time: 328.7286s
	iters: 200, epoch: 1 | loss: 0.5764579
	speed: 0.0074s/iter; left time: 192.8449s
Epoch: 1 cost time: 2.5530591011047363
Epoch: 1, Steps: 264 | Train Loss: 0.5417363 Vali Loss: 1.0995244 Test Loss: 0.7039851
Validation loss decreased (inf --> 1.099524).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.5297548
	speed: 0.0490s/iter; left time: 1274.5381s
	iters: 200, epoch: 2 | loss: 0.5040310
	speed: 0.0078s/iter; left time: 203.2423s
Epoch: 2 cost time: 2.682478427886963
Epoch: 2, Steps: 264 | Train Loss: 0.5417651 Vali Loss: 1.0985358 Test Loss: 0.7039930
Validation loss decreased (1.099524 --> 1.098536).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.4954638
	speed: 0.0484s/iter; left time: 1247.8667s
	iters: 200, epoch: 3 | loss: 0.5789053
	speed: 0.0083s/iter; left time: 212.2646s
Epoch: 3 cost time: 2.8279616832733154
Epoch: 3, Steps: 264 | Train Loss: 0.5417608 Vali Loss: 1.0989568 Test Loss: 0.7040021
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.5882096
	speed: 0.0475s/iter; left time: 1212.3662s
	iters: 200, epoch: 4 | loss: 0.5190165
	speed: 0.0075s/iter; left time: 191.4114s
Epoch: 4 cost time: 2.6563804149627686
Epoch: 4, Steps: 264 | Train Loss: 0.5417825 Vali Loss: 1.0987978 Test Loss: 0.7040141
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.5224500
	speed: 0.0465s/iter; left time: 1175.1287s
	iters: 200, epoch: 5 | loss: 0.5662383
	speed: 0.0074s/iter; left time: 186.5759s
Epoch: 5 cost time: 2.6671485900878906
Epoch: 5, Steps: 264 | Train Loss: 0.5416690 Vali Loss: 1.0982049 Test Loss: 0.7040261
Validation loss decreased (1.098536 --> 1.098205).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.5545678
	speed: 0.0470s/iter; left time: 1173.3870s
	iters: 200, epoch: 6 | loss: 0.5003998
	speed: 0.0072s/iter; left time: 180.3016s
Epoch: 6 cost time: 2.606095314025879
Epoch: 6, Steps: 264 | Train Loss: 0.5417675 Vali Loss: 1.0983657 Test Loss: 0.7040424
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.5922049
	speed: 0.0465s/iter; left time: 1149.8690s
	iters: 200, epoch: 7 | loss: 0.5501959
	speed: 0.0076s/iter; left time: 186.4846s
Epoch: 7 cost time: 2.6754181385040283
Epoch: 7, Steps: 264 | Train Loss: 0.5418325 Vali Loss: 1.0985047 Test Loss: 0.7040614
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.5616844
	speed: 0.0471s/iter; left time: 1151.2777s
	iters: 200, epoch: 8 | loss: 0.5468122
	speed: 0.0075s/iter; left time: 182.9619s
Epoch: 8 cost time: 2.634603261947632
Epoch: 8, Steps: 264 | Train Loss: 0.5416969 Vali Loss: 1.0986934 Test Loss: 0.7040828
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.5327463
	speed: 0.0467s/iter; left time: 1129.2448s
	iters: 200, epoch: 9 | loss: 0.5325091
	speed: 0.0078s/iter; left time: 188.6726s
Epoch: 9 cost time: 2.8652970790863037
Epoch: 9, Steps: 264 | Train Loss: 0.5416937 Vali Loss: 1.0981016 Test Loss: 0.7041101
Validation loss decreased (1.098205 --> 1.098102).  Saving model ...
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.5724778
	speed: 0.0470s/iter; left time: 1124.3525s
	iters: 200, epoch: 10 | loss: 0.5430163
	speed: 0.0074s/iter; left time: 175.2167s
Epoch: 10 cost time: 2.644209146499634
Epoch: 10, Steps: 264 | Train Loss: 0.5416605 Vali Loss: 1.0988915 Test Loss: 0.7041395
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.5348161
	speed: 0.0468s/iter; left time: 1106.2560s
	iters: 200, epoch: 11 | loss: 0.5419475
	speed: 0.0076s/iter; left time: 179.4647s
Epoch: 11 cost time: 2.6798324584960938
Epoch: 11, Steps: 264 | Train Loss: 0.5415864 Vali Loss: 1.0986840 Test Loss: 0.7041730
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.5333555
	speed: 0.0465s/iter; left time: 1087.8493s
	iters: 200, epoch: 12 | loss: 0.5316786
	speed: 0.0072s/iter; left time: 168.5813s
Epoch: 12 cost time: 2.585120677947998
Epoch: 12, Steps: 264 | Train Loss: 0.5416479 Vali Loss: 1.0988599 Test Loss: 0.7042128
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.5471026
	speed: 0.0455s/iter; left time: 1053.2667s
	iters: 200, epoch: 13 | loss: 0.5404190
	speed: 0.0074s/iter; left time: 169.8364s
Epoch: 13 cost time: 2.549213409423828
Epoch: 13, Steps: 264 | Train Loss: 0.5416279 Vali Loss: 1.0990170 Test Loss: 0.7042532
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.5374521
	speed: 0.0473s/iter; left time: 1082.0124s
	iters: 200, epoch: 14 | loss: 0.5427611
	speed: 0.0074s/iter; left time: 168.3743s
Epoch: 14 cost time: 2.6418323516845703
Epoch: 14, Steps: 264 | Train Loss: 0.5417070 Vali Loss: 1.0994468 Test Loss: 0.7042982
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.5570506
	speed: 0.0467s/iter; left time: 1055.6988s
	iters: 200, epoch: 15 | loss: 0.5138440
	speed: 0.0074s/iter; left time: 166.8872s
Epoch: 15 cost time: 2.541921615600586
Epoch: 15, Steps: 264 | Train Loss: 0.5415252 Vali Loss: 1.0983858 Test Loss: 0.7043431
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.5944458
	speed: 0.0499s/iter; left time: 1114.3756s
	iters: 200, epoch: 16 | loss: 0.5666834
	speed: 0.0079s/iter; left time: 175.8701s
Epoch: 16 cost time: 2.7641348838806152
Epoch: 16, Steps: 264 | Train Loss: 0.5416364 Vali Loss: 1.0990403 Test Loss: 0.7043921
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.5362002
	speed: 0.0496s/iter; left time: 1094.8455s
	iters: 200, epoch: 17 | loss: 0.5397272
	speed: 0.0078s/iter; left time: 170.6733s
Epoch: 17 cost time: 2.9268858432769775
Epoch: 17, Steps: 264 | Train Loss: 0.5414651 Vali Loss: 1.0994331 Test Loss: 0.7044412
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.5760906
	speed: 0.0467s/iter; left time: 1018.3041s
	iters: 200, epoch: 18 | loss: 0.5667075
	speed: 0.0074s/iter; left time: 160.5179s
Epoch: 18 cost time: 2.5423691272735596
Epoch: 18, Steps: 264 | Train Loss: 0.5414875 Vali Loss: 1.0994033 Test Loss: 0.7044863
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.5591904
	speed: 0.0466s/iter; left time: 1004.8898s
	iters: 200, epoch: 19 | loss: 0.5241110
	speed: 0.0073s/iter; left time: 157.1718s
Epoch: 19 cost time: 2.5854294300079346
Epoch: 19, Steps: 264 | Train Loss: 0.5416205 Vali Loss: 1.0985507 Test Loss: 0.7045339
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.5191728
	speed: 0.0447s/iter; left time: 951.9164s
	iters: 200, epoch: 20 | loss: 0.5207713
	speed: 0.0074s/iter; left time: 157.3973s
Epoch: 20 cost time: 2.56652569770813
Epoch: 20, Steps: 264 | Train Loss: 0.5415787 Vali Loss: 1.0996376 Test Loss: 0.7045799
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.5393648
	speed: 0.0507s/iter; left time: 1066.6045s
	iters: 200, epoch: 21 | loss: 0.5433165
	speed: 0.0075s/iter; left time: 157.6053s
Epoch: 21 cost time: 2.878310203552246
Epoch: 21, Steps: 264 | Train Loss: 0.5417014 Vali Loss: 1.0985948 Test Loss: 0.7046191
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.5563142
	speed: 0.0444s/iter; left time: 921.3700s
	iters: 200, epoch: 22 | loss: 0.4932181
	speed: 0.0071s/iter; left time: 146.9215s
Epoch: 22 cost time: 2.559828042984009
Epoch: 22, Steps: 264 | Train Loss: 0.5415667 Vali Loss: 1.0986875 Test Loss: 0.7046528
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.5339644
	speed: 0.0519s/iter; left time: 1062.8426s
	iters: 200, epoch: 23 | loss: 0.5433210
	speed: 0.0075s/iter; left time: 153.3216s
Epoch: 23 cost time: 2.620457649230957
Epoch: 23, Steps: 264 | Train Loss: 0.5415127 Vali Loss: 1.0986573 Test Loss: 0.7046870
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.5636218
	speed: 0.0462s/iter; left time: 934.3808s
	iters: 200, epoch: 24 | loss: 0.5431061
	speed: 0.0072s/iter; left time: 145.0721s
Epoch: 24 cost time: 2.6367645263671875
Epoch: 24, Steps: 264 | Train Loss: 0.5415716 Vali Loss: 1.0983659 Test Loss: 0.7047153
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.5105843
	speed: 0.0459s/iter; left time: 915.5237s
	iters: 200, epoch: 25 | loss: 0.5526828
	speed: 0.0074s/iter; left time: 146.8449s
Epoch: 25 cost time: 2.682234525680542
Epoch: 25, Steps: 264 | Train Loss: 0.5416113 Vali Loss: 1.0991060 Test Loss: 0.7047348
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.5701765
	speed: 0.0469s/iter; left time: 923.7888s
	iters: 200, epoch: 26 | loss: 0.5511118
	speed: 0.0074s/iter; left time: 144.1293s
Epoch: 26 cost time: 2.661114454269409
Epoch: 26, Steps: 264 | Train Loss: 0.5415645 Vali Loss: 1.0991187 Test Loss: 0.7047539
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.5530725
	speed: 0.0464s/iter; left time: 902.7377s
	iters: 200, epoch: 27 | loss: 0.5547563
	speed: 0.0073s/iter; left time: 141.2872s
Epoch: 27 cost time: 2.6515347957611084
Epoch: 27, Steps: 264 | Train Loss: 0.5414186 Vali Loss: 1.0992988 Test Loss: 0.7047688
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.5350910
	speed: 0.0477s/iter; left time: 913.8858s
	iters: 200, epoch: 28 | loss: 0.5593526
	speed: 0.0078s/iter; left time: 149.4724s
Epoch: 28 cost time: 2.6999144554138184
Epoch: 28, Steps: 264 | Train Loss: 0.5414675 Vali Loss: 1.0991658 Test Loss: 0.7047838
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.5742518
	speed: 0.0471s/iter; left time: 891.4150s
	iters: 200, epoch: 29 | loss: 0.5460758
	speed: 0.0073s/iter; left time: 137.5712s
Epoch: 29 cost time: 2.537065267562866
Epoch: 29, Steps: 264 | Train Loss: 0.5415922 Vali Loss: 1.0990049 Test Loss: 0.7047901
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTSFL_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.7041108012199402, mae:0.5586443543434143, rse:0.7983932495117188
