Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm1_336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_192_PatchTST_ETTm1_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.1597265
	speed: 0.0379s/iter; left time: 999.6925s
	iters: 200, epoch: 1 | loss: 0.1683058
	speed: 0.0178s/iter; left time: 466.9802s
Epoch: 1 cost time: 6.821017503738403
Epoch: 1, Steps: 265 | Train Loss: 0.1700959 Vali Loss: 0.0858270 Test Loss: 0.0436924
Validation loss decreased (inf --> 0.085827).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.1336106
	speed: 0.1136s/iter; left time: 2969.8548s
	iters: 200, epoch: 2 | loss: 0.1468578
	speed: 0.0204s/iter; left time: 530.6585s
Epoch: 2 cost time: 7.706152439117432
Epoch: 2, Steps: 265 | Train Loss: 0.1430312 Vali Loss: 0.0808216 Test Loss: 0.0411302
Validation loss decreased (0.085827 --> 0.080822).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.1300086
	speed: 0.1084s/iter; left time: 2804.0278s
	iters: 200, epoch: 3 | loss: 0.1060679
	speed: 0.0174s/iter; left time: 449.3308s
Epoch: 3 cost time: 6.751940011978149
Epoch: 3, Steps: 265 | Train Loss: 0.1347925 Vali Loss: 0.0787429 Test Loss: 0.0400234
Validation loss decreased (0.080822 --> 0.078743).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.1439207
	speed: 0.1096s/iter; left time: 2805.5008s
	iters: 200, epoch: 4 | loss: 0.1118316
	speed: 0.0182s/iter; left time: 464.6857s
Epoch: 4 cost time: 7.349796295166016
Epoch: 4, Steps: 265 | Train Loss: 0.1308390 Vali Loss: 0.0776973 Test Loss: 0.0394238
Validation loss decreased (0.078743 --> 0.077697).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.1258859
	speed: 0.1089s/iter; left time: 2758.4591s
	iters: 200, epoch: 5 | loss: 0.1551024
	speed: 0.0180s/iter; left time: 455.5990s
Epoch: 5 cost time: 6.837891101837158
Epoch: 5, Steps: 265 | Train Loss: 0.1280296 Vali Loss: 0.0772443 Test Loss: 0.0391707
Validation loss decreased (0.077697 --> 0.077244).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.1241110
	speed: 0.1099s/iter; left time: 2757.0803s
	iters: 200, epoch: 6 | loss: 0.1139067
	speed: 0.0184s/iter; left time: 460.5163s
Epoch: 6 cost time: 7.4505884647369385
Epoch: 6, Steps: 265 | Train Loss: 0.1261822 Vali Loss: 0.0770651 Test Loss: 0.0390736
Validation loss decreased (0.077244 --> 0.077065).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.1423410
	speed: 0.1060s/iter; left time: 2630.8833s
	iters: 200, epoch: 7 | loss: 0.1103320
	speed: 0.0181s/iter; left time: 446.7426s
Epoch: 7 cost time: 6.985252380371094
Epoch: 7, Steps: 265 | Train Loss: 0.1249108 Vali Loss: 0.0772706 Test Loss: 0.0391131
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.1280024
	speed: 0.1086s/iter; left time: 2666.3199s
	iters: 200, epoch: 8 | loss: 0.1051502
	speed: 0.0218s/iter; left time: 533.3566s
Epoch: 8 cost time: 7.640108108520508
Epoch: 8, Steps: 265 | Train Loss: 0.1235252 Vali Loss: 0.0771481 Test Loss: 0.0390932
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.1331261
	speed: 0.1126s/iter; left time: 2734.0271s
	iters: 200, epoch: 9 | loss: 0.1289880
	speed: 0.0177s/iter; left time: 429.1729s
Epoch: 9 cost time: 7.00706148147583
Epoch: 9, Steps: 265 | Train Loss: 0.1227541 Vali Loss: 0.0770682 Test Loss: 0.0392218
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.1153624
	speed: 0.1049s/iter; left time: 2519.6437s
	iters: 200, epoch: 10 | loss: 0.1043649
	speed: 0.0183s/iter; left time: 437.3456s
Epoch: 10 cost time: 7.049689769744873
Epoch: 10, Steps: 265 | Train Loss: 0.1216706 Vali Loss: 0.0774281 Test Loss: 0.0391665
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.1243829
	speed: 0.1094s/iter; left time: 2597.7554s
	iters: 200, epoch: 11 | loss: 0.1139976
	speed: 0.0180s/iter; left time: 426.3609s
Epoch: 11 cost time: 7.087846279144287
Epoch: 11, Steps: 265 | Train Loss: 0.1204777 Vali Loss: 0.0777151 Test Loss: 0.0393860
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.1151314
	speed: 0.1097s/iter; left time: 2576.1675s
	iters: 200, epoch: 12 | loss: 0.1091672
	speed: 0.0182s/iter; left time: 426.6950s
Epoch: 12 cost time: 7.086505889892578
Epoch: 12, Steps: 265 | Train Loss: 0.1193525 Vali Loss: 0.0778837 Test Loss: 0.0389306
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.1403646
	speed: 0.1111s/iter; left time: 2580.8874s
	iters: 200, epoch: 13 | loss: 0.1122966
	speed: 0.0183s/iter; left time: 423.1723s
Epoch: 13 cost time: 7.271367073059082
Epoch: 13, Steps: 265 | Train Loss: 0.1179348 Vali Loss: 0.0794906 Test Loss: 0.0392084
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.1438248
	speed: 0.1058s/iter; left time: 2429.2365s
	iters: 200, epoch: 14 | loss: 0.1009845
	speed: 0.0174s/iter; left time: 398.0442s
Epoch: 14 cost time: 6.7355263233184814
Epoch: 14, Steps: 265 | Train Loss: 0.1162739 Vali Loss: 0.0800332 Test Loss: 0.0396980
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.1286562
	speed: 0.1091s/iter; left time: 2475.8632s
	iters: 200, epoch: 15 | loss: 0.0987745
	speed: 0.0180s/iter; left time: 406.7915s
Epoch: 15 cost time: 7.153797149658203
Epoch: 15, Steps: 265 | Train Loss: 0.1145937 Vali Loss: 0.0812347 Test Loss: 0.0405732
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.1157974
	speed: 0.1118s/iter; left time: 2507.6478s
	iters: 200, epoch: 16 | loss: 0.1219354
	speed: 0.0182s/iter; left time: 405.2285s
Epoch: 16 cost time: 7.08774471282959
Epoch: 16, Steps: 265 | Train Loss: 0.1125601 Vali Loss: 0.0811631 Test Loss: 0.0400293
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.0972707
	speed: 0.1134s/iter; left time: 2513.7473s
	iters: 200, epoch: 17 | loss: 0.1110483
	speed: 0.0184s/iter; left time: 406.2196s
Epoch: 17 cost time: 7.2332470417022705
Epoch: 17, Steps: 265 | Train Loss: 0.1099827 Vali Loss: 0.0830368 Test Loss: 0.0408620
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.1043999
	speed: 0.1060s/iter; left time: 2322.0410s
	iters: 200, epoch: 18 | loss: 0.1027251
	speed: 0.0180s/iter; left time: 391.4613s
Epoch: 18 cost time: 6.9842307567596436
Epoch: 18, Steps: 265 | Train Loss: 0.1076562 Vali Loss: 0.0820610 Test Loss: 0.0414661
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.1044986
	speed: 0.1123s/iter; left time: 2429.0150s
	iters: 200, epoch: 19 | loss: 0.1044628
	speed: 0.0181s/iter; left time: 389.2062s
Epoch: 19 cost time: 7.569007873535156
Epoch: 19, Steps: 265 | Train Loss: 0.1047377 Vali Loss: 0.0840686 Test Loss: 0.0415189
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.0999037
	speed: 0.1097s/iter; left time: 2342.8733s
	iters: 200, epoch: 20 | loss: 0.1038786
	speed: 0.0181s/iter; left time: 383.9667s
Epoch: 20 cost time: 7.053070306777954
Epoch: 20, Steps: 265 | Train Loss: 0.1015297 Vali Loss: 0.0854007 Test Loss: 0.0417756
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.0879913
	speed: 0.1103s/iter; left time: 2327.5695s
	iters: 200, epoch: 21 | loss: 0.0791021
	speed: 0.0174s/iter; left time: 366.4175s
Epoch: 21 cost time: 6.956781625747681
Epoch: 21, Steps: 265 | Train Loss: 0.0988739 Vali Loss: 0.0874387 Test Loss: 0.0413843
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.0899440
	speed: 0.1117s/iter; left time: 2326.8936s
	iters: 200, epoch: 22 | loss: 0.1148463
	speed: 0.0180s/iter; left time: 373.7576s
Epoch: 22 cost time: 7.098979234695435
Epoch: 22, Steps: 265 | Train Loss: 0.0951258 Vali Loss: 0.0892568 Test Loss: 0.0421363
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.0775015
	speed: 0.1088s/iter; left time: 2238.1479s
	iters: 200, epoch: 23 | loss: 0.0861118
	speed: 0.0180s/iter; left time: 368.0209s
Epoch: 23 cost time: 7.0734171867370605
Epoch: 23, Steps: 265 | Train Loss: 0.0917277 Vali Loss: 0.0902846 Test Loss: 0.0434493
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.0947916
	speed: 0.1121s/iter; left time: 2275.5842s
	iters: 200, epoch: 24 | loss: 0.0822497
	speed: 0.0181s/iter; left time: 365.1484s
Epoch: 24 cost time: 7.248331546783447
Epoch: 24, Steps: 265 | Train Loss: 0.0883987 Vali Loss: 0.0883565 Test Loss: 0.0420790
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.0849454
	speed: 0.1093s/iter; left time: 2190.2891s
	iters: 200, epoch: 25 | loss: 0.0808870
	speed: 0.0205s/iter; left time: 408.7522s
Epoch: 25 cost time: 7.501638412475586
Epoch: 25, Steps: 265 | Train Loss: 0.0850205 Vali Loss: 0.0868523 Test Loss: 0.0443511
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.0748368
	speed: 0.1068s/iter; left time: 2112.5971s
	iters: 200, epoch: 26 | loss: 0.0873273
	speed: 0.0181s/iter; left time: 356.5158s
Epoch: 26 cost time: 7.000232458114624
Epoch: 26, Steps: 265 | Train Loss: 0.0819600 Vali Loss: 0.0925846 Test Loss: 0.0441884
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_192_PatchTST_ETTm1_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.03907359391450882, mae:0.14965784549713135, rse:0.5797647833824158
