Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_720_PatchTSW_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5543005
	speed: 0.3634s/iter; left time: 9448.3745s
	iters: 200, epoch: 1 | loss: 0.4966235
	speed: 0.3480s/iter; left time: 9014.3892s
Epoch: 1 cost time: 92.49517035484314
Epoch: 1, Steps: 261 | Train Loss: 0.5424454 Vali Loss: 1.0258433 Test Loss: 0.4697876
Validation loss decreased (inf --> 1.025843).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.4612207
	speed: 0.7907s/iter; left time: 20351.4595s
	iters: 200, epoch: 2 | loss: 0.4573785
	speed: 0.3484s/iter; left time: 8933.5244s
Epoch: 2 cost time: 92.44603848457336
Epoch: 2, Steps: 261 | Train Loss: 0.4626756 Vali Loss: 0.9741337 Test Loss: 0.4440745
Validation loss decreased (1.025843 --> 0.974134).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.5021048
	speed: 0.7918s/iter; left time: 20173.6617s
	iters: 200, epoch: 3 | loss: 0.4168546
	speed: 0.3484s/iter; left time: 8842.1601s
Epoch: 3 cost time: 92.59301829338074
Epoch: 3, Steps: 261 | Train Loss: 0.4455815 Vali Loss: 0.9629787 Test Loss: 0.4364162
Validation loss decreased (0.974134 --> 0.962979).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4256472
	speed: 0.7958s/iter; left time: 20069.2197s
	iters: 200, epoch: 4 | loss: 0.4348816
	speed: 0.3485s/iter; left time: 8752.5090s
Epoch: 4 cost time: 92.75352931022644
Epoch: 4, Steps: 261 | Train Loss: 0.4376900 Vali Loss: 0.9533013 Test Loss: 0.4323021
Validation loss decreased (0.962979 --> 0.953301).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.4131085
	speed: 0.7970s/iter; left time: 19890.7029s
	iters: 200, epoch: 5 | loss: 0.4578185
	speed: 0.3486s/iter; left time: 8664.5414s
Epoch: 5 cost time: 92.70072770118713
Epoch: 5, Steps: 261 | Train Loss: 0.4319117 Vali Loss: 0.9513199 Test Loss: 0.4298305
Validation loss decreased (0.953301 --> 0.951320).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.4430974
	speed: 0.7904s/iter; left time: 19518.5682s
	iters: 200, epoch: 6 | loss: 0.3921426
	speed: 0.3485s/iter; left time: 8572.0615s
Epoch: 6 cost time: 92.58813762664795
Epoch: 6, Steps: 261 | Train Loss: 0.4270496 Vali Loss: 0.9459448 Test Loss: 0.4275697
Validation loss decreased (0.951320 --> 0.945945).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.4392236
	speed: 0.7936s/iter; left time: 19391.7270s
	iters: 200, epoch: 7 | loss: 0.4091826
	speed: 0.3483s/iter; left time: 8476.8341s
Epoch: 7 cost time: 92.61022400856018
Epoch: 7, Steps: 261 | Train Loss: 0.4224978 Vali Loss: 0.9470831 Test Loss: 0.4258530
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.4535086
	speed: 0.7813s/iter; left time: 18886.6856s
	iters: 200, epoch: 8 | loss: 0.4296488
	speed: 0.3486s/iter; left time: 8391.6322s
Epoch: 8 cost time: 92.7303638458252
Epoch: 8, Steps: 261 | Train Loss: 0.4183847 Vali Loss: 0.9452920 Test Loss: 0.4273930
Validation loss decreased (0.945945 --> 0.945292).  Saving model ...
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.4084931
	speed: 0.7941s/iter; left time: 18988.2853s
	iters: 200, epoch: 9 | loss: 0.4052393
	speed: 0.3484s/iter; left time: 8296.7332s
Epoch: 9 cost time: 92.66134929656982
Epoch: 9, Steps: 261 | Train Loss: 0.4141768 Vali Loss: 0.9496905 Test Loss: 0.4242320
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.4153075
	speed: 0.7879s/iter; left time: 18636.3813s
	iters: 200, epoch: 10 | loss: 0.4401655
	speed: 0.3486s/iter; left time: 8209.2196s
Epoch: 10 cost time: 92.76919341087341
Epoch: 10, Steps: 261 | Train Loss: 0.4103666 Vali Loss: 0.9518103 Test Loss: 0.4235882
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.3968008
	speed: 0.7899s/iter; left time: 18476.6235s
	iters: 200, epoch: 11 | loss: 0.4111559
	speed: 0.3489s/iter; left time: 8125.5699s
Epoch: 11 cost time: 92.98007535934448
Epoch: 11, Steps: 261 | Train Loss: 0.4065030 Vali Loss: 0.9497601 Test Loss: 0.4237645
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.3902492
	speed: 0.7853s/iter; left time: 18163.9592s
	iters: 200, epoch: 12 | loss: 0.3787795
	speed: 0.3486s/iter; left time: 8027.8692s
Epoch: 12 cost time: 92.75343918800354
Epoch: 12, Steps: 261 | Train Loss: 0.4021640 Vali Loss: 0.9532605 Test Loss: 0.4240644
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.4031603
	speed: 0.7913s/iter; left time: 18097.2467s
	iters: 200, epoch: 13 | loss: 0.3939429
	speed: 0.3483s/iter; left time: 7930.7056s
Epoch: 13 cost time: 93.0479805469513
Epoch: 13, Steps: 261 | Train Loss: 0.3981725 Vali Loss: 0.9506051 Test Loss: 0.4256259
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.3960693
	speed: 0.7767s/iter; left time: 17560.1197s
	iters: 200, epoch: 14 | loss: 0.4135084
	speed: 0.3487s/iter; left time: 7849.6345s
Epoch: 14 cost time: 92.73813939094543
Epoch: 14, Steps: 261 | Train Loss: 0.3936918 Vali Loss: 0.9527131 Test Loss: 0.4276759
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.4206477
	speed: 0.7872s/iter; left time: 17592.5545s
	iters: 200, epoch: 15 | loss: 0.3508820
	speed: 0.3485s/iter; left time: 7752.2192s
Epoch: 15 cost time: 92.80492210388184
Epoch: 15, Steps: 261 | Train Loss: 0.3882984 Vali Loss: 0.9598023 Test Loss: 0.4231927
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.4086307
	speed: 0.7813s/iter; left time: 17255.7377s
	iters: 200, epoch: 16 | loss: 0.3797395
	speed: 0.3486s/iter; left time: 7665.2752s
Epoch: 16 cost time: 92.47417116165161
Epoch: 16, Steps: 261 | Train Loss: 0.3827968 Vali Loss: 0.9549832 Test Loss: 0.4316469
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.3915564
	speed: 0.7979s/iter; left time: 17414.4698s
	iters: 200, epoch: 17 | loss: 0.3672958
	speed: 0.3487s/iter; left time: 7574.8782s
Epoch: 17 cost time: 92.93486762046814
Epoch: 17, Steps: 261 | Train Loss: 0.3766308 Vali Loss: 0.9661608 Test Loss: 0.4308326
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.3977005
	speed: 0.7813s/iter; left time: 16847.5404s
	iters: 200, epoch: 18 | loss: 0.3430840
	speed: 0.3488s/iter; left time: 7485.8487s
Epoch: 18 cost time: 92.65250539779663
Epoch: 18, Steps: 261 | Train Loss: 0.3706069 Vali Loss: 0.9735964 Test Loss: 0.4320324
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.3638078
	speed: 0.7975s/iter; left time: 16990.1181s
	iters: 200, epoch: 19 | loss: 0.3495801
	speed: 0.3486s/iter; left time: 7391.9705s
Epoch: 19 cost time: 93.05676054954529
Epoch: 19, Steps: 261 | Train Loss: 0.3646903 Vali Loss: 0.9923175 Test Loss: 0.4352153
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.3612444
	speed: 0.7854s/iter; left time: 16525.7660s
	iters: 200, epoch: 20 | loss: 0.3599235
	speed: 0.3485s/iter; left time: 7298.6142s
Epoch: 20 cost time: 92.86982536315918
Epoch: 20, Steps: 261 | Train Loss: 0.3592397 Vali Loss: 0.9882825 Test Loss: 0.4411405
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.3569744
	speed: 0.7899s/iter; left time: 16414.3217s
	iters: 200, epoch: 21 | loss: 0.3389095
	speed: 0.3485s/iter; left time: 7206.5121s
Epoch: 21 cost time: 92.62399673461914
Epoch: 21, Steps: 261 | Train Loss: 0.3535975 Vali Loss: 1.0113897 Test Loss: 0.4425337
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3593653
	speed: 0.7880s/iter; left time: 16169.0986s
	iters: 200, epoch: 22 | loss: 0.3786636
	speed: 0.3485s/iter; left time: 7116.7676s
Epoch: 22 cost time: 93.30312538146973
Epoch: 22, Steps: 261 | Train Loss: 0.3481159 Vali Loss: 1.0043218 Test Loss: 0.4478580
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.3496229
	speed: 0.7950s/iter; left time: 16106.5508s
	iters: 200, epoch: 23 | loss: 0.3407145
	speed: 0.3485s/iter; left time: 7024.4945s
Epoch: 23 cost time: 92.77059388160706
Epoch: 23, Steps: 261 | Train Loss: 0.3425841 Vali Loss: 1.0095670 Test Loss: 0.4515757
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3079624
	speed: 0.7983s/iter; left time: 15965.1480s
	iters: 200, epoch: 24 | loss: 0.3059910
	speed: 0.3481s/iter; left time: 6925.8705s
Epoch: 24 cost time: 92.72276997566223
Epoch: 24, Steps: 261 | Train Loss: 0.3373050 Vali Loss: 1.0094045 Test Loss: 0.4502700
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3262285
	speed: 0.7812s/iter; left time: 15418.6493s
	iters: 200, epoch: 25 | loss: 0.3449227
	speed: 0.3481s/iter; left time: 6836.5093s
Epoch: 25 cost time: 92.51261401176453
Epoch: 25, Steps: 261 | Train Loss: 0.3321377 Vali Loss: 0.9965473 Test Loss: 0.4554054
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.3291587
	speed: 0.7962s/iter; left time: 15506.2393s
	iters: 200, epoch: 26 | loss: 0.3265984
	speed: 0.3481s/iter; left time: 6745.4982s
Epoch: 26 cost time: 92.98423790931702
Epoch: 26, Steps: 261 | Train Loss: 0.3274540 Vali Loss: 1.0015486 Test Loss: 0.4541385
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.3164997
	speed: 0.7847s/iter; left time: 15077.0709s
	iters: 200, epoch: 27 | loss: 0.3272395
	speed: 0.3484s/iter; left time: 6659.0709s
Epoch: 27 cost time: 92.58956098556519
Epoch: 27, Steps: 261 | Train Loss: 0.3226079 Vali Loss: 1.0089064 Test Loss: 0.4579278
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.3043422
	speed: 0.7844s/iter; left time: 14866.9388s
	iters: 200, epoch: 28 | loss: 0.3266795
	speed: 0.3483s/iter; left time: 6566.0457s
Epoch: 28 cost time: 92.65790224075317
Epoch: 28, Steps: 261 | Train Loss: 0.3183104 Vali Loss: 1.0202516 Test Loss: 0.4582619
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTSW_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4273931086063385, mae:0.42439261078834534, rse:0.621871829032898
