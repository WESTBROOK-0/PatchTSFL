Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_96_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_1440_Autoformer_custom_ftM_sl96_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35352
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 0.9245679
	speed: 0.0738s/iter; left time: 1296.4429s
	iters: 200, epoch: 1 | loss: 1.3146315
	speed: 0.0557s/iter; left time: 973.7302s
	iters: 300, epoch: 1 | loss: 1.0021104
	speed: 0.0525s/iter; left time: 912.8854s
	iters: 400, epoch: 1 | loss: 0.9504533
	speed: 0.0519s/iter; left time: 896.7102s
	iters: 500, epoch: 1 | loss: 0.8251106
	speed: 0.0520s/iter; left time: 892.3808s
	iters: 600, epoch: 1 | loss: 1.1129074
	speed: 0.0512s/iter; left time: 874.0870s
	iters: 700, epoch: 1 | loss: 0.8435760
	speed: 0.0512s/iter; left time: 868.6852s
	iters: 800, epoch: 1 | loss: 0.8218268
	speed: 0.0584s/iter; left time: 986.2642s
	iters: 900, epoch: 1 | loss: 1.5923332
	speed: 0.0531s/iter; left time: 891.4066s
	iters: 1000, epoch: 1 | loss: 0.7965052
	speed: 0.0547s/iter; left time: 912.0983s
	iters: 1100, epoch: 1 | loss: 1.5290480
	speed: 0.0540s/iter; left time: 895.4402s
	iters: 1200, epoch: 1 | loss: 1.0418851
	speed: 0.0528s/iter; left time: 870.1396s
	iters: 1300, epoch: 1 | loss: 1.2658994
	speed: 0.0537s/iter; left time: 879.3580s
	iters: 1400, epoch: 1 | loss: 0.7397125
	speed: 0.0530s/iter; left time: 863.2077s
	iters: 1500, epoch: 1 | loss: 0.6365038
	speed: 0.0502s/iter; left time: 811.9837s
	iters: 1600, epoch: 1 | loss: 0.6805611
	speed: 0.0501s/iter; left time: 805.4949s
	iters: 1700, epoch: 1 | loss: 0.7076569
	speed: 0.0515s/iter; left time: 823.5550s
	iters: 1800, epoch: 1 | loss: 0.9040824
	speed: 0.0535s/iter; left time: 850.2060s
	iters: 1900, epoch: 1 | loss: 1.0042114
	speed: 0.0563s/iter; left time: 887.8737s
	iters: 2000, epoch: 1 | loss: 0.6265953
	speed: 0.0562s/iter; left time: 881.2499s
	iters: 2100, epoch: 1 | loss: 0.7882803
	speed: 0.0586s/iter; left time: 913.1731s
	iters: 2200, epoch: 1 | loss: 0.7012233
	speed: 0.0574s/iter; left time: 888.9825s
	iters: 2300, epoch: 1 | loss: 0.5729967
	speed: 0.0556s/iter; left time: 854.8039s
	iters: 2400, epoch: 1 | loss: 1.0919501
	speed: 0.0524s/iter; left time: 801.2032s
	iters: 2500, epoch: 1 | loss: 0.7550656
	speed: 0.0513s/iter; left time: 778.9834s
	iters: 2600, epoch: 1 | loss: 0.7579384
	speed: 0.0518s/iter; left time: 780.4643s
	iters: 2700, epoch: 1 | loss: 1.0209565
	speed: 0.0554s/iter; left time: 829.3384s
	iters: 2800, epoch: 1 | loss: 0.8763112
	speed: 0.0534s/iter; left time: 794.8406s
	iters: 2900, epoch: 1 | loss: 0.8399798
	speed: 0.0554s/iter; left time: 819.3783s
	iters: 3000, epoch: 1 | loss: 1.1923213
	speed: 0.0551s/iter; left time: 809.2554s
	iters: 3100, epoch: 1 | loss: 0.8693477
	speed: 0.0554s/iter; left time: 807.6319s
	iters: 3200, epoch: 1 | loss: 0.9116261
	speed: 0.0563s/iter; left time: 815.3938s
	iters: 3300, epoch: 1 | loss: 0.7078272
	speed: 0.0517s/iter; left time: 743.2875s
	iters: 3400, epoch: 1 | loss: 1.1115330
	speed: 0.0501s/iter; left time: 715.9227s
	iters: 3500, epoch: 1 | loss: 1.8088607
	speed: 0.0523s/iter; left time: 742.0139s
	iters: 3600, epoch: 1 | loss: 0.7049288
	speed: 0.0567s/iter; left time: 798.0908s
	iters: 3700, epoch: 1 | loss: 0.6667274
	speed: 0.0531s/iter; left time: 742.3070s
	iters: 3800, epoch: 1 | loss: 0.8448359
	speed: 0.0524s/iter; left time: 726.7127s
	iters: 3900, epoch: 1 | loss: 0.5893893
	speed: 0.0551s/iter; left time: 759.6204s
	iters: 4000, epoch: 1 | loss: 0.7919680
	speed: 0.0550s/iter; left time: 751.9540s
	iters: 4100, epoch: 1 | loss: 1.1187246
	speed: 0.0525s/iter; left time: 712.7646s
	iters: 4200, epoch: 1 | loss: 1.1846257
	speed: 0.0520s/iter; left time: 701.4246s
	iters: 4300, epoch: 1 | loss: 0.8659422
	speed: 0.0535s/iter; left time: 716.0062s
	iters: 4400, epoch: 1 | loss: 0.7580196
	speed: 0.0518s/iter; left time: 688.2407s
	iters: 4500, epoch: 1 | loss: 0.7217936
	speed: 0.0524s/iter; left time: 690.0797s
	iters: 4600, epoch: 1 | loss: 1.4340813
	speed: 0.0512s/iter; left time: 670.1476s
	iters: 4700, epoch: 1 | loss: 0.6704843
	speed: 0.0521s/iter; left time: 675.8182s
	iters: 4800, epoch: 1 | loss: 0.5187466
	speed: 0.0528s/iter; left time: 679.9035s
	iters: 4900, epoch: 1 | loss: 0.6483745
	speed: 0.0502s/iter; left time: 641.8587s
	iters: 5000, epoch: 1 | loss: 0.7394521
	speed: 0.0500s/iter; left time: 633.9404s
	iters: 5100, epoch: 1 | loss: 1.1886964
	speed: 0.0504s/iter; left time: 633.7259s
	iters: 5200, epoch: 1 | loss: 1.2245101
	speed: 0.0542s/iter; left time: 676.7053s
	iters: 5300, epoch: 1 | loss: 0.5799921
	speed: 0.0518s/iter; left time: 640.9674s
	iters: 5400, epoch: 1 | loss: 0.7040678
	speed: 0.0499s/iter; left time: 612.0760s
	iters: 5500, epoch: 1 | loss: 0.9020485
	speed: 0.0553s/iter; left time: 673.1814s
	iters: 5600, epoch: 1 | loss: 1.1704848
	speed: 0.0562s/iter; left time: 678.2909s
	iters: 5700, epoch: 1 | loss: 1.2442690
	speed: 0.0570s/iter; left time: 682.7497s
	iters: 5800, epoch: 1 | loss: 0.7921969
	speed: 0.0563s/iter; left time: 668.6739s
	iters: 5900, epoch: 1 | loss: 0.7153209
	speed: 0.0527s/iter; left time: 621.1702s
	iters: 6000, epoch: 1 | loss: 1.0796435
	speed: 0.0521s/iter; left time: 608.0962s
	iters: 6100, epoch: 1 | loss: 1.0267062
	speed: 0.0498s/iter; left time: 576.9833s
	iters: 6200, epoch: 1 | loss: 0.7799926
	speed: 0.0566s/iter; left time: 650.0243s
	iters: 6300, epoch: 1 | loss: 0.6451793
	speed: 0.0561s/iter; left time: 638.7560s
	iters: 6400, epoch: 1 | loss: 0.9364046
	speed: 0.0548s/iter; left time: 617.4255s
	iters: 6500, epoch: 1 | loss: 0.6091300
	speed: 0.0534s/iter; left time: 596.6647s
	iters: 6600, epoch: 1 | loss: 0.6614401
	speed: 0.0549s/iter; left time: 608.6215s
	iters: 6700, epoch: 1 | loss: 0.6830904
	speed: 0.0559s/iter; left time: 613.4779s
	iters: 6800, epoch: 1 | loss: 0.5593764
	speed: 0.0550s/iter; left time: 597.8025s
	iters: 6900, epoch: 1 | loss: 1.6808705
	speed: 0.0553s/iter; left time: 596.1433s
	iters: 7000, epoch: 1 | loss: 0.6384652
	speed: 0.0531s/iter; left time: 566.9877s
	iters: 7100, epoch: 1 | loss: 0.6277534
	speed: 0.0535s/iter; left time: 566.0530s
	iters: 7200, epoch: 1 | loss: 0.7414619
	speed: 0.0519s/iter; left time: 544.2711s
	iters: 7300, epoch: 1 | loss: 0.5333427
	speed: 0.0512s/iter; left time: 531.3429s
	iters: 7400, epoch: 1 | loss: 0.7627659
	speed: 0.0505s/iter; left time: 518.8414s
	iters: 7500, epoch: 1 | loss: 1.2689567
	speed: 0.0537s/iter; left time: 546.1173s
	iters: 7600, epoch: 1 | loss: 0.7500247
	speed: 0.0521s/iter; left time: 524.7693s
	iters: 7700, epoch: 1 | loss: 0.5668152
	speed: 0.0535s/iter; left time: 534.2086s
	iters: 7800, epoch: 1 | loss: 1.0421200
	speed: 0.0551s/iter; left time: 544.0567s
	iters: 7900, epoch: 1 | loss: 0.6617219
	speed: 0.0532s/iter; left time: 520.4775s
	iters: 8000, epoch: 1 | loss: 0.6126087
	speed: 0.0570s/iter; left time: 551.9562s
	iters: 8100, epoch: 1 | loss: 0.6790831
	speed: 0.0499s/iter; left time: 478.1324s
	iters: 8200, epoch: 1 | loss: 0.7507117
	speed: 0.0534s/iter; left time: 506.3886s
	iters: 8300, epoch: 1 | loss: 0.7273992
	speed: 0.0563s/iter; left time: 527.5725s
	iters: 8400, epoch: 1 | loss: 1.1395680
	speed: 0.0541s/iter; left time: 501.8601s
	iters: 8500, epoch: 1 | loss: 0.6617811
	speed: 0.0573s/iter; left time: 525.4674s
	iters: 8600, epoch: 1 | loss: 0.5857000
	speed: 0.0541s/iter; left time: 491.4388s
	iters: 8700, epoch: 1 | loss: 0.7969667
	speed: 0.0506s/iter; left time: 453.9993s
	iters: 8800, epoch: 1 | loss: 0.5350012
	speed: 0.0517s/iter; left time: 458.7443s
Epoch: 1 cost time: 475.2220685482025
Epoch: 1, Steps: 8838 | Train Loss: 0.8760044 Vali Loss: 0.8989337 Test Loss: 0.4868334
Validation loss decreased (inf --> 0.898934).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8864590
	speed: 1.1324s/iter; left time: 9895.7284s
	iters: 200, epoch: 2 | loss: 0.6174654
	speed: 0.0539s/iter; left time: 465.7457s
	iters: 300, epoch: 2 | loss: 0.6681499
	speed: 0.0526s/iter; left time: 448.9256s
	iters: 400, epoch: 2 | loss: 1.3044680
	speed: 0.0547s/iter; left time: 461.4648s
	iters: 500, epoch: 2 | loss: 0.6068698
	speed: 0.0562s/iter; left time: 468.9495s
	iters: 600, epoch: 2 | loss: 0.9094573
	speed: 0.0544s/iter; left time: 447.9930s
	iters: 700, epoch: 2 | loss: 0.4751668
	speed: 0.0506s/iter; left time: 411.8086s
	iters: 800, epoch: 2 | loss: 0.5977564
	speed: 0.0514s/iter; left time: 413.4133s
	iters: 900, epoch: 2 | loss: 0.8757382
	speed: 0.0527s/iter; left time: 418.4635s
	iters: 1000, epoch: 2 | loss: 0.6392640
	speed: 0.0526s/iter; left time: 412.6277s
	iters: 1100, epoch: 2 | loss: 0.9232939
	speed: 0.0521s/iter; left time: 403.1931s
	iters: 1200, epoch: 2 | loss: 0.8362097
	speed: 0.0541s/iter; left time: 412.9928s
	iters: 1300, epoch: 2 | loss: 1.0040544
	speed: 0.0510s/iter; left time: 384.6894s
	iters: 1400, epoch: 2 | loss: 0.9627929
	speed: 0.0525s/iter; left time: 390.7608s
	iters: 1500, epoch: 2 | loss: 0.8569227
	speed: 0.0556s/iter; left time: 407.7234s
	iters: 1600, epoch: 2 | loss: 1.4059980
	speed: 0.0554s/iter; left time: 400.9088s
	iters: 1700, epoch: 2 | loss: 0.9167919
	speed: 0.0557s/iter; left time: 397.7887s
	iters: 1800, epoch: 2 | loss: 0.6498231
	speed: 0.0596s/iter; left time: 419.8762s
	iters: 1900, epoch: 2 | loss: 0.6802032
	speed: 0.0606s/iter; left time: 420.5273s
	iters: 2000, epoch: 2 | loss: 0.8115864
	speed: 0.0546s/iter; left time: 373.1386s
	iters: 2100, epoch: 2 | loss: 0.7211467
	speed: 0.0540s/iter; left time: 363.9053s
	iters: 2200, epoch: 2 | loss: 0.7360919
	speed: 0.0522s/iter; left time: 346.3326s
	iters: 2300, epoch: 2 | loss: 1.0568024
	speed: 0.0509s/iter; left time: 332.6065s
	iters: 2400, epoch: 2 | loss: 0.9153014
	speed: 0.0516s/iter; left time: 331.9853s
	iters: 2500, epoch: 2 | loss: 0.8591607
	speed: 0.0528s/iter; left time: 334.8746s
	iters: 2600, epoch: 2 | loss: 0.6922377
	speed: 0.0553s/iter; left time: 345.1604s
	iters: 2700, epoch: 2 | loss: 1.5159169
	speed: 0.0525s/iter; left time: 322.1651s
	iters: 2800, epoch: 2 | loss: 1.1226609
	speed: 0.0530s/iter; left time: 320.0575s
	iters: 2900, epoch: 2 | loss: 0.6325955
	speed: 0.0528s/iter; left time: 313.4121s
	iters: 3000, epoch: 2 | loss: 0.7637281
	speed: 0.0525s/iter; left time: 306.3521s
	iters: 3100, epoch: 2 | loss: 1.3279674
	speed: 0.0554s/iter; left time: 317.9280s
	iters: 3200, epoch: 2 | loss: 0.6082848
	speed: 0.0554s/iter; left time: 312.3176s
	iters: 3300, epoch: 2 | loss: 0.5858146
	speed: 0.0528s/iter; left time: 292.6690s
	iters: 3400, epoch: 2 | loss: 0.9651186
	speed: 0.0528s/iter; left time: 287.4243s
	iters: 3500, epoch: 2 | loss: 0.6199865
	speed: 0.0544s/iter; left time: 290.4802s
	iters: 3600, epoch: 2 | loss: 0.9156731
	speed: 0.0552s/iter; left time: 289.4323s
	iters: 3700, epoch: 2 | loss: 0.6185195
	speed: 0.0542s/iter; left time: 278.3734s
	iters: 3800, epoch: 2 | loss: 0.6494851
	speed: 0.0555s/iter; left time: 279.5804s
	iters: 3900, epoch: 2 | loss: 0.6912388
	speed: 0.0546s/iter; left time: 269.9012s
	iters: 4000, epoch: 2 | loss: 0.5804132
	speed: 0.0566s/iter; left time: 273.7864s
	iters: 4100, epoch: 2 | loss: 0.8487524
	speed: 0.0565s/iter; left time: 267.5376s
	iters: 4200, epoch: 2 | loss: 0.6753497
	speed: 0.0546s/iter; left time: 253.1346s
	iters: 4300, epoch: 2 | loss: 1.1698883
	speed: 0.0524s/iter; left time: 237.9818s
	iters: 4400, epoch: 2 | loss: 0.8550568
	speed: 0.0533s/iter; left time: 236.6258s
	iters: 4500, epoch: 2 | loss: 0.6136488
	speed: 0.0576s/iter; left time: 249.8765s
	iters: 4600, epoch: 2 | loss: 0.6234645
	speed: 0.0539s/iter; left time: 228.4982s
	iters: 4700, epoch: 2 | loss: 1.1289816
	speed: 0.0542s/iter; left time: 224.1275s
	iters: 4800, epoch: 2 | loss: 0.9447459
	speed: 0.0518s/iter; left time: 209.0193s
	iters: 4900, epoch: 2 | loss: 0.6763796
	speed: 0.0548s/iter; left time: 216.0225s
	iters: 5000, epoch: 2 | loss: 1.1296165
	speed: 0.0518s/iter; left time: 198.6683s
	iters: 5100, epoch: 2 | loss: 0.6436066
	speed: 0.0548s/iter; left time: 204.7926s
	iters: 5200, epoch: 2 | loss: 0.6000439
	speed: 0.0515s/iter; left time: 187.4556s
	iters: 5300, epoch: 2 | loss: 0.4043705
	speed: 0.0527s/iter; left time: 186.4867s
	iters: 5400, epoch: 2 | loss: 0.9225901
	speed: 0.0566s/iter; left time: 194.7198s
	iters: 5500, epoch: 2 | loss: 0.5253270
	speed: 0.0559s/iter; left time: 186.5524s
	iters: 5600, epoch: 2 | loss: 0.6147876
	speed: 0.0553s/iter; left time: 179.0503s
	iters: 5700, epoch: 2 | loss: 0.6999574
	speed: 0.0543s/iter; left time: 170.4116s
	iters: 5800, epoch: 2 | loss: 0.7353233
	speed: 0.0560s/iter; left time: 170.2918s
	iters: 5900, epoch: 2 | loss: 0.5614308
	speed: 0.0573s/iter; left time: 168.4020s
	iters: 6000, epoch: 2 | loss: 0.7056143
	speed: 0.0558s/iter; left time: 158.4459s
	iters: 6100, epoch: 2 | loss: 0.5481067
	speed: 0.0546s/iter; left time: 149.5068s
	iters: 6200, epoch: 2 | loss: 0.7490631
	speed: 0.0508s/iter; left time: 134.1085s
	iters: 6300, epoch: 2 | loss: 1.5366766
	speed: 0.0538s/iter; left time: 136.5690s
	iters: 6400, epoch: 2 | loss: 1.3192803
	speed: 0.0551s/iter; left time: 134.3280s
	iters: 6500, epoch: 2 | loss: 0.7414206
	speed: 0.0560s/iter; left time: 131.0974s
	iters: 6600, epoch: 2 | loss: 1.3146673
	speed: 0.0558s/iter; left time: 124.9690s
	iters: 6700, epoch: 2 | loss: 0.6503440
	speed: 0.0563s/iter; left time: 120.4410s
	iters: 6800, epoch: 2 | loss: 0.5874879
	speed: 0.0562s/iter; left time: 114.6029s
	iters: 6900, epoch: 2 | loss: 0.6142215
	speed: 0.0554s/iter; left time: 107.4375s
	iters: 7000, epoch: 2 | loss: 1.5733964
	speed: 0.0539s/iter; left time: 99.1661s
	iters: 7100, epoch: 2 | loss: 0.9585866
	speed: 0.0514s/iter; left time: 89.3212s
	iters: 7200, epoch: 2 | loss: 0.8960000
	speed: 0.0569s/iter; left time: 93.2371s
	iters: 7300, epoch: 2 | loss: 0.6743402
	speed: 0.0580s/iter; left time: 89.2431s
	iters: 7400, epoch: 2 | loss: 0.4960593
	speed: 0.0562s/iter; left time: 80.8651s
	iters: 7500, epoch: 2 | loss: 1.0761591
	speed: 0.0554s/iter; left time: 74.1447s
	iters: 7600, epoch: 2 | loss: 1.0961239
	speed: 0.0554s/iter; left time: 68.6621s
	iters: 7700, epoch: 2 | loss: 0.6684000
	speed: 0.0559s/iter; left time: 63.6514s
	iters: 7800, epoch: 2 | loss: 0.6556667
	speed: 0.0555s/iter; left time: 57.6142s
	iters: 7900, epoch: 2 | loss: 0.8503883
	speed: 0.0564s/iter; left time: 52.9624s
	iters: 8000, epoch: 2 | loss: 0.5531345
	speed: 0.0528s/iter; left time: 44.3124s
	iters: 8100, epoch: 2 | loss: 0.7039185
	speed: 0.0536s/iter; left time: 39.6436s
	iters: 8200, epoch: 2 | loss: 0.6124172
	speed: 0.0556s/iter; left time: 35.5062s
	iters: 8300, epoch: 2 | loss: 0.6469390
	speed: 0.0540s/iter; left time: 29.1243s
	iters: 8400, epoch: 2 | loss: 0.5924435
	speed: 0.0548s/iter; left time: 24.0611s
	iters: 8500, epoch: 2 | loss: 0.7094957
	speed: 0.0575s/iter; left time: 19.4910s
	iters: 8600, epoch: 2 | loss: 0.8599437
	speed: 0.0590s/iter; left time: 14.1094s
	iters: 8700, epoch: 2 | loss: 0.4998673
	speed: 0.0565s/iter; left time: 7.8532s
	iters: 8800, epoch: 2 | loss: 0.5810241
	speed: 0.0537s/iter; left time: 2.0930s
Epoch: 2 cost time: 484.11156249046326
Epoch: 2, Steps: 8838 | Train Loss: 0.7812849 Vali Loss: 0.8374552 Test Loss: 0.4744705
Validation loss decreased (0.898934 --> 0.837455).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_96_1440_Autoformer_custom_ftM_sl96_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:0.4744705259799957, mae:0.46496063470840454, rse:0.9101029634475708
