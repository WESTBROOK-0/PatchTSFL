Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5377282
	speed: 0.0531s/iter; left time: 1380.5732s
	iters: 200, epoch: 1 | loss: 0.6398562
	speed: 0.0472s/iter; left time: 1223.0634s
Epoch: 1 cost time: 13.045339584350586
Epoch: 1, Steps: 261 | Train Loss: 0.6042168 Vali Loss: 0.2892537 Test Loss: 0.3928615
Validation loss decreased (inf --> 0.289254).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.5505748
	speed: 0.1332s/iter; left time: 3428.1962s
	iters: 200, epoch: 2 | loss: 0.4034794
	speed: 0.0473s/iter; left time: 1212.9933s
Epoch: 2 cost time: 12.958741188049316
Epoch: 2, Steps: 261 | Train Loss: 0.5597126 Vali Loss: 0.2796881 Test Loss: 0.3811661
Validation loss decreased (0.289254 --> 0.279688).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4760678
	speed: 0.1344s/iter; left time: 3425.3276s
	iters: 200, epoch: 3 | loss: 0.6277654
	speed: 0.0473s/iter; left time: 1200.1421s
Epoch: 3 cost time: 13.025838375091553
Epoch: 3, Steps: 261 | Train Loss: 0.5476240 Vali Loss: 0.2748709 Test Loss: 0.3743664
Validation loss decreased (0.279688 --> 0.274871).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4904532
	speed: 0.1328s/iter; left time: 3348.6845s
	iters: 200, epoch: 4 | loss: 0.5117832
	speed: 0.0473s/iter; left time: 1188.4243s
Epoch: 4 cost time: 12.93811583518982
Epoch: 4, Steps: 261 | Train Loss: 0.5395267 Vali Loss: 0.2726822 Test Loss: 0.3710700
Validation loss decreased (0.274871 --> 0.272682).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.7121564
	speed: 0.1328s/iter; left time: 3313.4228s
	iters: 200, epoch: 5 | loss: 0.5741905
	speed: 0.0475s/iter; left time: 1181.6630s
Epoch: 5 cost time: 13.045016765594482
Epoch: 5, Steps: 261 | Train Loss: 0.5335040 Vali Loss: 0.2710224 Test Loss: 0.3681567
Validation loss decreased (0.272682 --> 0.271022).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.5227281
	speed: 0.1335s/iter; left time: 3296.5659s
	iters: 200, epoch: 6 | loss: 0.5597498
	speed: 0.0473s/iter; left time: 1163.7950s
Epoch: 6 cost time: 13.016600608825684
Epoch: 6, Steps: 261 | Train Loss: 0.5286425 Vali Loss: 0.2696274 Test Loss: 0.3675512
Validation loss decreased (0.271022 --> 0.269627).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.5657138
	speed: 0.1327s/iter; left time: 3241.3547s
	iters: 200, epoch: 7 | loss: 0.6213576
	speed: 0.0474s/iter; left time: 1152.8017s
Epoch: 7 cost time: 12.985730409622192
Epoch: 7, Steps: 261 | Train Loss: 0.5247902 Vali Loss: 0.2698400 Test Loss: 0.3644957
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.4388120
	speed: 0.1320s/iter; left time: 3190.7620s
	iters: 200, epoch: 8 | loss: 0.4746029
	speed: 0.0474s/iter; left time: 1140.5581s
Epoch: 8 cost time: 12.91173267364502
Epoch: 8, Steps: 261 | Train Loss: 0.5204024 Vali Loss: 0.2707719 Test Loss: 0.3629937
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.4409414
	speed: 0.1323s/iter; left time: 3163.9884s
	iters: 200, epoch: 9 | loss: 0.5850807
	speed: 0.0474s/iter; left time: 1128.5830s
Epoch: 9 cost time: 12.92357587814331
Epoch: 9, Steps: 261 | Train Loss: 0.5139319 Vali Loss: 0.2711713 Test Loss: 0.3614783
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.4547295
	speed: 0.1310s/iter; left time: 3099.2243s
	iters: 200, epoch: 10 | loss: 0.5160986
	speed: 0.0473s/iter; left time: 1114.9181s
Epoch: 10 cost time: 12.921670198440552
Epoch: 10, Steps: 261 | Train Loss: 0.5070626 Vali Loss: 0.2723577 Test Loss: 0.3596678
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.5475608
	speed: 0.1330s/iter; left time: 3110.8000s
	iters: 200, epoch: 11 | loss: 0.5450771
	speed: 0.0474s/iter; left time: 1103.8276s
Epoch: 11 cost time: 13.048384666442871
Epoch: 11, Steps: 261 | Train Loss: 0.4996302 Vali Loss: 0.2749820 Test Loss: 0.3556621
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.4844147
	speed: 0.1331s/iter; left time: 3078.1196s
	iters: 200, epoch: 12 | loss: 0.6256532
	speed: 0.0473s/iter; left time: 1089.6574s
Epoch: 12 cost time: 12.919843435287476
Epoch: 12, Steps: 261 | Train Loss: 0.4942643 Vali Loss: 0.2759030 Test Loss: 0.3579476
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.3972290
	speed: 0.1335s/iter; left time: 3052.3776s
	iters: 200, epoch: 13 | loss: 0.4961376
	speed: 0.0473s/iter; left time: 1077.7429s
Epoch: 13 cost time: 12.961205244064331
Epoch: 13, Steps: 261 | Train Loss: 0.4858092 Vali Loss: 0.2814233 Test Loss: 0.3564770
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.4390980
	speed: 0.1335s/iter; left time: 3017.0685s
	iters: 200, epoch: 14 | loss: 0.7060769
	speed: 0.0473s/iter; left time: 1065.3279s
Epoch: 14 cost time: 13.017213106155396
Epoch: 14, Steps: 261 | Train Loss: 0.4761027 Vali Loss: 0.2805220 Test Loss: 0.3635636
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.5219356
	speed: 0.1317s/iter; left time: 2943.5073s
	iters: 200, epoch: 15 | loss: 0.5492163
	speed: 0.0474s/iter; left time: 1053.7095s
Epoch: 15 cost time: 12.955317974090576
Epoch: 15, Steps: 261 | Train Loss: 0.4651830 Vali Loss: 0.2869430 Test Loss: 0.3650707
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.4179727
	speed: 0.1327s/iter; left time: 2930.1634s
	iters: 200, epoch: 16 | loss: 0.4893130
	speed: 0.0474s/iter; left time: 1041.8154s
Epoch: 16 cost time: 12.95480489730835
Epoch: 16, Steps: 261 | Train Loss: 0.4557540 Vali Loss: 0.2895694 Test Loss: 0.3734706
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.3314159
	speed: 0.1319s/iter; left time: 2878.9799s
	iters: 200, epoch: 17 | loss: 0.5253974
	speed: 0.0475s/iter; left time: 1031.4976s
Epoch: 17 cost time: 12.921961545944214
Epoch: 17, Steps: 261 | Train Loss: 0.4479582 Vali Loss: 0.2910948 Test Loss: 0.3777110
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.4081996
	speed: 0.1340s/iter; left time: 2890.4466s
	iters: 200, epoch: 18 | loss: 0.5071346
	speed: 0.0475s/iter; left time: 1018.5859s
Epoch: 18 cost time: 12.994566202163696
Epoch: 18, Steps: 261 | Train Loss: 0.4405775 Vali Loss: 0.2948649 Test Loss: 0.3826719
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.4348124
	speed: 0.1309s/iter; left time: 2789.0988s
	iters: 200, epoch: 19 | loss: 0.4648211
	speed: 0.0474s/iter; left time: 1004.4009s
Epoch: 19 cost time: 12.906675577163696
Epoch: 19, Steps: 261 | Train Loss: 0.4349545 Vali Loss: 0.2980795 Test Loss: 0.3840192
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.4858026
	speed: 0.1346s/iter; left time: 2831.8513s
	iters: 200, epoch: 20 | loss: 0.3874288
	speed: 0.0473s/iter; left time: 990.3805s
Epoch: 20 cost time: 13.189725875854492
Epoch: 20, Steps: 261 | Train Loss: 0.4286958 Vali Loss: 0.3003699 Test Loss: 0.3893801
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.4813207
	speed: 0.1348s/iter; left time: 2801.1511s
	iters: 200, epoch: 21 | loss: 0.4335900
	speed: 0.0473s/iter; left time: 979.0729s
Epoch: 21 cost time: 12.971367120742798
Epoch: 21, Steps: 261 | Train Loss: 0.4221866 Vali Loss: 0.3001782 Test Loss: 0.3965085
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3632382
	speed: 0.1331s/iter; left time: 2731.0887s
	iters: 200, epoch: 22 | loss: 0.4600524
	speed: 0.0473s/iter; left time: 966.3305s
Epoch: 22 cost time: 13.009942293167114
Epoch: 22, Steps: 261 | Train Loss: 0.4166617 Vali Loss: 0.2998543 Test Loss: 0.3894619
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.4388744
	speed: 0.1330s/iter; left time: 2693.7169s
	iters: 200, epoch: 23 | loss: 0.4908626
	speed: 0.0474s/iter; left time: 954.9043s
Epoch: 23 cost time: 12.964067220687866
Epoch: 23, Steps: 261 | Train Loss: 0.4122619 Vali Loss: 0.3042378 Test Loss: 0.3905673
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3986472
	speed: 0.1348s/iter; left time: 2694.8051s
	iters: 200, epoch: 24 | loss: 0.3715090
	speed: 0.0474s/iter; left time: 942.6972s
Epoch: 24 cost time: 13.067827224731445
Epoch: 24, Steps: 261 | Train Loss: 0.4058206 Vali Loss: 0.3034717 Test Loss: 0.3867604
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3183916
	speed: 0.1326s/iter; left time: 2617.6424s
	iters: 200, epoch: 25 | loss: 0.3856784
	speed: 0.0473s/iter; left time: 929.3768s
Epoch: 25 cost time: 12.989521980285645
Epoch: 25, Steps: 261 | Train Loss: 0.4006003 Vali Loss: 0.3070950 Test Loss: 0.3867618
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.3817948
	speed: 0.1326s/iter; left time: 2581.8840s
	iters: 200, epoch: 26 | loss: 0.5028610
	speed: 0.0475s/iter; left time: 919.5398s
Epoch: 26 cost time: 12.991724729537964
Epoch: 26, Steps: 261 | Train Loss: 0.3952426 Vali Loss: 0.2993380 Test Loss: 0.3936779
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.367551326751709, mae:0.38490915298461914, rse:0.4867534041404724
