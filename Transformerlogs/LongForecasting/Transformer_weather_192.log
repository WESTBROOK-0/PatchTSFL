Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Transformer', model_id='weather_96_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_192_Transformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6087108
	speed: 0.0511s/iter; left time: 923.1946s
	iters: 200, epoch: 1 | loss: 0.5494732
	speed: 0.0274s/iter; left time: 492.2158s
	iters: 300, epoch: 1 | loss: 0.7121489
	speed: 0.0265s/iter; left time: 474.1964s
	iters: 400, epoch: 1 | loss: 0.5101728
	speed: 0.0302s/iter; left time: 537.4574s
	iters: 500, epoch: 1 | loss: 0.6699432
	speed: 0.0281s/iter; left time: 497.5742s
	iters: 600, epoch: 1 | loss: 0.5895799
	speed: 0.0308s/iter; left time: 541.1245s
	iters: 700, epoch: 1 | loss: 0.3871571
	speed: 0.0315s/iter; left time: 550.7800s
	iters: 800, epoch: 1 | loss: 0.6275529
	speed: 0.0302s/iter; left time: 525.6429s
	iters: 900, epoch: 1 | loss: 0.7004598
	speed: 0.0314s/iter; left time: 542.4896s
	iters: 1000, epoch: 1 | loss: 0.3975025
	speed: 0.0302s/iter; left time: 518.9979s
	iters: 1100, epoch: 1 | loss: 0.8035520
	speed: 0.0286s/iter; left time: 488.8022s
	iters: 1200, epoch: 1 | loss: 1.0399204
	speed: 0.0283s/iter; left time: 481.1727s
	iters: 1300, epoch: 1 | loss: 0.4674261
	speed: 0.0269s/iter; left time: 454.6301s
	iters: 1400, epoch: 1 | loss: 4.3858023
	speed: 0.0260s/iter; left time: 436.6121s
	iters: 1500, epoch: 1 | loss: 0.7336343
	speed: 0.0264s/iter; left time: 440.3246s
	iters: 1600, epoch: 1 | loss: 0.3238329
	speed: 0.0270s/iter; left time: 448.1824s
	iters: 1700, epoch: 1 | loss: 0.5006205
	speed: 0.0266s/iter; left time: 437.6850s
	iters: 1800, epoch: 1 | loss: 0.3875131
	speed: 0.0259s/iter; left time: 423.6414s
	iters: 1900, epoch: 1 | loss: 0.5103672
	speed: 0.0265s/iter; left time: 432.2346s
	iters: 2000, epoch: 1 | loss: 0.3259675
	speed: 0.0277s/iter; left time: 448.2535s
	iters: 2100, epoch: 1 | loss: 0.4597485
	speed: 0.0284s/iter; left time: 457.3236s
	iters: 2200, epoch: 1 | loss: 0.7261809
	speed: 0.0267s/iter; left time: 426.4041s
	iters: 2300, epoch: 1 | loss: 4.1523895
	speed: 0.0265s/iter; left time: 421.1480s
	iters: 2400, epoch: 1 | loss: 0.3458376
	speed: 0.0296s/iter; left time: 466.6781s
	iters: 2500, epoch: 1 | loss: 0.4530173
	speed: 0.0280s/iter; left time: 438.3806s
	iters: 2600, epoch: 1 | loss: 0.3629396
	speed: 0.0313s/iter; left time: 488.1919s
	iters: 2700, epoch: 1 | loss: 0.5586187
	speed: 0.0300s/iter; left time: 464.5250s
	iters: 2800, epoch: 1 | loss: 0.4714409
	speed: 0.0327s/iter; left time: 502.8774s
	iters: 2900, epoch: 1 | loss: 0.4942725
	speed: 0.0311s/iter; left time: 475.2147s
	iters: 3000, epoch: 1 | loss: 0.6456379
	speed: 0.0268s/iter; left time: 407.6023s
	iters: 3100, epoch: 1 | loss: 0.4771662
	speed: 0.0268s/iter; left time: 404.2772s
	iters: 3200, epoch: 1 | loss: 0.4992866
	speed: 0.0258s/iter; left time: 386.0147s
	iters: 3300, epoch: 1 | loss: 0.3386160
	speed: 0.0256s/iter; left time: 380.4406s
	iters: 3400, epoch: 1 | loss: 0.3303260
	speed: 0.0271s/iter; left time: 400.8284s
	iters: 3500, epoch: 1 | loss: 0.3789897
	speed: 0.0286s/iter; left time: 420.4190s
	iters: 3600, epoch: 1 | loss: 0.4234348
	speed: 0.0264s/iter; left time: 384.2510s
	iters: 3700, epoch: 1 | loss: 0.3877044
	speed: 0.0281s/iter; left time: 407.3835s
	iters: 3800, epoch: 1 | loss: 0.3474207
	speed: 0.0280s/iter; left time: 401.9811s
	iters: 3900, epoch: 1 | loss: 0.4769984
	speed: 0.0252s/iter; left time: 360.5138s
	iters: 4000, epoch: 1 | loss: 0.5935009
	speed: 0.0254s/iter; left time: 359.7866s
	iters: 4100, epoch: 1 | loss: 0.2110494
	speed: 0.0262s/iter; left time: 368.7716s
	iters: 4200, epoch: 1 | loss: 1.0105151
	speed: 0.0243s/iter; left time: 339.8845s
	iters: 4300, epoch: 1 | loss: 0.4964615
	speed: 0.0247s/iter; left time: 342.6469s
	iters: 4400, epoch: 1 | loss: 0.5400997
	speed: 0.0269s/iter; left time: 371.2104s
	iters: 4500, epoch: 1 | loss: 0.3106587
	speed: 0.0275s/iter; left time: 376.0311s
	iters: 4600, epoch: 1 | loss: 0.3250243
	speed: 0.0306s/iter; left time: 415.4693s
	iters: 4700, epoch: 1 | loss: 0.6137639
	speed: 0.0301s/iter; left time: 405.7502s
	iters: 4800, epoch: 1 | loss: 0.1819790
	speed: 0.0282s/iter; left time: 376.9475s
	iters: 4900, epoch: 1 | loss: 0.2941537
	speed: 0.0283s/iter; left time: 375.4772s
	iters: 5000, epoch: 1 | loss: 0.3524953
	speed: 0.0290s/iter; left time: 382.2419s
	iters: 5100, epoch: 1 | loss: 0.3825559
	speed: 0.0290s/iter; left time: 378.8652s
	iters: 5200, epoch: 1 | loss: 0.4759682
	speed: 0.0258s/iter; left time: 335.4048s
	iters: 5300, epoch: 1 | loss: 0.3704810
	speed: 0.0255s/iter; left time: 328.5175s
	iters: 5400, epoch: 1 | loss: 0.2806362
	speed: 0.0251s/iter; left time: 320.4458s
	iters: 5500, epoch: 1 | loss: 0.1650369
	speed: 0.0250s/iter; left time: 317.3662s
	iters: 5600, epoch: 1 | loss: 0.6252548
	speed: 0.0270s/iter; left time: 339.7486s
	iters: 5700, epoch: 1 | loss: 0.2558969
	speed: 0.0283s/iter; left time: 352.9346s
	iters: 5800, epoch: 1 | loss: 0.1454845
	speed: 0.0270s/iter; left time: 333.8637s
	iters: 5900, epoch: 1 | loss: 0.2143520
	speed: 0.0263s/iter; left time: 322.5105s
	iters: 6000, epoch: 1 | loss: 0.9992743
	speed: 0.0273s/iter; left time: 332.5931s
	iters: 6100, epoch: 1 | loss: 0.3089431
	speed: 0.0293s/iter; left time: 354.3473s
	iters: 6200, epoch: 1 | loss: 0.2900153
	speed: 0.0264s/iter; left time: 315.9387s
	iters: 6300, epoch: 1 | loss: 0.6420351
	speed: 0.0281s/iter; left time: 334.0130s
	iters: 6400, epoch: 1 | loss: 0.3768232
	speed: 0.0292s/iter; left time: 343.9020s
	iters: 6500, epoch: 1 | loss: 0.1889810
	speed: 0.0294s/iter; left time: 343.8905s
	iters: 6600, epoch: 1 | loss: 0.2695220
	speed: 0.0302s/iter; left time: 349.9308s
	iters: 6700, epoch: 1 | loss: 0.2440888
	speed: 0.0313s/iter; left time: 358.9141s
	iters: 6800, epoch: 1 | loss: 0.2001919
	speed: 0.0316s/iter; left time: 359.4373s
	iters: 6900, epoch: 1 | loss: 0.8613088
	speed: 0.0301s/iter; left time: 340.0852s
	iters: 7000, epoch: 1 | loss: 0.1934857
	speed: 0.0294s/iter; left time: 329.1616s
	iters: 7100, epoch: 1 | loss: 0.1907331
	speed: 0.0305s/iter; left time: 338.0080s
	iters: 7200, epoch: 1 | loss: 0.3833131
	speed: 0.0312s/iter; left time: 342.9357s
	iters: 7300, epoch: 1 | loss: 0.2433967
	speed: 0.0295s/iter; left time: 320.6828s
	iters: 7400, epoch: 1 | loss: 0.3791892
	speed: 0.0262s/iter; left time: 282.3502s
	iters: 7500, epoch: 1 | loss: 0.3518512
	speed: 0.0261s/iter; left time: 278.4968s
	iters: 7600, epoch: 1 | loss: 0.3398373
	speed: 0.0256s/iter; left time: 271.3836s
	iters: 7700, epoch: 1 | loss: 0.2043207
	speed: 0.0281s/iter; left time: 294.2500s
	iters: 7800, epoch: 1 | loss: 0.2359447
	speed: 0.0273s/iter; left time: 283.2757s
	iters: 7900, epoch: 1 | loss: 0.3175521
	speed: 0.0275s/iter; left time: 282.7983s
	iters: 8000, epoch: 1 | loss: 0.2716841
	speed: 0.0276s/iter; left time: 280.6175s
	iters: 8100, epoch: 1 | loss: 2.7574561
	speed: 0.0284s/iter; left time: 285.9862s
	iters: 8200, epoch: 1 | loss: 0.3917511
	speed: 0.0264s/iter; left time: 263.5238s
	iters: 8300, epoch: 1 | loss: 0.1603238
	speed: 0.0293s/iter; left time: 289.9375s
	iters: 8400, epoch: 1 | loss: 0.2227200
	speed: 0.0290s/iter; left time: 284.0349s
	iters: 8500, epoch: 1 | loss: 0.2581913
	speed: 0.0296s/iter; left time: 286.3272s
	iters: 8600, epoch: 1 | loss: 0.7361782
	speed: 0.0319s/iter; left time: 305.4701s
	iters: 8700, epoch: 1 | loss: 0.2966365
	speed: 0.0320s/iter; left time: 303.2387s
	iters: 8800, epoch: 1 | loss: 0.1653896
	speed: 0.0308s/iter; left time: 289.3662s
	iters: 8900, epoch: 1 | loss: 0.2069615
	speed: 0.0282s/iter; left time: 261.5970s
	iters: 9000, epoch: 1 | loss: 0.3027720
	speed: 0.0289s/iter; left time: 265.7548s
Epoch: 1 cost time: 258.34838128089905
Epoch: 1, Steps: 9090 | Train Loss: 0.4944133 Vali Loss: 0.5334853 Test Loss: 0.3124095
Validation loss decreased (inf --> 0.533485).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7706188
	speed: 0.4174s/iter; left time: 3753.1093s
	iters: 200, epoch: 2 | loss: 0.7984151
	speed: 0.0316s/iter; left time: 280.6642s
	iters: 300, epoch: 2 | loss: 0.3298970
	speed: 0.0323s/iter; left time: 284.0740s
	iters: 400, epoch: 2 | loss: 0.1982707
	speed: 0.0295s/iter; left time: 256.2142s
	iters: 500, epoch: 2 | loss: 0.3932136
	speed: 0.0294s/iter; left time: 252.5556s
	iters: 600, epoch: 2 | loss: 0.3321846
	speed: 0.0281s/iter; left time: 238.8534s
	iters: 700, epoch: 2 | loss: 0.2297054
	speed: 0.0278s/iter; left time: 233.0950s
	iters: 800, epoch: 2 | loss: 0.3766226
	speed: 0.0279s/iter; left time: 231.2253s
	iters: 900, epoch: 2 | loss: 0.2478952
	speed: 0.0287s/iter; left time: 235.0851s
	iters: 1000, epoch: 2 | loss: 0.1733318
	speed: 0.0270s/iter; left time: 218.1761s
	iters: 1100, epoch: 2 | loss: 0.2428136
	speed: 0.0272s/iter; left time: 217.6874s
	iters: 1200, epoch: 2 | loss: 0.1369545
	speed: 0.0263s/iter; left time: 207.8664s
	iters: 1300, epoch: 2 | loss: 0.2632861
	speed: 0.0258s/iter; left time: 200.6209s
	iters: 1400, epoch: 2 | loss: 0.2234888
	speed: 0.0260s/iter; left time: 200.0367s
	iters: 1500, epoch: 2 | loss: 0.2291719
	speed: 0.0273s/iter; left time: 207.6014s
	iters: 1600, epoch: 2 | loss: 0.2959846
	speed: 0.0290s/iter; left time: 217.5486s
	iters: 1700, epoch: 2 | loss: 0.1797289
	speed: 0.0271s/iter; left time: 200.4716s
	iters: 1800, epoch: 2 | loss: 0.2435479
	speed: 0.0262s/iter; left time: 191.3664s
	iters: 1900, epoch: 2 | loss: 0.1889245
	speed: 0.0298s/iter; left time: 213.9535s
	iters: 2000, epoch: 2 | loss: 0.2860066
	speed: 0.0298s/iter; left time: 211.3015s
	iters: 2100, epoch: 2 | loss: 0.2087635
	speed: 0.0301s/iter; left time: 210.2706s
	iters: 2200, epoch: 2 | loss: 0.1487492
	speed: 0.0315s/iter; left time: 216.9856s
	iters: 2300, epoch: 2 | loss: 0.2188252
	speed: 0.0329s/iter; left time: 223.1589s
	iters: 2400, epoch: 2 | loss: 0.2308139
	speed: 0.0312s/iter; left time: 208.9139s
	iters: 2500, epoch: 2 | loss: 0.1769948
	speed: 0.0276s/iter; left time: 181.7158s
	iters: 2600, epoch: 2 | loss: 0.4190806
	speed: 0.0292s/iter; left time: 189.6629s
	iters: 2700, epoch: 2 | loss: 0.1047258
	speed: 0.0269s/iter; left time: 172.0279s
	iters: 2800, epoch: 2 | loss: 0.3933341
	speed: 0.0270s/iter; left time: 170.1088s
	iters: 2900, epoch: 2 | loss: 0.1607483
	speed: 0.0270s/iter; left time: 166.9508s
	iters: 3000, epoch: 2 | loss: 0.8202475
	speed: 0.0256s/iter; left time: 156.1411s
	iters: 3100, epoch: 2 | loss: 0.1515453
	speed: 0.0262s/iter; left time: 156.9785s
	iters: 3200, epoch: 2 | loss: 0.2216001
	speed: 0.0265s/iter; left time: 156.1167s
	iters: 3300, epoch: 2 | loss: 0.1933197
	speed: 0.0259s/iter; left time: 149.9758s
	iters: 3400, epoch: 2 | loss: 0.1468233
	speed: 0.0264s/iter; left time: 150.3385s
	iters: 3500, epoch: 2 | loss: 0.3027239
	speed: 0.0278s/iter; left time: 155.5455s
	iters: 3600, epoch: 2 | loss: 0.1691199
	speed: 0.0284s/iter; left time: 156.1205s
	iters: 3700, epoch: 2 | loss: 0.5047920
	speed: 0.0257s/iter; left time: 138.7267s
	iters: 3800, epoch: 2 | loss: 0.1958376
	speed: 0.0269s/iter; left time: 142.2028s
	iters: 3900, epoch: 2 | loss: 0.2788549
	speed: 0.0295s/iter; left time: 153.1670s
	iters: 4000, epoch: 2 | loss: 0.1956110
	speed: 0.0274s/iter; left time: 139.6803s
	iters: 4100, epoch: 2 | loss: 0.1869694
	speed: 0.0274s/iter; left time: 136.6911s
	iters: 4200, epoch: 2 | loss: 0.1534521
	speed: 0.0272s/iter; left time: 133.1875s
	iters: 4300, epoch: 2 | loss: 3.5257678
	speed: 0.0302s/iter; left time: 144.8313s
	iters: 4400, epoch: 2 | loss: 0.0971028
	speed: 0.0270s/iter; left time: 126.6268s
	iters: 4500, epoch: 2 | loss: 0.7403227
	speed: 0.0263s/iter; left time: 120.9332s
	iters: 4600, epoch: 2 | loss: 0.2144426
	speed: 0.0248s/iter; left time: 111.5841s
	iters: 4700, epoch: 2 | loss: 0.2143773
	speed: 0.0273s/iter; left time: 119.8610s
	iters: 4800, epoch: 2 | loss: 0.1190050
	speed: 0.0261s/iter; left time: 112.0696s
	iters: 4900, epoch: 2 | loss: 0.3360538
	speed: 0.0250s/iter; left time: 104.6258s
	iters: 5000, epoch: 2 | loss: 0.2458306
	speed: 0.0251s/iter; left time: 102.5673s
	iters: 5100, epoch: 2 | loss: 0.7726634
	speed: 0.0248s/iter; left time: 98.9435s
	iters: 5200, epoch: 2 | loss: 0.2347404
	speed: 0.0252s/iter; left time: 97.8626s
	iters: 5300, epoch: 2 | loss: 0.0810818
	speed: 0.0252s/iter; left time: 95.3970s
	iters: 5400, epoch: 2 | loss: 0.2661298
	speed: 0.0282s/iter; left time: 104.1116s
	iters: 5500, epoch: 2 | loss: 0.1775716
	speed: 0.0248s/iter; left time: 89.0981s
	iters: 5600, epoch: 2 | loss: 0.1209943
	speed: 0.0266s/iter; left time: 92.8269s
	iters: 5700, epoch: 2 | loss: 0.2488681
	speed: 0.0262s/iter; left time: 88.8760s
	iters: 5800, epoch: 2 | loss: 3.2230420
	speed: 0.0247s/iter; left time: 81.1978s
	iters: 5900, epoch: 2 | loss: 0.0874180
	speed: 0.0265s/iter; left time: 84.5421s
	iters: 6000, epoch: 2 | loss: 0.4095080
	speed: 0.0276s/iter; left time: 85.4115s
	iters: 6100, epoch: 2 | loss: 0.1354377
	speed: 0.0256s/iter; left time: 76.6827s
	iters: 6200, epoch: 2 | loss: 0.1523960
	speed: 0.0293s/iter; left time: 84.6382s
	iters: 6300, epoch: 2 | loss: 0.1779578
	speed: 0.0278s/iter; left time: 77.6079s
	iters: 6400, epoch: 2 | loss: 0.2375887
	speed: 0.0315s/iter; left time: 84.6495s
	iters: 6500, epoch: 2 | loss: 0.1575167
	speed: 0.0288s/iter; left time: 74.6211s
	iters: 6600, epoch: 2 | loss: 0.1388033
	speed: 0.0296s/iter; left time: 73.6856s
	iters: 6700, epoch: 2 | loss: 0.1322381
	speed: 0.0295s/iter; left time: 70.6164s
	iters: 6800, epoch: 2 | loss: 0.4132388
	speed: 0.0287s/iter; left time: 65.7524s
	iters: 6900, epoch: 2 | loss: 0.2255747
	speed: 0.0266s/iter; left time: 58.3274s
	iters: 7000, epoch: 2 | loss: 0.1098422
	speed: 0.0253s/iter; left time: 52.8470s
	iters: 7100, epoch: 2 | loss: 0.1606138
	speed: 0.0264s/iter; left time: 52.5417s
	iters: 7200, epoch: 2 | loss: 0.2059316
	speed: 0.0279s/iter; left time: 52.7027s
	iters: 7300, epoch: 2 | loss: 0.1453061
	speed: 0.0266s/iter; left time: 47.6675s
	iters: 7400, epoch: 2 | loss: 0.3012253
	speed: 0.0252s/iter; left time: 42.5865s
	iters: 7500, epoch: 2 | loss: 0.2686227
	speed: 0.0277s/iter; left time: 44.0205s
	iters: 7600, epoch: 2 | loss: 0.1237553
	speed: 0.0289s/iter; left time: 43.1369s
	iters: 7700, epoch: 2 | loss: 0.1273971
	speed: 0.0273s/iter; left time: 37.9283s
	iters: 7800, epoch: 2 | loss: 0.0929707
	speed: 0.0271s/iter; left time: 34.9387s
	iters: 7900, epoch: 2 | loss: 0.1552622
	speed: 0.0296s/iter; left time: 35.2983s
	iters: 8000, epoch: 2 | loss: 0.3286231
	speed: 0.0291s/iter; left time: 31.7219s
	iters: 8100, epoch: 2 | loss: 0.0909727
	speed: 0.0295s/iter; left time: 29.1869s
	iters: 8200, epoch: 2 | loss: 0.2210540
	speed: 0.0312s/iter; left time: 27.8015s
	iters: 8300, epoch: 2 | loss: 0.1023448
	speed: 0.0316s/iter; left time: 25.0306s
	iters: 8400, epoch: 2 | loss: 0.1739346
	speed: 0.0307s/iter; left time: 21.1981s
	iters: 8500, epoch: 2 | loss: 0.2130700
	speed: 0.0281s/iter; left time: 16.5802s
	iters: 8600, epoch: 2 | loss: 0.1497841
	speed: 0.0279s/iter; left time: 13.7111s
	iters: 8700, epoch: 2 | loss: 0.1707522
	speed: 0.0273s/iter; left time: 10.6924s
	iters: 8800, epoch: 2 | loss: 0.7052146
	speed: 0.0274s/iter; left time: 7.9719s
	iters: 8900, epoch: 2 | loss: 0.1200180
	speed: 0.0266s/iter; left time: 5.0806s
	iters: 9000, epoch: 2 | loss: 0.2577773
	speed: 0.0265s/iter; left time: 2.4117s
Epoch: 2 cost time: 254.64775443077087
Epoch: 2, Steps: 9090 | Train Loss: 0.2997110 Vali Loss: 0.6234046 Test Loss: 0.4945962
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_96_192_Transformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.3124091327190399, mae:0.3940120041370392, rse:0.7357495427131653
