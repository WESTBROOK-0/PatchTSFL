Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='custom', data_path='national_illness.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0025, loss='mse', lradj='constant', model='PatchTSFL', model_id='104_24', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=24, patience=100, pct_start=0.3, pred_len=24, random_seed=2021, revin=1, root_path='./dataset/', seq_len=104, stride=2, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 104_24_PatchTSFL_custom_ftM_sl104_ll48_pl24_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 549
val 74
test 170
Epoch: 1 cost time: 1.9218354225158691
Epoch: 1, Steps: 34 | Train Loss: 0.8579355 Vali Loss: 0.7529216 Test Loss: 4.2065444
Validation loss decreased (inf --> 0.752922).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 1.450364589691162
Epoch: 2, Steps: 34 | Train Loss: 0.8582668 Vali Loss: 0.7190597 Test Loss: 4.1871185
Validation loss decreased (0.752922 --> 0.719060).  Saving model ...
Updating learning rate to 0.0025
Epoch: 3 cost time: 2.014728546142578
Epoch: 3, Steps: 34 | Train Loss: 0.8547125 Vali Loss: 0.7362637 Test Loss: 4.1711488
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 4 cost time: 1.4692022800445557
Epoch: 4, Steps: 34 | Train Loss: 0.8544819 Vali Loss: 0.7527490 Test Loss: 4.1622391
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 5 cost time: 1.4160175323486328
Epoch: 5, Steps: 34 | Train Loss: 0.8538258 Vali Loss: 0.7379681 Test Loss: 4.1573887
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 6 cost time: 1.8717172145843506
Epoch: 6, Steps: 34 | Train Loss: 0.8546783 Vali Loss: 0.7215771 Test Loss: 4.1543999
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 7 cost time: 1.4432427883148193
Epoch: 7, Steps: 34 | Train Loss: 0.8536492 Vali Loss: 0.7205505 Test Loss: 4.1532640
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 8 cost time: 1.9588241577148438
Epoch: 8, Steps: 34 | Train Loss: 0.8557865 Vali Loss: 0.7083931 Test Loss: 4.1494236
Validation loss decreased (0.719060 --> 0.708393).  Saving model ...
Updating learning rate to 0.0025
Epoch: 9 cost time: 1.9422087669372559
Epoch: 9, Steps: 34 | Train Loss: 0.8534370 Vali Loss: 0.7437226 Test Loss: 4.1484480
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 10 cost time: 1.745650291442871
Epoch: 10, Steps: 34 | Train Loss: 0.8558890 Vali Loss: 0.7511252 Test Loss: 4.1499314
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 11 cost time: 1.8850200176239014
Epoch: 11, Steps: 34 | Train Loss: 0.8449578 Vali Loss: 0.7176198 Test Loss: 4.1484957
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 12 cost time: 1.7993566989898682
Epoch: 12, Steps: 34 | Train Loss: 0.8535244 Vali Loss: 0.7307039 Test Loss: 4.1488776
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 13 cost time: 1.7379028797149658
Epoch: 13, Steps: 34 | Train Loss: 0.8446920 Vali Loss: 0.6931806 Test Loss: 4.1496029
Validation loss decreased (0.708393 --> 0.693181).  Saving model ...
Updating learning rate to 0.0025
Epoch: 14 cost time: 1.6088547706604004
Epoch: 14, Steps: 34 | Train Loss: 0.8539816 Vali Loss: 0.7292992 Test Loss: 4.1473341
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 15 cost time: 1.6986775398254395
Epoch: 15, Steps: 34 | Train Loss: 0.8538138 Vali Loss: 0.7382498 Test Loss: 4.1495042
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 16 cost time: 1.5970847606658936
Epoch: 16, Steps: 34 | Train Loss: 0.8511804 Vali Loss: 0.6793253 Test Loss: 4.1478996
Validation loss decreased (0.693181 --> 0.679325).  Saving model ...
Updating learning rate to 0.0025
Epoch: 17 cost time: 1.6332998275756836
Epoch: 17, Steps: 34 | Train Loss: 0.8530938 Vali Loss: 0.7296378 Test Loss: 4.1490159
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 18 cost time: 1.7091941833496094
Epoch: 18, Steps: 34 | Train Loss: 0.8551951 Vali Loss: 0.6803496 Test Loss: 4.1488061
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 19 cost time: 1.7301251888275146
Epoch: 19, Steps: 34 | Train Loss: 0.8532299 Vali Loss: 0.6861411 Test Loss: 4.1476927
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 20 cost time: 1.590949535369873
Epoch: 20, Steps: 34 | Train Loss: 0.8514262 Vali Loss: 0.7237548 Test Loss: 4.1491952
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 21 cost time: 1.7684645652770996
Epoch: 21, Steps: 34 | Train Loss: 0.8541361 Vali Loss: 0.7023066 Test Loss: 4.1479387
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 22 cost time: 1.7440223693847656
Epoch: 22, Steps: 34 | Train Loss: 0.8536661 Vali Loss: 0.7272526 Test Loss: 4.1477113
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 23 cost time: 1.655402660369873
Epoch: 23, Steps: 34 | Train Loss: 0.8496453 Vali Loss: 0.7187044 Test Loss: 4.1485348
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 24 cost time: 1.843263864517212
Epoch: 24, Steps: 34 | Train Loss: 0.8544452 Vali Loss: 0.6812646 Test Loss: 4.1524830
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 25 cost time: 1.7754766941070557
Epoch: 25, Steps: 34 | Train Loss: 0.8451681 Vali Loss: 0.7023637 Test Loss: 4.1493564
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
Epoch: 26 cost time: 1.6209542751312256
Epoch: 26, Steps: 34 | Train Loss: 0.8544002 Vali Loss: 0.7211150 Test Loss: 4.1470342
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.0025
Epoch: 27 cost time: 1.7994906902313232
Epoch: 27, Steps: 34 | Train Loss: 0.8549324 Vali Loss: 0.7043321 Test Loss: 4.1478014
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.0025
Epoch: 28 cost time: 1.679905891418457
Epoch: 28, Steps: 34 | Train Loss: 0.8547709 Vali Loss: 0.7317799 Test Loss: 4.1485839
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.0025
Epoch: 29 cost time: 1.6254658699035645
Epoch: 29, Steps: 34 | Train Loss: 0.8499187 Vali Loss: 0.7087798 Test Loss: 4.1490507
EarlyStopping counter: 13 out of 100
Updating learning rate to 0.0025
Epoch: 30 cost time: 1.6290206909179688
Epoch: 30, Steps: 34 | Train Loss: 0.8548521 Vali Loss: 0.7263653 Test Loss: 4.1485949
EarlyStopping counter: 14 out of 100
Updating learning rate to 0.0025
Epoch: 31 cost time: 1.6626815795898438
Epoch: 31, Steps: 34 | Train Loss: 0.8434746 Vali Loss: 0.7333723 Test Loss: 4.1508141
EarlyStopping counter: 15 out of 100
Updating learning rate to 0.0025
Epoch: 32 cost time: 1.7108869552612305
Epoch: 32, Steps: 34 | Train Loss: 0.8448552 Vali Loss: 0.7306193 Test Loss: 4.1495490
EarlyStopping counter: 16 out of 100
Updating learning rate to 0.0025
Epoch: 33 cost time: 1.7331068515777588
Epoch: 33, Steps: 34 | Train Loss: 0.8510973 Vali Loss: 0.6940215 Test Loss: 4.1496296
EarlyStopping counter: 17 out of 100
Updating learning rate to 0.0025
Epoch: 34 cost time: 1.7314329147338867
Epoch: 34, Steps: 34 | Train Loss: 0.8543258 Vali Loss: 0.7323346 Test Loss: 4.1491752
EarlyStopping counter: 18 out of 100
Updating learning rate to 0.0025
Epoch: 35 cost time: 1.7602386474609375
Epoch: 35, Steps: 34 | Train Loss: 0.8547726 Vali Loss: 0.7064978 Test Loss: 4.1489658
EarlyStopping counter: 19 out of 100
Updating learning rate to 0.0025
Epoch: 36 cost time: 1.623594045639038
Epoch: 36, Steps: 34 | Train Loss: 0.8469995 Vali Loss: 0.7303221 Test Loss: 4.1498466
EarlyStopping counter: 20 out of 100
Updating learning rate to 0.0025
Epoch: 37 cost time: 1.6807620525360107
Epoch: 37, Steps: 34 | Train Loss: 0.8504079 Vali Loss: 0.7410004 Test Loss: 4.1475258
EarlyStopping counter: 21 out of 100
Updating learning rate to 0.0025
Epoch: 38 cost time: 1.738612413406372
Epoch: 38, Steps: 34 | Train Loss: 0.8547338 Vali Loss: 0.7093533 Test Loss: 4.1513491
EarlyStopping counter: 22 out of 100
Updating learning rate to 0.0025
Epoch: 39 cost time: 1.800246000289917
Epoch: 39, Steps: 34 | Train Loss: 0.8549667 Vali Loss: 0.7127348 Test Loss: 4.1485839
EarlyStopping counter: 23 out of 100
Updating learning rate to 0.0025
Epoch: 40 cost time: 1.6049275398254395
Epoch: 40, Steps: 34 | Train Loss: 0.8531303 Vali Loss: 0.7105393 Test Loss: 4.1502485
EarlyStopping counter: 24 out of 100
Updating learning rate to 0.0025
Epoch: 41 cost time: 1.5449323654174805
Epoch: 41, Steps: 34 | Train Loss: 0.8526796 Vali Loss: 0.6977535 Test Loss: 4.1483049
EarlyStopping counter: 25 out of 100
Updating learning rate to 0.0025
Epoch: 42 cost time: 1.738673448562622
Epoch: 42, Steps: 34 | Train Loss: 0.8532853 Vali Loss: 0.6823682 Test Loss: 4.1474028
EarlyStopping counter: 26 out of 100
Updating learning rate to 0.0025
Epoch: 43 cost time: 1.8307740688323975
Epoch: 43, Steps: 34 | Train Loss: 0.8526371 Vali Loss: 0.7480947 Test Loss: 4.1467814
EarlyStopping counter: 27 out of 100
Updating learning rate to 0.0025
Epoch: 44 cost time: 1.6737031936645508
Epoch: 44, Steps: 34 | Train Loss: 0.8549236 Vali Loss: 0.7018249 Test Loss: 4.1498137
EarlyStopping counter: 28 out of 100
Updating learning rate to 0.0025
Epoch: 45 cost time: 1.6307079792022705
Epoch: 45, Steps: 34 | Train Loss: 0.8553389 Vali Loss: 0.6874781 Test Loss: 4.1494589
EarlyStopping counter: 29 out of 100
Updating learning rate to 0.0025
Epoch: 46 cost time: 1.7373576164245605
Epoch: 46, Steps: 34 | Train Loss: 0.8521188 Vali Loss: 0.7046986 Test Loss: 4.1470895
EarlyStopping counter: 30 out of 100
Updating learning rate to 0.0025
Epoch: 47 cost time: 1.725050449371338
Epoch: 47, Steps: 34 | Train Loss: 0.8534264 Vali Loss: 0.7399775 Test Loss: 4.1456723
EarlyStopping counter: 31 out of 100
Updating learning rate to 0.0025
Epoch: 48 cost time: 1.7547664642333984
Epoch: 48, Steps: 34 | Train Loss: 0.8533042 Vali Loss: 0.7174919 Test Loss: 4.1477714
EarlyStopping counter: 32 out of 100
Updating learning rate to 0.0025
Epoch: 49 cost time: 1.5803377628326416
Epoch: 49, Steps: 34 | Train Loss: 0.8463887 Vali Loss: 0.7286709 Test Loss: 4.1494145
EarlyStopping counter: 33 out of 100
Updating learning rate to 0.0025
Epoch: 50 cost time: 1.6845910549163818
Epoch: 50, Steps: 34 | Train Loss: 0.8539305 Vali Loss: 0.7594160 Test Loss: 4.1468949
EarlyStopping counter: 34 out of 100
Updating learning rate to 0.0025
Epoch: 51 cost time: 1.715376615524292
Epoch: 51, Steps: 34 | Train Loss: 0.8529141 Vali Loss: 0.7066919 Test Loss: 4.1488276
EarlyStopping counter: 35 out of 100
Updating learning rate to 0.0025
Epoch: 52 cost time: 1.7569653987884521
Epoch: 52, Steps: 34 | Train Loss: 0.8549044 Vali Loss: 0.7247635 Test Loss: 4.1472063
EarlyStopping counter: 36 out of 100
Updating learning rate to 0.0025
Epoch: 53 cost time: 1.693070888519287
Epoch: 53, Steps: 34 | Train Loss: 0.8539864 Vali Loss: 0.7079365 Test Loss: 4.1463823
EarlyStopping counter: 37 out of 100
Updating learning rate to 0.0025
Epoch: 54 cost time: 1.6703600883483887
Epoch: 54, Steps: 34 | Train Loss: 0.8517268 Vali Loss: 0.7240591 Test Loss: 4.1487036
EarlyStopping counter: 38 out of 100
Updating learning rate to 0.0025
Epoch: 55 cost time: 1.7525410652160645
Epoch: 55, Steps: 34 | Train Loss: 0.8564446 Vali Loss: 0.7076932 Test Loss: 4.1505589
EarlyStopping counter: 39 out of 100
Updating learning rate to 0.0025
Epoch: 56 cost time: 1.7025396823883057
Epoch: 56, Steps: 34 | Train Loss: 0.8549409 Vali Loss: 0.7079977 Test Loss: 4.1485696
EarlyStopping counter: 40 out of 100
Updating learning rate to 0.0025
Epoch: 57 cost time: 1.8001255989074707
Epoch: 57, Steps: 34 | Train Loss: 0.8538824 Vali Loss: 0.7158387 Test Loss: 4.1489754
EarlyStopping counter: 41 out of 100
Updating learning rate to 0.0025
Epoch: 58 cost time: 1.7877986431121826
Epoch: 58, Steps: 34 | Train Loss: 0.8499296 Vali Loss: 0.7376865 Test Loss: 4.1484690
EarlyStopping counter: 42 out of 100
Updating learning rate to 0.0025
Epoch: 59 cost time: 1.7013859748840332
