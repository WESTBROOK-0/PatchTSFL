Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_192_Informer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6688533
	speed: 0.0553s/iter; left time: 999.9937s
	iters: 200, epoch: 1 | loss: 4.5590205
	speed: 0.0314s/iter; left time: 564.6576s
	iters: 300, epoch: 1 | loss: 0.7453507
	speed: 0.0312s/iter; left time: 557.0564s
	iters: 400, epoch: 1 | loss: 0.5542295
	speed: 0.0318s/iter; left time: 566.1119s
	iters: 500, epoch: 1 | loss: 0.4757078
	speed: 0.0319s/iter; left time: 563.9145s
	iters: 600, epoch: 1 | loss: 0.4327711
	speed: 0.0319s/iter; left time: 560.9591s
	iters: 700, epoch: 1 | loss: 0.5319327
	speed: 0.0322s/iter; left time: 562.8164s
	iters: 800, epoch: 1 | loss: 0.6379849
	speed: 0.0314s/iter; left time: 546.5001s
	iters: 900, epoch: 1 | loss: 0.3901690
	speed: 0.0313s/iter; left time: 540.4478s
	iters: 1000, epoch: 1 | loss: 0.4375431
	speed: 0.0324s/iter; left time: 556.2970s
	iters: 1100, epoch: 1 | loss: 0.3902507
	speed: 0.0332s/iter; left time: 567.4171s
	iters: 1200, epoch: 1 | loss: 0.4294040
	speed: 0.0324s/iter; left time: 549.3395s
	iters: 1300, epoch: 1 | loss: 1.0156524
	speed: 0.0323s/iter; left time: 545.1727s
	iters: 1400, epoch: 1 | loss: 0.3688128
	speed: 0.0330s/iter; left time: 553.4151s
	iters: 1500, epoch: 1 | loss: 0.3616327
	speed: 0.0334s/iter; left time: 557.0152s
	iters: 1600, epoch: 1 | loss: 0.6167964
	speed: 0.0333s/iter; left time: 552.3308s
	iters: 1700, epoch: 1 | loss: 0.4621350
	speed: 0.0356s/iter; left time: 586.3578s
	iters: 1800, epoch: 1 | loss: 0.3202364
	speed: 0.0338s/iter; left time: 554.1768s
	iters: 1900, epoch: 1 | loss: 0.3728660
	speed: 0.0325s/iter; left time: 529.8479s
	iters: 2000, epoch: 1 | loss: 0.7548952
	speed: 0.0335s/iter; left time: 541.8589s
	iters: 2100, epoch: 1 | loss: 0.3373943
	speed: 0.0314s/iter; left time: 505.2743s
	iters: 2200, epoch: 1 | loss: 4.2340732
	speed: 0.0333s/iter; left time: 532.1314s
	iters: 2300, epoch: 1 | loss: 0.7744598
	speed: 0.0365s/iter; left time: 579.2732s
	iters: 2400, epoch: 1 | loss: 0.3382570
	speed: 0.0312s/iter; left time: 493.0440s
	iters: 2500, epoch: 1 | loss: 0.3290645
	speed: 0.0316s/iter; left time: 496.0665s
	iters: 2600, epoch: 1 | loss: 0.4380805
	speed: 0.0340s/iter; left time: 530.2154s
	iters: 2700, epoch: 1 | loss: 0.2483525
	speed: 0.0348s/iter; left time: 539.4018s
	iters: 2800, epoch: 1 | loss: 0.5519591
	speed: 0.0311s/iter; left time: 478.6574s
	iters: 2900, epoch: 1 | loss: 0.3503273
	speed: 0.0322s/iter; left time: 492.1420s
	iters: 3000, epoch: 1 | loss: 0.3855520
	speed: 0.0315s/iter; left time: 478.3339s
	iters: 3100, epoch: 1 | loss: 0.2854355
	speed: 0.0312s/iter; left time: 470.2451s
	iters: 3200, epoch: 1 | loss: 0.3892682
	speed: 0.0322s/iter; left time: 482.3068s
	iters: 3300, epoch: 1 | loss: 0.7118378
	speed: 0.0318s/iter; left time: 473.3646s
	iters: 3400, epoch: 1 | loss: 0.5556975
	speed: 0.0312s/iter; left time: 461.6853s
	iters: 3500, epoch: 1 | loss: 0.2336617
	speed: 0.0314s/iter; left time: 461.5206s
	iters: 3600, epoch: 1 | loss: 0.3541704
	speed: 0.0333s/iter; left time: 485.7055s
	iters: 3700, epoch: 1 | loss: 0.2544900
	speed: 0.0390s/iter; left time: 565.3730s
	iters: 3800, epoch: 1 | loss: 0.2518069
	speed: 0.0323s/iter; left time: 465.0395s
	iters: 3900, epoch: 1 | loss: 0.3038062
	speed: 0.0313s/iter; left time: 446.6173s
	iters: 4000, epoch: 1 | loss: 0.9578034
	speed: 0.0326s/iter; left time: 461.8419s
	iters: 4100, epoch: 1 | loss: 0.3450367
	speed: 0.0315s/iter; left time: 443.1210s
	iters: 4200, epoch: 1 | loss: 0.5391754
	speed: 0.0312s/iter; left time: 436.1695s
	iters: 4300, epoch: 1 | loss: 0.2870152
	speed: 0.0328s/iter; left time: 455.3953s
	iters: 4400, epoch: 1 | loss: 0.3808501
	speed: 0.0343s/iter; left time: 472.8938s
	iters: 4500, epoch: 1 | loss: 0.4282222
	speed: 0.0353s/iter; left time: 482.8818s
	iters: 4600, epoch: 1 | loss: 0.2396757
	speed: 0.0344s/iter; left time: 467.7107s
	iters: 4700, epoch: 1 | loss: 0.5392621
	speed: 0.0313s/iter; left time: 422.4657s
	iters: 4800, epoch: 1 | loss: 0.4219601
	speed: 0.0312s/iter; left time: 417.1974s
	iters: 4900, epoch: 1 | loss: 0.2564004
	speed: 0.0312s/iter; left time: 414.5631s
	iters: 5000, epoch: 1 | loss: 0.3423859
	speed: 0.0311s/iter; left time: 410.2052s
	iters: 5100, epoch: 1 | loss: 0.5710916
	speed: 0.0309s/iter; left time: 404.2670s
	iters: 5200, epoch: 1 | loss: 0.2838340
	speed: 0.0315s/iter; left time: 408.5541s
	iters: 5300, epoch: 1 | loss: 0.4254324
	speed: 0.0306s/iter; left time: 394.6148s
	iters: 5400, epoch: 1 | loss: 0.5065514
	speed: 0.0319s/iter; left time: 407.7193s
	iters: 5500, epoch: 1 | loss: 0.4774280
	speed: 0.0326s/iter; left time: 412.9275s
	iters: 5600, epoch: 1 | loss: 0.2927145
	speed: 0.0326s/iter; left time: 410.6682s
	iters: 5700, epoch: 1 | loss: 0.5120338
	speed: 0.0327s/iter; left time: 408.4288s
	iters: 5800, epoch: 1 | loss: 0.3108306
	speed: 0.0321s/iter; left time: 397.5395s
	iters: 5900, epoch: 1 | loss: 0.3207504
	speed: 0.0313s/iter; left time: 384.7902s
	iters: 6000, epoch: 1 | loss: 0.4189656
	speed: 0.0310s/iter; left time: 377.5571s
	iters: 6100, epoch: 1 | loss: 0.8058088
	speed: 0.0315s/iter; left time: 380.1905s
	iters: 6200, epoch: 1 | loss: 0.4684831
	speed: 0.0310s/iter; left time: 371.3425s
	iters: 6300, epoch: 1 | loss: 0.2302733
	speed: 0.0322s/iter; left time: 382.8518s
	iters: 6400, epoch: 1 | loss: 0.3702302
	speed: 0.0337s/iter; left time: 397.4785s
	iters: 6500, epoch: 1 | loss: 0.1830809
	speed: 0.0324s/iter; left time: 377.8947s
	iters: 6600, epoch: 1 | loss: 0.4098631
	speed: 0.0324s/iter; left time: 375.2555s
	iters: 6700, epoch: 1 | loss: 0.3884941
	speed: 0.0330s/iter; left time: 378.2991s
	iters: 6800, epoch: 1 | loss: 0.3345534
	speed: 0.0355s/iter; left time: 404.5730s
	iters: 6900, epoch: 1 | loss: 0.3966137
	speed: 0.0352s/iter; left time: 396.6011s
	iters: 7000, epoch: 1 | loss: 0.5385441
	speed: 0.0367s/iter; left time: 409.9309s
	iters: 7100, epoch: 1 | loss: 0.2979733
	speed: 0.0342s/iter; left time: 378.8602s
	iters: 7200, epoch: 1 | loss: 0.2249252
	speed: 0.0311s/iter; left time: 341.9461s
	iters: 7300, epoch: 1 | loss: 0.2728242
	speed: 0.0322s/iter; left time: 350.5758s
	iters: 7400, epoch: 1 | loss: 0.6479221
	speed: 0.0305s/iter; left time: 328.5874s
	iters: 7500, epoch: 1 | loss: 0.4403659
	speed: 0.0313s/iter; left time: 334.1357s
	iters: 7600, epoch: 1 | loss: 0.3852480
	speed: 0.0318s/iter; left time: 336.0766s
	iters: 7700, epoch: 1 | loss: 0.2181554
	speed: 0.0323s/iter; left time: 338.0877s
	iters: 7800, epoch: 1 | loss: 0.7954646
	speed: 0.0321s/iter; left time: 333.7026s
	iters: 7900, epoch: 1 | loss: 0.2032675
	speed: 0.0342s/iter; left time: 351.1690s
	iters: 8000, epoch: 1 | loss: 1.0142018
	speed: 0.0341s/iter; left time: 346.9523s
	iters: 8100, epoch: 1 | loss: 0.3613913
	speed: 0.0322s/iter; left time: 324.7263s
	iters: 8200, epoch: 1 | loss: 0.4961693
	speed: 0.0326s/iter; left time: 325.3557s
	iters: 8300, epoch: 1 | loss: 0.3306123
	speed: 0.0321s/iter; left time: 317.3958s
	iters: 8400, epoch: 1 | loss: 0.4224213
	speed: 0.0317s/iter; left time: 310.3273s
	iters: 8500, epoch: 1 | loss: 0.3402239
	speed: 0.0311s/iter; left time: 300.7285s
	iters: 8600, epoch: 1 | loss: 0.4359510
	speed: 0.0315s/iter; left time: 301.8083s
	iters: 8700, epoch: 1 | loss: 0.5997946
	speed: 0.0321s/iter; left time: 304.3916s
	iters: 8800, epoch: 1 | loss: 0.8744281
	speed: 0.0327s/iter; left time: 306.3521s
	iters: 8900, epoch: 1 | loss: 0.2910295
	speed: 0.0346s/iter; left time: 320.9675s
	iters: 9000, epoch: 1 | loss: 0.2334503
	speed: 0.0365s/iter; left time: 335.0776s
Epoch: 1 cost time: 298.4828064441681
Epoch: 1, Steps: 9090 | Train Loss: 0.5368723 Vali Loss: 0.5798230 Test Loss: 0.5294965
Validation loss decreased (inf --> 0.579823).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5303548
	speed: 0.5194s/iter; left time: 4669.9209s
	iters: 200, epoch: 2 | loss: 1.1847436
	speed: 0.0311s/iter; left time: 276.4906s
	iters: 300, epoch: 2 | loss: 0.2277644
	speed: 0.0320s/iter; left time: 281.1338s
	iters: 400, epoch: 2 | loss: 0.8732755
	speed: 0.0319s/iter; left time: 276.9141s
	iters: 500, epoch: 2 | loss: 0.3502156
	speed: 0.0373s/iter; left time: 320.0506s
	iters: 600, epoch: 2 | loss: 0.2203826
	speed: 0.0366s/iter; left time: 310.3996s
	iters: 700, epoch: 2 | loss: 0.2417946
	speed: 0.0316s/iter; left time: 265.0966s
	iters: 800, epoch: 2 | loss: 0.3731666
	speed: 0.0310s/iter; left time: 256.8984s
	iters: 900, epoch: 2 | loss: 0.2947115
	speed: 0.0315s/iter; left time: 257.9181s
	iters: 1000, epoch: 2 | loss: 0.4301566
	speed: 0.0305s/iter; left time: 246.6934s
	iters: 1100, epoch: 2 | loss: 0.2285947
	speed: 0.0313s/iter; left time: 250.0188s
	iters: 1200, epoch: 2 | loss: 0.4117953
	speed: 0.0307s/iter; left time: 242.5685s
	iters: 1300, epoch: 2 | loss: 0.3364677
	speed: 0.0326s/iter; left time: 254.3456s
	iters: 1400, epoch: 2 | loss: 0.3028984
	speed: 0.0320s/iter; left time: 246.1863s
	iters: 1500, epoch: 2 | loss: 0.4055952
	speed: 0.0315s/iter; left time: 239.1530s
	iters: 1600, epoch: 2 | loss: 0.5403497
	speed: 0.0322s/iter; left time: 240.9985s
	iters: 1700, epoch: 2 | loss: 0.5355211
	speed: 0.0319s/iter; left time: 235.6991s
	iters: 1800, epoch: 2 | loss: 0.2713595
	speed: 0.0316s/iter; left time: 230.5390s
	iters: 1900, epoch: 2 | loss: 0.2225957
	speed: 0.0307s/iter; left time: 220.9849s
	iters: 2000, epoch: 2 | loss: 0.2243690
	speed: 0.0315s/iter; left time: 223.5493s
	iters: 2100, epoch: 2 | loss: 0.2202408
	speed: 0.0316s/iter; left time: 220.9016s
	iters: 2200, epoch: 2 | loss: 1.2457310
	speed: 0.0315s/iter; left time: 217.4100s
	iters: 2300, epoch: 2 | loss: 0.3371807
	speed: 0.0315s/iter; left time: 213.9275s
	iters: 2400, epoch: 2 | loss: 0.3521737
	speed: 0.0317s/iter; left time: 212.1514s
	iters: 2500, epoch: 2 | loss: 0.4640571
	speed: 0.0314s/iter; left time: 206.8584s
	iters: 2600, epoch: 2 | loss: 0.2738404
	speed: 0.0309s/iter; left time: 200.8353s
	iters: 2700, epoch: 2 | loss: 0.2168645
	speed: 0.0352s/iter; left time: 225.0726s
	iters: 2800, epoch: 2 | loss: 0.2967586
	speed: 0.0340s/iter; left time: 214.0443s
	iters: 2900, epoch: 2 | loss: 0.8612066
	speed: 0.0313s/iter; left time: 193.6073s
	iters: 3000, epoch: 2 | loss: 0.6142452
	speed: 0.0318s/iter; left time: 193.5885s
	iters: 3100, epoch: 2 | loss: 0.2785234
	speed: 0.0309s/iter; left time: 185.3422s
	iters: 3200, epoch: 2 | loss: 0.1979587
	speed: 0.0316s/iter; left time: 186.1894s
	iters: 3300, epoch: 2 | loss: 0.1905460
	speed: 0.0318s/iter; left time: 184.1569s
	iters: 3400, epoch: 2 | loss: 0.2303938
	speed: 0.0318s/iter; left time: 180.8170s
	iters: 3500, epoch: 2 | loss: 0.2836733
	speed: 0.0311s/iter; left time: 174.0587s
	iters: 3600, epoch: 2 | loss: 0.3701068
	speed: 0.0310s/iter; left time: 170.1456s
	iters: 3700, epoch: 2 | loss: 0.3264401
	speed: 0.0314s/iter; left time: 169.5270s
	iters: 3800, epoch: 2 | loss: 0.2739519
	speed: 0.0331s/iter; left time: 174.8852s
	iters: 3900, epoch: 2 | loss: 0.2634396
	speed: 0.0318s/iter; left time: 165.2600s
	iters: 4000, epoch: 2 | loss: 0.3407989
	speed: 0.0316s/iter; left time: 160.6519s
	iters: 4100, epoch: 2 | loss: 0.1985848
	speed: 0.0318s/iter; left time: 158.6478s
	iters: 4200, epoch: 2 | loss: 0.3379712
	speed: 0.0322s/iter; left time: 157.5559s
	iters: 4300, epoch: 2 | loss: 0.3443499
	speed: 0.0324s/iter; left time: 155.1488s
	iters: 4400, epoch: 2 | loss: 0.2544995
	speed: 0.0323s/iter; left time: 151.6815s
	iters: 4500, epoch: 2 | loss: 0.3391853
	speed: 0.0321s/iter; left time: 147.4992s
	iters: 4600, epoch: 2 | loss: 0.3469369
	speed: 0.0316s/iter; left time: 142.0228s
	iters: 4700, epoch: 2 | loss: 0.3139018
	speed: 0.0315s/iter; left time: 138.3403s
	iters: 4800, epoch: 2 | loss: 0.2466137
	speed: 0.0307s/iter; left time: 131.5875s
	iters: 4900, epoch: 2 | loss: 0.1850918
	speed: 0.0320s/iter; left time: 133.9930s
	iters: 5000, epoch: 2 | loss: 0.1818798
	speed: 0.0313s/iter; left time: 127.8461s
	iters: 5100, epoch: 2 | loss: 0.2209932
	speed: 0.0313s/iter; left time: 124.7429s
	iters: 5200, epoch: 2 | loss: 0.2319790
	speed: 0.0317s/iter; left time: 123.3059s
	iters: 5300, epoch: 2 | loss: 0.1662579
	speed: 0.0315s/iter; left time: 119.3324s
	iters: 5400, epoch: 2 | loss: 0.3176293
	speed: 0.0318s/iter; left time: 117.5480s
	iters: 5500, epoch: 2 | loss: 0.2289941
	speed: 0.0324s/iter; left time: 116.4928s
	iters: 5600, epoch: 2 | loss: 0.3540395
	speed: 0.0324s/iter; left time: 113.0950s
	iters: 5700, epoch: 2 | loss: 0.2019417
	speed: 0.0319s/iter; left time: 108.1069s
	iters: 5800, epoch: 2 | loss: 0.2527952
	speed: 0.0316s/iter; left time: 104.0538s
	iters: 5900, epoch: 2 | loss: 0.2016686
	speed: 0.0334s/iter; left time: 106.4311s
	iters: 6000, epoch: 2 | loss: 0.3977763
	speed: 0.0339s/iter; left time: 104.9285s
	iters: 6100, epoch: 2 | loss: 0.2496722
	speed: 0.0319s/iter; left time: 95.3346s
	iters: 6200, epoch: 2 | loss: 0.1813011
	speed: 0.0314s/iter; left time: 90.9061s
	iters: 6300, epoch: 2 | loss: 0.7491932
	speed: 0.0312s/iter; left time: 87.2069s
	iters: 6400, epoch: 2 | loss: 0.1968381
	speed: 0.0306s/iter; left time: 82.4202s
	iters: 6500, epoch: 2 | loss: 0.2954113
	speed: 0.0311s/iter; left time: 80.5872s
	iters: 6600, epoch: 2 | loss: 0.3174287
	speed: 0.0308s/iter; left time: 76.6635s
	iters: 6700, epoch: 2 | loss: 0.2472308
	speed: 0.0311s/iter; left time: 74.2910s
	iters: 6800, epoch: 2 | loss: 0.2897125
	speed: 0.0316s/iter; left time: 72.4083s
	iters: 6900, epoch: 2 | loss: 0.2799370
	speed: 0.0316s/iter; left time: 69.3077s
	iters: 7000, epoch: 2 | loss: 0.2766277
	speed: 0.0342s/iter; left time: 71.4955s
	iters: 7100, epoch: 2 | loss: 0.2923262
	speed: 0.0321s/iter; left time: 63.8906s
	iters: 7200, epoch: 2 | loss: 0.4223840
	speed: 0.0310s/iter; left time: 58.6660s
	iters: 7300, epoch: 2 | loss: 0.3436106
	speed: 0.0314s/iter; left time: 56.2554s
	iters: 7400, epoch: 2 | loss: 0.3221436
	speed: 0.0318s/iter; left time: 53.7314s
	iters: 7500, epoch: 2 | loss: 0.1297144
	speed: 0.0320s/iter; left time: 50.8521s
	iters: 7600, epoch: 2 | loss: 0.3231839
	speed: 0.0325s/iter; left time: 48.4993s
	iters: 7700, epoch: 2 | loss: 0.1508366
	speed: 0.0330s/iter; left time: 45.9649s
	iters: 7800, epoch: 2 | loss: 0.1586375
	speed: 0.0315s/iter; left time: 40.7270s
	iters: 7900, epoch: 2 | loss: 0.1831670
	speed: 0.0320s/iter; left time: 38.1143s
	iters: 8000, epoch: 2 | loss: 0.3650494
	speed: 0.0311s/iter; left time: 33.9048s
	iters: 8100, epoch: 2 | loss: 0.1674555
	speed: 0.0312s/iter; left time: 30.9401s
	iters: 8200, epoch: 2 | loss: 0.2122334
	speed: 0.0323s/iter; left time: 28.7754s
	iters: 8300, epoch: 2 | loss: 0.2277653
	speed: 0.0321s/iter; left time: 25.4209s
	iters: 8400, epoch: 2 | loss: 0.7564377
	speed: 0.0316s/iter; left time: 21.8569s
	iters: 8500, epoch: 2 | loss: 0.2603471
	speed: 0.0316s/iter; left time: 18.6654s
	iters: 8600, epoch: 2 | loss: 0.1804761
	speed: 0.0311s/iter; left time: 15.2885s
	iters: 8700, epoch: 2 | loss: 0.1270293
	speed: 0.0316s/iter; left time: 12.3444s
	iters: 8800, epoch: 2 | loss: 0.2061124
	speed: 0.0316s/iter; left time: 9.1840s
	iters: 8900, epoch: 2 | loss: 0.1495004
	speed: 0.0312s/iter; left time: 5.9575s
	iters: 9000, epoch: 2 | loss: 0.2862135
	speed: 0.0310s/iter; left time: 2.8209s
Epoch: 2 cost time: 291.6384868621826
Epoch: 2, Steps: 9090 | Train Loss: 0.3915841 Vali Loss: 0.5375603 Test Loss: 0.3392417
Validation loss decreased (0.579823 --> 0.537560).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_192_Informer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.33924055099487305, mae:0.4003174901008606, rse:0.7666938900947571
