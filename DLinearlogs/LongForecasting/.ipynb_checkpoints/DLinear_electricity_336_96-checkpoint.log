Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.001, loss='mse', lradj='type3', model='DLinear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.5676394
	speed: 0.0147s/iter; left time: 1644.9877s
	iters: 200, epoch: 1 | loss: 0.3515099
	speed: 0.0093s/iter; left time: 1045.2262s
	iters: 300, epoch: 1 | loss: 0.2800536
	speed: 0.0092s/iter; left time: 1030.8112s
	iters: 400, epoch: 1 | loss: 0.3463926
	speed: 0.0091s/iter; left time: 1018.5772s
	iters: 500, epoch: 1 | loss: 0.2267221
	speed: 0.0093s/iter; left time: 1037.1969s
	iters: 600, epoch: 1 | loss: 0.2322915
	speed: 0.0091s/iter; left time: 1012.5068s
	iters: 700, epoch: 1 | loss: 0.2259972
	speed: 0.0092s/iter; left time: 1027.6747s
	iters: 800, epoch: 1 | loss: 0.2141978
	speed: 0.0092s/iter; left time: 1025.9768s
	iters: 900, epoch: 1 | loss: 0.2530302
	speed: 0.0093s/iter; left time: 1036.1932s
	iters: 1000, epoch: 1 | loss: 0.2337733
	speed: 0.0105s/iter; left time: 1169.9204s
	iters: 1100, epoch: 1 | loss: 0.2020613
	speed: 0.0097s/iter; left time: 1080.5289s
Epoch: 1 cost time: 11.236191511154175
Epoch: 1, Steps: 1123 | Train Loss: 0.3124414 Vali Loss: 0.1829842 Test Loss: 0.2060371
Validation loss decreased (inf --> 0.182984).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1586777
	speed: 0.0911s/iter; left time: 10120.4038s
	iters: 200, epoch: 2 | loss: 0.1492449
	speed: 0.0094s/iter; left time: 1042.0793s
	iters: 300, epoch: 2 | loss: 0.1325178
	speed: 0.0096s/iter; left time: 1059.5650s
	iters: 400, epoch: 2 | loss: 0.1247526
	speed: 0.0092s/iter; left time: 1020.0834s
	iters: 500, epoch: 2 | loss: 0.1349777
	speed: 0.0093s/iter; left time: 1032.3353s
	iters: 600, epoch: 2 | loss: 0.1447252
	speed: 0.0094s/iter; left time: 1043.7005s
	iters: 700, epoch: 2 | loss: 0.1325550
	speed: 0.0092s/iter; left time: 1019.6675s
	iters: 800, epoch: 2 | loss: 0.1360569
	speed: 0.0093s/iter; left time: 1027.8405s
	iters: 900, epoch: 2 | loss: 0.1609143
	speed: 0.0096s/iter; left time: 1059.4516s
	iters: 1000, epoch: 2 | loss: 0.1286481
	speed: 0.0096s/iter; left time: 1058.5799s
	iters: 1100, epoch: 2 | loss: 0.1248866
	speed: 0.0091s/iter; left time: 1006.2046s
Epoch: 2 cost time: 11.287898302078247
Epoch: 2, Steps: 1123 | Train Loss: 0.1545837 Vali Loss: 0.1258470 Test Loss: 0.1462848
Validation loss decreased (0.182984 --> 0.125847).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 3 | loss: 0.1518226
	speed: 0.0893s/iter; left time: 9819.2104s
	iters: 200, epoch: 3 | loss: 0.1375275
	speed: 0.0097s/iter; left time: 1066.7863s
	iters: 300, epoch: 3 | loss: 0.1604863
	speed: 0.0091s/iter; left time: 996.1570s
	iters: 400, epoch: 3 | loss: 0.1256938
	speed: 0.0090s/iter; left time: 988.6279s
	iters: 500, epoch: 3 | loss: 0.1852979
	speed: 0.0090s/iter; left time: 985.8713s
	iters: 600, epoch: 3 | loss: 0.1338802
	speed: 0.0092s/iter; left time: 1006.4887s
	iters: 700, epoch: 3 | loss: 0.1372240
	speed: 0.0093s/iter; left time: 1021.7303s
	iters: 800, epoch: 3 | loss: 0.1355054
	speed: 0.0091s/iter; left time: 990.3777s
	iters: 900, epoch: 3 | loss: 0.1514454
	speed: 0.0093s/iter; left time: 1012.7606s
	iters: 1000, epoch: 3 | loss: 0.1868049
	speed: 0.0092s/iter; left time: 1003.4800s
	iters: 1100, epoch: 3 | loss: 0.1423616
	speed: 0.0092s/iter; left time: 1002.5313s
Epoch: 3 cost time: 11.02268671989441
Epoch: 3, Steps: 1123 | Train Loss: 0.1461972 Vali Loss: 0.1236299 Test Loss: 0.1443835
Validation loss decreased (0.125847 --> 0.123630).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 4 | loss: 0.1544633
	speed: 0.0908s/iter; left time: 9884.4910s
	iters: 200, epoch: 4 | loss: 0.2202445
	speed: 0.0095s/iter; left time: 1030.4970s
	iters: 300, epoch: 4 | loss: 0.1443730
	speed: 0.0095s/iter; left time: 1030.1693s
	iters: 400, epoch: 4 | loss: 0.2048409
	speed: 0.0099s/iter; left time: 1073.0196s
	iters: 500, epoch: 4 | loss: 0.1744299
	speed: 0.0094s/iter; left time: 1019.9188s
	iters: 600, epoch: 4 | loss: 0.1434938
	speed: 0.0096s/iter; left time: 1041.9822s
	iters: 700, epoch: 4 | loss: 0.1268685
	speed: 0.0097s/iter; left time: 1050.7693s
	iters: 800, epoch: 4 | loss: 0.1243682
	speed: 0.0096s/iter; left time: 1038.5571s
	iters: 900, epoch: 4 | loss: 0.1265448
	speed: 0.0095s/iter; left time: 1030.6052s
	iters: 1000, epoch: 4 | loss: 0.1264778
	speed: 0.0095s/iter; left time: 1029.3313s
	iters: 1100, epoch: 4 | loss: 0.1511315
	speed: 0.0096s/iter; left time: 1037.8461s
Epoch: 4 cost time: 11.597023963928223
