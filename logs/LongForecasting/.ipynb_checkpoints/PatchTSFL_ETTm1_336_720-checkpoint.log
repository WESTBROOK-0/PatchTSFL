Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_720', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_720_PatchTSFL_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6052571
	speed: 0.0168s/iter; left time: 435.9491s
	iters: 200, epoch: 1 | loss: 0.6527374
	speed: 0.0087s/iter; left time: 224.3467s
Epoch: 1 cost time: 3.1890318393707275
Epoch: 1, Steps: 261 | Train Loss: 0.5909649 Vali Loss: 1.3711826 Test Loss: 0.7211002
Validation loss decreased (inf --> 1.371183).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.5879634
	speed: 0.0575s/iter; left time: 1480.7996s
	iters: 200, epoch: 2 | loss: 0.6117811
	speed: 0.0089s/iter; left time: 227.2240s
Epoch: 2 cost time: 3.0853095054626465
Epoch: 2, Steps: 261 | Train Loss: 0.5908341 Vali Loss: 1.3708383 Test Loss: 0.7211152
Validation loss decreased (1.371183 --> 1.370838).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.5750972
	speed: 0.0552s/iter; left time: 1406.9783s
	iters: 200, epoch: 3 | loss: 0.5804019
	speed: 0.0088s/iter; left time: 223.9171s
Epoch: 3 cost time: 2.993215322494507
Epoch: 3, Steps: 261 | Train Loss: 0.5909526 Vali Loss: 1.3702592 Test Loss: 0.7211318
Validation loss decreased (1.370838 --> 1.370259).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.5876680
	speed: 0.0522s/iter; left time: 1315.7864s
	iters: 200, epoch: 4 | loss: 0.5901528
	speed: 0.0088s/iter; left time: 220.6987s
Epoch: 4 cost time: 2.931251287460327
Epoch: 4, Steps: 261 | Train Loss: 0.5906918 Vali Loss: 1.3703226 Test Loss: 0.7211510
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.6259933
	speed: 0.0549s/iter; left time: 1371.2147s
	iters: 200, epoch: 5 | loss: 0.6243893
	speed: 0.0086s/iter; left time: 212.9522s
Epoch: 5 cost time: 3.061199903488159
Epoch: 5, Steps: 261 | Train Loss: 0.5909152 Vali Loss: 1.3711309 Test Loss: 0.7211741
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.5559213
	speed: 0.0553s/iter; left time: 1365.4766s
	iters: 200, epoch: 6 | loss: 0.6557702
	speed: 0.0086s/iter; left time: 212.1250s
Epoch: 6 cost time: 3.0003435611724854
Epoch: 6, Steps: 261 | Train Loss: 0.5907589 Vali Loss: 1.3707927 Test Loss: 0.7212035
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.5507166
	speed: 0.0558s/iter; left time: 1363.8166s
	iters: 200, epoch: 7 | loss: 0.5523672
	speed: 0.0084s/iter; left time: 204.6976s
Epoch: 7 cost time: 2.968350648880005
Epoch: 7, Steps: 261 | Train Loss: 0.5908639 Vali Loss: 1.3709444 Test Loss: 0.7212370
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.5651660
	speed: 0.0527s/iter; left time: 1273.4989s
	iters: 200, epoch: 8 | loss: 0.6199196
	speed: 0.0088s/iter; left time: 210.8701s
Epoch: 8 cost time: 3.043797492980957
Epoch: 8, Steps: 261 | Train Loss: 0.5906745 Vali Loss: 1.3708824 Test Loss: 0.7212779
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.6373924
	speed: 0.0556s/iter; left time: 1328.6575s
	iters: 200, epoch: 9 | loss: 0.5910218
	speed: 0.0091s/iter; left time: 215.7297s
Epoch: 9 cost time: 3.1633505821228027
Epoch: 9, Steps: 261 | Train Loss: 0.5908599 Vali Loss: 1.3690150 Test Loss: 0.7213230
Validation loss decreased (1.370259 --> 1.369015).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.6203417
	speed: 0.0540s/iter; left time: 1277.0067s
	iters: 200, epoch: 10 | loss: 0.5669374
	speed: 0.0081s/iter; left time: 190.8723s
Epoch: 10 cost time: 2.8158457279205322
Epoch: 10, Steps: 261 | Train Loss: 0.5907064 Vali Loss: 1.3710593 Test Loss: 0.7213783
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.5688312
	speed: 0.0549s/iter; left time: 1284.8877s
	iters: 200, epoch: 11 | loss: 0.5939636
	speed: 0.0087s/iter; left time: 203.7118s
Epoch: 11 cost time: 3.093914031982422
Epoch: 11, Steps: 261 | Train Loss: 0.5907687 Vali Loss: 1.3711618 Test Loss: 0.7214397
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.5893547
	speed: 0.0532s/iter; left time: 1229.6950s
	iters: 200, epoch: 12 | loss: 0.6137781
	speed: 0.0083s/iter; left time: 190.9688s
Epoch: 12 cost time: 2.9190542697906494
Epoch: 12, Steps: 261 | Train Loss: 0.5908207 Vali Loss: 1.3707629 Test Loss: 0.7215077
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.5866275
	speed: 0.0529s/iter; left time: 1209.1259s
	iters: 200, epoch: 13 | loss: 0.5883059
	speed: 0.0083s/iter; left time: 188.2494s
Epoch: 13 cost time: 2.8247084617614746
Epoch: 13, Steps: 261 | Train Loss: 0.5908175 Vali Loss: 1.3704648 Test Loss: 0.7215774
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.6004740
	speed: 0.0516s/iter; left time: 1166.9047s
	iters: 200, epoch: 14 | loss: 0.5995103
	speed: 0.0086s/iter; left time: 193.8441s
Epoch: 14 cost time: 2.967745065689087
Epoch: 14, Steps: 261 | Train Loss: 0.5907428 Vali Loss: 1.3707365 Test Loss: 0.7216605
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.5788261
	speed: 0.0527s/iter; left time: 1178.1931s
	iters: 200, epoch: 15 | loss: 0.5793049
	speed: 0.0083s/iter; left time: 184.2700s
Epoch: 15 cost time: 2.8767244815826416
Epoch: 15, Steps: 261 | Train Loss: 0.5906499 Vali Loss: 1.3715713 Test Loss: 0.7217447
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.6516244
	speed: 0.0525s/iter; left time: 1158.9762s
	iters: 200, epoch: 16 | loss: 0.6158496
	speed: 0.0086s/iter; left time: 188.2470s
Epoch: 16 cost time: 2.883441925048828
Epoch: 16, Steps: 261 | Train Loss: 0.5907032 Vali Loss: 1.3708769 Test Loss: 0.7218321
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.5684686
	speed: 0.0527s/iter; left time: 1150.7089s
	iters: 200, epoch: 17 | loss: 0.6088816
	speed: 0.0080s/iter; left time: 174.3710s
Epoch: 17 cost time: 2.9093172550201416
Epoch: 17, Steps: 261 | Train Loss: 0.5907437 Vali Loss: 1.3711934 Test Loss: 0.7219170
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.5602975
	speed: 0.0529s/iter; left time: 1140.5245s
	iters: 200, epoch: 18 | loss: 0.5858150
	speed: 0.0085s/iter; left time: 181.4477s
Epoch: 18 cost time: 2.894148826599121
Epoch: 18, Steps: 261 | Train Loss: 0.5905929 Vali Loss: 1.3709410 Test Loss: 0.7220026
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.5489310
	speed: 0.0530s/iter; left time: 1130.0040s
	iters: 200, epoch: 19 | loss: 0.5624571
	speed: 0.0082s/iter; left time: 173.6180s
Epoch: 19 cost time: 2.8421924114227295
Epoch: 19, Steps: 261 | Train Loss: 0.5906112 Vali Loss: 1.3715407 Test Loss: 0.7220796
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.6218233
	speed: 0.0521s/iter; left time: 1095.7134s
	iters: 200, epoch: 20 | loss: 0.6001145
	speed: 0.0085s/iter; left time: 177.7591s
Epoch: 20 cost time: 2.8306875228881836
Epoch: 20, Steps: 261 | Train Loss: 0.5905465 Vali Loss: 1.3714170 Test Loss: 0.7221600
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.5617381
	speed: 0.0546s/iter; left time: 1134.5966s
	iters: 200, epoch: 21 | loss: 0.5890013
	speed: 0.0086s/iter; left time: 177.9146s
Epoch: 21 cost time: 2.896095037460327
Epoch: 21, Steps: 261 | Train Loss: 0.5906756 Vali Loss: 1.3719069 Test Loss: 0.7222275
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.5980964
	speed: 0.0522s/iter; left time: 1072.0290s
	iters: 200, epoch: 22 | loss: 0.6223478
	speed: 0.0085s/iter; left time: 173.0383s
Epoch: 22 cost time: 2.8636491298675537
Epoch: 22, Steps: 261 | Train Loss: 0.5906572 Vali Loss: 1.3714311 Test Loss: 0.7222964
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.5889834
	speed: 0.0533s/iter; left time: 1079.2508s
	iters: 200, epoch: 23 | loss: 0.5822559
	speed: 0.0092s/iter; left time: 184.7654s
Epoch: 23 cost time: 3.0566296577453613
Epoch: 23, Steps: 261 | Train Loss: 0.5906005 Vali Loss: 1.3713279 Test Loss: 0.7223616
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.5551792
	speed: 0.0571s/iter; left time: 1142.3847s
	iters: 200, epoch: 24 | loss: 0.6110908
	speed: 0.0094s/iter; left time: 186.7239s
Epoch: 24 cost time: 3.071754217147827
Epoch: 24, Steps: 261 | Train Loss: 0.5906087 Vali Loss: 1.3715396 Test Loss: 0.7224171
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.5393944
	speed: 0.0537s/iter; left time: 1060.1072s
	iters: 200, epoch: 25 | loss: 0.5925097
	speed: 0.0085s/iter; left time: 167.6253s
Epoch: 25 cost time: 2.869723320007324
Epoch: 25, Steps: 261 | Train Loss: 0.5906736 Vali Loss: 1.3710532 Test Loss: 0.7224669
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.5629466
	speed: 0.0543s/iter; left time: 1056.9783s
	iters: 200, epoch: 26 | loss: 0.5838216
	speed: 0.0086s/iter; left time: 167.4783s
Epoch: 26 cost time: 3.0425994396209717
Epoch: 26, Steps: 261 | Train Loss: 0.5905756 Vali Loss: 1.3717606 Test Loss: 0.7225006
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.5793520
	speed: 0.0528s/iter; left time: 1014.1458s
	iters: 200, epoch: 27 | loss: 0.5529122
	speed: 0.0089s/iter; left time: 169.7770s
Epoch: 27 cost time: 2.876303195953369
Epoch: 27, Steps: 261 | Train Loss: 0.5906170 Vali Loss: 1.3721222 Test Loss: 0.7225278
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.5683649
	speed: 0.0540s/iter; left time: 1022.7023s
	iters: 200, epoch: 28 | loss: 0.5752447
	speed: 0.0082s/iter; left time: 154.0445s
Epoch: 28 cost time: 2.871485710144043
Epoch: 28, Steps: 261 | Train Loss: 0.5905891 Vali Loss: 1.3714346 Test Loss: 0.7225434
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.5641330
	speed: 0.0510s/iter; left time: 954.2238s
	iters: 200, epoch: 29 | loss: 0.6232162
	speed: 0.0080s/iter; left time: 148.0518s
Epoch: 29 cost time: 2.74922513961792
Epoch: 29, Steps: 261 | Train Loss: 0.5905616 Vali Loss: 1.3721625 Test Loss: 0.7225718
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTSFL_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7213237285614014, mae:0.5705181956291199, rse:0.807889997959137
