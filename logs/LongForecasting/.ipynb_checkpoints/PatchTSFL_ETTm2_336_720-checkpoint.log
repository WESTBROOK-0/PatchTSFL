Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_720', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_720_PatchTSFL_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6524042
	speed: 0.0172s/iter; left time: 445.9584s
	iters: 200, epoch: 1 | loss: 0.6391301
	speed: 0.0087s/iter; left time: 226.5773s
Epoch: 1 cost time: 3.216265916824341
Epoch: 1, Steps: 261 | Train Loss: 0.6013394 Vali Loss: 0.3152252 Test Loss: 0.4207150
Validation loss decreased (inf --> 0.315225).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.6317853
	speed: 0.0585s/iter; left time: 1506.0421s
	iters: 200, epoch: 2 | loss: 0.8791075
	speed: 0.0083s/iter; left time: 213.3727s
Epoch: 2 cost time: 3.121915578842163
Epoch: 2, Steps: 261 | Train Loss: 0.6007487 Vali Loss: 0.3152500 Test Loss: 0.4207127
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.5526398
	speed: 0.0582s/iter; left time: 1483.7991s
	iters: 200, epoch: 3 | loss: 0.6354377
	speed: 0.0087s/iter; left time: 221.8905s
Epoch: 3 cost time: 3.0617663860321045
Epoch: 3, Steps: 261 | Train Loss: 0.6011468 Vali Loss: 0.3150375 Test Loss: 0.4207101
Validation loss decreased (0.315225 --> 0.315038).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4472072
	speed: 0.0559s/iter; left time: 1409.2839s
	iters: 200, epoch: 4 | loss: 0.5478722
	speed: 0.0083s/iter; left time: 209.0285s
Epoch: 4 cost time: 2.919881820678711
Epoch: 4, Steps: 261 | Train Loss: 0.6005255 Vali Loss: 0.3152253 Test Loss: 0.4207075
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.6078964
	speed: 0.0571s/iter; left time: 1424.0720s
	iters: 200, epoch: 5 | loss: 0.6312242
	speed: 0.0084s/iter; left time: 207.7579s
Epoch: 5 cost time: 2.989352226257324
Epoch: 5, Steps: 261 | Train Loss: 0.6012431 Vali Loss: 0.3153703 Test Loss: 0.4207041
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.4484558
	speed: 0.0552s/iter; left time: 1364.2933s
	iters: 200, epoch: 6 | loss: 0.8653220
	speed: 0.0082s/iter; left time: 202.5404s
Epoch: 6 cost time: 2.946784257888794
Epoch: 6, Steps: 261 | Train Loss: 0.6013370 Vali Loss: 0.3151646 Test Loss: 0.4206998
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.6737713
	speed: 0.0551s/iter; left time: 1346.5822s
	iters: 200, epoch: 7 | loss: 0.5448313
	speed: 0.0086s/iter; left time: 210.0660s
Epoch: 7 cost time: 2.9784982204437256
Epoch: 7, Steps: 261 | Train Loss: 0.6016075 Vali Loss: 0.3154445 Test Loss: 0.4206959
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.5980948
	speed: 0.0587s/iter; left time: 1419.9990s
	iters: 200, epoch: 8 | loss: 0.6067842
	speed: 0.0090s/iter; left time: 216.0061s
Epoch: 8 cost time: 3.233480215072632
Epoch: 8, Steps: 261 | Train Loss: 0.6005672 Vali Loss: 0.3155826 Test Loss: 0.4206898
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.6652744
	speed: 0.0593s/iter; left time: 1417.3036s
	iters: 200, epoch: 9 | loss: 0.6115691
	speed: 0.0092s/iter; left time: 218.5596s
Epoch: 9 cost time: 3.2670323848724365
Epoch: 9, Steps: 261 | Train Loss: 0.6013647 Vali Loss: 0.3153549 Test Loss: 0.4206840
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.6089163
	speed: 0.0562s/iter; left time: 1328.1121s
	iters: 200, epoch: 10 | loss: 0.5468669
	speed: 0.0084s/iter; left time: 198.0663s
Epoch: 10 cost time: 3.0176122188568115
Epoch: 10, Steps: 261 | Train Loss: 0.6009425 Vali Loss: 0.3155969 Test Loss: 0.4206775
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.6066689
	speed: 0.0585s/iter; left time: 1369.4463s
	iters: 200, epoch: 11 | loss: 0.6486405
	speed: 0.0076s/iter; left time: 177.7069s
Epoch: 11 cost time: 2.942718505859375
Epoch: 11, Steps: 261 | Train Loss: 0.6008618 Vali Loss: 0.3154621 Test Loss: 0.4206671
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.5528046
	speed: 0.0566s/iter; left time: 1309.1654s
	iters: 200, epoch: 12 | loss: 0.7603638
	speed: 0.0078s/iter; left time: 179.7640s
Epoch: 12 cost time: 2.9944775104522705
Epoch: 12, Steps: 261 | Train Loss: 0.6009659 Vali Loss: 0.3154106 Test Loss: 0.4206589
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.5879101
	speed: 0.0564s/iter; left time: 1289.3069s
	iters: 200, epoch: 13 | loss: 0.5401726
	speed: 0.0078s/iter; left time: 176.6798s
Epoch: 13 cost time: 2.9591023921966553
Epoch: 13, Steps: 261 | Train Loss: 0.6008694 Vali Loss: 0.3152489 Test Loss: 0.4206510
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.5901891
	speed: 0.0567s/iter; left time: 1280.9601s
	iters: 200, epoch: 14 | loss: 0.5584013
	speed: 0.0085s/iter; left time: 191.8840s
Epoch: 14 cost time: 3.0747320652008057
Epoch: 14, Steps: 261 | Train Loss: 0.6014244 Vali Loss: 0.3153498 Test Loss: 0.4206391
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.7040517
	speed: 0.0601s/iter; left time: 1342.2522s
	iters: 200, epoch: 15 | loss: 0.6054320
	speed: 0.0081s/iter; left time: 180.5801s
Epoch: 15 cost time: 3.0635290145874023
Epoch: 15, Steps: 261 | Train Loss: 0.6006673 Vali Loss: 0.3152700 Test Loss: 0.4206307
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.4173960
	speed: 0.0584s/iter; left time: 1290.3377s
	iters: 200, epoch: 16 | loss: 0.6003792
	speed: 0.0084s/iter; left time: 185.0746s
Epoch: 16 cost time: 3.130708694458008
Epoch: 16, Steps: 261 | Train Loss: 0.6008224 Vali Loss: 0.3155130 Test Loss: 0.4206183
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.6088847
	speed: 0.0560s/iter; left time: 1221.9928s
	iters: 200, epoch: 17 | loss: 0.6710452
	speed: 0.0075s/iter; left time: 163.5327s
Epoch: 17 cost time: 2.7698607444763184
Epoch: 17, Steps: 261 | Train Loss: 0.6009214 Vali Loss: 0.3155805 Test Loss: 0.4206085
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.6224302
	speed: 0.0586s/iter; left time: 1262.7955s
	iters: 200, epoch: 18 | loss: 0.5527956
	speed: 0.0077s/iter; left time: 166.1309s
Epoch: 18 cost time: 3.024278163909912
Epoch: 18, Steps: 261 | Train Loss: 0.6007514 Vali Loss: 0.3155091 Test Loss: 0.4205979
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.6651194
	speed: 0.0604s/iter; left time: 1287.4779s
	iters: 200, epoch: 19 | loss: 0.4686133
	speed: 0.0075s/iter; left time: 158.1276s
Epoch: 19 cost time: 3.0082578659057617
Epoch: 19, Steps: 261 | Train Loss: 0.6009114 Vali Loss: 0.3155642 Test Loss: 0.4205848
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.6721659
	speed: 0.0574s/iter; left time: 1208.1338s
	iters: 200, epoch: 20 | loss: 0.8604014
	speed: 0.0081s/iter; left time: 169.3971s
Epoch: 20 cost time: 3.016947031021118
Epoch: 20, Steps: 261 | Train Loss: 0.6009857 Vali Loss: 0.3157357 Test Loss: 0.4205733
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.4426674
	speed: 0.0580s/iter; left time: 1205.8576s
	iters: 200, epoch: 21 | loss: 0.7225139
	speed: 0.0076s/iter; left time: 157.0829s
Epoch: 21 cost time: 3.0140576362609863
Epoch: 21, Steps: 261 | Train Loss: 0.6007966 Vali Loss: 0.3156279 Test Loss: 0.4205609
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.7102908
	speed: 0.0568s/iter; left time: 1165.2056s
	iters: 200, epoch: 22 | loss: 0.4948775
	speed: 0.0073s/iter; left time: 149.4687s
Epoch: 22 cost time: 2.8159284591674805
Epoch: 22, Steps: 261 | Train Loss: 0.6012588 Vali Loss: 0.3157140 Test Loss: 0.4205527
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.5095152
	speed: 0.0569s/iter; left time: 1153.1976s
	iters: 200, epoch: 23 | loss: 0.5600743
	speed: 0.0072s/iter; left time: 146.0127s
Epoch: 23 cost time: 2.9427287578582764
Epoch: 23, Steps: 261 | Train Loss: 0.6010727 Vali Loss: 0.3155670 Test Loss: 0.4205414
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTSFL_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.42071059346199036, mae:0.42295947670936584, rse:0.5207648873329163
