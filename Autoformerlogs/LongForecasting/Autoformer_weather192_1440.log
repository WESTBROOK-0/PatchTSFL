Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_192_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_1440_Autoformer_custom_ftM_sl192_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35256
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 1.1900312
	speed: 0.0741s/iter; left time: 1299.4549s
	iters: 200, epoch: 1 | loss: 1.2063484
	speed: 0.0518s/iter; left time: 902.7463s
	iters: 300, epoch: 1 | loss: 0.9158114
	speed: 0.0540s/iter; left time: 936.5144s
	iters: 400, epoch: 1 | loss: 0.9689390
	speed: 0.0579s/iter; left time: 997.0368s
	iters: 500, epoch: 1 | loss: 0.8674151
	speed: 0.0578s/iter; left time: 989.9528s
	iters: 600, epoch: 1 | loss: 0.8577753
	speed: 0.0561s/iter; left time: 954.9999s
	iters: 700, epoch: 1 | loss: 0.8390069
	speed: 0.0540s/iter; left time: 914.1028s
	iters: 800, epoch: 1 | loss: 1.0005236
	speed: 0.0538s/iter; left time: 905.5687s
	iters: 900, epoch: 1 | loss: 0.7493013
	speed: 0.0536s/iter; left time: 897.4899s
	iters: 1000, epoch: 1 | loss: 0.7434762
	speed: 0.0537s/iter; left time: 893.4558s
	iters: 1100, epoch: 1 | loss: 0.6918957
	speed: 0.0539s/iter; left time: 890.7780s
	iters: 1200, epoch: 1 | loss: 0.6471810
	speed: 0.0538s/iter; left time: 883.1457s
	iters: 1300, epoch: 1 | loss: 0.8003981
	speed: 0.0505s/iter; left time: 824.7604s
	iters: 1400, epoch: 1 | loss: 0.7204204
	speed: 0.0497s/iter; left time: 805.8288s
	iters: 1500, epoch: 1 | loss: 0.9586174
	speed: 0.0505s/iter; left time: 813.7279s
	iters: 1600, epoch: 1 | loss: 0.9515861
	speed: 0.0511s/iter; left time: 818.7413s
	iters: 1700, epoch: 1 | loss: 0.9886386
	speed: 0.0525s/iter; left time: 836.2115s
	iters: 1800, epoch: 1 | loss: 0.7343928
	speed: 0.0535s/iter; left time: 846.9784s
	iters: 1900, epoch: 1 | loss: 0.7068972
	speed: 0.0507s/iter; left time: 797.8286s
	iters: 2000, epoch: 1 | loss: 0.5447859
	speed: 0.0553s/iter; left time: 864.9910s
	iters: 2100, epoch: 1 | loss: 0.8110237
	speed: 0.0580s/iter; left time: 899.9629s
	iters: 2200, epoch: 1 | loss: 0.5970652
	speed: 0.0575s/iter; left time: 886.8924s
	iters: 2300, epoch: 1 | loss: 0.6178861
	speed: 0.0557s/iter; left time: 853.4568s
	iters: 2400, epoch: 1 | loss: 0.8382660
	speed: 0.0540s/iter; left time: 822.8044s
	iters: 2500, epoch: 1 | loss: 0.7323259
	speed: 0.0567s/iter; left time: 857.8024s
	iters: 2600, epoch: 1 | loss: 1.2275115
	speed: 0.0562s/iter; left time: 845.0731s
	iters: 2700, epoch: 1 | loss: 0.5205349
	speed: 0.0542s/iter; left time: 808.8722s
	iters: 2800, epoch: 1 | loss: 0.8775703
	speed: 0.0534s/iter; left time: 792.2492s
	iters: 2900, epoch: 1 | loss: 0.5802190
	speed: 0.0505s/iter; left time: 744.5278s
	iters: 3000, epoch: 1 | loss: 0.4804386
	speed: 0.0506s/iter; left time: 739.8935s
	iters: 3100, epoch: 1 | loss: 0.6798208
	speed: 0.0555s/iter; left time: 806.8289s
	iters: 3200, epoch: 1 | loss: 0.8382689
	speed: 0.0548s/iter; left time: 790.7667s
	iters: 3300, epoch: 1 | loss: 0.6089312
	speed: 0.0551s/iter; left time: 789.6910s
	iters: 3400, epoch: 1 | loss: 0.9129094
	speed: 0.0554s/iter; left time: 787.9260s
	iters: 3500, epoch: 1 | loss: 0.6164452
	speed: 0.0578s/iter; left time: 816.7527s
	iters: 3600, epoch: 1 | loss: 0.6668926
	speed: 0.0575s/iter; left time: 807.0513s
	iters: 3700, epoch: 1 | loss: 0.9488415
	speed: 0.0576s/iter; left time: 801.9843s
	iters: 3800, epoch: 1 | loss: 0.6990304
	speed: 0.0573s/iter; left time: 792.6089s
	iters: 3900, epoch: 1 | loss: 0.4915389
	speed: 0.0534s/iter; left time: 733.4385s
	iters: 4000, epoch: 1 | loss: 0.6188183
	speed: 0.0536s/iter; left time: 730.0777s
	iters: 4100, epoch: 1 | loss: 0.5649334
	speed: 0.0579s/iter; left time: 783.3083s
	iters: 4200, epoch: 1 | loss: 0.6683741
	speed: 0.0571s/iter; left time: 767.3643s
	iters: 4300, epoch: 1 | loss: 1.2021136
	speed: 0.0579s/iter; left time: 771.3078s
	iters: 4400, epoch: 1 | loss: 1.2271922
	speed: 0.0576s/iter; left time: 762.4192s
	iters: 4500, epoch: 1 | loss: 0.5783838
	speed: 0.0573s/iter; left time: 752.1504s
	iters: 4600, epoch: 1 | loss: 0.6089955
	speed: 0.0570s/iter; left time: 742.4245s
	iters: 4700, epoch: 1 | loss: 0.6995713
	speed: 0.0516s/iter; left time: 667.3597s
	iters: 4800, epoch: 1 | loss: 0.6678659
	speed: 0.0505s/iter; left time: 648.4370s
	iters: 4900, epoch: 1 | loss: 0.4392797
	speed: 0.0513s/iter; left time: 653.0666s
	iters: 5000, epoch: 1 | loss: 0.9353985
	speed: 0.0558s/iter; left time: 705.2195s
	iters: 5100, epoch: 1 | loss: 1.1120924
	speed: 0.0566s/iter; left time: 709.5048s
	iters: 5200, epoch: 1 | loss: 0.6247116
	speed: 0.0563s/iter; left time: 699.7785s
	iters: 5300, epoch: 1 | loss: 0.7012384
	speed: 0.0561s/iter; left time: 692.1642s
	iters: 5400, epoch: 1 | loss: 0.6525869
	speed: 0.0573s/iter; left time: 700.8154s
	iters: 5500, epoch: 1 | loss: 0.5229255
	speed: 0.0571s/iter; left time: 692.4118s
	iters: 5600, epoch: 1 | loss: 0.7648865
	speed: 0.0575s/iter; left time: 692.2427s
	iters: 5700, epoch: 1 | loss: 1.0950686
	speed: 0.0578s/iter; left time: 689.1971s
	iters: 5800, epoch: 1 | loss: 0.5994720
	speed: 0.0561s/iter; left time: 663.9537s
	iters: 5900, epoch: 1 | loss: 0.7598719
	speed: 0.0509s/iter; left time: 597.5887s
	iters: 6000, epoch: 1 | loss: 0.5402262
	speed: 0.0504s/iter; left time: 585.5525s
	iters: 6100, epoch: 1 | loss: 0.6556172
	speed: 0.0501s/iter; left time: 577.1820s
	iters: 6200, epoch: 1 | loss: 0.6643811
	speed: 0.0503s/iter; left time: 574.3943s
	iters: 6300, epoch: 1 | loss: 0.8553681
	speed: 0.0502s/iter; left time: 568.5045s
	iters: 6400, epoch: 1 | loss: 0.5240151
	speed: 0.0502s/iter; left time: 563.6060s
	iters: 6500, epoch: 1 | loss: 0.6464651
	speed: 0.0502s/iter; left time: 558.4992s
	iters: 6600, epoch: 1 | loss: 0.9827077
	speed: 0.0503s/iter; left time: 554.5723s
	iters: 6700, epoch: 1 | loss: 0.7412697
	speed: 0.0502s/iter; left time: 548.5683s
	iters: 6800, epoch: 1 | loss: 1.1530360
	speed: 0.0505s/iter; left time: 546.7684s
	iters: 6900, epoch: 1 | loss: 0.8856868
	speed: 0.0546s/iter; left time: 585.5191s
	iters: 7000, epoch: 1 | loss: 0.6944323
	speed: 0.0567s/iter; left time: 603.1582s
	iters: 7100, epoch: 1 | loss: 0.7695181
	speed: 0.0544s/iter; left time: 572.7049s
	iters: 7200, epoch: 1 | loss: 0.5038382
	speed: 0.0527s/iter; left time: 549.9298s
	iters: 7300, epoch: 1 | loss: 0.5276976
	speed: 0.0558s/iter; left time: 576.7843s
	iters: 7400, epoch: 1 | loss: 0.4700558
	speed: 0.0571s/iter; left time: 584.4444s
	iters: 7500, epoch: 1 | loss: 0.5945236
	speed: 0.0574s/iter; left time: 581.0345s
	iters: 7600, epoch: 1 | loss: 0.5118142
	speed: 0.0552s/iter; left time: 553.7227s
	iters: 7700, epoch: 1 | loss: 0.7678616
	speed: 0.0554s/iter; left time: 550.2187s
	iters: 7800, epoch: 1 | loss: 0.7256783
	speed: 0.0584s/iter; left time: 573.8823s
	iters: 7900, epoch: 1 | loss: 0.4822312
	speed: 0.0577s/iter; left time: 561.3922s
	iters: 8000, epoch: 1 | loss: 1.1066169
	speed: 0.0577s/iter; left time: 555.6564s
	iters: 8100, epoch: 1 | loss: 1.1753067
	speed: 0.0515s/iter; left time: 491.1439s
	iters: 8200, epoch: 1 | loss: 0.6227493
	speed: 0.0522s/iter; left time: 492.2273s
	iters: 8300, epoch: 1 | loss: 0.6701101
	speed: 0.0539s/iter; left time: 502.7784s
	iters: 8400, epoch: 1 | loss: 0.9219052
	speed: 0.0505s/iter; left time: 466.2548s
	iters: 8500, epoch: 1 | loss: 1.3224829
	speed: 0.0501s/iter; left time: 457.1604s
	iters: 8600, epoch: 1 | loss: 0.5904143
	speed: 0.0504s/iter; left time: 454.8993s
	iters: 8700, epoch: 1 | loss: 0.9700230
	speed: 0.0500s/iter; left time: 446.2911s
	iters: 8800, epoch: 1 | loss: 0.8005392
	speed: 0.0499s/iter; left time: 440.6356s
Epoch: 1 cost time: 479.5532953739166
Epoch: 1, Steps: 8814 | Train Loss: 0.8013214 Vali Loss: 0.8311032 Test Loss: 0.4570572
Validation loss decreased (inf --> 0.831103).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6284925
	speed: 1.1437s/iter; left time: 9967.4639s
	iters: 200, epoch: 2 | loss: 0.6576263
	speed: 0.0518s/iter; left time: 446.6612s
	iters: 300, epoch: 2 | loss: 0.8119374
	speed: 0.0514s/iter; left time: 437.9543s
	iters: 400, epoch: 2 | loss: 0.8229288
	speed: 0.0504s/iter; left time: 424.3105s
	iters: 500, epoch: 2 | loss: 0.9253446
	speed: 0.0503s/iter; left time: 418.1434s
	iters: 600, epoch: 2 | loss: 0.6416140
	speed: 0.0505s/iter; left time: 414.9716s
	iters: 700, epoch: 2 | loss: 0.5399618
	speed: 0.0505s/iter; left time: 410.0578s
	iters: 800, epoch: 2 | loss: 0.5115297
	speed: 0.0505s/iter; left time: 404.8508s
	iters: 900, epoch: 2 | loss: 0.4285080
	speed: 0.0501s/iter; left time: 396.7924s
	iters: 1000, epoch: 2 | loss: 0.5062879
	speed: 0.0504s/iter; left time: 393.5427s
	iters: 1100, epoch: 2 | loss: 0.7539107
	speed: 0.0507s/iter; left time: 391.4734s
	iters: 1200, epoch: 2 | loss: 1.1140546
	speed: 0.0503s/iter; left time: 382.6761s
	iters: 1300, epoch: 2 | loss: 0.8180324
	speed: 0.0507s/iter; left time: 381.1422s
	iters: 1400, epoch: 2 | loss: 0.6866601
	speed: 0.0504s/iter; left time: 374.0700s
	iters: 1500, epoch: 2 | loss: 0.4200030
	speed: 0.0505s/iter; left time: 369.7335s
	iters: 1600, epoch: 2 | loss: 0.6150592
	speed: 0.0502s/iter; left time: 362.5352s
	iters: 1700, epoch: 2 | loss: 0.5916874
	speed: 0.0504s/iter; left time: 358.2967s
	iters: 1800, epoch: 2 | loss: 0.7436203
	speed: 0.0506s/iter; left time: 354.7989s
	iters: 1900, epoch: 2 | loss: 0.9394640
	speed: 0.0502s/iter; left time: 346.8057s
	iters: 2000, epoch: 2 | loss: 0.5638335
	speed: 0.0505s/iter; left time: 344.2713s
	iters: 2100, epoch: 2 | loss: 0.8209143
	speed: 0.0503s/iter; left time: 337.8394s
	iters: 2200, epoch: 2 | loss: 0.5592168
	speed: 0.0504s/iter; left time: 333.0762s
	iters: 2300, epoch: 2 | loss: 0.5771155
	speed: 0.0511s/iter; left time: 332.6441s
	iters: 2400, epoch: 2 | loss: 0.9563916
	speed: 0.0509s/iter; left time: 326.5173s
	iters: 2500, epoch: 2 | loss: 0.6173277
	speed: 0.0517s/iter; left time: 326.7956s
	iters: 2600, epoch: 2 | loss: 0.6612815
	speed: 0.0490s/iter; left time: 304.6694s
	iters: 2700, epoch: 2 | loss: 0.5244864
	speed: 0.0514s/iter; left time: 314.5676s
	iters: 2800, epoch: 2 | loss: 0.8404015
	speed: 0.0530s/iter; left time: 318.6643s
	iters: 2900, epoch: 2 | loss: 0.5157216
	speed: 0.0528s/iter; left time: 312.4529s
	iters: 3000, epoch: 2 | loss: 1.0444636
	speed: 0.0563s/iter; left time: 327.4672s
	iters: 3100, epoch: 2 | loss: 1.0422499
	speed: 0.0578s/iter; left time: 330.5782s
	iters: 3200, epoch: 2 | loss: 1.1010822
	speed: 0.0560s/iter; left time: 314.3951s
	iters: 3300, epoch: 2 | loss: 0.5642913
	speed: 0.0541s/iter; left time: 298.4591s
	iters: 3400, epoch: 2 | loss: 0.4498404
	speed: 0.0506s/iter; left time: 273.8953s
	iters: 3500, epoch: 2 | loss: 0.7070192
	speed: 0.0559s/iter; left time: 297.1324s
	iters: 3600, epoch: 2 | loss: 0.4654651
	speed: 0.0565s/iter; left time: 294.8896s
	iters: 3700, epoch: 2 | loss: 0.4177143
	speed: 0.0571s/iter; left time: 292.1891s
	iters: 3800, epoch: 2 | loss: 0.6596125
	speed: 0.0570s/iter; left time: 285.6467s
	iters: 3900, epoch: 2 | loss: 0.5942190
	speed: 0.0566s/iter; left time: 278.4196s
	iters: 4000, epoch: 2 | loss: 1.3531625
	speed: 0.0566s/iter; left time: 272.3623s
	iters: 4100, epoch: 2 | loss: 0.8636175
	speed: 0.0564s/iter; left time: 265.7794s
	iters: 4200, epoch: 2 | loss: 0.8496037
	speed: 0.0571s/iter; left time: 263.3492s
	iters: 4300, epoch: 2 | loss: 1.0998489
	speed: 0.0559s/iter; left time: 252.2186s
	iters: 4400, epoch: 2 | loss: 0.8070506
	speed: 0.0545s/iter; left time: 240.5491s
	iters: 4500, epoch: 2 | loss: 0.7216288
	speed: 0.0524s/iter; left time: 226.0053s
	iters: 4600, epoch: 2 | loss: 1.0777028
	speed: 0.0557s/iter; left time: 234.5910s
	iters: 4700, epoch: 2 | loss: 0.5563180
	speed: 0.0573s/iter; left time: 235.6691s
	iters: 4800, epoch: 2 | loss: 0.8454781
	speed: 0.0605s/iter; left time: 242.9544s
	iters: 4900, epoch: 2 | loss: 0.9046147
	speed: 0.0571s/iter; left time: 223.4726s
	iters: 5000, epoch: 2 | loss: 1.6326071
	speed: 0.0579s/iter; left time: 220.7519s
	iters: 5100, epoch: 2 | loss: 0.6886220
	speed: 0.0572s/iter; left time: 212.5551s
	iters: 5200, epoch: 2 | loss: 0.6620070
	speed: 0.0557s/iter; left time: 201.1873s
	iters: 5300, epoch: 2 | loss: 0.4970434
	speed: 0.0541s/iter; left time: 190.2495s
	iters: 5400, epoch: 2 | loss: 0.8261725
	speed: 0.0577s/iter; left time: 196.9833s
	iters: 5500, epoch: 2 | loss: 0.5393333
	speed: 0.0575s/iter; left time: 190.6978s
	iters: 5600, epoch: 2 | loss: 0.7579468
	speed: 0.0579s/iter; left time: 186.0955s
	iters: 5700, epoch: 2 | loss: 0.4748462
	speed: 0.0571s/iter; left time: 177.9494s
	iters: 5800, epoch: 2 | loss: 0.6099321
	speed: 0.0571s/iter; left time: 172.2731s
	iters: 5900, epoch: 2 | loss: 1.0835363
	speed: 0.0580s/iter; left time: 169.0802s
	iters: 6000, epoch: 2 | loss: 0.6991631
	speed: 0.0580s/iter; left time: 163.3017s
	iters: 6100, epoch: 2 | loss: 0.5794825
	speed: 0.0578s/iter; left time: 156.9106s
	iters: 6200, epoch: 2 | loss: 1.1318033
	speed: 0.0577s/iter; left time: 151.0126s
	iters: 6300, epoch: 2 | loss: 0.7301674
	speed: 0.0578s/iter; left time: 145.4746s
	iters: 6400, epoch: 2 | loss: 1.3607794
	speed: 0.0572s/iter; left time: 138.1699s
	iters: 6500, epoch: 2 | loss: 0.6284069
	speed: 0.0577s/iter; left time: 133.6635s
	iters: 6600, epoch: 2 | loss: 0.6004987
	speed: 0.0575s/iter; left time: 127.4376s
	iters: 6700, epoch: 2 | loss: 0.9540692
	speed: 0.0568s/iter; left time: 120.1907s
	iters: 6800, epoch: 2 | loss: 0.5594623
	speed: 0.0566s/iter; left time: 114.1127s
	iters: 6900, epoch: 2 | loss: 0.5148435
	speed: 0.0576s/iter; left time: 110.3419s
	iters: 7000, epoch: 2 | loss: 0.6105371
	speed: 0.0579s/iter; left time: 105.0329s
	iters: 7100, epoch: 2 | loss: 1.3674319
	speed: 0.0575s/iter; left time: 98.6069s
	iters: 7200, epoch: 2 | loss: 0.6685796
	speed: 0.0543s/iter; left time: 87.6910s
	iters: 7300, epoch: 2 | loss: 0.4744975
	speed: 0.0527s/iter; left time: 79.9036s
	iters: 7400, epoch: 2 | loss: 1.0162190
	speed: 0.0505s/iter; left time: 71.4478s
	iters: 7500, epoch: 2 | loss: 0.6636839
	speed: 0.0506s/iter; left time: 66.5019s
	iters: 7600, epoch: 2 | loss: 0.5189968
	speed: 0.0509s/iter; left time: 61.8833s
	iters: 7700, epoch: 2 | loss: 0.4904561
	speed: 0.0504s/iter; left time: 56.2474s
	iters: 7800, epoch: 2 | loss: 0.5025237
	speed: 0.0502s/iter; left time: 50.9370s
	iters: 7900, epoch: 2 | loss: 0.5473477
	speed: 0.0509s/iter; left time: 46.6059s
	iters: 8000, epoch: 2 | loss: 0.4780702
	speed: 0.0540s/iter; left time: 44.0076s
	iters: 8100, epoch: 2 | loss: 0.5270209
	speed: 0.0516s/iter; left time: 36.8844s
	iters: 8200, epoch: 2 | loss: 0.4938393
	speed: 0.0511s/iter; left time: 31.4350s
	iters: 8300, epoch: 2 | loss: 0.6787381
	speed: 0.0545s/iter; left time: 28.0658s
	iters: 8400, epoch: 2 | loss: 0.5491526
	speed: 0.0570s/iter; left time: 23.6456s
	iters: 8500, epoch: 2 | loss: 0.5499773
	speed: 0.0538s/iter; left time: 16.9564s
	iters: 8600, epoch: 2 | loss: 0.5339976
	speed: 0.0537s/iter; left time: 11.5462s
	iters: 8700, epoch: 2 | loss: 0.6522779
	speed: 0.0530s/iter; left time: 6.0991s
	iters: 8800, epoch: 2 | loss: 1.2215989
	speed: 0.0506s/iter; left time: 0.7597s
Epoch: 2 cost time: 477.4991991519928
Epoch: 2, Steps: 8814 | Train Loss: 0.7092493 Vali Loss: 0.8545289 Test Loss: 0.5319844
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_1440_Autoformer_custom_ftM_sl192_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:0.45705631375312805, mae:0.4469706118106842, rse:0.8932453393936157
