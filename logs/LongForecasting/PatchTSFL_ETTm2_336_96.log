Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : 336_96_PatchTSFL_ETTm2_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5696134
	speed: 0.0898s/iter; left time: 2380.8126s
	iters: 200, epoch: 1 | loss: 0.3333133
	speed: 0.0714s/iter; left time: 1884.3930s
Epoch: 1 cost time: 21.00047254562378
Epoch: 1, Steps: 266 | Train Loss: 0.4275058 Vali Loss: 0.2057465 Test Loss: 0.2778348
Validation loss decreased (inf --> 0.205747).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.6320373
	speed: 0.2187s/iter; left time: 5737.6406s
	iters: 200, epoch: 2 | loss: 0.3900479
	speed: 0.0708s/iter; left time: 1850.5154s
Epoch: 2 cost time: 21.353551149368286
Epoch: 2, Steps: 266 | Train Loss: 0.3993263 Vali Loss: 0.1954054 Test Loss: 0.2632502
Validation loss decreased (0.205747 --> 0.195405).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.3448390
	speed: 0.2168s/iter; left time: 5629.6974s
	iters: 200, epoch: 3 | loss: 0.3495375
	speed: 0.0703s/iter; left time: 1817.5395s
Epoch: 3 cost time: 21.58651351928711
Epoch: 3, Steps: 266 | Train Loss: 0.3756663 Vali Loss: 0.1771105 Test Loss: 0.2366157
Validation loss decreased (0.195405 --> 0.177110).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3145765
	speed: 0.2211s/iter; left time: 5682.3010s
	iters: 200, epoch: 4 | loss: 0.3252400
	speed: 0.0710s/iter; left time: 1817.3693s
Epoch: 4 cost time: 21.487737894058228
Epoch: 4, Steps: 266 | Train Loss: 0.3130112 Vali Loss: 0.1427548 Test Loss: 0.2059738
Validation loss decreased (0.177110 --> 0.142755).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.3107816
	speed: 0.2190s/iter; left time: 5571.7892s
	iters: 200, epoch: 5 | loss: 0.2348322
	speed: 0.0710s/iter; left time: 1797.7013s
Epoch: 5 cost time: 21.279006719589233
Epoch: 5, Steps: 266 | Train Loss: 0.2652408 Vali Loss: 0.1347560 Test Loss: 0.1978713
Validation loss decreased (0.142755 --> 0.134756).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2562840
	speed: 0.2209s/iter; left time: 5560.4270s
	iters: 200, epoch: 6 | loss: 0.2492109
	speed: 0.0717s/iter; left time: 1796.4658s
Epoch: 6 cost time: 21.49168610572815
Epoch: 6, Steps: 266 | Train Loss: 0.2516857 Vali Loss: 0.1311807 Test Loss: 0.1918789
Validation loss decreased (0.134756 --> 0.131181).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2337490
	speed: 0.2072s/iter; left time: 5161.0480s
	iters: 200, epoch: 7 | loss: 0.2632912
	speed: 0.0712s/iter; left time: 1767.3437s
Epoch: 7 cost time: 21.150362968444824
Epoch: 7, Steps: 266 | Train Loss: 0.2428677 Vali Loss: 0.1294125 Test Loss: 0.1893253
Validation loss decreased (0.131181 --> 0.129413).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2324264
	speed: 0.2121s/iter; left time: 5226.6916s
	iters: 200, epoch: 8 | loss: 0.1864242
	speed: 0.0709s/iter; left time: 1738.8604s
Epoch: 8 cost time: 21.1402907371521
Epoch: 8, Steps: 266 | Train Loss: 0.2361836 Vali Loss: 0.1269828 Test Loss: 0.1846889
Validation loss decreased (0.129413 --> 0.126983).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.1969858
	speed: 0.2064s/iter; left time: 5030.8890s
	iters: 200, epoch: 9 | loss: 0.2696032
	speed: 0.0705s/iter; left time: 1711.5982s
Epoch: 9 cost time: 20.884275197982788
Epoch: 9, Steps: 266 | Train Loss: 0.2300959 Vali Loss: 0.1260083 Test Loss: 0.1814547
Validation loss decreased (0.126983 --> 0.126008).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.1893375
	speed: 0.2062s/iter; left time: 4970.6272s
	iters: 200, epoch: 10 | loss: 0.2198931
	speed: 0.0707s/iter; left time: 1698.4448s
Epoch: 10 cost time: 20.81875443458557
Epoch: 10, Steps: 266 | Train Loss: 0.2254011 Vali Loss: 0.1249476 Test Loss: 0.1814794
Validation loss decreased (0.126008 --> 0.124948).  Saving model ...
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.1776656
	speed: 0.2058s/iter; left time: 4906.2988s
	iters: 200, epoch: 11 | loss: 0.2088363
	speed: 0.0704s/iter; left time: 1670.7168s
Epoch: 11 cost time: 20.81587505340576
Epoch: 11, Steps: 266 | Train Loss: 0.2201916 Vali Loss: 0.1236613 Test Loss: 0.1778425
Validation loss decreased (0.124948 --> 0.123661).  Saving model ...
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.1921244
	speed: 0.2100s/iter; left time: 4950.0461s
	iters: 200, epoch: 12 | loss: 0.2061917
	speed: 0.0706s/iter; left time: 1656.7714s
Epoch: 12 cost time: 21.09852910041809
Epoch: 12, Steps: 266 | Train Loss: 0.2164047 Vali Loss: 0.1228100 Test Loss: 0.1786448
Validation loss decreased (0.123661 --> 0.122810).  Saving model ...
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.2087734
	speed: 0.2076s/iter; left time: 4838.7607s
	iters: 200, epoch: 13 | loss: 0.1822337
	speed: 0.0710s/iter; left time: 1648.7190s
Epoch: 13 cost time: 20.946798086166382
Epoch: 13, Steps: 266 | Train Loss: 0.2121341 Vali Loss: 0.1220538 Test Loss: 0.1764173
Validation loss decreased (0.122810 --> 0.122054).  Saving model ...
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.1726196
	speed: 0.2058s/iter; left time: 4743.3847s
	iters: 200, epoch: 14 | loss: 0.1683273
	speed: 0.0705s/iter; left time: 1618.0120s
Epoch: 14 cost time: 21.025810956954956
Epoch: 14, Steps: 266 | Train Loss: 0.2086245 Vali Loss: 0.1217111 Test Loss: 0.1774664
Validation loss decreased (0.122054 --> 0.121711).  Saving model ...
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.1825045
	speed: 0.2254s/iter; left time: 5134.3042s
	iters: 200, epoch: 15 | loss: 0.1755741
	speed: 0.0706s/iter; left time: 1601.3798s
Epoch: 15 cost time: 21.710429906845093
Epoch: 15, Steps: 266 | Train Loss: 0.2045978 Vali Loss: 0.1217286 Test Loss: 0.1745460
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.1996712
	speed: 0.2055s/iter; left time: 4627.1210s
	iters: 200, epoch: 16 | loss: 0.2121973
	speed: 0.0710s/iter; left time: 1591.3188s
Epoch: 16 cost time: 21.00457000732422
Epoch: 16, Steps: 266 | Train Loss: 0.2007033 Vali Loss: 0.1220566 Test Loss: 0.1730981
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.1493462
	speed: 0.2186s/iter; left time: 4862.7867s
	iters: 200, epoch: 17 | loss: 0.1211246
	speed: 0.0721s/iter; left time: 1596.6958s
Epoch: 17 cost time: 21.31337261199951
Epoch: 17, Steps: 266 | Train Loss: 0.1972816 Vali Loss: 0.1202413 Test Loss: 0.1729046
Validation loss decreased (0.121711 --> 0.120241).  Saving model ...
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2149655
	speed: 0.2031s/iter; left time: 4463.0379s
	iters: 200, epoch: 18 | loss: 0.1854527
	speed: 0.0704s/iter; left time: 1539.2928s
Epoch: 18 cost time: 20.86873149871826
Epoch: 18, Steps: 266 | Train Loss: 0.1937444 Vali Loss: 0.1209735 Test Loss: 0.1717514
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.1624435
	speed: 0.2081s/iter; left time: 4519.5473s
	iters: 200, epoch: 19 | loss: 0.2284597
	speed: 0.0705s/iter; left time: 1522.8000s
Epoch: 19 cost time: 21.077834844589233
Epoch: 19, Steps: 266 | Train Loss: 0.1905658 Vali Loss: 0.1224039 Test Loss: 0.1749324
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2363106
	speed: 0.2146s/iter; left time: 4603.3891s
	iters: 200, epoch: 20 | loss: 0.1665320
	speed: 0.0711s/iter; left time: 1518.7815s
Epoch: 20 cost time: 21.23208260536194
Epoch: 20, Steps: 266 | Train Loss: 0.1872890 Vali Loss: 0.1221271 Test Loss: 0.1754473
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.1572005
	speed: 0.2105s/iter; left time: 4459.0834s
	iters: 200, epoch: 21 | loss: 0.1671314
	speed: 0.0702s/iter; left time: 1479.7784s
Epoch: 21 cost time: 21.190480709075928
Epoch: 21, Steps: 266 | Train Loss: 0.1842243 Vali Loss: 0.1222279 Test Loss: 0.1726977
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.1614282
	speed: 0.2134s/iter; left time: 4463.0834s
	iters: 200, epoch: 22 | loss: 0.1740916
	speed: 0.0706s/iter; left time: 1469.1441s
Epoch: 22 cost time: 21.28518271446228
Epoch: 22, Steps: 266 | Train Loss: 0.1811199 Vali Loss: 0.1214137 Test Loss: 0.1717554
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.2107361
	speed: 0.2217s/iter; left time: 4577.1924s
	iters: 200, epoch: 23 | loss: 0.1633748
	speed: 0.0710s/iter; left time: 1459.8802s
Epoch: 23 cost time: 21.414372444152832
Epoch: 23, Steps: 266 | Train Loss: 0.1786127 Vali Loss: 0.1212024 Test Loss: 0.1726745
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.1455220
	speed: 0.2134s/iter; left time: 4350.4145s
	iters: 200, epoch: 24 | loss: 0.1641895
	speed: 0.0707s/iter; left time: 1434.9857s
Epoch: 24 cost time: 21.073853492736816
Epoch: 24, Steps: 266 | Train Loss: 0.1759425 Vali Loss: 0.1220489 Test Loss: 0.1740443
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.1315176
	speed: 0.2075s/iter; left time: 4175.0448s
	iters: 200, epoch: 25 | loss: 0.1592068
	speed: 0.0710s/iter; left time: 1420.3378s
Epoch: 25 cost time: 21.011163473129272
Epoch: 25, Steps: 266 | Train Loss: 0.1734354 Vali Loss: 0.1225799 Test Loss: 0.1737133
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.1682813
	speed: 0.2060s/iter; left time: 4089.1784s
	iters: 200, epoch: 26 | loss: 0.1289100
	speed: 0.0705s/iter; left time: 1392.9849s
Epoch: 26 cost time: 20.992746353149414
Epoch: 26, Steps: 266 | Train Loss: 0.1714423 Vali Loss: 0.1235705 Test Loss: 0.1783906
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.1778155
	speed: 0.2025s/iter; left time: 3965.3244s
	iters: 200, epoch: 27 | loss: 0.1346296
	speed: 0.0709s/iter; left time: 1380.9719s
Epoch: 27 cost time: 20.714778661727905
Epoch: 27, Steps: 266 | Train Loss: 0.1700153 Vali Loss: 0.1223104 Test Loss: 0.1754359
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.1692672
	speed: 0.2136s/iter; left time: 4126.5004s
	iters: 200, epoch: 28 | loss: 0.1631649
	speed: 0.0705s/iter; left time: 1354.5384s
Epoch: 28 cost time: 21.126723051071167
Epoch: 28, Steps: 266 | Train Loss: 0.1676545 Vali Loss: 0.1243803 Test Loss: 0.1771161
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.1831515
	speed: 0.2023s/iter; left time: 3854.1326s
	iters: 200, epoch: 29 | loss: 0.1900554
	speed: 0.0698s/iter; left time: 1322.2319s
Epoch: 29 cost time: 20.576775074005127
Epoch: 29, Steps: 266 | Train Loss: 0.1660213 Vali Loss: 0.1244860 Test Loss: 0.1760779
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.1395148
	speed: 0.2144s/iter; left time: 4028.4397s
	iters: 200, epoch: 30 | loss: 0.1498026
	speed: 0.0707s/iter; left time: 1321.7723s
Epoch: 30 cost time: 21.07782006263733
Epoch: 30, Steps: 266 | Train Loss: 0.1645322 Vali Loss: 0.1263771 Test Loss: 0.1780281
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.59486415263404e-05
	iters: 100, epoch: 31 | loss: 0.1209822
	speed: 0.2226s/iter; left time: 4122.3128s
	iters: 200, epoch: 31 | loss: 0.1506144
	speed: 0.0731s/iter; left time: 1346.3219s
Epoch: 31 cost time: 21.905458688735962
Epoch: 31, Steps: 266 | Train Loss: 0.1624735 Vali Loss: 0.1250263 Test Loss: 0.1771831
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.850661944740828e-05
	iters: 100, epoch: 32 | loss: 0.1265617
	speed: 0.2321s/iter; left time: 4236.8306s
	iters: 200, epoch: 32 | loss: 0.1734835
	speed: 0.0738s/iter; left time: 1340.4517s
Epoch: 32 cost time: 21.872017860412598
Epoch: 32, Steps: 266 | Train Loss: 0.1602773 Vali Loss: 0.1249990 Test Loss: 0.1787607
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.083947962827694e-05
	iters: 100, epoch: 33 | loss: 0.2119095
	speed: 0.2313s/iter; left time: 4160.7595s
	iters: 200, epoch: 33 | loss: 0.1526107
	speed: 0.0736s/iter; left time: 1316.4410s
Epoch: 33 cost time: 21.86159372329712
Epoch: 33, Steps: 266 | Train Loss: 0.1591596 Vali Loss: 0.1278631 Test Loss: 0.1785816
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.293283650764084e-05
	iters: 100, epoch: 34 | loss: 0.1737691
	speed: 0.2149s/iter; left time: 3809.0898s
	iters: 200, epoch: 34 | loss: 0.1837892
	speed: 0.0722s/iter; left time: 1272.6061s
Epoch: 34 cost time: 21.757728576660156
Epoch: 34, Steps: 266 | Train Loss: 0.1572333 Vali Loss: 0.1252666 Test Loss: 0.1771140
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.477378141914727e-05
	iters: 100, epoch: 35 | loss: 0.1502817
	speed: 0.2153s/iter; left time: 3758.9036s
	iters: 200, epoch: 35 | loss: 0.1350752
	speed: 0.0711s/iter; left time: 1233.8038s
Epoch: 35 cost time: 21.5301353931427
Epoch: 35, Steps: 266 | Train Loss: 0.1555574 Vali Loss: 0.1292666 Test Loss: 0.1786187
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.635096219257111e-05
	iters: 100, epoch: 36 | loss: 0.1550371
	speed: 0.2291s/iter; left time: 3937.9564s
	iters: 200, epoch: 36 | loss: 0.1280347
	speed: 0.0713s/iter; left time: 1218.7713s
Epoch: 36 cost time: 21.419793367385864
Epoch: 36, Steps: 266 | Train Loss: 0.1543415 Vali Loss: 0.1289227 Test Loss: 0.1799760
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.765465315687045e-05
	iters: 100, epoch: 37 | loss: 0.1384159
	speed: 0.2162s/iter; left time: 3658.4073s
	iters: 200, epoch: 37 | loss: 0.1413161
	speed: 0.0737s/iter; left time: 1240.1933s
Epoch: 37 cost time: 22.071064233779907
Epoch: 37, Steps: 266 | Train Loss: 0.1529939 Vali Loss: 0.1272714 Test Loss: 0.1787300
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTSFL_ETTm2_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17290449142456055, mae:0.2600278854370117, rse:0.3368595540523529
