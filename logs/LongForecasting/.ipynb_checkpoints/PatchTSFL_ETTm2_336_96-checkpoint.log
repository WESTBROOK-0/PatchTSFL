Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_96', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_96_PatchTSFL_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3294898
	speed: 0.0157s/iter; left time: 415.5984s
	iters: 200, epoch: 1 | loss: 0.3854650
	speed: 0.0064s/iter; left time: 167.6848s
Epoch: 1 cost time: 2.749469757080078
Epoch: 1, Steps: 266 | Train Loss: 0.3911123 Vali Loss: 0.2053401 Test Loss: 0.2757443
Validation loss decreased (inf --> 0.205340).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.4041877
	speed: 0.0492s/iter; left time: 1291.4236s
	iters: 200, epoch: 2 | loss: 0.5571952
	speed: 0.0065s/iter; left time: 170.5487s
Epoch: 2 cost time: 2.6182916164398193
Epoch: 2, Steps: 266 | Train Loss: 0.3911899 Vali Loss: 0.2052878 Test Loss: 0.2757407
Validation loss decreased (0.205340 --> 0.205288).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2799777
	speed: 0.0487s/iter; left time: 1265.3437s
	iters: 200, epoch: 3 | loss: 0.3040937
	speed: 0.0067s/iter; left time: 173.6053s
Epoch: 3 cost time: 2.744129180908203
Epoch: 3, Steps: 266 | Train Loss: 0.3913026 Vali Loss: 0.2053105 Test Loss: 0.2757360
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.4418648
	speed: 0.0511s/iter; left time: 1313.7149s
	iters: 200, epoch: 4 | loss: 0.3374422
	speed: 0.0067s/iter; left time: 170.6958s
Epoch: 4 cost time: 2.6733744144439697
Epoch: 4, Steps: 266 | Train Loss: 0.3911111 Vali Loss: 0.2053954 Test Loss: 0.2757311
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2988969
	speed: 0.0504s/iter; left time: 1282.0120s
	iters: 200, epoch: 5 | loss: 0.3748672
	speed: 0.0067s/iter; left time: 168.6064s
Epoch: 5 cost time: 2.734886646270752
Epoch: 5, Steps: 266 | Train Loss: 0.3899319 Vali Loss: 0.2053562 Test Loss: 0.2757256
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.4417293
	speed: 0.0492s/iter; left time: 1237.6108s
	iters: 200, epoch: 6 | loss: 0.3499606
	speed: 0.0064s/iter; left time: 161.4090s
Epoch: 6 cost time: 2.6824302673339844
Epoch: 6, Steps: 266 | Train Loss: 0.3906926 Vali Loss: 0.2054731 Test Loss: 0.2757187
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2617633
	speed: 0.0486s/iter; left time: 1209.4121s
	iters: 200, epoch: 7 | loss: 0.3260612
	speed: 0.0067s/iter; left time: 165.0945s
Epoch: 7 cost time: 2.581707000732422
Epoch: 7, Steps: 266 | Train Loss: 0.3911616 Vali Loss: 0.2052955 Test Loss: 0.2757100
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.3574761
	speed: 0.0475s/iter; left time: 1171.2809s
	iters: 200, epoch: 8 | loss: 0.3709167
	speed: 0.0065s/iter; left time: 159.1054s
Epoch: 8 cost time: 2.605405569076538
Epoch: 8, Steps: 266 | Train Loss: 0.3911998 Vali Loss: 0.2055254 Test Loss: 0.2756999
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2771702
	speed: 0.0492s/iter; left time: 1199.4382s
	iters: 200, epoch: 9 | loss: 0.4020654
	speed: 0.0064s/iter; left time: 155.2900s
Epoch: 9 cost time: 2.678842544555664
Epoch: 9, Steps: 266 | Train Loss: 0.3904327 Vali Loss: 0.2054703 Test Loss: 0.2756907
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.3955945
	speed: 0.0497s/iter; left time: 1199.1559s
	iters: 200, epoch: 10 | loss: 0.2804640
	speed: 0.0065s/iter; left time: 156.0285s
Epoch: 10 cost time: 2.616182565689087
Epoch: 10, Steps: 266 | Train Loss: 0.3911906 Vali Loss: 0.2055129 Test Loss: 0.2756790
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.4230876
	speed: 0.0504s/iter; left time: 1200.5676s
	iters: 200, epoch: 11 | loss: 0.3083856
	speed: 0.0064s/iter; left time: 151.3105s
Epoch: 11 cost time: 2.670686960220337
Epoch: 11, Steps: 266 | Train Loss: 0.3910224 Vali Loss: 0.2056149 Test Loss: 0.2756629
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.4466100
	speed: 0.0524s/iter; left time: 1236.0728s
	iters: 200, epoch: 12 | loss: 0.4020401
	speed: 0.0068s/iter; left time: 159.5619s
Epoch: 12 cost time: 2.828172206878662
Epoch: 12, Steps: 266 | Train Loss: 0.3910393 Vali Loss: 0.2054468 Test Loss: 0.2756487
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.4216602
	speed: 0.0499s/iter; left time: 1162.6036s
	iters: 200, epoch: 13 | loss: 0.3229944
	speed: 0.0067s/iter; left time: 156.1877s
Epoch: 13 cost time: 2.7476072311401367
Epoch: 13, Steps: 266 | Train Loss: 0.3909582 Vali Loss: 0.2055058 Test Loss: 0.2756330
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.5096087
	speed: 0.0498s/iter; left time: 1146.6925s
	iters: 200, epoch: 14 | loss: 0.4120052
	speed: 0.0065s/iter; left time: 150.1989s
Epoch: 14 cost time: 2.622917652130127
Epoch: 14, Steps: 266 | Train Loss: 0.3910683 Vali Loss: 0.2056470 Test Loss: 0.2756125
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.3634095
	speed: 0.0485s/iter; left time: 1103.6645s
	iters: 200, epoch: 15 | loss: 0.5212587
	speed: 0.0066s/iter; left time: 148.8338s
Epoch: 15 cost time: 2.6668601036071777
Epoch: 15, Steps: 266 | Train Loss: 0.3908723 Vali Loss: 0.2055950 Test Loss: 0.2755941
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.4870460
	speed: 0.0496s/iter; left time: 1115.5863s
	iters: 200, epoch: 16 | loss: 0.3333977
	speed: 0.0064s/iter; left time: 143.4656s
Epoch: 16 cost time: 2.673210382461548
Epoch: 16, Steps: 266 | Train Loss: 0.3910299 Vali Loss: 0.2056443 Test Loss: 0.2755748
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.3737327
	speed: 0.0486s/iter; left time: 1080.8796s
	iters: 200, epoch: 17 | loss: 0.3913205
	speed: 0.0063s/iter; left time: 138.6132s
Epoch: 17 cost time: 2.677884578704834
Epoch: 17, Steps: 266 | Train Loss: 0.3908010 Vali Loss: 0.2057179 Test Loss: 0.2755546
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2951789
	speed: 0.0494s/iter; left time: 1085.5657s
	iters: 200, epoch: 18 | loss: 0.3736324
	speed: 0.0065s/iter; left time: 142.4591s
Epoch: 18 cost time: 2.6575098037719727
Epoch: 18, Steps: 266 | Train Loss: 0.3907579 Vali Loss: 0.2058380 Test Loss: 0.2755343
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.5406809
	speed: 0.0486s/iter; left time: 1055.5819s
	iters: 200, epoch: 19 | loss: 0.3717747
	speed: 0.0064s/iter; left time: 138.9840s
Epoch: 19 cost time: 2.657102346420288
Epoch: 19, Steps: 266 | Train Loss: 0.3909099 Vali Loss: 0.2056855 Test Loss: 0.2755160
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.3461792
	speed: 0.0509s/iter; left time: 1091.6476s
	iters: 200, epoch: 20 | loss: 0.2887444
	speed: 0.0067s/iter; left time: 142.2219s
Epoch: 20 cost time: 2.703110694885254
Epoch: 20, Steps: 266 | Train Loss: 0.3904116 Vali Loss: 0.2056838 Test Loss: 0.2754967
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.4234557
	speed: 0.0504s/iter; left time: 1067.3708s
	iters: 200, epoch: 21 | loss: 0.2839085
	speed: 0.0067s/iter; left time: 140.9457s
Epoch: 21 cost time: 2.7467739582061768
Epoch: 21, Steps: 266 | Train Loss: 0.3905623 Vali Loss: 0.2058655 Test Loss: 0.2754753
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.3543349
	speed: 0.0505s/iter; left time: 1055.6066s
	iters: 200, epoch: 22 | loss: 0.3050348
	speed: 0.0068s/iter; left time: 141.7134s
Epoch: 22 cost time: 2.701082468032837
Epoch: 22, Steps: 266 | Train Loss: 0.3908923 Vali Loss: 0.2059162 Test Loss: 0.2754581
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTSFL_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.2757408320903778, mae:0.3440507650375366, rse:0.4253987967967987
