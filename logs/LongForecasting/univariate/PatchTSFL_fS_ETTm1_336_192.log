Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm1_336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm1_336_192_PatchTSFL_ETTm1_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2041792
	speed: 0.0731s/iter; left time: 1929.6999s
	iters: 200, epoch: 1 | loss: 0.2094936
	speed: 0.0507s/iter; left time: 1332.2631s
Epoch: 1 cost time: 15.7390878200531
Epoch: 1, Steps: 265 | Train Loss: 0.2002387 Vali Loss: 0.1070618 Test Loss: 0.0560893
Validation loss decreased (inf --> 0.107062).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.1426819
	speed: 0.1795s/iter; left time: 4691.0900s
	iters: 200, epoch: 2 | loss: 0.1439925
	speed: 0.0486s/iter; left time: 1264.4078s
Epoch: 2 cost time: 15.280897617340088
Epoch: 2, Steps: 265 | Train Loss: 0.1895221 Vali Loss: 0.1035273 Test Loss: 0.0547454
Validation loss decreased (0.107062 --> 0.103527).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.1678990
	speed: 0.1683s/iter; left time: 4353.2011s
	iters: 200, epoch: 3 | loss: 0.1968477
	speed: 0.0518s/iter; left time: 1333.9424s
Epoch: 3 cost time: 15.660255193710327
Epoch: 3, Steps: 265 | Train Loss: 0.1834767 Vali Loss: 0.0980624 Test Loss: 0.0521518
Validation loss decreased (0.103527 --> 0.098062).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.1382320
	speed: 0.1724s/iter; left time: 4415.3179s
	iters: 200, epoch: 4 | loss: 0.1774866
	speed: 0.0468s/iter; left time: 1193.6179s
Epoch: 4 cost time: 15.112451314926147
Epoch: 4, Steps: 265 | Train Loss: 0.1697451 Vali Loss: 0.0862057 Test Loss: 0.0452643
Validation loss decreased (0.098062 --> 0.086206).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.1328955
	speed: 0.1765s/iter; left time: 4472.0858s
	iters: 200, epoch: 5 | loss: 0.1327213
	speed: 0.0510s/iter; left time: 1286.2675s
Epoch: 5 cost time: 15.77660584449768
Epoch: 5, Steps: 265 | Train Loss: 0.1478883 Vali Loss: 0.0840180 Test Loss: 0.0443827
Validation loss decreased (0.086206 --> 0.084018).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.1367980
	speed: 0.1827s/iter; left time: 4580.4009s
	iters: 200, epoch: 6 | loss: 0.1343259
	speed: 0.0489s/iter; left time: 1221.4792s
Epoch: 6 cost time: 15.559043645858765
Epoch: 6, Steps: 265 | Train Loss: 0.1402822 Vali Loss: 0.0835522 Test Loss: 0.0444079
Validation loss decreased (0.084018 --> 0.083552).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.1433562
	speed: 0.1755s/iter; left time: 4353.6203s
	iters: 200, epoch: 7 | loss: 0.1162495
	speed: 0.0488s/iter; left time: 1205.8337s
Epoch: 7 cost time: 15.11279034614563
Epoch: 7, Steps: 265 | Train Loss: 0.1365879 Vali Loss: 0.0828628 Test Loss: 0.0440202
Validation loss decreased (0.083552 --> 0.082863).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.1169382
	speed: 0.1763s/iter; left time: 4328.0322s
	iters: 200, epoch: 8 | loss: 0.1304396
	speed: 0.0500s/iter; left time: 1222.4349s
Epoch: 8 cost time: 15.548455238342285
Epoch: 8, Steps: 265 | Train Loss: 0.1346229 Vali Loss: 0.0821662 Test Loss: 0.0437162
Validation loss decreased (0.082863 --> 0.082166).  Saving model ...
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.1513068
	speed: 0.1803s/iter; left time: 4378.7869s
	iters: 200, epoch: 9 | loss: 0.1576696
	speed: 0.0515s/iter; left time: 1245.8694s
Epoch: 9 cost time: 15.682852745056152
Epoch: 9, Steps: 265 | Train Loss: 0.1325541 Vali Loss: 0.0806138 Test Loss: 0.0430850
Validation loss decreased (0.082166 --> 0.080614).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.1283549
	speed: 0.1790s/iter; left time: 4299.6684s
	iters: 200, epoch: 10 | loss: 0.1275034
	speed: 0.0498s/iter; left time: 1190.3478s
Epoch: 10 cost time: 15.856469631195068
Epoch: 10, Steps: 265 | Train Loss: 0.1304310 Vali Loss: 0.0802158 Test Loss: 0.0426047
Validation loss decreased (0.080614 --> 0.080216).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.1627878
	speed: 0.1813s/iter; left time: 4305.9204s
	iters: 200, epoch: 11 | loss: 0.1084254
	speed: 0.0507s/iter; left time: 1198.6670s
Epoch: 11 cost time: 15.873775959014893
Epoch: 11, Steps: 265 | Train Loss: 0.1286089 Vali Loss: 0.0790755 Test Loss: 0.0418903
Validation loss decreased (0.080216 --> 0.079075).  Saving model ...
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.1066743
	speed: 0.1761s/iter; left time: 4136.7987s
	iters: 200, epoch: 12 | loss: 0.1295535
	speed: 0.0463s/iter; left time: 1083.8660s
Epoch: 12 cost time: 14.831284284591675
Epoch: 12, Steps: 265 | Train Loss: 0.1264491 Vali Loss: 0.0780475 Test Loss: 0.0412236
Validation loss decreased (0.079075 --> 0.078047).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.1177953
	speed: 0.1722s/iter; left time: 3999.4428s
	iters: 200, epoch: 13 | loss: 0.1058212
	speed: 0.0504s/iter; left time: 1165.0670s
Epoch: 13 cost time: 15.591187715530396
Epoch: 13, Steps: 265 | Train Loss: 0.1246671 Vali Loss: 0.0779908 Test Loss: 0.0413084
Validation loss decreased (0.078047 --> 0.077991).  Saving model ...
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.1154347
	speed: 0.1752s/iter; left time: 4022.1496s
	iters: 200, epoch: 14 | loss: 0.1127284
	speed: 0.0504s/iter; left time: 1152.4656s
Epoch: 14 cost time: 15.748346328735352
Epoch: 14, Steps: 265 | Train Loss: 0.1225962 Vali Loss: 0.0775162 Test Loss: 0.0408377
Validation loss decreased (0.077991 --> 0.077516).  Saving model ...
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.1257425
	speed: 0.1794s/iter; left time: 4070.5954s
	iters: 200, epoch: 15 | loss: 0.1554604
	speed: 0.0497s/iter; left time: 1123.4595s
Epoch: 15 cost time: 15.737571477890015
Epoch: 15, Steps: 265 | Train Loss: 0.1202260 Vali Loss: 0.0783724 Test Loss: 0.0414368
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.1241983
	speed: 0.1773s/iter; left time: 3975.9475s
	iters: 200, epoch: 16 | loss: 0.1124204
	speed: 0.0495s/iter; left time: 1104.9329s
Epoch: 16 cost time: 15.26189661026001
Epoch: 16, Steps: 265 | Train Loss: 0.1185621 Vali Loss: 0.0779119 Test Loss: 0.0415368
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.1021635
	speed: 0.1805s/iter; left time: 4001.1008s
	iters: 200, epoch: 17 | loss: 0.1588709
	speed: 0.0509s/iter; left time: 1122.6467s
Epoch: 17 cost time: 15.696779489517212
Epoch: 17, Steps: 265 | Train Loss: 0.1164322 Vali Loss: 0.0775358 Test Loss: 0.0416836
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.1661171
	speed: 0.1775s/iter; left time: 3886.7762s
	iters: 200, epoch: 18 | loss: 0.0955912
	speed: 0.0504s/iter; left time: 1098.2195s
Epoch: 18 cost time: 15.824374198913574
Epoch: 18, Steps: 265 | Train Loss: 0.1147398 Vali Loss: 0.0775864 Test Loss: 0.0418680
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.1252197
	speed: 0.1780s/iter; left time: 3850.5204s
	iters: 200, epoch: 19 | loss: 0.1182557
	speed: 0.0492s/iter; left time: 1059.9132s
Epoch: 19 cost time: 15.49146294593811
Epoch: 19, Steps: 265 | Train Loss: 0.1131032 Vali Loss: 0.0779809 Test Loss: 0.0422157
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.1069508
	speed: 0.1753s/iter; left time: 3746.0756s
	iters: 200, epoch: 20 | loss: 0.1270805
	speed: 0.0497s/iter; left time: 1055.9461s
Epoch: 20 cost time: 15.252918481826782
Epoch: 20, Steps: 265 | Train Loss: 0.1114366 Vali Loss: 0.0778467 Test Loss: 0.0429029
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.0950425
	speed: 0.1820s/iter; left time: 3840.3275s
	iters: 200, epoch: 21 | loss: 0.1085635
	speed: 0.0503s/iter; left time: 1055.9789s
Epoch: 21 cost time: 16.081592559814453
Epoch: 21, Steps: 265 | Train Loss: 0.1096362 Vali Loss: 0.0781102 Test Loss: 0.0424148
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.0907889
	speed: 0.1826s/iter; left time: 3804.9019s
	iters: 200, epoch: 22 | loss: 0.1045008
	speed: 0.0484s/iter; left time: 1002.7777s
Epoch: 22 cost time: 14.912520170211792
Epoch: 22, Steps: 265 | Train Loss: 0.1079395 Vali Loss: 0.0787187 Test Loss: 0.0436622
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.1152373
	speed: 0.1668s/iter; left time: 3430.6949s
	iters: 200, epoch: 23 | loss: 0.0989485
	speed: 0.0492s/iter; left time: 1007.9673s
Epoch: 23 cost time: 15.180675029754639
Epoch: 23, Steps: 265 | Train Loss: 0.1056899 Vali Loss: 0.0800923 Test Loss: 0.0434129
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.1270178
	speed: 0.1743s/iter; left time: 3538.5627s
	iters: 200, epoch: 24 | loss: 0.0996225
	speed: 0.0495s/iter; left time: 1000.6971s
Epoch: 24 cost time: 15.449787616729736
Epoch: 24, Steps: 265 | Train Loss: 0.1038459 Vali Loss: 0.0803904 Test Loss: 0.0439687
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.1068209
	speed: 0.1745s/iter; left time: 3497.2578s
	iters: 200, epoch: 25 | loss: 0.1119427
	speed: 0.0526s/iter; left time: 1047.9354s
Epoch: 25 cost time: 15.88753342628479
Epoch: 25, Steps: 265 | Train Loss: 0.1015081 Vali Loss: 0.0813733 Test Loss: 0.0446164
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.1015235
	speed: 0.1823s/iter; left time: 3604.5916s
	iters: 200, epoch: 26 | loss: 0.1044880
	speed: 0.0511s/iter; left time: 1006.2171s
Epoch: 26 cost time: 16.014406204223633
Epoch: 26, Steps: 265 | Train Loss: 0.0989708 Vali Loss: 0.0843436 Test Loss: 0.0451911
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.0907393
	speed: 0.1797s/iter; left time: 3505.4705s
	iters: 200, epoch: 27 | loss: 0.1064898
	speed: 0.0500s/iter; left time: 971.3899s
Epoch: 27 cost time: 15.392403841018677
Epoch: 27, Steps: 265 | Train Loss: 0.0965835 Vali Loss: 0.0852467 Test Loss: 0.0453094
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.1015417
	speed: 0.1725s/iter; left time: 3320.1683s
	iters: 200, epoch: 28 | loss: 0.0921596
	speed: 0.0505s/iter; left time: 967.3191s
Epoch: 28 cost time: 15.266679525375366
Epoch: 28, Steps: 265 | Train Loss: 0.0939318 Vali Loss: 0.0869327 Test Loss: 0.0464676
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.0980873
	speed: 0.1640s/iter; left time: 3113.7567s
	iters: 200, epoch: 29 | loss: 0.0989249
	speed: 0.0472s/iter; left time: 891.9839s
Epoch: 29 cost time: 14.708496809005737
Epoch: 29, Steps: 265 | Train Loss: 0.0909096 Vali Loss: 0.0909866 Test Loss: 0.0460951
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.0972849
	speed: 0.1716s/iter; left time: 3212.0529s
	iters: 200, epoch: 30 | loss: 0.0950387
	speed: 0.0480s/iter; left time: 893.8359s
Epoch: 30 cost time: 15.075677633285522
Epoch: 30, Steps: 265 | Train Loss: 0.0883162 Vali Loss: 0.0896562 Test Loss: 0.0477832
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.0785220
	speed: 0.1687s/iter; left time: 3112.8701s
	iters: 200, epoch: 31 | loss: 0.0809077
	speed: 0.0482s/iter; left time: 884.1568s
Epoch: 31 cost time: 15.370722770690918
Epoch: 31, Steps: 265 | Train Loss: 0.0858405 Vali Loss: 0.0939639 Test Loss: 0.0490484
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.0769854
	speed: 0.1650s/iter; left time: 3001.0599s
	iters: 200, epoch: 32 | loss: 0.0781274
	speed: 0.0491s/iter; left time: 887.3596s
Epoch: 32 cost time: 15.077934265136719
Epoch: 32, Steps: 265 | Train Loss: 0.0832986 Vali Loss: 0.0955407 Test Loss: 0.0492318
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.0722413
	speed: 0.1654s/iter; left time: 2964.3619s
	iters: 200, epoch: 33 | loss: 0.0762918
	speed: 0.0494s/iter; left time: 880.4585s
Epoch: 33 cost time: 14.921605587005615
Epoch: 33, Steps: 265 | Train Loss: 0.0810697 Vali Loss: 0.0970218 Test Loss: 0.0508743
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.0797709
	speed: 0.1641s/iter; left time: 2897.7833s
	iters: 200, epoch: 34 | loss: 0.0749865
	speed: 0.0479s/iter; left time: 841.7583s
Epoch: 34 cost time: 14.957648754119873
Epoch: 34, Steps: 265 | Train Loss: 0.0784687 Vali Loss: 0.0991264 Test Loss: 0.0503163
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_192_PatchTSFL_ETTm1_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.04083767905831337, mae:0.1540510207414627, rse:0.5927078723907471
