Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm2_336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_336_PatchTST_ETTm2_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2063103
	speed: 0.0344s/iter; left time: 904.4207s
	iters: 200, epoch: 1 | loss: 0.2001577
	speed: 0.0181s/iter; left time: 474.0977s
Epoch: 1 cost time: 6.513719797134399
Epoch: 1, Steps: 264 | Train Loss: 0.2434272 Vali Loss: 0.1931667 Test Loss: 0.1290894
Validation loss decreased (inf --> 0.193167).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.1839902
	speed: 0.1060s/iter; left time: 2760.0959s
	iters: 200, epoch: 2 | loss: 0.1899057
	speed: 0.0190s/iter; left time: 492.9861s
Epoch: 2 cost time: 7.1789140701293945
Epoch: 2, Steps: 264 | Train Loss: 0.2024721 Vali Loss: 0.1840521 Test Loss: 0.1225410
Validation loss decreased (0.193167 --> 0.184052).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.1975736
	speed: 0.1082s/iter; left time: 2788.4703s
	iters: 200, epoch: 3 | loss: 0.1939105
	speed: 0.0183s/iter; left time: 468.7145s
Epoch: 3 cost time: 7.0347161293029785
Epoch: 3, Steps: 264 | Train Loss: 0.1929114 Vali Loss: 0.1813692 Test Loss: 0.1207518
Validation loss decreased (0.184052 --> 0.181369).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.2029948
	speed: 0.0992s/iter; left time: 2531.1525s
	iters: 200, epoch: 4 | loss: 0.1588758
	speed: 0.0185s/iter; left time: 469.2194s
Epoch: 4 cost time: 6.7151148319244385
Epoch: 4, Steps: 264 | Train Loss: 0.1876127 Vali Loss: 0.1795682 Test Loss: 0.1200064
Validation loss decreased (0.181369 --> 0.179568).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.2232095
	speed: 0.1002s/iter; left time: 2528.8330s
	iters: 200, epoch: 5 | loss: 0.1874329
	speed: 0.0179s/iter; left time: 450.6276s
Epoch: 5 cost time: 6.586744546890259
Epoch: 5, Steps: 264 | Train Loss: 0.1842892 Vali Loss: 0.1804315 Test Loss: 0.1200602
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.1681825
	speed: 0.1026s/iter; left time: 2563.3596s
	iters: 200, epoch: 6 | loss: 0.1871937
	speed: 0.0178s/iter; left time: 443.7679s
Epoch: 6 cost time: 6.798465728759766
Epoch: 6, Steps: 264 | Train Loss: 0.1818259 Vali Loss: 0.1804055 Test Loss: 0.1202008
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.1738922
	speed: 0.1019s/iter; left time: 2517.6525s
	iters: 200, epoch: 7 | loss: 0.1548346
	speed: 0.0181s/iter; left time: 444.7763s
Epoch: 7 cost time: 6.871737718582153
Epoch: 7, Steps: 264 | Train Loss: 0.1797032 Vali Loss: 0.1816911 Test Loss: 0.1205260
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.1838221
	speed: 0.1055s/iter; left time: 2579.0297s
	iters: 200, epoch: 8 | loss: 0.1829815
	speed: 0.0179s/iter; left time: 436.5114s
Epoch: 8 cost time: 6.8092427253723145
Epoch: 8, Steps: 264 | Train Loss: 0.1782331 Vali Loss: 0.1826844 Test Loss: 0.1212289
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.1643926
	speed: 0.1074s/iter; left time: 2598.3653s
	iters: 200, epoch: 9 | loss: 0.1930699
	speed: 0.0184s/iter; left time: 443.3899s
Epoch: 9 cost time: 6.976770639419556
Epoch: 9, Steps: 264 | Train Loss: 0.1764051 Vali Loss: 0.1828784 Test Loss: 0.1210490
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.1672309
	speed: 0.1022s/iter; left time: 2445.8606s
	iters: 200, epoch: 10 | loss: 0.1629284
	speed: 0.0181s/iter; left time: 430.4578s
Epoch: 10 cost time: 6.764039039611816
Epoch: 10, Steps: 264 | Train Loss: 0.1747249 Vali Loss: 0.1851489 Test Loss: 0.1211483
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.1529768
	speed: 0.1023s/iter; left time: 2419.7771s
	iters: 200, epoch: 11 | loss: 0.1814823
	speed: 0.0187s/iter; left time: 440.1133s
Epoch: 11 cost time: 6.949916124343872
Epoch: 11, Steps: 264 | Train Loss: 0.1733397 Vali Loss: 0.1888757 Test Loss: 0.1225502
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.1678420
	speed: 0.1022s/iter; left time: 2390.0368s
	iters: 200, epoch: 12 | loss: 0.2022030
	speed: 0.0180s/iter; left time: 418.6606s
Epoch: 12 cost time: 6.951972007751465
Epoch: 12, Steps: 264 | Train Loss: 0.1715296 Vali Loss: 0.1914493 Test Loss: 0.1225210
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.1764177
	speed: 0.1052s/iter; left time: 2433.5720s
	iters: 200, epoch: 13 | loss: 0.1687605
	speed: 0.0186s/iter; left time: 427.9433s
Epoch: 13 cost time: 6.875510931015015
Epoch: 13, Steps: 264 | Train Loss: 0.1699845 Vali Loss: 0.1961653 Test Loss: 0.1236480
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.1688227
	speed: 0.1042s/iter; left time: 2382.5896s
	iters: 200, epoch: 14 | loss: 0.1579250
	speed: 0.0181s/iter; left time: 412.2585s
Epoch: 14 cost time: 6.788928270339966
Epoch: 14, Steps: 264 | Train Loss: 0.1679391 Vali Loss: 0.1962030 Test Loss: 0.1218108
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.1580869
	speed: 0.1024s/iter; left time: 2314.3441s
	iters: 200, epoch: 15 | loss: 0.1692799
	speed: 0.0180s/iter; left time: 405.8683s
Epoch: 15 cost time: 6.8801093101501465
Epoch: 15, Steps: 264 | Train Loss: 0.1660832 Vali Loss: 0.1949631 Test Loss: 0.1220165
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.1619234
	speed: 0.1089s/iter; left time: 2433.0026s
	iters: 200, epoch: 16 | loss: 0.1881872
	speed: 0.0201s/iter; left time: 446.1213s
Epoch: 16 cost time: 7.59235692024231
Epoch: 16, Steps: 264 | Train Loss: 0.1641948 Vali Loss: 0.1982078 Test Loss: 0.1228530
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.1448132
	speed: 0.1082s/iter; left time: 2387.9241s
	iters: 200, epoch: 17 | loss: 0.1424855
	speed: 0.0183s/iter; left time: 401.5567s
Epoch: 17 cost time: 6.879823923110962
Epoch: 17, Steps: 264 | Train Loss: 0.1609903 Vali Loss: 0.1988008 Test Loss: 0.1238819
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.1518406
	speed: 0.1012s/iter; left time: 2207.3759s
	iters: 200, epoch: 18 | loss: 0.1821624
	speed: 0.0188s/iter; left time: 408.7594s
Epoch: 18 cost time: 6.822978496551514
Epoch: 18, Steps: 264 | Train Loss: 0.1577210 Vali Loss: 0.2006921 Test Loss: 0.1274388
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.1560485
	speed: 0.1033s/iter; left time: 2225.1243s
	iters: 200, epoch: 19 | loss: 0.1418723
	speed: 0.0183s/iter; left time: 393.4133s
Epoch: 19 cost time: 6.868150234222412
Epoch: 19, Steps: 264 | Train Loss: 0.1536903 Vali Loss: 0.2100890 Test Loss: 0.1317500
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.1703837
	speed: 0.1043s/iter; left time: 2219.5252s
	iters: 200, epoch: 20 | loss: 0.1355634
	speed: 0.0181s/iter; left time: 382.6410s
Epoch: 20 cost time: 6.719812870025635
Epoch: 20, Steps: 264 | Train Loss: 0.1491597 Vali Loss: 0.2028841 Test Loss: 0.1315209
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.1472992
	speed: 0.1070s/iter; left time: 2248.6585s
	iters: 200, epoch: 21 | loss: 0.1369217
	speed: 0.0190s/iter; left time: 396.9177s
Epoch: 21 cost time: 7.071331024169922
Epoch: 21, Steps: 264 | Train Loss: 0.1451385 Vali Loss: 0.2202075 Test Loss: 0.1395147
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.1559524
	speed: 0.1143s/iter; left time: 2372.0164s
	iters: 200, epoch: 22 | loss: 0.1386686
	speed: 0.0201s/iter; left time: 414.3260s
Epoch: 22 cost time: 7.509724855422974
Epoch: 22, Steps: 264 | Train Loss: 0.1408184 Vali Loss: 0.2084033 Test Loss: 0.1397650
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.1406035
	speed: 0.1202s/iter; left time: 2463.7481s
	iters: 200, epoch: 23 | loss: 0.1398028
	speed: 0.0215s/iter; left time: 439.4032s
Epoch: 23 cost time: 8.184517860412598
Epoch: 23, Steps: 264 | Train Loss: 0.1366269 Vali Loss: 0.2241643 Test Loss: 0.1521137
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.1164142
	speed: 0.1113s/iter; left time: 2250.8972s
	iters: 200, epoch: 24 | loss: 0.1236917
	speed: 0.0185s/iter; left time: 371.4931s
Epoch: 24 cost time: 7.265392303466797
Epoch: 24, Steps: 264 | Train Loss: 0.1328007 Vali Loss: 0.2341614 Test Loss: 0.1482000
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_336_PatchTST_ETTm2_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.12000642716884613, mae:0.26463374495506287, rse:0.5654091238975525
