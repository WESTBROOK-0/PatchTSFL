Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4160757
	speed: 0.0506s/iter; left time: 1339.9359s
	iters: 200, epoch: 1 | loss: 0.3992244
	speed: 0.0442s/iter; left time: 1167.7572s
Epoch: 1 cost time: 12.528580904006958
Epoch: 1, Steps: 266 | Train Loss: 0.3406250 Vali Loss: 0.1469210 Test Loss: 0.2058899
Validation loss decreased (inf --> 0.146921).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.2722977
	speed: 0.1275s/iter; left time: 3343.9087s
	iters: 200, epoch: 2 | loss: 0.2852281
	speed: 0.0441s/iter; left time: 1153.1268s
Epoch: 2 cost time: 12.471419334411621
Epoch: 2, Steps: 266 | Train Loss: 0.2698402 Vali Loss: 0.1316177 Test Loss: 0.1851936
Validation loss decreased (0.146921 --> 0.131618).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2408719
	speed: 0.1268s/iter; left time: 3292.3821s
	iters: 200, epoch: 3 | loss: 0.1712363
	speed: 0.0443s/iter; left time: 1145.1690s
Epoch: 3 cost time: 12.484840869903564
Epoch: 3, Steps: 266 | Train Loss: 0.2485379 Vali Loss: 0.1258610 Test Loss: 0.1766139
Validation loss decreased (0.131618 --> 0.125861).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.2330152
	speed: 0.1293s/iter; left time: 3323.2773s
	iters: 200, epoch: 4 | loss: 0.2444330
	speed: 0.0442s/iter; left time: 1132.9088s
Epoch: 4 cost time: 12.64695954322815
Epoch: 4, Steps: 266 | Train Loss: 0.2366834 Vali Loss: 0.1226963 Test Loss: 0.1710823
Validation loss decreased (0.125861 --> 0.122696).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2030484
	speed: 0.1285s/iter; left time: 3269.9062s
	iters: 200, epoch: 5 | loss: 0.2409238
	speed: 0.0445s/iter; left time: 1127.1421s
Epoch: 5 cost time: 12.583524942398071
Epoch: 5, Steps: 266 | Train Loss: 0.2293811 Vali Loss: 0.1206262 Test Loss: 0.1676994
Validation loss decreased (0.122696 --> 0.120626).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2378512
	speed: 0.1271s/iter; left time: 3199.6001s
	iters: 200, epoch: 6 | loss: 0.1543676
	speed: 0.0444s/iter; left time: 1112.0555s
Epoch: 6 cost time: 12.521117687225342
Epoch: 6, Steps: 266 | Train Loss: 0.2245827 Vali Loss: 0.1196480 Test Loss: 0.1670777
Validation loss decreased (0.120626 --> 0.119648).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2429054
	speed: 0.1269s/iter; left time: 3160.8542s
	iters: 200, epoch: 7 | loss: 0.2781316
	speed: 0.0445s/iter; left time: 1102.7678s
Epoch: 7 cost time: 12.469690084457397
Epoch: 7, Steps: 266 | Train Loss: 0.2214498 Vali Loss: 0.1198518 Test Loss: 0.1648674
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.1984869
	speed: 0.1287s/iter; left time: 3170.5100s
	iters: 200, epoch: 8 | loss: 0.2180887
	speed: 0.0447s/iter; left time: 1096.2798s
Epoch: 8 cost time: 12.530166625976562
Epoch: 8, Steps: 266 | Train Loss: 0.2188648 Vali Loss: 0.1183176 Test Loss: 0.1648853
Validation loss decreased (0.119648 --> 0.118318).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.1864194
	speed: 0.1293s/iter; left time: 3150.4333s
	iters: 200, epoch: 9 | loss: 0.1667506
	speed: 0.0446s/iter; left time: 1082.2331s
Epoch: 9 cost time: 12.567959547042847
Epoch: 9, Steps: 266 | Train Loss: 0.2168808 Vali Loss: 0.1183801 Test Loss: 0.1641753
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.1511102
	speed: 0.1286s/iter; left time: 3100.9749s
	iters: 200, epoch: 10 | loss: 0.2015542
	speed: 0.0447s/iter; left time: 1072.4060s
Epoch: 10 cost time: 12.573428869247437
Epoch: 10, Steps: 266 | Train Loss: 0.2149358 Vali Loss: 0.1191587 Test Loss: 0.1645988
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2015337
	speed: 0.1274s/iter; left time: 3036.8892s
	iters: 200, epoch: 11 | loss: 0.2238090
	speed: 0.0448s/iter; left time: 1062.4445s
Epoch: 11 cost time: 12.538206100463867
Epoch: 11, Steps: 266 | Train Loss: 0.2126169 Vali Loss: 0.1188816 Test Loss: 0.1650504
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.2015320
	speed: 0.1291s/iter; left time: 3043.5694s
	iters: 200, epoch: 12 | loss: 0.1552582
	speed: 0.0446s/iter; left time: 1046.0090s
Epoch: 12 cost time: 12.72068190574646
Epoch: 12, Steps: 266 | Train Loss: 0.2097490 Vali Loss: 0.1193557 Test Loss: 0.1655359
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.1694913
	speed: 0.1284s/iter; left time: 2993.6878s
	iters: 200, epoch: 13 | loss: 0.1917826
	speed: 0.0446s/iter; left time: 1034.4942s
Epoch: 13 cost time: 12.538398027420044
Epoch: 13, Steps: 266 | Train Loss: 0.2064252 Vali Loss: 0.1189143 Test Loss: 0.1645746
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2303796
	speed: 0.1284s/iter; left time: 2958.2822s
	iters: 200, epoch: 14 | loss: 0.1776612
	speed: 0.0446s/iter; left time: 1023.2689s
Epoch: 14 cost time: 12.491400718688965
Epoch: 14, Steps: 266 | Train Loss: 0.2038321 Vali Loss: 0.1208139 Test Loss: 0.1689627
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.1600999
	speed: 0.1285s/iter; left time: 2925.9247s
	iters: 200, epoch: 15 | loss: 0.2093939
	speed: 0.0446s/iter; left time: 1012.0075s
Epoch: 15 cost time: 12.585031270980835
Epoch: 15, Steps: 266 | Train Loss: 0.2000248 Vali Loss: 0.1216114 Test Loss: 0.1675133
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2100848
	speed: 0.1303s/iter; left time: 2932.8888s
	iters: 200, epoch: 16 | loss: 0.1624942
	speed: 0.0446s/iter; left time: 1000.0812s
Epoch: 16 cost time: 12.671374797821045
Epoch: 16, Steps: 266 | Train Loss: 0.1971571 Vali Loss: 0.1249164 Test Loss: 0.1708380
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2043433
	speed: 0.1284s/iter; left time: 2857.2931s
	iters: 200, epoch: 17 | loss: 0.1712645
	speed: 0.0446s/iter; left time: 987.0817s
Epoch: 17 cost time: 12.63936710357666
Epoch: 17, Steps: 266 | Train Loss: 0.1935510 Vali Loss: 0.1238211 Test Loss: 0.1698605
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.1808424
	speed: 0.1294s/iter; left time: 2843.6042s
	iters: 200, epoch: 18 | loss: 0.1550394
	speed: 0.0446s/iter; left time: 976.2921s
Epoch: 18 cost time: 12.664018392562866
Epoch: 18, Steps: 266 | Train Loss: 0.1903822 Vali Loss: 0.1237474 Test Loss: 0.1675490
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.1944721
	speed: 0.1284s/iter; left time: 2788.3896s
	iters: 200, epoch: 19 | loss: 0.1692742
	speed: 0.0446s/iter; left time: 964.1877s
Epoch: 19 cost time: 12.535863399505615
Epoch: 19, Steps: 266 | Train Loss: 0.1879292 Vali Loss: 0.1274390 Test Loss: 0.1716528
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2146965
	speed: 0.1293s/iter; left time: 2773.4496s
	iters: 200, epoch: 20 | loss: 0.1917057
	speed: 0.0446s/iter; left time: 951.6659s
Epoch: 20 cost time: 12.605796337127686
Epoch: 20, Steps: 266 | Train Loss: 0.1849666 Vali Loss: 0.1254068 Test Loss: 0.1717605
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.1631545
	speed: 0.1288s/iter; left time: 2727.9091s
	iters: 200, epoch: 21 | loss: 0.1619475
	speed: 0.0446s/iter; left time: 940.2733s
Epoch: 21 cost time: 12.54845142364502
Epoch: 21, Steps: 266 | Train Loss: 0.1827524 Vali Loss: 0.1286614 Test Loss: 0.1718980
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.2419436
	speed: 0.1281s/iter; left time: 2678.2472s
	iters: 200, epoch: 22 | loss: 0.1905750
	speed: 0.0446s/iter; left time: 927.3603s
Epoch: 22 cost time: 12.53252124786377
Epoch: 22, Steps: 266 | Train Loss: 0.1803873 Vali Loss: 0.1284241 Test Loss: 0.1728597
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.1789353
	speed: 0.1266s/iter; left time: 2613.2409s
	iters: 200, epoch: 23 | loss: 0.1831274
	speed: 0.0446s/iter; left time: 915.5219s
Epoch: 23 cost time: 12.560965776443481
Epoch: 23, Steps: 266 | Train Loss: 0.1781343 Vali Loss: 0.1278003 Test Loss: 0.1743602
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.1559801
	speed: 0.1277s/iter; left time: 2603.9231s
	iters: 200, epoch: 24 | loss: 0.1876776
	speed: 0.0448s/iter; left time: 908.7881s
Epoch: 24 cost time: 12.553288698196411
Epoch: 24, Steps: 266 | Train Loss: 0.1753512 Vali Loss: 0.1275370 Test Loss: 0.1782576
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.2345851
	speed: 0.1277s/iter; left time: 2568.8008s
	iters: 200, epoch: 25 | loss: 0.1671344
	speed: 0.0446s/iter; left time: 892.2899s
Epoch: 25 cost time: 12.507460832595825
Epoch: 25, Steps: 266 | Train Loss: 0.1736415 Vali Loss: 0.1297957 Test Loss: 0.1795622
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.1751016
	speed: 0.1285s/iter; left time: 2549.9024s
	iters: 200, epoch: 26 | loss: 0.1418255
	speed: 0.0446s/iter; left time: 880.0887s
Epoch: 26 cost time: 12.517658710479736
Epoch: 26, Steps: 266 | Train Loss: 0.1714491 Vali Loss: 0.1269399 Test Loss: 0.1791939
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.1523644
	speed: 0.1275s/iter; left time: 2497.2166s
	iters: 200, epoch: 27 | loss: 0.1424323
	speed: 0.0445s/iter; left time: 867.8572s
Epoch: 27 cost time: 12.539046287536621
Epoch: 27, Steps: 266 | Train Loss: 0.1693329 Vali Loss: 0.1272591 Test Loss: 0.1758227
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.1567002
	speed: 0.1305s/iter; left time: 2521.1371s
	iters: 200, epoch: 28 | loss: 0.1791408
	speed: 0.0446s/iter; left time: 857.1004s
Epoch: 28 cost time: 12.680009126663208
Epoch: 28, Steps: 266 | Train Loss: 0.1677243 Vali Loss: 0.1267537 Test Loss: 0.1774132
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16488529741764069, mae:0.25483155250549316, rse:0.32895511388778687
