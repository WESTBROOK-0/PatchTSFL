Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm1_336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm1_336_336_PatchTSFL_ETTm1_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2301202
	speed: 0.0685s/iter; left time: 1801.2121s
	iters: 200, epoch: 1 | loss: 0.2103673
	speed: 0.0468s/iter; left time: 1226.8028s
Epoch: 1 cost time: 14.623131513595581
Epoch: 1, Steps: 264 | Train Loss: 0.2207883 Vali Loss: 0.1203731 Test Loss: 0.0649305
Validation loss decreased (inf --> 0.120373).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.2245079
	speed: 0.1653s/iter; left time: 4302.8590s
	iters: 200, epoch: 2 | loss: 0.2058204
	speed: 0.0460s/iter; left time: 1191.9839s
Epoch: 2 cost time: 14.646219491958618
Epoch: 2, Steps: 264 | Train Loss: 0.2109309 Vali Loss: 0.1177464 Test Loss: 0.0641182
Validation loss decreased (0.120373 --> 0.117746).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.1788519
	speed: 0.1732s/iter; left time: 4463.9188s
	iters: 200, epoch: 3 | loss: 0.1603589
	speed: 0.0487s/iter; left time: 1249.3584s
Epoch: 3 cost time: 14.859299421310425
Epoch: 3, Steps: 264 | Train Loss: 0.2060505 Vali Loss: 0.1141802 Test Loss: 0.0626313
Validation loss decreased (0.117746 --> 0.114180).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.1873057
	speed: 0.1663s/iter; left time: 4242.5812s
	iters: 200, epoch: 4 | loss: 0.1976095
	speed: 0.0498s/iter; left time: 1266.2122s
Epoch: 4 cost time: 15.206754446029663
Epoch: 4, Steps: 264 | Train Loss: 0.1975185 Vali Loss: 0.1056973 Test Loss: 0.0576175
Validation loss decreased (0.114180 --> 0.105697).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.1716172
	speed: 0.1679s/iter; left time: 4239.4662s
	iters: 200, epoch: 5 | loss: 0.2123208
	speed: 0.0476s/iter; left time: 1196.2606s
Epoch: 5 cost time: 14.881664514541626
Epoch: 5, Steps: 264 | Train Loss: 0.1805163 Vali Loss: 0.1038365 Test Loss: 0.0563322
Validation loss decreased (0.105697 --> 0.103837).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.1828721
	speed: 0.1713s/iter; left time: 4280.2140s
	iters: 200, epoch: 6 | loss: 0.1709454
	speed: 0.0478s/iter; left time: 1189.9750s
Epoch: 6 cost time: 15.092453956604004
Epoch: 6, Steps: 264 | Train Loss: 0.1734017 Vali Loss: 0.1031558 Test Loss: 0.0561704
Validation loss decreased (0.103837 --> 0.103156).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.1623194
	speed: 0.1703s/iter; left time: 4208.5695s
	iters: 200, epoch: 7 | loss: 0.1330606
	speed: 0.0485s/iter; left time: 1193.3363s
Epoch: 7 cost time: 14.96700143814087
Epoch: 7, Steps: 264 | Train Loss: 0.1705691 Vali Loss: 0.1023499 Test Loss: 0.0558461
Validation loss decreased (0.103156 --> 0.102350).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.1497532
	speed: 0.1695s/iter; left time: 4145.5863s
	iters: 200, epoch: 8 | loss: 0.1657865
	speed: 0.0485s/iter; left time: 1181.1248s
Epoch: 8 cost time: 15.22835636138916
Epoch: 8, Steps: 264 | Train Loss: 0.1681661 Vali Loss: 0.1018256 Test Loss: 0.0554019
Validation loss decreased (0.102350 --> 0.101826).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.2007717
	speed: 0.1821s/iter; left time: 4404.5108s
	iters: 200, epoch: 9 | loss: 0.1784694
	speed: 0.0508s/iter; left time: 1223.5931s
Epoch: 9 cost time: 15.752278089523315
Epoch: 9, Steps: 264 | Train Loss: 0.1659173 Vali Loss: 0.1010274 Test Loss: 0.0552765
Validation loss decreased (0.101826 --> 0.101027).  Saving model ...
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.1462317
	speed: 0.1836s/iter; left time: 4393.0784s
	iters: 200, epoch: 10 | loss: 0.2135686
	speed: 0.0448s/iter; left time: 1067.4338s
Epoch: 10 cost time: 15.138737440109253
Epoch: 10, Steps: 264 | Train Loss: 0.1638195 Vali Loss: 0.0997807 Test Loss: 0.0548858
Validation loss decreased (0.101027 --> 0.099781).  Saving model ...
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.1931767
	speed: 0.1827s/iter; left time: 4323.1215s
	iters: 200, epoch: 11 | loss: 0.1635962
	speed: 0.0505s/iter; left time: 1190.4266s
Epoch: 11 cost time: 15.707479238510132
Epoch: 11, Steps: 264 | Train Loss: 0.1616637 Vali Loss: 0.0987240 Test Loss: 0.0543470
Validation loss decreased (0.099781 --> 0.098724).  Saving model ...
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.1609396
	speed: 0.1805s/iter; left time: 4224.0849s
	iters: 200, epoch: 12 | loss: 0.1619435
	speed: 0.0516s/iter; left time: 1203.2093s
Epoch: 12 cost time: 15.990179061889648
Epoch: 12, Steps: 264 | Train Loss: 0.1593362 Vali Loss: 0.0984363 Test Loss: 0.0542077
Validation loss decreased (0.098724 --> 0.098436).  Saving model ...
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.1679286
	speed: 0.1779s/iter; left time: 4114.6532s
	iters: 200, epoch: 13 | loss: 0.1457457
	speed: 0.0507s/iter; left time: 1167.9175s
Epoch: 13 cost time: 16.03284740447998
Epoch: 13, Steps: 264 | Train Loss: 0.1570608 Vali Loss: 0.0978827 Test Loss: 0.0538374
Validation loss decreased (0.098436 --> 0.097883).  Saving model ...
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.1272462
	speed: 0.1849s/iter; left time: 4228.9968s
	iters: 200, epoch: 14 | loss: 0.1309016
	speed: 0.0497s/iter; left time: 1130.8557s
Epoch: 14 cost time: 15.856695652008057
Epoch: 14, Steps: 264 | Train Loss: 0.1545502 Vali Loss: 0.0988034 Test Loss: 0.0542212
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.1556783
	speed: 0.1794s/iter; left time: 4055.6129s
	iters: 200, epoch: 15 | loss: 0.2206937
	speed: 0.0522s/iter; left time: 1174.0618s
Epoch: 15 cost time: 16.02203106880188
Epoch: 15, Steps: 264 | Train Loss: 0.1518566 Vali Loss: 0.1000384 Test Loss: 0.0553760
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.1227009
	speed: 0.1815s/iter; left time: 4053.8636s
	iters: 200, epoch: 16 | loss: 0.1471711
	speed: 0.0481s/iter; left time: 1069.0700s
Epoch: 16 cost time: 15.237407445907593
Epoch: 16, Steps: 264 | Train Loss: 0.1496309 Vali Loss: 0.0987760 Test Loss: 0.0557663
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.1464163
	speed: 0.1804s/iter; left time: 3981.6652s
	iters: 200, epoch: 17 | loss: 0.1504269
	speed: 0.0490s/iter; left time: 1077.4160s
Epoch: 17 cost time: 15.636366605758667
Epoch: 17, Steps: 264 | Train Loss: 0.1478254 Vali Loss: 0.0999734 Test Loss: 0.0555249
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.1565580
	speed: 0.1783s/iter; left time: 3888.1754s
	iters: 200, epoch: 18 | loss: 0.1686118
	speed: 0.0462s/iter; left time: 1002.4826s
Epoch: 18 cost time: 15.179473876953125
Epoch: 18, Steps: 264 | Train Loss: 0.1459417 Vali Loss: 0.0994526 Test Loss: 0.0557087
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.1517548
	speed: 0.1809s/iter; left time: 3897.4612s
	iters: 200, epoch: 19 | loss: 0.1371616
	speed: 0.0493s/iter; left time: 1056.8299s
Epoch: 19 cost time: 15.487913370132446
Epoch: 19, Steps: 264 | Train Loss: 0.1442057 Vali Loss: 0.0989978 Test Loss: 0.0554325
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.1531410
	speed: 0.1758s/iter; left time: 3741.6866s
	iters: 200, epoch: 20 | loss: 0.1255845
	speed: 0.0507s/iter; left time: 1073.9440s
Epoch: 20 cost time: 16.161835193634033
Epoch: 20, Steps: 264 | Train Loss: 0.1417981 Vali Loss: 0.1012934 Test Loss: 0.0565127
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.1420516
	speed: 0.1857s/iter; left time: 3903.8330s
	iters: 200, epoch: 21 | loss: 0.1520244
	speed: 0.0522s/iter; left time: 1092.0728s
Epoch: 21 cost time: 16.00455617904663
Epoch: 21, Steps: 264 | Train Loss: 0.1392913 Vali Loss: 0.1016495 Test Loss: 0.0586317
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.1446068
	speed: 0.1765s/iter; left time: 3663.9305s
	iters: 200, epoch: 22 | loss: 0.1260147
	speed: 0.0443s/iter; left time: 914.1878s
Epoch: 22 cost time: 14.515820026397705
Epoch: 22, Steps: 264 | Train Loss: 0.1369979 Vali Loss: 0.1016939 Test Loss: 0.0579744
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.1335088
	speed: 0.1802s/iter; left time: 3691.9526s
	iters: 200, epoch: 23 | loss: 0.1225018
	speed: 0.0505s/iter; left time: 1030.0060s
Epoch: 23 cost time: 16.24055242538452
Epoch: 23, Steps: 264 | Train Loss: 0.1338201 Vali Loss: 0.1027431 Test Loss: 0.0577754
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.1557721
	speed: 0.1861s/iter; left time: 3764.4108s
	iters: 200, epoch: 24 | loss: 0.1130443
	speed: 0.0497s/iter; left time: 999.8484s
Epoch: 24 cost time: 15.730864524841309
Epoch: 24, Steps: 264 | Train Loss: 0.1305460 Vali Loss: 0.1027812 Test Loss: 0.0585840
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.1233653
	speed: 0.1741s/iter; left time: 3475.2407s
	iters: 200, epoch: 25 | loss: 0.1348967
	speed: 0.0492s/iter; left time: 976.8052s
Epoch: 25 cost time: 15.004436016082764
Epoch: 25, Steps: 264 | Train Loss: 0.1269459 Vali Loss: 0.1020348 Test Loss: 0.0590745
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.1198823
	speed: 0.1781s/iter; left time: 3509.3527s
	iters: 200, epoch: 26 | loss: 0.1442293
	speed: 0.0448s/iter; left time: 877.4514s
Epoch: 26 cost time: 14.942191362380981
Epoch: 26, Steps: 264 | Train Loss: 0.1239420 Vali Loss: 0.1049790 Test Loss: 0.0604547
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.1207623
	speed: 0.1775s/iter; left time: 3449.8258s
	iters: 200, epoch: 27 | loss: 0.1298299
	speed: 0.0477s/iter; left time: 922.8006s
Epoch: 27 cost time: 15.020781517028809
Epoch: 27, Steps: 264 | Train Loss: 0.1201153 Vali Loss: 0.1082139 Test Loss: 0.0620088
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.0894718
	speed: 0.1727s/iter; left time: 3310.6704s
	iters: 200, epoch: 28 | loss: 0.1162100
	speed: 0.0487s/iter; left time: 927.9372s
Epoch: 28 cost time: 15.491361856460571
Epoch: 28, Steps: 264 | Train Loss: 0.1162723 Vali Loss: 0.1102021 Test Loss: 0.0627833
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.1025493
	speed: 0.1701s/iter; left time: 3216.5468s
	iters: 200, epoch: 29 | loss: 0.1080433
	speed: 0.0467s/iter; left time: 878.0837s
Epoch: 29 cost time: 14.64653754234314
Epoch: 29, Steps: 264 | Train Loss: 0.1132276 Vali Loss: 0.1102033 Test Loss: 0.0635854
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.318137880466269e-05
	iters: 100, epoch: 30 | loss: 0.1153631
	speed: 0.1711s/iter; left time: 3190.0712s
	iters: 200, epoch: 30 | loss: 0.1031287
	speed: 0.0482s/iter; left time: 894.6542s
Epoch: 30 cost time: 14.880621671676636
Epoch: 30, Steps: 264 | Train Loss: 0.1100791 Vali Loss: 0.1159009 Test Loss: 0.0669106
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.594869846499432e-05
	iters: 100, epoch: 31 | loss: 0.1303821
	speed: 0.1729s/iter; left time: 3177.6484s
	iters: 200, epoch: 31 | loss: 0.1195391
	speed: 0.0481s/iter; left time: 879.6031s
Epoch: 31 cost time: 15.422486543655396
Epoch: 31, Steps: 264 | Train Loss: 0.1071187 Vali Loss: 0.1159750 Test Loss: 0.0659528
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.85066734838546e-05
	iters: 100, epoch: 32 | loss: 0.1264901
	speed: 0.1794s/iter; left time: 3249.7686s
	iters: 200, epoch: 32 | loss: 0.0983813
	speed: 0.0423s/iter; left time: 761.3037s
Epoch: 32 cost time: 14.603201866149902
Epoch: 32, Steps: 264 | Train Loss: 0.1049085 Vali Loss: 0.1146559 Test Loss: 0.0659845
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.083953010886336e-05
	iters: 100, epoch: 33 | loss: 0.1069880
	speed: 0.1725s/iter; left time: 3079.6174s
	iters: 200, epoch: 33 | loss: 0.1072742
	speed: 0.0504s/iter; left time: 894.2171s
Epoch: 33 cost time: 15.554296731948853
Epoch: 33, Steps: 264 | Train Loss: 0.1020523 Vali Loss: 0.1180083 Test Loss: 0.0658655
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_336_PatchTSFL_ETTm1_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.05383741483092308, mae:0.17650561034679413, rse:0.6845405101776123
