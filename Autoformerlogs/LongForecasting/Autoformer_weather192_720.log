Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_192_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9370683
	speed: 0.0706s/iter; left time: 1263.7740s
	iters: 200, epoch: 1 | loss: 0.7604154
	speed: 0.0498s/iter; left time: 885.5150s
	iters: 300, epoch: 1 | loss: 0.8374286
	speed: 0.0489s/iter; left time: 864.5226s
	iters: 400, epoch: 1 | loss: 1.1940886
	speed: 0.0436s/iter; left time: 767.3515s
	iters: 500, epoch: 1 | loss: 0.8235831
	speed: 0.0405s/iter; left time: 707.7380s
	iters: 600, epoch: 1 | loss: 0.8334130
	speed: 0.0419s/iter; left time: 729.1597s
	iters: 700, epoch: 1 | loss: 0.8780797
	speed: 0.0408s/iter; left time: 705.4266s
	iters: 800, epoch: 1 | loss: 0.8727810
	speed: 0.0408s/iter; left time: 701.0594s
	iters: 900, epoch: 1 | loss: 0.7213181
	speed: 0.0412s/iter; left time: 703.4091s
	iters: 1000, epoch: 1 | loss: 0.5836817
	speed: 0.0402s/iter; left time: 682.9062s
	iters: 1100, epoch: 1 | loss: 1.0803509
	speed: 0.0419s/iter; left time: 706.8410s
	iters: 1200, epoch: 1 | loss: 0.6129813
	speed: 0.0412s/iter; left time: 692.1653s
	iters: 1300, epoch: 1 | loss: 0.6290216
	speed: 0.0471s/iter; left time: 786.0744s
	iters: 1400, epoch: 1 | loss: 0.9375668
	speed: 0.0476s/iter; left time: 789.0692s
	iters: 1500, epoch: 1 | loss: 1.6355658
	speed: 0.0461s/iter; left time: 759.7494s
	iters: 1600, epoch: 1 | loss: 0.7760738
	speed: 0.0452s/iter; left time: 741.3376s
	iters: 1700, epoch: 1 | loss: 0.7444381
	speed: 0.0456s/iter; left time: 742.5764s
	iters: 1800, epoch: 1 | loss: 0.6923019
	speed: 0.0464s/iter; left time: 751.8019s
	iters: 1900, epoch: 1 | loss: 0.7717338
	speed: 0.0473s/iter; left time: 761.7673s
	iters: 2000, epoch: 1 | loss: 0.4520955
	speed: 0.0490s/iter; left time: 784.1934s
	iters: 2100, epoch: 1 | loss: 0.9544467
	speed: 0.0490s/iter; left time: 778.2492s
	iters: 2200, epoch: 1 | loss: 0.6064174
	speed: 0.0463s/iter; left time: 730.6900s
	iters: 2300, epoch: 1 | loss: 0.6358377
	speed: 0.0459s/iter; left time: 720.2617s
	iters: 2400, epoch: 1 | loss: 0.9691386
	speed: 0.0434s/iter; left time: 675.8000s
	iters: 2500, epoch: 1 | loss: 0.7348462
	speed: 0.0418s/iter; left time: 646.9023s
	iters: 2600, epoch: 1 | loss: 1.0208148
	speed: 0.0414s/iter; left time: 636.6968s
	iters: 2700, epoch: 1 | loss: 0.8416564
	speed: 0.0408s/iter; left time: 623.6172s
	iters: 2800, epoch: 1 | loss: 0.7423278
	speed: 0.0407s/iter; left time: 618.5955s
	iters: 2900, epoch: 1 | loss: 0.7185992
	speed: 0.0408s/iter; left time: 615.0532s
	iters: 3000, epoch: 1 | loss: 0.7217542
	speed: 0.0460s/iter; left time: 690.0375s
	iters: 3100, epoch: 1 | loss: 0.9261801
	speed: 0.0471s/iter; left time: 701.3083s
	iters: 3200, epoch: 1 | loss: 0.7454544
	speed: 0.0456s/iter; left time: 674.4359s
	iters: 3300, epoch: 1 | loss: 0.6649740
	speed: 0.0427s/iter; left time: 627.7219s
	iters: 3400, epoch: 1 | loss: 0.4968891
	speed: 0.0416s/iter; left time: 607.5396s
	iters: 3500, epoch: 1 | loss: 0.5561526
	speed: 0.0438s/iter; left time: 634.0679s
	iters: 3600, epoch: 1 | loss: 0.6462107
	speed: 0.0459s/iter; left time: 659.7692s
	iters: 3700, epoch: 1 | loss: 0.4544766
	speed: 0.0468s/iter; left time: 668.4589s
	iters: 3800, epoch: 1 | loss: 0.7262718
	speed: 0.0472s/iter; left time: 670.3729s
	iters: 3900, epoch: 1 | loss: 0.7207077
	speed: 0.0477s/iter; left time: 672.6208s
	iters: 4000, epoch: 1 | loss: 0.7417603
	speed: 0.0469s/iter; left time: 655.8643s
	iters: 4100, epoch: 1 | loss: 0.6212018
	speed: 0.0486s/iter; left time: 674.5079s
	iters: 4200, epoch: 1 | loss: 0.4548886
	speed: 0.0502s/iter; left time: 691.6485s
	iters: 4300, epoch: 1 | loss: 0.5010952
	speed: 0.0486s/iter; left time: 665.7650s
	iters: 4400, epoch: 1 | loss: 0.6980712
	speed: 0.0490s/iter; left time: 665.4592s
	iters: 4500, epoch: 1 | loss: 1.4883000
	speed: 0.0494s/iter; left time: 666.4205s
	iters: 4600, epoch: 1 | loss: 1.3656131
	speed: 0.0487s/iter; left time: 652.6868s
	iters: 4700, epoch: 1 | loss: 0.5320856
	speed: 0.0489s/iter; left time: 650.2288s
	iters: 4800, epoch: 1 | loss: 0.5069205
	speed: 0.0461s/iter; left time: 608.1444s
	iters: 4900, epoch: 1 | loss: 0.5293685
	speed: 0.0400s/iter; left time: 524.0023s
	iters: 5000, epoch: 1 | loss: 0.9294996
	speed: 0.0407s/iter; left time: 529.2536s
	iters: 5100, epoch: 1 | loss: 0.6745294
	speed: 0.0417s/iter; left time: 537.0027s
	iters: 5200, epoch: 1 | loss: 0.7693030
	speed: 0.0403s/iter; left time: 515.5499s
	iters: 5300, epoch: 1 | loss: 0.5673330
	speed: 0.0404s/iter; left time: 512.9924s
	iters: 5400, epoch: 1 | loss: 0.8415300
	speed: 0.0401s/iter; left time: 504.7162s
	iters: 5500, epoch: 1 | loss: 0.6890088
	speed: 0.0403s/iter; left time: 502.7842s
	iters: 5600, epoch: 1 | loss: 0.6657203
	speed: 0.0403s/iter; left time: 499.3565s
	iters: 5700, epoch: 1 | loss: 0.7058146
	speed: 0.0410s/iter; left time: 503.5449s
	iters: 5800, epoch: 1 | loss: 0.5481310
	speed: 0.0484s/iter; left time: 590.4682s
	iters: 5900, epoch: 1 | loss: 0.6366163
	speed: 0.0497s/iter; left time: 600.3383s
	iters: 6000, epoch: 1 | loss: 0.7066643
	speed: 0.0487s/iter; left time: 584.0336s
	iters: 6100, epoch: 1 | loss: 0.4326686
	speed: 0.0459s/iter; left time: 545.4104s
	iters: 6200, epoch: 1 | loss: 1.7282945
	speed: 0.0468s/iter; left time: 551.1605s
	iters: 6300, epoch: 1 | loss: 0.5406908
	speed: 0.0471s/iter; left time: 550.6965s
	iters: 6400, epoch: 1 | loss: 0.8025650
	speed: 0.0459s/iter; left time: 532.3310s
	iters: 6500, epoch: 1 | loss: 0.6480621
	speed: 0.0461s/iter; left time: 529.5713s
	iters: 6600, epoch: 1 | loss: 0.5515399
	speed: 0.0455s/iter; left time: 517.7919s
	iters: 6700, epoch: 1 | loss: 0.5782076
	speed: 0.0464s/iter; left time: 524.0003s
	iters: 6800, epoch: 1 | loss: 0.5337737
	speed: 0.0457s/iter; left time: 511.5477s
	iters: 6900, epoch: 1 | loss: 0.5869541
	speed: 0.0430s/iter; left time: 477.2812s
	iters: 7000, epoch: 1 | loss: 0.4896922
	speed: 0.0404s/iter; left time: 444.2566s
	iters: 7100, epoch: 1 | loss: 0.6758122
	speed: 0.0405s/iter; left time: 441.2915s
	iters: 7200, epoch: 1 | loss: 0.5165668
	speed: 0.0416s/iter; left time: 448.9667s
	iters: 7300, epoch: 1 | loss: 0.5285159
	speed: 0.0416s/iter; left time: 444.7402s
	iters: 7400, epoch: 1 | loss: 0.5175191
	speed: 0.0419s/iter; left time: 443.5469s
	iters: 7500, epoch: 1 | loss: 0.8038948
	speed: 0.0416s/iter; left time: 435.9156s
	iters: 7600, epoch: 1 | loss: 0.9329252
	speed: 0.0429s/iter; left time: 445.5737s
	iters: 7700, epoch: 1 | loss: 0.5888705
	speed: 0.0458s/iter; left time: 471.6637s
	iters: 7800, epoch: 1 | loss: 0.5106785
	speed: 0.0459s/iter; left time: 468.1529s
	iters: 7900, epoch: 1 | loss: 0.6269765
	speed: 0.0457s/iter; left time: 461.4929s
	iters: 8000, epoch: 1 | loss: 0.5859975
	speed: 0.0459s/iter; left time: 458.4839s
	iters: 8100, epoch: 1 | loss: 0.6296467
	speed: 0.0460s/iter; left time: 454.6978s
	iters: 8200, epoch: 1 | loss: 0.5882441
	speed: 0.0459s/iter; left time: 449.7223s
	iters: 8300, epoch: 1 | loss: 0.7152330
	speed: 0.0478s/iter; left time: 463.3671s
	iters: 8400, epoch: 1 | loss: 0.5975533
	speed: 0.0481s/iter; left time: 461.4341s
	iters: 8500, epoch: 1 | loss: 0.9117098
	speed: 0.0478s/iter; left time: 453.5928s
	iters: 8600, epoch: 1 | loss: 1.0167260
	speed: 0.0477s/iter; left time: 447.9815s
	iters: 8700, epoch: 1 | loss: 0.8705264
	speed: 0.0487s/iter; left time: 452.7283s
	iters: 8800, epoch: 1 | loss: 0.4895574
	speed: 0.0466s/iter; left time: 428.2309s
	iters: 8900, epoch: 1 | loss: 0.6531909
	speed: 0.0486s/iter; left time: 441.9095s
Epoch: 1 cost time: 406.99686646461487
Epoch: 1, Steps: 8994 | Train Loss: 0.7765272 Vali Loss: 0.7873908 Test Loss: 0.3987784
Validation loss decreased (inf --> 0.787391).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4123770
	speed: 0.8918s/iter; left time: 7932.2358s
	iters: 200, epoch: 2 | loss: 0.4781823
	speed: 0.0487s/iter; left time: 428.1266s
	iters: 300, epoch: 2 | loss: 0.8463534
	speed: 0.0455s/iter; left time: 395.1960s
	iters: 400, epoch: 2 | loss: 1.4145156
	speed: 0.0459s/iter; left time: 394.1955s
	iters: 500, epoch: 2 | loss: 0.6869184
	speed: 0.0473s/iter; left time: 401.5213s
	iters: 600, epoch: 2 | loss: 0.5292680
	speed: 0.0499s/iter; left time: 418.9412s
	iters: 700, epoch: 2 | loss: 0.4319208
	speed: 0.0466s/iter; left time: 386.5284s
	iters: 800, epoch: 2 | loss: 0.5935345
	speed: 0.0460s/iter; left time: 376.7122s
	iters: 900, epoch: 2 | loss: 0.7749048
	speed: 0.0463s/iter; left time: 374.9665s
	iters: 1000, epoch: 2 | loss: 0.6180075
	speed: 0.0460s/iter; left time: 367.4517s
	iters: 1100, epoch: 2 | loss: 0.5495719
	speed: 0.0496s/iter; left time: 391.7941s
	iters: 1200, epoch: 2 | loss: 0.8795955
	speed: 0.0468s/iter; left time: 364.8218s
	iters: 1300, epoch: 2 | loss: 0.6403376
	speed: 0.0443s/iter; left time: 341.0899s
	iters: 1400, epoch: 2 | loss: 0.6850354
	speed: 0.0437s/iter; left time: 331.8161s
	iters: 1500, epoch: 2 | loss: 0.8871371
	speed: 0.0420s/iter; left time: 314.6350s
	iters: 1600, epoch: 2 | loss: 0.7097973
	speed: 0.0408s/iter; left time: 301.9790s
	iters: 1700, epoch: 2 | loss: 0.7307644
	speed: 0.0403s/iter; left time: 294.1146s
	iters: 1800, epoch: 2 | loss: 1.7399882
	speed: 0.0404s/iter; left time: 290.9586s
	iters: 1900, epoch: 2 | loss: 0.3727481
	speed: 0.0414s/iter; left time: 293.6227s
	iters: 2000, epoch: 2 | loss: 0.5570401
	speed: 0.0481s/iter; left time: 336.6686s
	iters: 2100, epoch: 2 | loss: 0.6026992
	speed: 0.0483s/iter; left time: 333.1871s
	iters: 2200, epoch: 2 | loss: 0.4455303
	speed: 0.0461s/iter; left time: 313.0281s
	iters: 2300, epoch: 2 | loss: 0.5054358
	speed: 0.0428s/iter; left time: 286.3982s
	iters: 2400, epoch: 2 | loss: 0.6326649
	speed: 0.0393s/iter; left time: 259.2722s
	iters: 2500, epoch: 2 | loss: 0.5968394
	speed: 0.0406s/iter; left time: 263.6058s
	iters: 2600, epoch: 2 | loss: 1.6177833
	speed: 0.0407s/iter; left time: 260.0560s
	iters: 2700, epoch: 2 | loss: 0.5271503
	speed: 0.0406s/iter; left time: 255.7607s
	iters: 2800, epoch: 2 | loss: 0.7427248
	speed: 0.0410s/iter; left time: 254.1396s
	iters: 2900, epoch: 2 | loss: 0.5877764
	speed: 0.0407s/iter; left time: 247.8292s
	iters: 3000, epoch: 2 | loss: 0.5014781
	speed: 0.0401s/iter; left time: 240.1202s
	iters: 3100, epoch: 2 | loss: 0.5992087
	speed: 0.0404s/iter; left time: 238.2034s
	iters: 3200, epoch: 2 | loss: 1.0814396
	speed: 0.0453s/iter; left time: 262.6987s
	iters: 3300, epoch: 2 | loss: 0.5284094
	speed: 0.0466s/iter; left time: 265.4810s
	iters: 3400, epoch: 2 | loss: 0.6589192
	speed: 0.0470s/iter; left time: 262.6946s
	iters: 3500, epoch: 2 | loss: 0.5360546
	speed: 0.0471s/iter; left time: 259.0463s
	iters: 3600, epoch: 2 | loss: 0.5995237
	speed: 0.0474s/iter; left time: 255.7037s
	iters: 3700, epoch: 2 | loss: 0.7174624
	speed: 0.0468s/iter; left time: 247.7584s
	iters: 3800, epoch: 2 | loss: 1.3783560
	speed: 0.0462s/iter; left time: 239.8754s
	iters: 3900, epoch: 2 | loss: 0.6010602
	speed: 0.0461s/iter; left time: 234.9172s
	iters: 4000, epoch: 2 | loss: 0.6977138
	speed: 0.0524s/iter; left time: 261.6963s
	iters: 4100, epoch: 2 | loss: 0.7269215
	speed: 0.0506s/iter; left time: 247.4617s
	iters: 4200, epoch: 2 | loss: 0.6617746
	speed: 0.0525s/iter; left time: 251.8015s
	iters: 4300, epoch: 2 | loss: 0.6348445
	speed: 0.0468s/iter; left time: 219.5817s
	iters: 4400, epoch: 2 | loss: 0.4862959
	speed: 0.0456s/iter; left time: 209.7394s
	iters: 4500, epoch: 2 | loss: 0.8150188
	speed: 0.0469s/iter; left time: 210.9375s
	iters: 4600, epoch: 2 | loss: 0.9675512
	speed: 0.0461s/iter; left time: 202.8088s
	iters: 4700, epoch: 2 | loss: 0.4724135
	speed: 0.0455s/iter; left time: 195.4549s
	iters: 4800, epoch: 2 | loss: 0.6003394
	speed: 0.0472s/iter; left time: 197.9793s
	iters: 4900, epoch: 2 | loss: 1.5019966
	speed: 0.0459s/iter; left time: 188.1144s
	iters: 5000, epoch: 2 | loss: 0.6044062
	speed: 0.0408s/iter; left time: 162.9542s
	iters: 5100, epoch: 2 | loss: 0.5099646
	speed: 0.0418s/iter; left time: 162.9391s
	iters: 5200, epoch: 2 | loss: 0.3825482
	speed: 0.0414s/iter; left time: 157.0328s
	iters: 5300, epoch: 2 | loss: 1.5155680
	speed: 0.0406s/iter; left time: 150.0445s
	iters: 5400, epoch: 2 | loss: 0.6956530
	speed: 0.0390s/iter; left time: 140.1958s
	iters: 5500, epoch: 2 | loss: 0.4518009
	speed: 0.0428s/iter; left time: 149.6447s
	iters: 5600, epoch: 2 | loss: 0.5603905
	speed: 0.0403s/iter; left time: 136.8261s
	iters: 5700, epoch: 2 | loss: 0.4875172
	speed: 0.0408s/iter; left time: 134.4519s
	iters: 5800, epoch: 2 | loss: 0.5250298
	speed: 0.0419s/iter; left time: 133.8307s
	iters: 5900, epoch: 2 | loss: 0.9687452
	speed: 0.0418s/iter; left time: 129.4031s
	iters: 6000, epoch: 2 | loss: 0.5484301
	speed: 0.0420s/iter; left time: 125.9148s
	iters: 6100, epoch: 2 | loss: 1.5650458
	speed: 0.0427s/iter; left time: 123.5066s
	iters: 6200, epoch: 2 | loss: 0.5929119
	speed: 0.0408s/iter; left time: 114.0878s
	iters: 6300, epoch: 2 | loss: 0.7329584
	speed: 0.0407s/iter; left time: 109.5867s
	iters: 6400, epoch: 2 | loss: 0.5116724
	speed: 0.0415s/iter; left time: 107.6333s
	iters: 6500, epoch: 2 | loss: 0.4856848
	speed: 0.0408s/iter; left time: 101.7888s
	iters: 6600, epoch: 2 | loss: 0.4537687
	speed: 0.0408s/iter; left time: 97.6252s
	iters: 6700, epoch: 2 | loss: 0.5452875
	speed: 0.0486s/iter; left time: 111.5840s
	iters: 6800, epoch: 2 | loss: 0.6001534
	speed: 0.0493s/iter; left time: 108.1070s
	iters: 6900, epoch: 2 | loss: 0.8758133
	speed: 0.0475s/iter; left time: 99.4626s
	iters: 7000, epoch: 2 | loss: 1.5100253
	speed: 0.0458s/iter; left time: 91.4648s
	iters: 7100, epoch: 2 | loss: 0.7705097
	speed: 0.0445s/iter; left time: 84.3805s
	iters: 7200, epoch: 2 | loss: 0.6487290
	speed: 0.0483s/iter; left time: 86.7030s
	iters: 7300, epoch: 2 | loss: 0.5582852
	speed: 0.0465s/iter; left time: 78.7994s
	iters: 7400, epoch: 2 | loss: 0.6349622
	speed: 0.0465s/iter; left time: 74.1886s
	iters: 7500, epoch: 2 | loss: 0.5539860
	speed: 0.0463s/iter; left time: 69.2801s
	iters: 7600, epoch: 2 | loss: 0.5543035
	speed: 0.0479s/iter; left time: 66.8351s
	iters: 7700, epoch: 2 | loss: 0.5450845
	speed: 0.0488s/iter; left time: 63.1378s
	iters: 7800, epoch: 2 | loss: 0.5290015
	speed: 0.0485s/iter; left time: 57.9625s
	iters: 7900, epoch: 2 | loss: 0.3737115
	speed: 0.0476s/iter; left time: 52.1369s
	iters: 8000, epoch: 2 | loss: 0.6697157
	speed: 0.0464s/iter; left time: 46.1870s
	iters: 8100, epoch: 2 | loss: 0.5252452
	speed: 0.0474s/iter; left time: 42.4228s
	iters: 8200, epoch: 2 | loss: 0.4586287
	speed: 0.0472s/iter; left time: 37.5083s
	iters: 8300, epoch: 2 | loss: 0.4791377
	speed: 0.0467s/iter; left time: 32.4618s
	iters: 8400, epoch: 2 | loss: 0.5070408
	speed: 0.0461s/iter; left time: 27.4269s
	iters: 8500, epoch: 2 | loss: 0.7321984
	speed: 0.0458s/iter; left time: 22.6937s
	iters: 8600, epoch: 2 | loss: 0.7404590
	speed: 0.0474s/iter; left time: 18.7313s
	iters: 8700, epoch: 2 | loss: 0.5397349
	speed: 0.0477s/iter; left time: 14.0835s
	iters: 8800, epoch: 2 | loss: 0.4704150
	speed: 0.0475s/iter; left time: 9.2536s
	iters: 8900, epoch: 2 | loss: 0.4394374
	speed: 0.0475s/iter; left time: 4.5117s
Epoch: 2 cost time: 407.2339656352997
Epoch: 2, Steps: 8994 | Train Loss: 0.6860168 Vali Loss: 0.7827917 Test Loss: 0.4108676
Validation loss decreased (0.787391 --> 0.782792).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4108680188655853, mae:0.4289754331111908, rse:0.8434963822364807
