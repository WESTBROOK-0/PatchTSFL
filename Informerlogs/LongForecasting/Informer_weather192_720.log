Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_192_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_720_Informer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6612850
	speed: 0.0527s/iter; left time: 941.9567s
	iters: 200, epoch: 1 | loss: 0.8152165
	speed: 0.0348s/iter; left time: 618.5778s
	iters: 300, epoch: 1 | loss: 0.5672954
	speed: 0.0331s/iter; left time: 584.9353s
	iters: 400, epoch: 1 | loss: 0.8494430
	speed: 0.0336s/iter; left time: 591.0571s
	iters: 500, epoch: 1 | loss: 0.5736509
	speed: 0.0333s/iter; left time: 582.5870s
	iters: 600, epoch: 1 | loss: 0.6330094
	speed: 0.0331s/iter; left time: 576.0307s
	iters: 700, epoch: 1 | loss: 0.5966877
	speed: 0.0335s/iter; left time: 578.6923s
	iters: 800, epoch: 1 | loss: 0.5922369
	speed: 0.0323s/iter; left time: 554.3988s
	iters: 900, epoch: 1 | loss: 0.5241070
	speed: 0.0325s/iter; left time: 555.8192s
	iters: 1000, epoch: 1 | loss: 0.5489160
	speed: 0.0330s/iter; left time: 560.8854s
	iters: 1100, epoch: 1 | loss: 0.7134230
	speed: 0.0327s/iter; left time: 551.9985s
	iters: 1200, epoch: 1 | loss: 0.6093569
	speed: 0.0330s/iter; left time: 554.1027s
	iters: 1300, epoch: 1 | loss: 0.7064223
	speed: 0.0329s/iter; left time: 549.6430s
	iters: 1400, epoch: 1 | loss: 0.6105655
	speed: 0.0331s/iter; left time: 548.9886s
	iters: 1500, epoch: 1 | loss: 0.5275283
	speed: 0.0327s/iter; left time: 539.4232s
	iters: 1600, epoch: 1 | loss: 0.4692985
	speed: 0.0322s/iter; left time: 527.8633s
	iters: 1700, epoch: 1 | loss: 0.8553265
	speed: 0.0326s/iter; left time: 530.9252s
	iters: 1800, epoch: 1 | loss: 0.5461329
	speed: 0.0326s/iter; left time: 528.3405s
	iters: 1900, epoch: 1 | loss: 0.9944103
	speed: 0.0329s/iter; left time: 529.6026s
	iters: 2000, epoch: 1 | loss: 0.8979203
	speed: 0.0337s/iter; left time: 538.3841s
	iters: 2100, epoch: 1 | loss: 1.0025659
	speed: 0.0363s/iter; left time: 577.3459s
	iters: 2200, epoch: 1 | loss: 0.4941486
	speed: 0.0360s/iter; left time: 567.9180s
	iters: 2300, epoch: 1 | loss: 0.7290649
	speed: 0.0361s/iter; left time: 566.0684s
	iters: 2400, epoch: 1 | loss: 0.7695136
	speed: 0.0366s/iter; left time: 570.6128s
	iters: 2500, epoch: 1 | loss: 0.5368063
	speed: 0.0360s/iter; left time: 558.0992s
	iters: 2600, epoch: 1 | loss: 1.7165048
	speed: 0.0360s/iter; left time: 554.1907s
	iters: 2700, epoch: 1 | loss: 0.5116096
	speed: 0.0364s/iter; left time: 555.8523s
	iters: 2800, epoch: 1 | loss: 0.6069599
	speed: 0.0364s/iter; left time: 552.5894s
	iters: 2900, epoch: 1 | loss: 0.6103286
	speed: 0.0365s/iter; left time: 551.0823s
	iters: 3000, epoch: 1 | loss: 0.4834540
	speed: 0.0361s/iter; left time: 540.9973s
	iters: 3100, epoch: 1 | loss: 0.6166416
	speed: 0.0362s/iter; left time: 539.4753s
	iters: 3200, epoch: 1 | loss: 0.5051851
	speed: 0.0362s/iter; left time: 535.3674s
	iters: 3300, epoch: 1 | loss: 0.4549003
	speed: 0.0360s/iter; left time: 529.0848s
	iters: 3400, epoch: 1 | loss: 0.5747641
	speed: 0.0360s/iter; left time: 525.3090s
	iters: 3500, epoch: 1 | loss: 0.7223628
	speed: 0.0358s/iter; left time: 518.5470s
	iters: 3600, epoch: 1 | loss: 0.8389413
	speed: 0.0359s/iter; left time: 516.3520s
	iters: 3700, epoch: 1 | loss: 0.5438678
	speed: 0.0358s/iter; left time: 511.8763s
	iters: 3800, epoch: 1 | loss: 0.5453053
	speed: 0.0365s/iter; left time: 517.7156s
	iters: 3900, epoch: 1 | loss: 0.5859630
	speed: 0.0364s/iter; left time: 512.6403s
	iters: 4000, epoch: 1 | loss: 0.3727924
	speed: 0.0367s/iter; left time: 513.4270s
	iters: 4100, epoch: 1 | loss: 0.4161253
	speed: 0.0363s/iter; left time: 503.7309s
	iters: 4200, epoch: 1 | loss: 0.6374496
	speed: 0.0363s/iter; left time: 501.0293s
	iters: 4300, epoch: 1 | loss: 0.5351359
	speed: 0.0361s/iter; left time: 493.8847s
	iters: 4400, epoch: 1 | loss: 0.5351247
	speed: 0.0364s/iter; left time: 495.0821s
	iters: 4500, epoch: 1 | loss: 0.4557335
	speed: 0.0360s/iter; left time: 486.1975s
	iters: 4600, epoch: 1 | loss: 0.8899685
	speed: 0.0359s/iter; left time: 480.2183s
	iters: 4700, epoch: 1 | loss: 0.5472399
	speed: 0.0360s/iter; left time: 478.5478s
	iters: 4800, epoch: 1 | loss: 0.4970467
	speed: 0.0358s/iter; left time: 472.0769s
	iters: 4900, epoch: 1 | loss: 0.5619851
	speed: 0.0361s/iter; left time: 472.0445s
	iters: 5000, epoch: 1 | loss: 0.4780433
	speed: 0.0353s/iter; left time: 459.0449s
	iters: 5100, epoch: 1 | loss: 0.4558185
	speed: 0.0360s/iter; left time: 463.9584s
	iters: 5200, epoch: 1 | loss: 0.4852721
	speed: 0.0357s/iter; left time: 456.9321s
	iters: 5300, epoch: 1 | loss: 0.3405344
	speed: 0.0359s/iter; left time: 455.5020s
	iters: 5400, epoch: 1 | loss: 0.3915568
	speed: 0.0358s/iter; left time: 450.8266s
	iters: 5500, epoch: 1 | loss: 0.4884861
	speed: 0.0357s/iter; left time: 445.7081s
	iters: 5600, epoch: 1 | loss: 0.6414795
	speed: 0.0362s/iter; left time: 448.7207s
	iters: 5700, epoch: 1 | loss: 0.4219663
	speed: 0.0360s/iter; left time: 442.0920s
	iters: 5800, epoch: 1 | loss: 0.6818247
	speed: 0.0361s/iter; left time: 440.0212s
	iters: 5900, epoch: 1 | loss: 1.5269428
	speed: 0.0359s/iter; left time: 433.9653s
	iters: 6000, epoch: 1 | loss: 0.4961451
	speed: 0.0362s/iter; left time: 434.2777s
	iters: 6100, epoch: 1 | loss: 0.4941708
	speed: 0.0362s/iter; left time: 429.8851s
	iters: 6200, epoch: 1 | loss: 0.6411338
	speed: 0.0363s/iter; left time: 427.9581s
	iters: 6300, epoch: 1 | loss: 0.5500463
	speed: 0.0356s/iter; left time: 415.6911s
	iters: 6400, epoch: 1 | loss: 0.4613312
	speed: 0.0359s/iter; left time: 416.0848s
	iters: 6500, epoch: 1 | loss: 1.5418271
	speed: 0.0359s/iter; left time: 412.1893s
	iters: 6600, epoch: 1 | loss: 0.5338675
	speed: 0.0361s/iter; left time: 411.4705s
	iters: 6700, epoch: 1 | loss: 0.4361953
	speed: 0.0365s/iter; left time: 412.6054s
	iters: 6800, epoch: 1 | loss: 0.6402327
	speed: 0.0361s/iter; left time: 403.4489s
	iters: 6900, epoch: 1 | loss: 0.4653625
	speed: 0.0359s/iter; left time: 398.2698s
	iters: 7000, epoch: 1 | loss: 0.6866353
	speed: 0.0361s/iter; left time: 396.3177s
	iters: 7100, epoch: 1 | loss: 0.4458976
	speed: 0.0360s/iter; left time: 392.0764s
	iters: 7200, epoch: 1 | loss: 0.5400793
	speed: 0.0367s/iter; left time: 396.1529s
	iters: 7300, epoch: 1 | loss: 0.5850867
	speed: 0.0361s/iter; left time: 385.4129s
	iters: 7400, epoch: 1 | loss: 0.4660794
	speed: 0.0368s/iter; left time: 390.1532s
	iters: 7500, epoch: 1 | loss: 0.4029257
	speed: 0.0373s/iter; left time: 391.0706s
	iters: 7600, epoch: 1 | loss: 0.4151017
	speed: 0.0352s/iter; left time: 366.0656s
	iters: 7700, epoch: 1 | loss: 0.9698266
	speed: 0.0333s/iter; left time: 342.5090s
	iters: 7800, epoch: 1 | loss: 0.4543870
	speed: 0.0330s/iter; left time: 336.5688s
	iters: 7900, epoch: 1 | loss: 0.4535501
	speed: 0.0328s/iter; left time: 330.4190s
	iters: 8000, epoch: 1 | loss: 0.5646631
	speed: 0.0332s/iter; left time: 331.8499s
	iters: 8100, epoch: 1 | loss: 0.6783545
	speed: 0.0331s/iter; left time: 327.2666s
	iters: 8200, epoch: 1 | loss: 0.5576587
	speed: 0.0325s/iter; left time: 318.0059s
	iters: 8300, epoch: 1 | loss: 0.4445735
	speed: 0.0326s/iter; left time: 315.8415s
	iters: 8400, epoch: 1 | loss: 0.4608814
	speed: 0.0325s/iter; left time: 312.0531s
	iters: 8500, epoch: 1 | loss: 0.5435244
	speed: 0.0328s/iter; left time: 311.4558s
	iters: 8600, epoch: 1 | loss: 0.6315582
	speed: 0.0334s/iter; left time: 313.6698s
	iters: 8700, epoch: 1 | loss: 0.3907539
	speed: 0.0333s/iter; left time: 308.9446s
	iters: 8800, epoch: 1 | loss: 0.5134351
	speed: 0.0328s/iter; left time: 301.6408s
	iters: 8900, epoch: 1 | loss: 0.5903813
	speed: 0.0327s/iter; left time: 297.2812s
Epoch: 1 cost time: 316.3056809902191
Epoch: 1, Steps: 8994 | Train Loss: 0.6585062 Vali Loss: 0.9020079 Test Loss: 1.2571020
Validation loss decreased (inf --> 0.902008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4304360
	speed: 0.5117s/iter; left time: 4551.2647s
	iters: 200, epoch: 2 | loss: 0.5176560
	speed: 0.0331s/iter; left time: 291.0856s
	iters: 300, epoch: 2 | loss: 1.6299634
	speed: 0.0331s/iter; left time: 287.9910s
	iters: 400, epoch: 2 | loss: 0.4978999
	speed: 0.0333s/iter; left time: 285.9318s
	iters: 500, epoch: 2 | loss: 0.3586962
	speed: 0.0329s/iter; left time: 279.3771s
	iters: 600, epoch: 2 | loss: 0.3520303
	speed: 0.0340s/iter; left time: 285.6876s
	iters: 700, epoch: 2 | loss: 0.4083063
	speed: 0.0358s/iter; left time: 297.0451s
	iters: 800, epoch: 2 | loss: 0.4928610
	speed: 0.0351s/iter; left time: 287.6804s
	iters: 900, epoch: 2 | loss: 0.5934846
	speed: 0.0335s/iter; left time: 271.4167s
	iters: 1000, epoch: 2 | loss: 0.4846035
	speed: 0.0331s/iter; left time: 264.6674s
	iters: 1100, epoch: 2 | loss: 0.5564071
	speed: 0.0328s/iter; left time: 259.3016s
	iters: 1200, epoch: 2 | loss: 0.4287066
	speed: 0.0327s/iter; left time: 254.7815s
	iters: 1300, epoch: 2 | loss: 0.3129903
	speed: 0.0326s/iter; left time: 250.9981s
	iters: 1400, epoch: 2 | loss: 0.4428833
	speed: 0.0329s/iter; left time: 249.5377s
	iters: 1500, epoch: 2 | loss: 0.3938823
	speed: 0.0325s/iter; left time: 243.3334s
	iters: 1600, epoch: 2 | loss: 0.4724527
	speed: 0.0338s/iter; left time: 249.5893s
	iters: 1700, epoch: 2 | loss: 0.3298392
	speed: 0.0330s/iter; left time: 240.9714s
	iters: 1800, epoch: 2 | loss: 0.4244597
	speed: 0.0333s/iter; left time: 239.6763s
	iters: 1900, epoch: 2 | loss: 0.3582752
	speed: 0.0324s/iter; left time: 230.1771s
	iters: 2000, epoch: 2 | loss: 0.3893574
	speed: 0.0326s/iter; left time: 227.8711s
	iters: 2100, epoch: 2 | loss: 0.2167728
	speed: 0.0327s/iter; left time: 225.6828s
	iters: 2200, epoch: 2 | loss: 0.4949568
	speed: 0.0329s/iter; left time: 223.2498s
	iters: 2300, epoch: 2 | loss: 0.4355066
	speed: 0.0349s/iter; left time: 233.9767s
	iters: 2400, epoch: 2 | loss: 0.4320077
	speed: 0.0364s/iter; left time: 239.8804s
	iters: 2500, epoch: 2 | loss: 0.3277397
	speed: 0.0329s/iter; left time: 213.8240s
	iters: 2600, epoch: 2 | loss: 0.5282660
	speed: 0.0332s/iter; left time: 212.4832s
	iters: 2700, epoch: 2 | loss: 0.2572869
	speed: 0.0325s/iter; left time: 204.8686s
	iters: 2800, epoch: 2 | loss: 0.2660181
	speed: 0.0327s/iter; left time: 202.5555s
	iters: 2900, epoch: 2 | loss: 0.2927721
	speed: 0.0327s/iter; left time: 199.5292s
	iters: 3000, epoch: 2 | loss: 0.3273341
	speed: 0.0325s/iter; left time: 195.0977s
	iters: 3100, epoch: 2 | loss: 0.4004841
	speed: 0.0327s/iter; left time: 192.9070s
	iters: 3200, epoch: 2 | loss: 0.3422309
	speed: 0.0329s/iter; left time: 190.4274s
	iters: 3300, epoch: 2 | loss: 0.3229322
	speed: 0.0324s/iter; left time: 184.5113s
	iters: 3400, epoch: 2 | loss: 0.4789215
	speed: 0.0328s/iter; left time: 183.6460s
	iters: 3500, epoch: 2 | loss: 0.2937540
	speed: 0.0334s/iter; left time: 183.7093s
	iters: 3600, epoch: 2 | loss: 0.5479944
	speed: 0.0336s/iter; left time: 181.2731s
	iters: 3700, epoch: 2 | loss: 1.2832441
	speed: 0.0326s/iter; left time: 172.3746s
	iters: 3800, epoch: 2 | loss: 0.3621625
	speed: 0.0340s/iter; left time: 176.8292s
	iters: 3900, epoch: 2 | loss: 0.2303407
	speed: 0.0325s/iter; left time: 165.3568s
	iters: 4000, epoch: 2 | loss: 0.4536355
	speed: 0.0333s/iter; left time: 166.3782s
	iters: 4100, epoch: 2 | loss: 0.3272800
	speed: 0.0327s/iter; left time: 160.3036s
	iters: 4200, epoch: 2 | loss: 0.3244009
	speed: 0.0336s/iter; left time: 160.9118s
	iters: 4300, epoch: 2 | loss: 0.2622996
	speed: 0.0333s/iter; left time: 156.5702s
	iters: 4400, epoch: 2 | loss: 0.3504001
	speed: 0.0326s/iter; left time: 149.9939s
	iters: 4500, epoch: 2 | loss: 0.2389382
	speed: 0.0341s/iter; left time: 153.2034s
	iters: 4600, epoch: 2 | loss: 1.3709434
	speed: 0.0333s/iter; left time: 146.3736s
	iters: 4700, epoch: 2 | loss: 0.2737076
	speed: 0.0328s/iter; left time: 140.8440s
	iters: 4800, epoch: 2 | loss: 0.5300982
	speed: 0.0331s/iter; left time: 138.9050s
	iters: 4900, epoch: 2 | loss: 1.3954571
	speed: 0.0330s/iter; left time: 135.2779s
	iters: 5000, epoch: 2 | loss: 0.5621731
	speed: 0.0338s/iter; left time: 135.0613s
	iters: 5100, epoch: 2 | loss: 0.2327377
	speed: 0.0333s/iter; left time: 129.8124s
	iters: 5200, epoch: 2 | loss: 0.2538986
	speed: 0.0322s/iter; left time: 122.3117s
	iters: 5300, epoch: 2 | loss: 0.2088298
	speed: 0.0347s/iter; left time: 128.2626s
	iters: 5400, epoch: 2 | loss: 0.3111148
	speed: 0.0363s/iter; left time: 130.4542s
	iters: 5500, epoch: 2 | loss: 0.5103601
	speed: 0.0351s/iter; left time: 122.5547s
	iters: 5600, epoch: 2 | loss: 0.4012332
	speed: 0.0330s/iter; left time: 111.8738s
	iters: 5700, epoch: 2 | loss: 0.3534366
	speed: 0.0334s/iter; left time: 110.1519s
	iters: 5800, epoch: 2 | loss: 1.2007577
	speed: 0.0334s/iter; left time: 106.7233s
	iters: 5900, epoch: 2 | loss: 0.2501919
	speed: 0.0332s/iter; left time: 102.6514s
	iters: 6000, epoch: 2 | loss: 0.3984922
	speed: 0.0327s/iter; left time: 98.0003s
	iters: 6100, epoch: 2 | loss: 0.2996100
	speed: 0.0331s/iter; left time: 95.8464s
	iters: 6200, epoch: 2 | loss: 0.2737022
	speed: 0.0332s/iter; left time: 92.8109s
	iters: 6300, epoch: 2 | loss: 1.1055477
	speed: 0.0358s/iter; left time: 96.3639s
	iters: 6400, epoch: 2 | loss: 0.3682179
	speed: 0.0335s/iter; left time: 86.9457s
	iters: 6500, epoch: 2 | loss: 0.2563360
	speed: 0.0356s/iter; left time: 88.7380s
	iters: 6600, epoch: 2 | loss: 0.1924743
	speed: 0.0344s/iter; left time: 82.3612s
	iters: 6700, epoch: 2 | loss: 0.2622737
	speed: 0.0323s/iter; left time: 74.1732s
	iters: 6800, epoch: 2 | loss: 0.3424769
	speed: 0.0323s/iter; left time: 70.8170s
	iters: 6900, epoch: 2 | loss: 0.2397754
	speed: 0.0329s/iter; left time: 68.8687s
	iters: 7000, epoch: 2 | loss: 0.2333387
	speed: 0.0332s/iter; left time: 66.2664s
	iters: 7100, epoch: 2 | loss: 0.3091286
	speed: 0.0327s/iter; left time: 61.9348s
	iters: 7200, epoch: 2 | loss: 0.4155818
	speed: 0.0328s/iter; left time: 58.8740s
	iters: 7300, epoch: 2 | loss: 0.2679096
	speed: 0.0330s/iter; left time: 55.9111s
	iters: 7400, epoch: 2 | loss: 0.4496808
	speed: 0.0328s/iter; left time: 52.3785s
	iters: 7500, epoch: 2 | loss: 0.2445344
	speed: 0.0330s/iter; left time: 49.3293s
	iters: 7600, epoch: 2 | loss: 0.3685075
	speed: 0.0329s/iter; left time: 45.8636s
	iters: 7700, epoch: 2 | loss: 0.2088980
	speed: 0.0332s/iter; left time: 43.0339s
	iters: 7800, epoch: 2 | loss: 0.2307074
	speed: 0.0325s/iter; left time: 38.8608s
	iters: 7900, epoch: 2 | loss: 0.3050499
	speed: 0.0330s/iter; left time: 36.1200s
	iters: 8000, epoch: 2 | loss: 0.2761713
	speed: 0.0329s/iter; left time: 32.6894s
	iters: 8100, epoch: 2 | loss: 0.2934048
	speed: 0.0332s/iter; left time: 29.7408s
	iters: 8200, epoch: 2 | loss: 0.2173641
	speed: 0.0334s/iter; left time: 26.5293s
	iters: 8300, epoch: 2 | loss: 0.3158430
	speed: 0.0329s/iter; left time: 22.8593s
	iters: 8400, epoch: 2 | loss: 0.2754715
	speed: 0.0330s/iter; left time: 19.6169s
	iters: 8500, epoch: 2 | loss: 0.1924735
	speed: 0.0340s/iter; left time: 16.8094s
	iters: 8600, epoch: 2 | loss: 0.2265108
	speed: 0.0368s/iter; left time: 14.5364s
	iters: 8700, epoch: 2 | loss: 0.2842503
	speed: 0.0349s/iter; left time: 10.2990s
	iters: 8800, epoch: 2 | loss: 0.3118895
	speed: 0.0334s/iter; left time: 6.5174s
	iters: 8900, epoch: 2 | loss: 1.1710346
	speed: 0.0341s/iter; left time: 3.2417s
Epoch: 2 cost time: 302.05678701400757
Epoch: 2, Steps: 8994 | Train Loss: 0.4379284 Vali Loss: 0.8258814 Test Loss: 0.9828179
Validation loss decreased (0.902008 --> 0.825881).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_720_Informer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.9828194379806519, mae:0.7300721406936646, rse:1.3045746088027954
