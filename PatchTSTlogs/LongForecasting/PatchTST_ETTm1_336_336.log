Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4811136
	speed: 0.0514s/iter; left time: 1352.5809s
	iters: 200, epoch: 1 | loss: 0.4351768
	speed: 0.0451s/iter; left time: 1181.5871s
Epoch: 1 cost time: 12.666972160339355
Epoch: 1, Steps: 264 | Train Loss: 0.4978792 Vali Loss: 0.7163687 Test Loss: 0.4307570
Validation loss decreased (inf --> 0.716369).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.4095981
	speed: 0.1293s/iter; left time: 3367.0316s
	iters: 200, epoch: 2 | loss: 0.3689741
	speed: 0.0452s/iter; left time: 1172.7335s
Epoch: 2 cost time: 12.619208812713623
Epoch: 2, Steps: 264 | Train Loss: 0.4099036 Vali Loss: 0.6749340 Test Loss: 0.3987184
Validation loss decreased (0.716369 --> 0.674934).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.3460692
	speed: 0.1292s/iter; left time: 3328.6244s
	iters: 200, epoch: 3 | loss: 0.3913707
	speed: 0.0452s/iter; left time: 1160.5453s
Epoch: 3 cost time: 12.619923830032349
Epoch: 3, Steps: 264 | Train Loss: 0.3859577 Vali Loss: 0.6629878 Test Loss: 0.3872645
Validation loss decreased (0.674934 --> 0.662988).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.4206491
	speed: 0.1296s/iter; left time: 3306.4022s
	iters: 200, epoch: 4 | loss: 0.3251568
	speed: 0.0453s/iter; left time: 1149.8317s
Epoch: 4 cost time: 12.643102884292603
Epoch: 4, Steps: 264 | Train Loss: 0.3738804 Vali Loss: 0.6559597 Test Loss: 0.3814971
Validation loss decreased (0.662988 --> 0.655960).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3437476
	speed: 0.1316s/iter; left time: 3321.6339s
	iters: 200, epoch: 5 | loss: 0.4011720
	speed: 0.0452s/iter; left time: 1136.8622s
Epoch: 5 cost time: 12.720845460891724
Epoch: 5, Steps: 264 | Train Loss: 0.3672706 Vali Loss: 0.6555135 Test Loss: 0.3778081
Validation loss decreased (0.655960 --> 0.655514).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.3835152
	speed: 0.1289s/iter; left time: 3219.1782s
	iters: 200, epoch: 6 | loss: 0.3497559
	speed: 0.0452s/iter; left time: 1124.5820s
Epoch: 6 cost time: 12.615340232849121
Epoch: 6, Steps: 264 | Train Loss: 0.3633199 Vali Loss: 0.6529013 Test Loss: 0.3759545
Validation loss decreased (0.655514 --> 0.652901).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.4078688
	speed: 0.1290s/iter; left time: 3188.4511s
	iters: 200, epoch: 7 | loss: 0.3210192
	speed: 0.0453s/iter; left time: 1115.2837s
Epoch: 7 cost time: 12.546510934829712
Epoch: 7, Steps: 264 | Train Loss: 0.3600912 Vali Loss: 0.6544585 Test Loss: 0.3740318
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3471399
	speed: 0.1277s/iter; left time: 3122.3993s
	iters: 200, epoch: 8 | loss: 0.3522315
	speed: 0.0453s/iter; left time: 1102.9007s
Epoch: 8 cost time: 12.575764894485474
Epoch: 8, Steps: 264 | Train Loss: 0.3574577 Vali Loss: 0.6479731 Test Loss: 0.3735995
Validation loss decreased (0.652901 --> 0.647973).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.3456957
	speed: 0.1276s/iter; left time: 3085.5467s
	iters: 200, epoch: 9 | loss: 0.3745540
	speed: 0.0452s/iter; left time: 1089.7946s
Epoch: 9 cost time: 12.51868987083435
Epoch: 9, Steps: 264 | Train Loss: 0.3542482 Vali Loss: 0.6490912 Test Loss: 0.3702239
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.3409764
	speed: 0.1308s/iter; left time: 3129.1043s
	iters: 200, epoch: 10 | loss: 0.2998146
	speed: 0.0452s/iter; left time: 1077.5398s
Epoch: 10 cost time: 12.70702314376831
Epoch: 10, Steps: 264 | Train Loss: 0.3502459 Vali Loss: 0.6489341 Test Loss: 0.3687176
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3048662
	speed: 0.1297s/iter; left time: 3069.0103s
	iters: 200, epoch: 11 | loss: 0.3558401
	speed: 0.0452s/iter; left time: 1065.2855s
Epoch: 11 cost time: 12.633540868759155
Epoch: 11, Steps: 264 | Train Loss: 0.3462639 Vali Loss: 0.6471285 Test Loss: 0.3663141
Validation loss decreased (0.647973 --> 0.647128).  Saving model ...
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3253465
	speed: 0.1299s/iter; left time: 3039.1033s
	iters: 200, epoch: 12 | loss: 0.3618993
	speed: 0.0453s/iter; left time: 1054.2180s
Epoch: 12 cost time: 12.637706279754639
Epoch: 12, Steps: 264 | Train Loss: 0.3424173 Vali Loss: 0.6406138 Test Loss: 0.3653395
Validation loss decreased (0.647128 --> 0.640614).  Saving model ...
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3163766
	speed: 0.1290s/iter; left time: 2984.4493s
	iters: 200, epoch: 13 | loss: 0.3981708
	speed: 0.0453s/iter; left time: 1042.4686s
Epoch: 13 cost time: 12.670328617095947
Epoch: 13, Steps: 264 | Train Loss: 0.3395400 Vali Loss: 0.6373891 Test Loss: 0.3644253
Validation loss decreased (0.640614 --> 0.637389).  Saving model ...
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3104040
	speed: 0.1314s/iter; left time: 3004.4367s
	iters: 200, epoch: 14 | loss: 0.3656835
	speed: 0.0452s/iter; left time: 1029.5996s
Epoch: 14 cost time: 12.69313359260559
Epoch: 14, Steps: 264 | Train Loss: 0.3367268 Vali Loss: 0.6363085 Test Loss: 0.3648961
Validation loss decreased (0.637389 --> 0.636308).  Saving model ...
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.3537722
	speed: 0.1288s/iter; left time: 2911.4036s
	iters: 200, epoch: 15 | loss: 0.3525700
	speed: 0.0453s/iter; left time: 1018.9277s
Epoch: 15 cost time: 12.648467302322388
Epoch: 15, Steps: 264 | Train Loss: 0.3342015 Vali Loss: 0.6394014 Test Loss: 0.3654942
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.3437814
	speed: 0.1297s/iter; left time: 2898.4176s
	iters: 200, epoch: 16 | loss: 0.3376918
	speed: 0.0452s/iter; left time: 1005.1617s
Epoch: 16 cost time: 12.636309146881104
Epoch: 16, Steps: 264 | Train Loss: 0.3321828 Vali Loss: 0.6387480 Test Loss: 0.3661234
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.2953185
	speed: 0.1298s/iter; left time: 2865.6398s
	iters: 200, epoch: 17 | loss: 0.3297231
	speed: 0.0451s/iter; left time: 992.2510s
Epoch: 17 cost time: 12.631972789764404
Epoch: 17, Steps: 264 | Train Loss: 0.3298043 Vali Loss: 0.6356482 Test Loss: 0.3664751
Validation loss decreased (0.636308 --> 0.635648).  Saving model ...
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.3003002
	speed: 0.1290s/iter; left time: 2814.2984s
	iters: 200, epoch: 18 | loss: 0.3275435
	speed: 0.0452s/iter; left time: 981.8061s
Epoch: 18 cost time: 12.60930323600769
Epoch: 18, Steps: 264 | Train Loss: 0.3276409 Vali Loss: 0.6368544 Test Loss: 0.3664283
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3223137
	speed: 0.1306s/iter; left time: 2815.2332s
	iters: 200, epoch: 19 | loss: 0.3794382
	speed: 0.0452s/iter; left time: 970.1012s
Epoch: 19 cost time: 12.623389482498169
Epoch: 19, Steps: 264 | Train Loss: 0.3254447 Vali Loss: 0.6443108 Test Loss: 0.3646505
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3132935
	speed: 0.1305s/iter; left time: 2777.6090s
	iters: 200, epoch: 20 | loss: 0.3575505
	speed: 0.0452s/iter; left time: 957.7869s
Epoch: 20 cost time: 12.639511585235596
Epoch: 20, Steps: 264 | Train Loss: 0.3230543 Vali Loss: 0.6376337 Test Loss: 0.3678772
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.3184373
	speed: 0.1288s/iter; left time: 2706.9582s
	iters: 200, epoch: 21 | loss: 0.3374381
	speed: 0.0452s/iter; left time: 946.2830s
Epoch: 21 cost time: 12.607284784317017
Epoch: 21, Steps: 264 | Train Loss: 0.3203969 Vali Loss: 0.6411883 Test Loss: 0.3652331
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.3127281
	speed: 0.1279s/iter; left time: 2654.1447s
	iters: 200, epoch: 22 | loss: 0.3520488
	speed: 0.0453s/iter; left time: 934.7841s
Epoch: 22 cost time: 12.554222106933594
Epoch: 22, Steps: 264 | Train Loss: 0.3178451 Vali Loss: 0.6339615 Test Loss: 0.3658594
Validation loss decreased (0.635648 --> 0.633961).  Saving model ...
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.3094222
	speed: 0.1301s/iter; left time: 2666.5790s
	iters: 200, epoch: 23 | loss: 0.3206547
	speed: 0.0453s/iter; left time: 924.4649s
Epoch: 23 cost time: 12.668359279632568
Epoch: 23, Steps: 264 | Train Loss: 0.3152749 Vali Loss: 0.6431572 Test Loss: 0.3649436
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2880406
	speed: 0.1334s/iter; left time: 2698.6104s
	iters: 200, epoch: 24 | loss: 0.3443556
	speed: 0.0452s/iter; left time: 910.1560s
Epoch: 24 cost time: 12.684974431991577
Epoch: 24, Steps: 264 | Train Loss: 0.3125197 Vali Loss: 0.6415897 Test Loss: 0.3666681
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.3159172
	speed: 0.1298s/iter; left time: 2592.3969s
	iters: 200, epoch: 25 | loss: 0.3252856
	speed: 0.0454s/iter; left time: 901.1691s
Epoch: 25 cost time: 12.660420894622803
Epoch: 25, Steps: 264 | Train Loss: 0.3095512 Vali Loss: 0.6643675 Test Loss: 0.3668156
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2795621
	speed: 0.1286s/iter; left time: 2533.4611s
	iters: 200, epoch: 26 | loss: 0.3140995
	speed: 0.0452s/iter; left time: 885.9006s
Epoch: 26 cost time: 12.556451082229614
Epoch: 26, Steps: 264 | Train Loss: 0.3063335 Vali Loss: 0.6488782 Test Loss: 0.3667305
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2825990
	speed: 0.1278s/iter; left time: 2484.2085s
	iters: 200, epoch: 27 | loss: 0.3129713
	speed: 0.0453s/iter; left time: 875.3492s
Epoch: 27 cost time: 12.637985467910767
Epoch: 27, Steps: 264 | Train Loss: 0.3033413 Vali Loss: 0.6530804 Test Loss: 0.3696012
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.2743220
	speed: 0.1297s/iter; left time: 2487.1613s
	iters: 200, epoch: 28 | loss: 0.3185309
	speed: 0.0453s/iter; left time: 863.2579s
Epoch: 28 cost time: 12.609259128570557
Epoch: 28, Steps: 264 | Train Loss: 0.2998891 Vali Loss: 0.6658731 Test Loss: 0.3750128
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.3132506
	speed: 0.1288s/iter; left time: 2434.7868s
	iters: 200, epoch: 29 | loss: 0.2832670
	speed: 0.0453s/iter; left time: 851.2676s
Epoch: 29 cost time: 12.637043237686157
Epoch: 29, Steps: 264 | Train Loss: 0.2960474 Vali Loss: 0.6595158 Test Loss: 0.3723305
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.318137880466269e-05
	iters: 100, epoch: 30 | loss: 0.2727035
	speed: 0.1301s/iter; left time: 2424.9369s
	iters: 200, epoch: 30 | loss: 0.2720040
	speed: 0.0453s/iter; left time: 839.6383s
Epoch: 30 cost time: 12.574487924575806
Epoch: 30, Steps: 264 | Train Loss: 0.2931569 Vali Loss: 0.6653869 Test Loss: 0.3702255
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.594869846499432e-05
	iters: 100, epoch: 31 | loss: 0.2918314
	speed: 0.1294s/iter; left time: 2379.1799s
	iters: 200, epoch: 31 | loss: 0.2893250
	speed: 0.0453s/iter; left time: 828.5316s
Epoch: 31 cost time: 12.631283521652222
Epoch: 31, Steps: 264 | Train Loss: 0.2893113 Vali Loss: 0.6866047 Test Loss: 0.3762481
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.85066734838546e-05
	iters: 100, epoch: 32 | loss: 0.2886756
	speed: 0.1298s/iter; left time: 2350.8285s
	iters: 200, epoch: 32 | loss: 0.2590796
	speed: 0.0453s/iter; left time: 816.1743s
Epoch: 32 cost time: 12.65024995803833
Epoch: 32, Steps: 264 | Train Loss: 0.2860253 Vali Loss: 0.6650791 Test Loss: 0.3740712
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.083953010886336e-05
	iters: 100, epoch: 33 | loss: 0.3026447
	speed: 0.1295s/iter; left time: 2312.1222s
	iters: 200, epoch: 33 | loss: 0.2638988
	speed: 0.0452s/iter; left time: 802.6599s
Epoch: 33 cost time: 12.648879051208496
Epoch: 33, Steps: 264 | Train Loss: 0.2830768 Vali Loss: 0.7142713 Test Loss: 0.3757173
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.29328827801656e-05
	iters: 100, epoch: 34 | loss: 0.2707646
	speed: 0.1292s/iter; left time: 2272.9324s
	iters: 200, epoch: 34 | loss: 0.2946384
	speed: 0.0453s/iter; left time: 792.5325s
Epoch: 34 cost time: 12.695372581481934
Epoch: 34, Steps: 264 | Train Loss: 0.2795884 Vali Loss: 0.6993962 Test Loss: 0.3781571
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.477382283898318e-05
	iters: 100, epoch: 35 | loss: 0.2707486
	speed: 0.1303s/iter; left time: 2257.8000s
	iters: 200, epoch: 35 | loss: 0.2920755
	speed: 0.0454s/iter; left time: 781.6582s
Epoch: 35 cost time: 12.67844843864441
Epoch: 35, Steps: 264 | Train Loss: 0.2764744 Vali Loss: 0.6996376 Test Loss: 0.3803329
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.635099812885627e-05
	iters: 100, epoch: 36 | loss: 0.2727316
	speed: 0.1316s/iter; left time: 2245.7412s
	iters: 200, epoch: 36 | loss: 0.2660900
	speed: 0.0453s/iter; left time: 767.5405s
Epoch: 36 cost time: 12.737143993377686
Epoch: 36, Steps: 264 | Train Loss: 0.2731491 Vali Loss: 0.7043036 Test Loss: 0.3813086
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.765468299871352e-05
	iters: 100, epoch: 37 | loss: 0.2785820
	speed: 0.1278s/iter; left time: 2147.1714s
	iters: 200, epoch: 37 | loss: 0.2554700
	speed: 0.0453s/iter; left time: 755.7273s
Epoch: 37 cost time: 12.63594675064087
Epoch: 37, Steps: 264 | Train Loss: 0.2704419 Vali Loss: 0.7038900 Test Loss: 0.3838872
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.86768382760973e-05
	iters: 100, epoch: 38 | loss: 0.2617550
	speed: 0.1275s/iter; left time: 2107.2185s
	iters: 200, epoch: 38 | loss: 0.2943549
	speed: 0.0452s/iter; left time: 743.5870s
Epoch: 38 cost time: 12.618892669677734
Epoch: 38, Steps: 264 | Train Loss: 0.2674552 Vali Loss: 0.7007059 Test Loss: 0.3854314
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.941116084071886e-05
	iters: 100, epoch: 39 | loss: 0.2710010
	speed: 0.1288s/iter; left time: 2094.7777s
	iters: 200, epoch: 39 | loss: 0.2903267
	speed: 0.0453s/iter; left time: 731.9382s
Epoch: 39 cost time: 12.648521900177002
Epoch: 39, Steps: 264 | Train Loss: 0.2647023 Vali Loss: 0.6950363 Test Loss: 0.3854968
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.985312249264813e-05
	iters: 100, epoch: 40 | loss: 0.2559789
	speed: 0.1329s/iter; left time: 2127.5796s
	iters: 200, epoch: 40 | loss: 0.2539535
	speed: 0.0454s/iter; left time: 722.1017s
Epoch: 40 cost time: 12.969391584396362
Epoch: 40, Steps: 264 | Train Loss: 0.2619346 Vali Loss: 0.7184790 Test Loss: 0.3849595
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.999999901660576e-05
	iters: 100, epoch: 41 | loss: 0.2615346
	speed: 0.1324s/iter; left time: 2083.9153s
	iters: 200, epoch: 41 | loss: 0.2587546
	speed: 0.0455s/iter; left time: 712.1295s
Epoch: 41 cost time: 12.85662841796875
Epoch: 41, Steps: 264 | Train Loss: 0.2593508 Vali Loss: 0.7180771 Test Loss: 0.3937672
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.99309570348355e-05
	iters: 100, epoch: 42 | loss: 0.2484064
	speed: 0.1357s/iter; left time: 2100.9376s
	iters: 200, epoch: 42 | loss: 0.2759975
	speed: 0.0456s/iter; left time: 701.0777s
Epoch: 42 cost time: 12.994010925292969
Epoch: 42, Steps: 264 | Train Loss: 0.2566686 Vali Loss: 0.7121656 Test Loss: 0.3912990
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.36585915088653564, mae:0.39251017570495605, rse:0.575510561466217
