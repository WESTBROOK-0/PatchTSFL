Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_336_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_1440_Informer_custom_ftM_sl336_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35112
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 0.8720198
	speed: 0.0581s/iter; left time: 1014.6524s
	iters: 200, epoch: 1 | loss: 0.9593047
	speed: 0.0381s/iter; left time: 661.2058s
	iters: 300, epoch: 1 | loss: 0.6702105
	speed: 0.0377s/iter; left time: 651.3905s
	iters: 400, epoch: 1 | loss: 1.1017505
	speed: 0.0369s/iter; left time: 633.1587s
	iters: 500, epoch: 1 | loss: 0.6390663
	speed: 0.0374s/iter; left time: 638.2461s
	iters: 600, epoch: 1 | loss: 0.6548066
	speed: 0.0372s/iter; left time: 631.3768s
	iters: 700, epoch: 1 | loss: 0.6524459
	speed: 0.0369s/iter; left time: 621.4213s
	iters: 800, epoch: 1 | loss: 0.7211713
	speed: 0.0395s/iter; left time: 661.2150s
	iters: 900, epoch: 1 | loss: 0.6532863
	speed: 0.0393s/iter; left time: 654.7762s
	iters: 1000, epoch: 1 | loss: 1.1452950
	speed: 0.0386s/iter; left time: 639.1578s
	iters: 1100, epoch: 1 | loss: 0.5664746
	speed: 0.0369s/iter; left time: 606.7606s
	iters: 1200, epoch: 1 | loss: 0.6561278
	speed: 0.0366s/iter; left time: 599.1168s
	iters: 1300, epoch: 1 | loss: 0.6762362
	speed: 0.0368s/iter; left time: 598.1470s
	iters: 1400, epoch: 1 | loss: 0.5944861
	speed: 0.0361s/iter; left time: 583.6232s
	iters: 1500, epoch: 1 | loss: 1.0015857
	speed: 0.0367s/iter; left time: 589.0730s
	iters: 1600, epoch: 1 | loss: 0.5583401
	speed: 0.0370s/iter; left time: 590.6970s
	iters: 1700, epoch: 1 | loss: 0.7227536
	speed: 0.0370s/iter; left time: 587.4762s
	iters: 1800, epoch: 1 | loss: 0.4459750
	speed: 0.0395s/iter; left time: 622.9441s
	iters: 1900, epoch: 1 | loss: 1.0962774
	speed: 0.0371s/iter; left time: 580.2625s
	iters: 2000, epoch: 1 | loss: 0.6869242
	speed: 0.0370s/iter; left time: 575.7042s
	iters: 2100, epoch: 1 | loss: 0.5992422
	speed: 0.0363s/iter; left time: 560.5123s
	iters: 2200, epoch: 1 | loss: 1.1516236
	speed: 0.0364s/iter; left time: 559.6596s
	iters: 2300, epoch: 1 | loss: 0.8881025
	speed: 0.0362s/iter; left time: 551.7944s
	iters: 2400, epoch: 1 | loss: 0.6106735
	speed: 0.0383s/iter; left time: 580.0689s
	iters: 2500, epoch: 1 | loss: 0.7562935
	speed: 0.0377s/iter; left time: 567.6881s
	iters: 2600, epoch: 1 | loss: 0.6126127
	speed: 0.0381s/iter; left time: 570.4936s
	iters: 2700, epoch: 1 | loss: 0.6017835
	speed: 0.0363s/iter; left time: 539.7335s
	iters: 2800, epoch: 1 | loss: 1.0921534
	speed: 0.0365s/iter; left time: 539.1622s
	iters: 2900, epoch: 1 | loss: 1.0910321
	speed: 0.0361s/iter; left time: 529.6872s
	iters: 3000, epoch: 1 | loss: 0.5636357
	speed: 0.0367s/iter; left time: 534.5732s
	iters: 3100, epoch: 1 | loss: 0.4985971
	speed: 0.0372s/iter; left time: 537.6538s
	iters: 3200, epoch: 1 | loss: 0.7408081
	speed: 0.0372s/iter; left time: 533.4043s
	iters: 3300, epoch: 1 | loss: 1.1516775
	speed: 0.0370s/iter; left time: 527.8206s
	iters: 3400, epoch: 1 | loss: 0.5753969
	speed: 0.0367s/iter; left time: 519.8195s
	iters: 3500, epoch: 1 | loss: 0.6897747
	speed: 0.0370s/iter; left time: 519.7980s
	iters: 3600, epoch: 1 | loss: 0.6188774
	speed: 0.0370s/iter; left time: 516.0787s
	iters: 3700, epoch: 1 | loss: 0.7978107
	speed: 0.0364s/iter; left time: 504.0284s
	iters: 3800, epoch: 1 | loss: 1.2542460
	speed: 0.0372s/iter; left time: 512.0582s
	iters: 3900, epoch: 1 | loss: 0.5233191
	speed: 0.0366s/iter; left time: 499.9980s
	iters: 4000, epoch: 1 | loss: 0.6590906
	speed: 0.0372s/iter; left time: 504.0403s
	iters: 4100, epoch: 1 | loss: 0.5236953
	speed: 0.0364s/iter; left time: 489.5254s
	iters: 4200, epoch: 1 | loss: 0.5346140
	speed: 0.0368s/iter; left time: 492.1680s
	iters: 4300, epoch: 1 | loss: 0.6410605
	speed: 0.0369s/iter; left time: 489.3762s
	iters: 4400, epoch: 1 | loss: 0.6395682
	speed: 0.0374s/iter; left time: 491.4377s
	iters: 4500, epoch: 1 | loss: 0.6671936
	speed: 0.0376s/iter; left time: 490.4703s
	iters: 4600, epoch: 1 | loss: 0.5904452
	speed: 0.0369s/iter; left time: 477.4673s
	iters: 4700, epoch: 1 | loss: 1.4468703
	speed: 0.0375s/iter; left time: 482.0912s
	iters: 4800, epoch: 1 | loss: 0.8742508
	speed: 0.0371s/iter; left time: 473.3107s
	iters: 4900, epoch: 1 | loss: 0.4632884
	speed: 0.0361s/iter; left time: 457.1129s
	iters: 5000, epoch: 1 | loss: 0.6369590
	speed: 0.0370s/iter; left time: 464.8354s
	iters: 5100, epoch: 1 | loss: 1.1294842
	speed: 0.0366s/iter; left time: 456.1193s
	iters: 5200, epoch: 1 | loss: 0.7204217
	speed: 0.0362s/iter; left time: 447.7265s
	iters: 5300, epoch: 1 | loss: 0.4739487
	speed: 0.0365s/iter; left time: 447.4942s
	iters: 5400, epoch: 1 | loss: 0.6023324
	speed: 0.0361s/iter; left time: 439.4558s
	iters: 5500, epoch: 1 | loss: 0.9049096
	speed: 0.0364s/iter; left time: 439.4437s
	iters: 5600, epoch: 1 | loss: 0.9659929
	speed: 0.0363s/iter; left time: 433.4740s
	iters: 5700, epoch: 1 | loss: 0.9307258
	speed: 0.0375s/iter; left time: 444.1941s
	iters: 5800, epoch: 1 | loss: 0.7080648
	speed: 0.0375s/iter; left time: 440.4080s
	iters: 5900, epoch: 1 | loss: 0.4637366
	speed: 0.0367s/iter; left time: 427.7411s
	iters: 6000, epoch: 1 | loss: 1.3511539
	speed: 0.0373s/iter; left time: 430.9370s
	iters: 6100, epoch: 1 | loss: 0.5939800
	speed: 0.0360s/iter; left time: 411.9994s
	iters: 6200, epoch: 1 | loss: 0.6455601
	speed: 0.0361s/iter; left time: 410.3588s
	iters: 6300, epoch: 1 | loss: 1.0157872
	speed: 0.0363s/iter; left time: 408.5822s
	iters: 6400, epoch: 1 | loss: 0.7393526
	speed: 0.0374s/iter; left time: 416.9874s
	iters: 6500, epoch: 1 | loss: 0.6287398
	speed: 0.0371s/iter; left time: 409.9164s
	iters: 6600, epoch: 1 | loss: 0.4415286
	speed: 0.0371s/iter; left time: 406.7242s
	iters: 6700, epoch: 1 | loss: 0.8566304
	speed: 0.0369s/iter; left time: 400.4907s
	iters: 6800, epoch: 1 | loss: 0.4677680
	speed: 0.0366s/iter; left time: 393.8013s
	iters: 6900, epoch: 1 | loss: 1.1365902
	speed: 0.0367s/iter; left time: 391.4028s
	iters: 7000, epoch: 1 | loss: 0.5545382
	speed: 0.0373s/iter; left time: 393.4890s
	iters: 7100, epoch: 1 | loss: 0.4961355
	speed: 0.0376s/iter; left time: 392.8015s
	iters: 7200, epoch: 1 | loss: 0.5521827
	speed: 0.0364s/iter; left time: 377.0615s
	iters: 7300, epoch: 1 | loss: 0.5677575
	speed: 0.0368s/iter; left time: 377.5397s
	iters: 7400, epoch: 1 | loss: 0.5968879
	speed: 0.0371s/iter; left time: 376.6603s
	iters: 7500, epoch: 1 | loss: 0.4697386
	speed: 0.0378s/iter; left time: 379.7537s
	iters: 7600, epoch: 1 | loss: 0.5643330
	speed: 0.0392s/iter; left time: 389.8849s
	iters: 7700, epoch: 1 | loss: 0.6904211
	speed: 0.0369s/iter; left time: 363.3302s
	iters: 7800, epoch: 1 | loss: 0.5754386
	speed: 0.0369s/iter; left time: 360.3666s
	iters: 7900, epoch: 1 | loss: 0.6464753
	speed: 0.0369s/iter; left time: 356.3430s
	iters: 8000, epoch: 1 | loss: 0.7856840
	speed: 0.0365s/iter; left time: 348.9106s
	iters: 8100, epoch: 1 | loss: 0.3983702
	speed: 0.0376s/iter; left time: 355.6662s
	iters: 8200, epoch: 1 | loss: 0.5641191
	speed: 0.0370s/iter; left time: 346.3516s
	iters: 8300, epoch: 1 | loss: 1.1605157
	speed: 0.0373s/iter; left time: 345.6347s
	iters: 8400, epoch: 1 | loss: 0.7362935
	speed: 0.0373s/iter; left time: 341.9332s
	iters: 8500, epoch: 1 | loss: 0.7016927
	speed: 0.0364s/iter; left time: 330.0352s
	iters: 8600, epoch: 1 | loss: 0.6171470
	speed: 0.0376s/iter; left time: 336.8156s
	iters: 8700, epoch: 1 | loss: 1.0440124
	speed: 0.0391s/iter; left time: 346.4351s
Epoch: 1 cost time: 327.82616424560547
Epoch: 1, Steps: 8778 | Train Loss: 0.7088020 Vali Loss: 1.1454512 Test Loss: 2.1576903
Validation loss decreased (inf --> 1.145451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5294754
	speed: 0.5775s/iter; left time: 5012.2128s
	iters: 200, epoch: 2 | loss: 0.5273581
	speed: 0.0373s/iter; left time: 319.9981s
	iters: 300, epoch: 2 | loss: 0.7426267
	speed: 0.0378s/iter; left time: 320.8348s
	iters: 400, epoch: 2 | loss: 0.5904178
	speed: 0.0383s/iter; left time: 321.2886s
	iters: 500, epoch: 2 | loss: 0.4968859
	speed: 0.0370s/iter; left time: 306.4701s
	iters: 600, epoch: 2 | loss: 0.6029599
	speed: 0.0368s/iter; left time: 300.5828s
	iters: 700, epoch: 2 | loss: 0.7730065
	speed: 0.0366s/iter; left time: 295.6700s
	iters: 800, epoch: 2 | loss: 0.4601143
	speed: 0.0366s/iter; left time: 292.2075s
	iters: 900, epoch: 2 | loss: 0.4984964
	speed: 0.0365s/iter; left time: 287.6130s
	iters: 1000, epoch: 2 | loss: 1.8973938
	speed: 0.0361s/iter; left time: 281.1587s
	iters: 1100, epoch: 2 | loss: 0.5640410
	speed: 0.0373s/iter; left time: 286.2414s
	iters: 1200, epoch: 2 | loss: 0.4525679
	speed: 0.0367s/iter; left time: 278.5195s
	iters: 1300, epoch: 2 | loss: 0.3452605
	speed: 0.0372s/iter; left time: 278.2441s
	iters: 1400, epoch: 2 | loss: 0.3588378
	speed: 0.0386s/iter; left time: 285.0998s
	iters: 1500, epoch: 2 | loss: 0.4043648
	speed: 0.0371s/iter; left time: 270.0456s
	iters: 1600, epoch: 2 | loss: 0.5488666
	speed: 0.0375s/iter; left time: 268.8674s
	iters: 1700, epoch: 2 | loss: 0.3529777
	speed: 0.0364s/iter; left time: 257.4357s
	iters: 1800, epoch: 2 | loss: 0.3077770
	speed: 0.0365s/iter; left time: 254.8588s
	iters: 1900, epoch: 2 | loss: 0.3640013
	speed: 0.0362s/iter; left time: 249.0000s
	iters: 2000, epoch: 2 | loss: 0.4063329
	speed: 0.0366s/iter; left time: 247.8193s
	iters: 2100, epoch: 2 | loss: 0.8061920
	speed: 0.0368s/iter; left time: 245.6835s
	iters: 2200, epoch: 2 | loss: 0.3746271
	speed: 0.0363s/iter; left time: 238.8147s
	iters: 2300, epoch: 2 | loss: 0.5171220
	speed: 0.0367s/iter; left time: 237.5256s
	iters: 2400, epoch: 2 | loss: 0.4517894
	speed: 0.0375s/iter; left time: 239.4990s
	iters: 2500, epoch: 2 | loss: 0.3791653
	speed: 0.0374s/iter; left time: 234.9426s
	iters: 2600, epoch: 2 | loss: 0.4896309
	speed: 0.0372s/iter; left time: 229.9976s
	iters: 2700, epoch: 2 | loss: 0.3471806
	speed: 0.0367s/iter; left time: 222.9135s
	iters: 2800, epoch: 2 | loss: 0.3491019
	speed: 0.0366s/iter; left time: 218.9018s
	iters: 2900, epoch: 2 | loss: 0.3602148
	speed: 0.0367s/iter; left time: 215.7552s
	iters: 3000, epoch: 2 | loss: 0.3816610
	speed: 0.0364s/iter; left time: 210.3705s
	iters: 3100, epoch: 2 | loss: 0.3290595
	speed: 0.0366s/iter; left time: 207.7924s
	iters: 3200, epoch: 2 | loss: 0.3178925
	speed: 0.0366s/iter; left time: 204.1340s
	iters: 3300, epoch: 2 | loss: 0.3595133
	speed: 0.0363s/iter; left time: 198.8764s
	iters: 3400, epoch: 2 | loss: 0.3358107
	speed: 0.0370s/iter; left time: 199.0250s
	iters: 3500, epoch: 2 | loss: 0.7391752
	speed: 0.0378s/iter; left time: 199.4084s
	iters: 3600, epoch: 2 | loss: 0.4072180
	speed: 0.0364s/iter; left time: 188.6176s
	iters: 3700, epoch: 2 | loss: 0.8174381
	speed: 0.0360s/iter; left time: 182.6523s
	iters: 3800, epoch: 2 | loss: 0.3076901
	speed: 0.0360s/iter; left time: 179.4865s
	iters: 3900, epoch: 2 | loss: 0.2716511
	speed: 0.0379s/iter; left time: 185.0394s
	iters: 4000, epoch: 2 | loss: 0.3742305
	speed: 0.0381s/iter; left time: 182.1578s
	iters: 4100, epoch: 2 | loss: 0.3909377
	speed: 0.0361s/iter; left time: 169.0176s
	iters: 4200, epoch: 2 | loss: 0.2517880
	speed: 0.0363s/iter; left time: 166.4191s
	iters: 4300, epoch: 2 | loss: 0.2185983
	speed: 0.0362s/iter; left time: 162.3335s
	iters: 4400, epoch: 2 | loss: 0.2395185
	speed: 0.0370s/iter; left time: 161.9176s
	iters: 4500, epoch: 2 | loss: 0.5019243
	speed: 0.0366s/iter; left time: 156.4561s
	iters: 4600, epoch: 2 | loss: 0.2901756
	speed: 0.0365s/iter; left time: 152.4569s
	iters: 4700, epoch: 2 | loss: 0.7942698
	speed: 0.0369s/iter; left time: 150.5337s
	iters: 4800, epoch: 2 | loss: 0.3861084
	speed: 0.0372s/iter; left time: 147.9093s
	iters: 4900, epoch: 2 | loss: 0.4066233
	speed: 0.0389s/iter; left time: 150.9251s
	iters: 5000, epoch: 2 | loss: 0.4646067
	speed: 0.0362s/iter; left time: 136.6967s
	iters: 5100, epoch: 2 | loss: 0.4561245
	speed: 0.0370s/iter; left time: 135.9439s
	iters: 5200, epoch: 2 | loss: 0.3503236
	speed: 0.0372s/iter; left time: 133.1137s
	iters: 5300, epoch: 2 | loss: 0.2329819
	speed: 0.0368s/iter; left time: 128.1916s
	iters: 5400, epoch: 2 | loss: 0.2682706
	speed: 0.0370s/iter; left time: 125.1803s
	iters: 5500, epoch: 2 | loss: 0.4049247
	speed: 0.0374s/iter; left time: 122.7311s
	iters: 5600, epoch: 2 | loss: 0.4127981
	speed: 0.0381s/iter; left time: 120.9624s
	iters: 5700, epoch: 2 | loss: 0.2444922
	speed: 0.0377s/iter; left time: 116.1900s
	iters: 5800, epoch: 2 | loss: 0.3092981
	speed: 0.0384s/iter; left time: 114.3488s
	iters: 5900, epoch: 2 | loss: 0.5134550
	speed: 0.0373s/iter; left time: 107.2826s
	iters: 6000, epoch: 2 | loss: 0.3623534
	speed: 0.0369s/iter; left time: 102.6336s
	iters: 6100, epoch: 2 | loss: 0.6669186
	speed: 0.0376s/iter; left time: 100.8288s
	iters: 6200, epoch: 2 | loss: 0.7121404
	speed: 0.0366s/iter; left time: 94.3742s
	iters: 6300, epoch: 2 | loss: 0.3902830
	speed: 0.0368s/iter; left time: 91.1507s
	iters: 6400, epoch: 2 | loss: 0.2330436
	speed: 0.0382s/iter; left time: 90.7720s
	iters: 6500, epoch: 2 | loss: 0.3638162
	speed: 0.0371s/iter; left time: 84.4666s
	iters: 6600, epoch: 2 | loss: 0.3313831
	speed: 0.0387s/iter; left time: 84.3507s
	iters: 6700, epoch: 2 | loss: 0.2253658
	speed: 0.0370s/iter; left time: 76.9452s
	iters: 6800, epoch: 2 | loss: 0.2732332
	speed: 0.0371s/iter; left time: 73.4214s
	iters: 6900, epoch: 2 | loss: 0.2881026
	speed: 0.0374s/iter; left time: 70.2296s
	iters: 7000, epoch: 2 | loss: 0.2223385
	speed: 0.0402s/iter; left time: 71.5927s
	iters: 7100, epoch: 2 | loss: 0.4404726
	speed: 0.0416s/iter; left time: 69.8231s
	iters: 7200, epoch: 2 | loss: 0.7036891
	speed: 0.0391s/iter; left time: 61.7111s
	iters: 7300, epoch: 2 | loss: 0.3533627
	speed: 0.0372s/iter; left time: 54.9515s
	iters: 7400, epoch: 2 | loss: 0.6717778
	speed: 0.0368s/iter; left time: 50.7320s
	iters: 7500, epoch: 2 | loss: 0.2400152
	speed: 0.0378s/iter; left time: 48.3431s
	iters: 7600, epoch: 2 | loss: 0.8141213
	speed: 0.0365s/iter; left time: 42.9915s
	iters: 7700, epoch: 2 | loss: 0.3494191
	speed: 0.0367s/iter; left time: 39.6096s
	iters: 7800, epoch: 2 | loss: 0.2501063
	speed: 0.0370s/iter; left time: 36.2661s
	iters: 7900, epoch: 2 | loss: 0.2310536
	speed: 0.0366s/iter; left time: 32.1563s
	iters: 8000, epoch: 2 | loss: 0.2377470
	speed: 0.0365s/iter; left time: 28.4127s
	iters: 8100, epoch: 2 | loss: 0.3384277
	speed: 0.0362s/iter; left time: 24.6127s
	iters: 8200, epoch: 2 | loss: 0.2173121
	speed: 0.0368s/iter; left time: 21.2876s
	iters: 8300, epoch: 2 | loss: 0.2004306
	speed: 0.0368s/iter; left time: 17.6468s
	iters: 8400, epoch: 2 | loss: 0.3331265
	speed: 0.0374s/iter; left time: 14.1612s
	iters: 8500, epoch: 2 | loss: 0.1627060
	speed: 0.0371s/iter; left time: 10.3421s
	iters: 8600, epoch: 2 | loss: 0.3006803
	speed: 0.0364s/iter; left time: 6.5083s
	iters: 8700, epoch: 2 | loss: 1.0232855
	speed: 0.0371s/iter; left time: 2.9310s
Epoch: 2 cost time: 328.0940315723419
Epoch: 2, Steps: 8778 | Train Loss: 0.4401731 Vali Loss: 1.0534561 Test Loss: 1.1626865
Validation loss decreased (1.145451 --> 1.053456).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_1440_Informer_custom_ftM_sl336_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:1.1627246141433716, mae:0.8075763583183289, rse:1.4247030019760132
