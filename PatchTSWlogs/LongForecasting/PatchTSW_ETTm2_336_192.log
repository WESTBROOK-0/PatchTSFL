Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_192_PatchTSW_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4033332
	speed: 0.3635s/iter; left time: 9596.6358s
	iters: 200, epoch: 1 | loss: 0.3607012
	speed: 0.3466s/iter; left time: 9116.3493s
Epoch: 1 cost time: 93.67343235015869
Epoch: 1, Steps: 265 | Train Loss: 0.4170826 Vali Loss: 0.1789822 Test Loss: 0.2528758
Validation loss decreased (inf --> 0.178982).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3649648
	speed: 0.8099s/iter; left time: 21167.6680s
	iters: 200, epoch: 2 | loss: 0.2869413
	speed: 0.3467s/iter; left time: 9025.4035s
Epoch: 2 cost time: 93.56820631027222
Epoch: 2, Steps: 265 | Train Loss: 0.3382747 Vali Loss: 0.1687976 Test Loss: 0.2396327
Validation loss decreased (0.178982 --> 0.168798).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.3961881
	speed: 0.8156s/iter; left time: 21100.2266s
	iters: 200, epoch: 3 | loss: 0.2624071
	speed: 0.3466s/iter; left time: 8932.3641s
Epoch: 3 cost time: 94.06927990913391
Epoch: 3, Steps: 265 | Train Loss: 0.3214493 Vali Loss: 0.1644888 Test Loss: 0.2330392
Validation loss decreased (0.168798 --> 0.164489).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.4190184
	speed: 0.8133s/iter; left time: 20826.5022s
	iters: 200, epoch: 4 | loss: 0.3662791
	speed: 0.3462s/iter; left time: 8830.0211s
Epoch: 4 cost time: 93.77737998962402
Epoch: 4, Steps: 265 | Train Loss: 0.3119537 Vali Loss: 0.1623012 Test Loss: 0.2325725
Validation loss decreased (0.164489 --> 0.162301).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.4258939
	speed: 0.8093s/iter; left time: 20508.9190s
	iters: 200, epoch: 5 | loss: 0.2051999
	speed: 0.3461s/iter; left time: 8736.6860s
Epoch: 5 cost time: 93.63138842582703
Epoch: 5, Steps: 265 | Train Loss: 0.3046815 Vali Loss: 0.1622788 Test Loss: 0.2284899
Validation loss decreased (0.162301 --> 0.162279).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.4415013
	speed: 0.8071s/iter; left time: 20237.8414s
	iters: 200, epoch: 6 | loss: 0.2514422
	speed: 0.3462s/iter; left time: 8647.8021s
Epoch: 6 cost time: 93.8085720539093
Epoch: 6, Steps: 265 | Train Loss: 0.2980036 Vali Loss: 0.1624503 Test Loss: 0.2289684
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.2383802
	speed: 0.7987s/iter; left time: 19817.2756s
	iters: 200, epoch: 7 | loss: 0.2567370
	speed: 0.3463s/iter; left time: 8558.1375s
Epoch: 7 cost time: 93.63424873352051
Epoch: 7, Steps: 265 | Train Loss: 0.2898964 Vali Loss: 0.1609805 Test Loss: 0.2306341
Validation loss decreased (0.162279 --> 0.160981).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.2902457
	speed: 0.8083s/iter; left time: 19840.8843s
	iters: 200, epoch: 8 | loss: 0.3025666
	speed: 0.3463s/iter; left time: 8465.2493s
Epoch: 8 cost time: 93.74346399307251
Epoch: 8, Steps: 265 | Train Loss: 0.2818424 Vali Loss: 0.1617885 Test Loss: 0.2295858
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.3050785
	speed: 0.7957s/iter; left time: 19320.7897s
	iters: 200, epoch: 9 | loss: 0.2036022
	speed: 0.3462s/iter; left time: 8371.8467s
Epoch: 9 cost time: 93.48861122131348
Epoch: 9, Steps: 265 | Train Loss: 0.2725928 Vali Loss: 0.1630911 Test Loss: 0.2300060
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.1851909
	speed: 0.7974s/iter; left time: 19151.1411s
	iters: 200, epoch: 10 | loss: 0.3343047
	speed: 0.3462s/iter; left time: 8280.5332s
Epoch: 10 cost time: 93.68626070022583
Epoch: 10, Steps: 265 | Train Loss: 0.2644042 Vali Loss: 0.1644436 Test Loss: 0.2316076
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.2515820
	speed: 0.7985s/iter; left time: 18964.4798s
	iters: 200, epoch: 11 | loss: 0.2921041
	speed: 0.3463s/iter; left time: 8189.5541s
Epoch: 11 cost time: 93.65141129493713
Epoch: 11, Steps: 265 | Train Loss: 0.2573481 Vali Loss: 0.1656973 Test Loss: 0.2314324
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3018562
	speed: 0.8007s/iter; left time: 18805.4139s
	iters: 200, epoch: 12 | loss: 0.2543388
	speed: 0.3462s/iter; left time: 8096.2248s
Epoch: 12 cost time: 93.69811272621155
Epoch: 12, Steps: 265 | Train Loss: 0.2495079 Vali Loss: 0.1654405 Test Loss: 0.2303518
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2058666
	speed: 0.7960s/iter; left time: 18483.8149s
	iters: 200, epoch: 13 | loss: 0.2258039
	speed: 0.3462s/iter; left time: 8004.0952s
Epoch: 13 cost time: 93.65529561042786
Epoch: 13, Steps: 265 | Train Loss: 0.2435986 Vali Loss: 0.1671574 Test Loss: 0.2340568
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.2225688
	speed: 0.7974s/iter; left time: 18305.0995s
	iters: 200, epoch: 14 | loss: 0.2177254
	speed: 0.3463s/iter; left time: 7914.9655s
Epoch: 14 cost time: 93.52951335906982
Epoch: 14, Steps: 265 | Train Loss: 0.2387039 Vali Loss: 0.1688473 Test Loss: 0.2391210
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2296047
	speed: 0.8068s/iter; left time: 18306.5318s
	iters: 200, epoch: 15 | loss: 0.2295485
	speed: 0.3461s/iter; left time: 7819.5254s
Epoch: 15 cost time: 94.08866214752197
Epoch: 15, Steps: 265 | Train Loss: 0.2331329 Vali Loss: 0.1673425 Test Loss: 0.2323736
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2211322
	speed: 0.7998s/iter; left time: 17936.6695s
	iters: 200, epoch: 16 | loss: 0.2294855
	speed: 0.3463s/iter; left time: 7730.9363s
Epoch: 16 cost time: 93.71225309371948
Epoch: 16, Steps: 265 | Train Loss: 0.2279829 Vali Loss: 0.1697692 Test Loss: 0.2393084
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2142844
	speed: 0.8061s/iter; left time: 17864.8216s
	iters: 200, epoch: 17 | loss: 0.2262460
	speed: 0.3466s/iter; left time: 7645.8202s
Epoch: 17 cost time: 94.22976016998291
Epoch: 17, Steps: 265 | Train Loss: 0.2230536 Vali Loss: 0.1682067 Test Loss: 0.2368395
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2335833
	speed: 0.8003s/iter; left time: 17523.5509s
	iters: 200, epoch: 18 | loss: 0.1674189
	speed: 0.3465s/iter; left time: 7552.6399s
Epoch: 18 cost time: 93.64540886878967
Epoch: 18, Steps: 265 | Train Loss: 0.2181409 Vali Loss: 0.1741867 Test Loss: 0.2432234
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2096485
	speed: 0.8063s/iter; left time: 17440.5174s
	iters: 200, epoch: 19 | loss: 0.1747149
	speed: 0.3463s/iter; left time: 7455.4823s
Epoch: 19 cost time: 93.87158846855164
Epoch: 19, Steps: 265 | Train Loss: 0.2144144 Vali Loss: 0.1740624 Test Loss: 0.2421517
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.1598056
	speed: 0.7955s/iter; left time: 16997.4042s
	iters: 200, epoch: 20 | loss: 0.2012341
	speed: 0.3463s/iter; left time: 7364.8909s
Epoch: 20 cost time: 93.4821937084198
Epoch: 20, Steps: 265 | Train Loss: 0.2093657 Vali Loss: 0.1751127 Test Loss: 0.2473619
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.1846604
	speed: 0.8061s/iter; left time: 17010.3575s
	iters: 200, epoch: 21 | loss: 0.2175598
	speed: 0.3464s/iter; left time: 7274.3410s
Epoch: 21 cost time: 93.83277535438538
Epoch: 21, Steps: 265 | Train Loss: 0.2043110 Vali Loss: 0.1755940 Test Loss: 0.2483211
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2529384
	speed: 0.7995s/iter; left time: 16657.9032s
	iters: 200, epoch: 22 | loss: 0.2466241
	speed: 0.3462s/iter; left time: 7178.2914s
Epoch: 22 cost time: 93.59096455574036
Epoch: 22, Steps: 265 | Train Loss: 0.1996839 Vali Loss: 0.1765287 Test Loss: 0.2490248
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2156858
	speed: 0.7946s/iter; left time: 16346.2367s
	iters: 200, epoch: 23 | loss: 0.2033849
	speed: 0.3461s/iter; left time: 7085.3306s
Epoch: 23 cost time: 93.48610210418701
Epoch: 23, Steps: 265 | Train Loss: 0.1969063 Vali Loss: 0.1793049 Test Loss: 0.2539053
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.1748407
	speed: 0.7959s/iter; left time: 16162.1894s
	iters: 200, epoch: 24 | loss: 0.1692056
	speed: 0.3462s/iter; left time: 6994.4722s
Epoch: 24 cost time: 93.66813588142395
Epoch: 24, Steps: 265 | Train Loss: 0.1897519 Vali Loss: 0.1795935 Test Loss: 0.2508900
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.1701633
	speed: 0.7977s/iter; left time: 15986.9986s
	iters: 200, epoch: 25 | loss: 0.1892681
	speed: 0.3461s/iter; left time: 6900.9108s
Epoch: 25 cost time: 93.69815516471863
Epoch: 25, Steps: 265 | Train Loss: 0.1869166 Vali Loss: 0.1824972 Test Loss: 0.2561467
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2401110
	speed: 0.8001s/iter; left time: 15822.0250s
	iters: 200, epoch: 26 | loss: 0.1842684
	speed: 0.3461s/iter; left time: 6810.1825s
Epoch: 26 cost time: 93.63156867027283
Epoch: 26, Steps: 265 | Train Loss: 0.1832987 Vali Loss: 0.1860531 Test Loss: 0.2600877
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.1829895
	speed: 0.7990s/iter; left time: 15588.9183s
	iters: 200, epoch: 27 | loss: 0.1980555
	speed: 0.3465s/iter; left time: 6726.7246s
Epoch: 27 cost time: 93.74025082588196
Epoch: 27, Steps: 265 | Train Loss: 0.1787028 Vali Loss: 0.1875482 Test Loss: 0.2589116
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTSW_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23063398897647858, mae:0.2984434962272644, rse:0.38812369108200073
