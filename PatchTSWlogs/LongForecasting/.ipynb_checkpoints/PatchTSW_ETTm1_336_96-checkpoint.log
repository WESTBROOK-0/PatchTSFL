Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_96_PatchTSW_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3778839
	speed: 0.3649s/iter; left time: 9669.7358s
	iters: 200, epoch: 1 | loss: 0.3517080
	speed: 0.3465s/iter; left time: 9147.9372s
Epoch: 1 cost time: 94.13089799880981
Epoch: 1, Steps: 266 | Train Loss: 0.3942242 Vali Loss: 0.4275565 Test Loss: 0.3457291
Validation loss decreased (inf --> 0.427556).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.3050604
	speed: 0.8230s/iter; left time: 21592.3269s
	iters: 200, epoch: 2 | loss: 0.3176875
	speed: 0.3466s/iter; left time: 9058.2555s
Epoch: 2 cost time: 94.15650987625122
Epoch: 2, Steps: 266 | Train Loss: 0.3137873 Vali Loss: 0.3927984 Test Loss: 0.3163724
Validation loss decreased (0.427556 --> 0.392798).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2972570
	speed: 0.8269s/iter; left time: 21472.9804s
	iters: 200, epoch: 3 | loss: 0.2855800
	speed: 0.3466s/iter; left time: 8967.4343s
Epoch: 3 cost time: 94.24679827690125
Epoch: 3, Steps: 266 | Train Loss: 0.2962614 Vali Loss: 0.3849797 Test Loss: 0.3096485
Validation loss decreased (0.392798 --> 0.384980).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3009906
	speed: 0.8195s/iter; left time: 21063.0879s
	iters: 200, epoch: 4 | loss: 0.2687975
	speed: 0.3469s/iter; left time: 8882.9185s
Epoch: 4 cost time: 94.2125072479248
Epoch: 4, Steps: 266 | Train Loss: 0.2869532 Vali Loss: 0.3798527 Test Loss: 0.3064657
Validation loss decreased (0.384980 --> 0.379853).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2884689
	speed: 0.8220s/iter; left time: 20908.5461s
	iters: 200, epoch: 5 | loss: 0.2835977
	speed: 0.3468s/iter; left time: 8786.4692s
Epoch: 5 cost time: 94.18341255187988
Epoch: 5, Steps: 266 | Train Loss: 0.2797711 Vali Loss: 0.3780791 Test Loss: 0.3003009
Validation loss decreased (0.379853 --> 0.378079).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2870279
	speed: 0.8240s/iter; left time: 20739.7521s
	iters: 200, epoch: 6 | loss: 0.2651834
	speed: 0.3466s/iter; left time: 8689.4337s
Epoch: 6 cost time: 94.18727660179138
Epoch: 6, Steps: 266 | Train Loss: 0.2729933 Vali Loss: 0.3750321 Test Loss: 0.3001578
Validation loss decreased (0.378079 --> 0.375032).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.3154712
	speed: 0.8228s/iter; left time: 20491.2250s
	iters: 200, epoch: 7 | loss: 0.2792843
	speed: 0.3469s/iter; left time: 8604.7901s
Epoch: 7 cost time: 94.23800444602966
Epoch: 7, Steps: 266 | Train Loss: 0.2666714 Vali Loss: 0.3739377 Test Loss: 0.2971106
Validation loss decreased (0.375032 --> 0.373938).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2651922
	speed: 0.8220s/iter; left time: 20252.8015s
	iters: 200, epoch: 8 | loss: 0.2631031
	speed: 0.3470s/iter; left time: 8514.2109s
Epoch: 8 cost time: 94.17813539505005
Epoch: 8, Steps: 266 | Train Loss: 0.2604228 Vali Loss: 0.3695310 Test Loss: 0.2953900
Validation loss decreased (0.373938 --> 0.369531).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2570781
	speed: 0.8250s/iter; left time: 20108.9122s
	iters: 200, epoch: 9 | loss: 0.2665071
	speed: 0.3468s/iter; left time: 8417.7798s
Epoch: 9 cost time: 94.26361107826233
Epoch: 9, Steps: 266 | Train Loss: 0.2552476 Vali Loss: 0.3710186 Test Loss: 0.2946530
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502584908855415e-05
