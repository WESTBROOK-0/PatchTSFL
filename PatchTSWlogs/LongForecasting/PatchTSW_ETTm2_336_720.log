Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_720_PatchTSW_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6281335
	speed: 0.3639s/iter; left time: 9461.3290s
	iters: 200, epoch: 1 | loss: 0.4783542
	speed: 0.3471s/iter; left time: 8991.4900s
Epoch: 1 cost time: 92.42512512207031
Epoch: 1, Steps: 261 | Train Loss: 0.6168392 Vali Loss: 0.2891887 Test Loss: 0.3952982
Validation loss decreased (inf --> 0.289189).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.5847557
	speed: 0.7898s/iter; left time: 20329.3083s
	iters: 200, epoch: 2 | loss: 0.5682198
	speed: 0.3474s/iter; left time: 8907.4849s
Epoch: 2 cost time: 92.7251627445221
Epoch: 2, Steps: 261 | Train Loss: 0.5588960 Vali Loss: 0.2760811 Test Loss: 0.3806234
Validation loss decreased (0.289189 --> 0.276081).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4768654
	speed: 0.7896s/iter; left time: 20118.6466s
	iters: 200, epoch: 3 | loss: 0.4370474
	speed: 0.3474s/iter; left time: 8816.0232s
Epoch: 3 cost time: 92.4011595249176
Epoch: 3, Steps: 261 | Train Loss: 0.5433782 Vali Loss: 0.2723431 Test Loss: 0.3774005
Validation loss decreased (0.276081 --> 0.272343).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4655950
	speed: 0.7905s/iter; left time: 19933.6748s
	iters: 200, epoch: 4 | loss: 0.6803596
	speed: 0.3475s/iter; left time: 8727.3981s
Epoch: 4 cost time: 92.56113052368164
Epoch: 4, Steps: 261 | Train Loss: 0.5350774 Vali Loss: 0.2712730 Test Loss: 0.3741815
Validation loss decreased (0.272343 --> 0.271273).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.4320793
	speed: 0.7906s/iter; left time: 19731.5359s
	iters: 200, epoch: 5 | loss: 0.4306991
	speed: 0.3474s/iter; left time: 8635.1341s
Epoch: 5 cost time: 92.79076647758484
Epoch: 5, Steps: 261 | Train Loss: 0.5290210 Vali Loss: 0.2712575 Test Loss: 0.3704957
Validation loss decreased (0.271273 --> 0.271258).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.5475271
	speed: 0.7961s/iter; left time: 19660.0958s
	iters: 200, epoch: 6 | loss: 0.6108175
	speed: 0.3474s/iter; left time: 8544.9610s
Epoch: 6 cost time: 92.65073442459106
Epoch: 6, Steps: 261 | Train Loss: 0.5236234 Vali Loss: 0.2716249 Test Loss: 0.3697926
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.5410492
	speed: 0.7845s/iter; left time: 19169.0796s
	iters: 200, epoch: 7 | loss: 0.3627123
	speed: 0.3474s/iter; left time: 8454.7861s
Epoch: 7 cost time: 92.63889074325562
Epoch: 7, Steps: 261 | Train Loss: 0.5174652 Vali Loss: 0.2717459 Test Loss: 0.3664623
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.5542947
	speed: 0.7853s/iter; left time: 18984.1713s
	iters: 200, epoch: 8 | loss: 0.5372421
	speed: 0.3475s/iter; left time: 8365.5658s
Epoch: 8 cost time: 92.70630669593811
Epoch: 8, Steps: 261 | Train Loss: 0.5074732 Vali Loss: 0.2720287 Test Loss: 0.3666508
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.6504346
	speed: 0.7793s/iter; left time: 18636.0306s
	iters: 200, epoch: 9 | loss: 0.5720971
	speed: 0.3475s/iter; left time: 8274.2267s
Epoch: 9 cost time: 92.38369607925415
Epoch: 9, Steps: 261 | Train Loss: 0.4967627 Vali Loss: 0.2757398 Test Loss: 0.3671486
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.5708230
	speed: 0.7837s/iter; left time: 18536.7138s
	iters: 200, epoch: 10 | loss: 0.4746451
	speed: 0.3474s/iter; left time: 8181.7847s
Epoch: 10 cost time: 92.57683658599854
Epoch: 10, Steps: 261 | Train Loss: 0.4856517 Vali Loss: 0.2773190 Test Loss: 0.3657359
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.4681166
	speed: 0.7860s/iter; left time: 18384.5103s
	iters: 200, epoch: 11 | loss: 0.4121648
	speed: 0.3475s/iter; left time: 8092.7822s
Epoch: 11 cost time: 92.60024881362915
Epoch: 11, Steps: 261 | Train Loss: 0.4752217 Vali Loss: 0.2808626 Test Loss: 0.3663665
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.4889624
	speed: 0.7842s/iter; left time: 18138.1694s
	iters: 200, epoch: 12 | loss: 0.5133703
	speed: 0.3475s/iter; left time: 8002.5404s
Epoch: 12 cost time: 92.69329643249512
Epoch: 12, Steps: 261 | Train Loss: 0.4643167 Vali Loss: 0.2849932 Test Loss: 0.3649934
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.4219035
	speed: 0.7827s/iter; left time: 17898.9241s
	iters: 200, epoch: 13 | loss: 0.4392884
	speed: 0.3476s/iter; left time: 7914.3939s
Epoch: 13 cost time: 92.47682309150696
Epoch: 13, Steps: 261 | Train Loss: 0.4559341 Vali Loss: 0.2890984 Test Loss: 0.3649306
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.6054518
	speed: 0.7886s/iter; left time: 17829.2476s
	iters: 200, epoch: 14 | loss: 0.3741159
	speed: 0.3475s/iter; left time: 7820.6945s
Epoch: 14 cost time: 92.87997102737427
Epoch: 14, Steps: 261 | Train Loss: 0.4453708 Vali Loss: 0.2923109 Test Loss: 0.3716599
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.4933588
	speed: 0.7769s/iter; left time: 17361.1197s
	iters: 200, epoch: 15 | loss: 0.4115414
	speed: 0.3474s/iter; left time: 7729.6631s
Epoch: 15 cost time: 92.36986565589905
Epoch: 15, Steps: 261 | Train Loss: 0.4344896 Vali Loss: 0.2989488 Test Loss: 0.3724875
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.3460511
	speed: 0.7849s/iter; left time: 17334.8906s
	iters: 200, epoch: 16 | loss: 0.4761205
	speed: 0.3476s/iter; left time: 7643.0517s
Epoch: 16 cost time: 92.83466601371765
Epoch: 16, Steps: 261 | Train Loss: 0.4270166 Vali Loss: 0.2948769 Test Loss: 0.3763419
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.4968044
	speed: 0.7864s/iter; left time: 17164.0595s
	iters: 200, epoch: 17 | loss: 0.4158159
	speed: 0.3473s/iter; left time: 7544.9526s
Epoch: 17 cost time: 92.67781972885132
Epoch: 17, Steps: 261 | Train Loss: 0.4191586 Vali Loss: 0.2957252 Test Loss: 0.3791244
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.3389820
	speed: 0.7810s/iter; left time: 16841.1926s
	iters: 200, epoch: 18 | loss: 0.5581657
	speed: 0.3479s/iter; left time: 7467.0367s
Epoch: 18 cost time: 92.87704014778137
Epoch: 18, Steps: 261 | Train Loss: 0.4108667 Vali Loss: 0.3040467 Test Loss: 0.3841027
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.4474748
	speed: 0.7836s/iter; left time: 16693.4005s
	iters: 200, epoch: 19 | loss: 0.4704893
	speed: 0.3476s/iter; left time: 7369.6396s
Epoch: 19 cost time: 92.71747612953186
Epoch: 19, Steps: 261 | Train Loss: 0.4046065 Vali Loss: 0.2991876 Test Loss: 0.3838946
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.4650986
	speed: 0.7857s/iter; left time: 16531.7656s
	iters: 200, epoch: 20 | loss: 0.4457837
	speed: 0.3477s/iter; left time: 7282.3871s
Epoch: 20 cost time: 92.69596529006958
Epoch: 20, Steps: 261 | Train Loss: 0.3954332 Vali Loss: 0.3033242 Test Loss: 0.3811661
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.3774171
	speed: 0.7881s/iter; left time: 16376.7165s
	iters: 200, epoch: 21 | loss: 0.4526338
	speed: 0.3477s/iter; left time: 7191.5437s
Epoch: 21 cost time: 92.64962577819824
Epoch: 21, Steps: 261 | Train Loss: 0.3880525 Vali Loss: 0.3040460 Test Loss: 0.3822941
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3308852
	speed: 0.7826s/iter; left time: 16059.5710s
	iters: 200, epoch: 22 | loss: 0.3092916
	speed: 0.3479s/iter; left time: 7104.6748s
Epoch: 22 cost time: 92.69621634483337
Epoch: 22, Steps: 261 | Train Loss: 0.3816613 Vali Loss: 0.3051259 Test Loss: 0.3843353
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.4217503
	speed: 0.7890s/iter; left time: 15984.6660s
	iters: 200, epoch: 23 | loss: 0.3990673
	speed: 0.3476s/iter; left time: 7007.2055s
Epoch: 23 cost time: 92.87523651123047
Epoch: 23, Steps: 261 | Train Loss: 0.3771053 Vali Loss: 0.3053143 Test Loss: 0.3910857
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3426390
	speed: 0.7801s/iter; left time: 15600.7455s
	iters: 200, epoch: 24 | loss: 0.3192070
	speed: 0.3475s/iter; left time: 6915.3451s
Epoch: 24 cost time: 92.40551948547363
Epoch: 24, Steps: 261 | Train Loss: 0.3680331 Vali Loss: 0.3082076 Test Loss: 0.3852796
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3641891
	speed: 0.7814s/iter; left time: 15423.4465s
	iters: 200, epoch: 25 | loss: 0.3518327
	speed: 0.3475s/iter; left time: 6823.7374s
Epoch: 25 cost time: 92.64349865913391
Epoch: 25, Steps: 261 | Train Loss: 0.3604121 Vali Loss: 0.3129511 Test Loss: 0.3935836
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTSW_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.37049511075019836, mae:0.38668525218963623, rse:0.4886987507343292
