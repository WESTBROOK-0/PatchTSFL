Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm2_336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm2_336_336_PatchTSFL_ETTm2_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3080650
	speed: 0.0664s/iter; left time: 1747.2118s
	iters: 200, epoch: 1 | loss: 0.2357268
	speed: 0.0451s/iter; left time: 1180.4510s
Epoch: 1 cost time: 14.09348464012146
Epoch: 1, Steps: 264 | Train Loss: 0.2710055 Vali Loss: 0.2300004 Test Loss: 0.1551066
Validation loss decreased (inf --> 0.230000).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.2493845
	speed: 0.1611s/iter; left time: 4193.3885s
	iters: 200, epoch: 2 | loss: 0.2818734
	speed: 0.0463s/iter; left time: 1200.1999s
Epoch: 2 cost time: 14.410029649734497
Epoch: 2, Steps: 264 | Train Loss: 0.2466588 Vali Loss: 0.2250941 Test Loss: 0.1496630
Validation loss decreased (0.230000 --> 0.225094).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.2264709
	speed: 0.1632s/iter; left time: 4204.9048s
	iters: 200, epoch: 3 | loss: 0.2204048
	speed: 0.0476s/iter; left time: 1222.2819s
Epoch: 3 cost time: 14.629466533660889
Epoch: 3, Steps: 264 | Train Loss: 0.2396475 Vali Loss: 0.2192119 Test Loss: 0.1448393
Validation loss decreased (0.225094 --> 0.219212).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.1965951
	speed: 0.1664s/iter; left time: 4244.9323s
	iters: 200, epoch: 4 | loss: 0.2008924
	speed: 0.0456s/iter; left time: 1158.7036s
Epoch: 4 cost time: 14.085708618164062
Epoch: 4, Steps: 264 | Train Loss: 0.2302742 Vali Loss: 0.2062902 Test Loss: 0.1361873
Validation loss decreased (0.219212 --> 0.206290).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.2500047
	speed: 0.1648s/iter; left time: 4160.7492s
	iters: 200, epoch: 5 | loss: 0.2244067
	speed: 0.0456s/iter; left time: 1147.1549s
Epoch: 5 cost time: 14.268375158309937
Epoch: 5, Steps: 264 | Train Loss: 0.2100033 Vali Loss: 0.1995452 Test Loss: 0.1333095
Validation loss decreased (0.206290 --> 0.199545).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.2299995
	speed: 0.1653s/iter; left time: 4129.8306s
	iters: 200, epoch: 6 | loss: 0.1645125
	speed: 0.0445s/iter; left time: 1107.3477s
Epoch: 6 cost time: 14.158182382583618
Epoch: 6, Steps: 264 | Train Loss: 0.1962794 Vali Loss: 0.1982716 Test Loss: 0.1333478
Validation loss decreased (0.199545 --> 0.198272).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.2027355
	speed: 0.1654s/iter; left time: 4089.1553s
	iters: 200, epoch: 7 | loss: 0.1635111
	speed: 0.0443s/iter; left time: 1091.2561s
Epoch: 7 cost time: 14.389795303344727
Epoch: 7, Steps: 264 | Train Loss: 0.1896203 Vali Loss: 0.1976622 Test Loss: 0.1323874
Validation loss decreased (0.198272 --> 0.197662).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.1824984
	speed: 0.1615s/iter; left time: 3948.9965s
	iters: 200, epoch: 8 | loss: 0.1977119
	speed: 0.0461s/iter; left time: 1122.0921s
Epoch: 8 cost time: 14.32752513885498
Epoch: 8, Steps: 264 | Train Loss: 0.1839960 Vali Loss: 0.1950765 Test Loss: 0.1312328
Validation loss decreased (0.197662 --> 0.195076).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.1902056
	speed: 0.1680s/iter; left time: 4063.8214s
	iters: 200, epoch: 9 | loss: 0.2002897
	speed: 0.0463s/iter; left time: 1114.9011s
Epoch: 9 cost time: 14.590728282928467
Epoch: 9, Steps: 264 | Train Loss: 0.1791521 Vali Loss: 0.1963334 Test Loss: 0.1320853
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.1491578
	speed: 0.1699s/iter; left time: 4064.1328s
	iters: 200, epoch: 10 | loss: 0.2153691
	speed: 0.0481s/iter; left time: 1145.7193s
Epoch: 10 cost time: 14.892552375793457
Epoch: 10, Steps: 264 | Train Loss: 0.1756096 Vali Loss: 0.1954321 Test Loss: 0.1320291
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.2139652
	speed: 0.1623s/iter; left time: 3841.1034s
	iters: 200, epoch: 11 | loss: 0.1617917
	speed: 0.0466s/iter; left time: 1097.6995s
Epoch: 11 cost time: 14.508458137512207
Epoch: 11, Steps: 264 | Train Loss: 0.1722537 Vali Loss: 0.1949610 Test Loss: 0.1325584
Validation loss decreased (0.195076 --> 0.194961).  Saving model ...
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.1634566
	speed: 0.1649s/iter; left time: 3858.4929s
	iters: 200, epoch: 12 | loss: 0.1652719
	speed: 0.0447s/iter; left time: 1042.3785s
Epoch: 12 cost time: 13.91094708442688
Epoch: 12, Steps: 264 | Train Loss: 0.1692911 Vali Loss: 0.1941680 Test Loss: 0.1327324
Validation loss decreased (0.194961 --> 0.194168).  Saving model ...
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.1847909
	speed: 0.1592s/iter; left time: 3681.9885s
	iters: 200, epoch: 13 | loss: 0.1432367
	speed: 0.0455s/iter; left time: 1048.4307s
Epoch: 13 cost time: 14.064012050628662
Epoch: 13, Steps: 264 | Train Loss: 0.1674588 Vali Loss: 0.1924384 Test Loss: 0.1310099
Validation loss decreased (0.194168 --> 0.192438).  Saving model ...
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.1596763
	speed: 0.1718s/iter; left time: 3928.0484s
	iters: 200, epoch: 14 | loss: 0.1418051
	speed: 0.0455s/iter; left time: 1035.4758s
Epoch: 14 cost time: 14.837054252624512
Epoch: 14, Steps: 264 | Train Loss: 0.1653707 Vali Loss: 0.1934736 Test Loss: 0.1329775
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.1814446
	speed: 0.1622s/iter; left time: 3666.6211s
	iters: 200, epoch: 15 | loss: 0.1764474
	speed: 0.0474s/iter; left time: 1066.2761s
Epoch: 15 cost time: 14.616817474365234
Epoch: 15, Steps: 264 | Train Loss: 0.1636548 Vali Loss: 0.1959309 Test Loss: 0.1345614
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.1660446
	speed: 0.1634s/iter; left time: 3649.4992s
	iters: 200, epoch: 16 | loss: 0.1450358
	speed: 0.0493s/iter; left time: 1095.4153s
Epoch: 16 cost time: 14.545045137405396
Epoch: 16, Steps: 264 | Train Loss: 0.1619040 Vali Loss: 0.1950817 Test Loss: 0.1341558
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.1773775
	speed: 0.1665s/iter; left time: 3675.6072s
	iters: 200, epoch: 17 | loss: 0.1528660
	speed: 0.0458s/iter; left time: 1007.3521s
Epoch: 17 cost time: 14.62989854812622
Epoch: 17, Steps: 264 | Train Loss: 0.1602046 Vali Loss: 0.1929273 Test Loss: 0.1369364
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.1449446
	speed: 0.1746s/iter; left time: 3807.5176s
	iters: 200, epoch: 18 | loss: 0.1831036
	speed: 0.0450s/iter; left time: 976.7709s
Epoch: 18 cost time: 14.526148319244385
Epoch: 18, Steps: 264 | Train Loss: 0.1585739 Vali Loss: 0.1939364 Test Loss: 0.1365134
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.1649913
	speed: 0.1603s/iter; left time: 3454.8451s
	iters: 200, epoch: 19 | loss: 0.1475782
	speed: 0.0480s/iter; left time: 1030.1043s
Epoch: 19 cost time: 14.628089189529419
Epoch: 19, Steps: 264 | Train Loss: 0.1567207 Vali Loss: 0.1958664 Test Loss: 0.1382476
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.1645220
	speed: 0.1724s/iter; left time: 3669.3097s
	iters: 200, epoch: 20 | loss: 0.1280672
	speed: 0.0459s/iter; left time: 972.0984s
Epoch: 20 cost time: 14.472492456436157
Epoch: 20, Steps: 264 | Train Loss: 0.1546292 Vali Loss: 0.1970856 Test Loss: 0.1380784
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.1529964
	speed: 0.1699s/iter; left time: 3571.8187s
	iters: 200, epoch: 21 | loss: 0.1511613
	speed: 0.0477s/iter; left time: 997.5618s
Epoch: 21 cost time: 15.403516292572021
Epoch: 21, Steps: 264 | Train Loss: 0.1525566 Vali Loss: 0.1977567 Test Loss: 0.1406774
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.1462645
	speed: 0.1716s/iter; left time: 3561.1285s
	iters: 200, epoch: 22 | loss: 0.1642633
	speed: 0.0461s/iter; left time: 953.0141s
Epoch: 22 cost time: 14.535419464111328
Epoch: 22, Steps: 264 | Train Loss: 0.1506686 Vali Loss: 0.1987881 Test Loss: 0.1410421
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.1246816
	speed: 0.1683s/iter; left time: 3449.6095s
	iters: 200, epoch: 23 | loss: 0.1542244
	speed: 0.0462s/iter; left time: 941.1455s
Epoch: 23 cost time: 14.191283226013184
Epoch: 23, Steps: 264 | Train Loss: 0.1488164 Vali Loss: 0.2041448 Test Loss: 0.1433984
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.1390854
	speed: 0.1585s/iter; left time: 3206.1602s
	iters: 200, epoch: 24 | loss: 0.1280699
	speed: 0.0456s/iter; left time: 918.1073s
Epoch: 24 cost time: 14.096154689788818
Epoch: 24, Steps: 264 | Train Loss: 0.1466480 Vali Loss: 0.2058630 Test Loss: 0.1453228
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.1354968
	speed: 0.1640s/iter; left time: 3274.0159s
	iters: 200, epoch: 25 | loss: 0.1783504
	speed: 0.0462s/iter; left time: 917.3178s
Epoch: 25 cost time: 14.397567749023438
Epoch: 25, Steps: 264 | Train Loss: 0.1442108 Vali Loss: 0.2026162 Test Loss: 0.1462062
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.1463584
	speed: 0.1624s/iter; left time: 3198.7331s
	iters: 200, epoch: 26 | loss: 0.1693021
	speed: 0.0459s/iter; left time: 899.6359s
Epoch: 26 cost time: 14.35790729522705
Epoch: 26, Steps: 264 | Train Loss: 0.1421386 Vali Loss: 0.2032963 Test Loss: 0.1488171
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.1454381
	speed: 0.1701s/iter; left time: 3305.5592s
	iters: 200, epoch: 27 | loss: 0.1579033
	speed: 0.0475s/iter; left time: 917.5466s
Epoch: 27 cost time: 15.05744218826294
Epoch: 27, Steps: 264 | Train Loss: 0.1399502 Vali Loss: 0.2158614 Test Loss: 0.1510215
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.1234827
	speed: 0.1745s/iter; left time: 3345.3114s
	iters: 200, epoch: 28 | loss: 0.1585815
	speed: 0.0462s/iter; left time: 880.7706s
Epoch: 28 cost time: 14.988598585128784
Epoch: 28, Steps: 264 | Train Loss: 0.1377248 Vali Loss: 0.2163484 Test Loss: 0.1514173
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.1258946
	speed: 0.1809s/iter; left time: 3421.1232s
	iters: 200, epoch: 29 | loss: 0.1194801
	speed: 0.0477s/iter; left time: 897.1968s
Epoch: 29 cost time: 15.431442737579346
Epoch: 29, Steps: 264 | Train Loss: 0.1353862 Vali Loss: 0.2166083 Test Loss: 0.1550216
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.318137880466269e-05
	iters: 100, epoch: 30 | loss: 0.1425648
	speed: 0.1776s/iter; left time: 3311.9390s
	iters: 200, epoch: 30 | loss: 0.1215403
	speed: 0.0496s/iter; left time: 920.3660s
Epoch: 30 cost time: 15.296726703643799
Epoch: 30, Steps: 264 | Train Loss: 0.1332233 Vali Loss: 0.2154496 Test Loss: 0.1527761
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.594869846499432e-05
	iters: 100, epoch: 31 | loss: 0.1285756
	speed: 0.1772s/iter; left time: 3257.1915s
	iters: 200, epoch: 31 | loss: 0.1370509
	speed: 0.0456s/iter; left time: 832.8608s
Epoch: 31 cost time: 14.745969533920288
Epoch: 31, Steps: 264 | Train Loss: 0.1310074 Vali Loss: 0.2206226 Test Loss: 0.1536927
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.85066734838546e-05
	iters: 100, epoch: 32 | loss: 0.1365837
	speed: 0.1783s/iter; left time: 3230.5009s
	iters: 200, epoch: 32 | loss: 0.1254573
	speed: 0.0461s/iter; left time: 831.3147s
Epoch: 32 cost time: 14.839705467224121
Epoch: 32, Steps: 264 | Train Loss: 0.1293561 Vali Loss: 0.2225050 Test Loss: 0.1615556
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.083953010886336e-05
	iters: 100, epoch: 33 | loss: 0.1318443
	speed: 0.1800s/iter; left time: 3213.0623s
	iters: 200, epoch: 33 | loss: 0.1273193
	speed: 0.0451s/iter; left time: 799.9083s
Epoch: 33 cost time: 14.6361083984375
Epoch: 33, Steps: 264 | Train Loss: 0.1265161 Vali Loss: 0.2236826 Test Loss: 0.1581011
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_336_PatchTSFL_ETTm2_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.13100993633270264, mae:0.27573665976524353, rse:0.590762197971344
