Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=1, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='CIPatchTSF', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : weather_336_96_CIPatchTSF_custom_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5603561
	speed: 0.7357s/iter; left time: 20822.4434s
	iters: 200, epoch: 1 | loss: 0.5226018
	speed: 0.6981s/iter; left time: 19688.3735s
Epoch: 1 cost time: 199.00145030021667
Epoch: 1, Steps: 284 | Train Loss: 0.6361096 Vali Loss: 0.5334442 Test Loss: 0.2491840
Validation loss decreased (inf --> 0.533444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4560022
	speed: 1.5509s/iter; left time: 43451.0543s
	iters: 200, epoch: 2 | loss: 0.5899260
	speed: 0.7346s/iter; left time: 20508.3786s
Epoch: 2 cost time: 206.1880910396576
Epoch: 2, Steps: 284 | Train Loss: 0.4611588 Vali Loss: 0.3888655 Test Loss: 0.1520727
Validation loss decreased (0.533444 --> 0.388866).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2940698
	speed: 1.5032s/iter; left time: 41687.4605s
	iters: 200, epoch: 3 | loss: 0.3351679
	speed: 0.6797s/iter; left time: 18781.3966s
Epoch: 3 cost time: 195.5456085205078
Epoch: 3, Steps: 284 | Train Loss: 0.4094372 Vali Loss: 0.3968587 Test Loss: 0.1517321
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3202959
	speed: 1.5397s/iter; left time: 42264.3515s
	iters: 200, epoch: 4 | loss: 0.5077775
	speed: 0.6412s/iter; left time: 17535.7067s
Epoch: 4 cost time: 185.72805213928223
Epoch: 4, Steps: 284 | Train Loss: 0.3947898 Vali Loss: 0.3974236 Test Loss: 0.1536783
EarlyStopping counter: 2 out of 20
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5477652
	speed: 1.5468s/iter; left time: 42017.9286s
	iters: 200, epoch: 5 | loss: 0.3701407
	speed: 0.7219s/iter; left time: 19537.0232s
Epoch: 5 cost time: 207.03421902656555
Epoch: 5, Steps: 284 | Train Loss: 0.3840937 Vali Loss: 0.3959844 Test Loss: 0.1551624
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5735574
	speed: 1.5303s/iter; left time: 41135.0299s
	iters: 200, epoch: 6 | loss: 0.2863662
	speed: 0.6664s/iter; left time: 17846.2859s
Epoch: 6 cost time: 197.7778389453888
Epoch: 6, Steps: 284 | Train Loss: 0.3748956 Vali Loss: 0.4020057 Test Loss: 0.1563496
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2701612
	speed: 1.6891s/iter; left time: 44925.2838s
	iters: 200, epoch: 7 | loss: 0.3387094
	speed: 0.7502s/iter; left time: 19878.5382s
Epoch: 7 cost time: 215.08492231369019
Epoch: 7, Steps: 284 | Train Loss: 0.3692938 Vali Loss: 0.4000439 Test Loss: 0.1556200
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2603111
	speed: 1.6428s/iter; left time: 43226.5052s
	iters: 200, epoch: 8 | loss: 0.2675146
	speed: 0.6938s/iter; left time: 18186.1535s
Epoch: 8 cost time: 204.32120442390442
Epoch: 8, Steps: 284 | Train Loss: 0.3642571 Vali Loss: 0.4015779 Test Loss: 0.1588141
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2652614
	speed: 1.5152s/iter; left time: 39439.5232s
	iters: 200, epoch: 9 | loss: 0.2500274
	speed: 0.6759s/iter; left time: 17525.4372s
Epoch: 9 cost time: 194.7715528011322
Epoch: 9, Steps: 284 | Train Loss: 0.3600102 Vali Loss: 0.4005055 Test Loss: 0.1576983
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7062751
	speed: 1.5550s/iter; left time: 40034.0756s
	iters: 200, epoch: 10 | loss: 0.2766797
	speed: 0.6859s/iter; left time: 17590.8611s
Epoch: 10 cost time: 201.13808345794678
Epoch: 10, Steps: 284 | Train Loss: 0.3554055 Vali Loss: 0.4060677 Test Loss: 0.1591649
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3193410
	speed: 1.6067s/iter; left time: 40908.0577s
	iters: 200, epoch: 11 | loss: 0.2947135
	speed: 0.7502s/iter; left time: 19025.8462s
Epoch: 11 cost time: 216.5125982761383
Epoch: 11, Steps: 284 | Train Loss: 0.3531852 Vali Loss: 0.4085554 Test Loss: 0.1599306
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5442048
	speed: 1.6788s/iter; left time: 42266.6428s
	iters: 200, epoch: 12 | loss: 0.2853646
	speed: 0.7419s/iter; left time: 18604.0312s
Epoch: 12 cost time: 214.21678519248962
Epoch: 12, Steps: 284 | Train Loss: 0.3502537 Vali Loss: 0.4062777 Test Loss: 0.1599938
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.4850372
	speed: 1.5560s/iter; left time: 38734.1863s
	iters: 200, epoch: 13 | loss: 0.2796372
	speed: 0.7074s/iter; left time: 17537.4384s
Epoch: 13 cost time: 198.15445399284363
Epoch: 13, Steps: 284 | Train Loss: 0.3478665 Vali Loss: 0.4115495 Test Loss: 0.1616230
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3250220
	speed: 1.5378s/iter; left time: 37844.7073s
	iters: 200, epoch: 14 | loss: 0.2535519
	speed: 0.6732s/iter; left time: 16499.7264s
Epoch: 14 cost time: 196.70343613624573
Epoch: 14, Steps: 284 | Train Loss: 0.3456604 Vali Loss: 0.4098037 Test Loss: 0.1606810
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.2799878
	speed: 1.5220s/iter; left time: 37021.6202s
	iters: 200, epoch: 15 | loss: 0.2557180
	speed: 0.6864s/iter; left time: 16628.4900s
Epoch: 15 cost time: 201.4855706691742
Epoch: 15, Steps: 284 | Train Loss: 0.3438343 Vali Loss: 0.4118588 Test Loss: 0.1613231
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4933099
	speed: 1.5983s/iter; left time: 38424.1192s
	iters: 200, epoch: 16 | loss: 0.3148374
	speed: 0.7185s/iter; left time: 17200.9827s
Epoch: 16 cost time: 201.53288173675537
Epoch: 16, Steps: 284 | Train Loss: 0.3416377 Vali Loss: 0.4128292 Test Loss: 0.1624522
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2186558
	speed: 1.5954s/iter; left time: 37902.3630s
	iters: 200, epoch: 17 | loss: 0.2231475
	speed: 0.7808s/iter; left time: 18470.9908s
Epoch: 17 cost time: 210.8038613796234
Epoch: 17, Steps: 284 | Train Loss: 0.3403342 Vali Loss: 0.4126708 Test Loss: 0.1627435
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2395463
	speed: 1.5523s/iter; left time: 36436.0436s
	iters: 200, epoch: 18 | loss: 0.5022429
	speed: 0.6493s/iter; left time: 15175.2034s
Epoch: 18 cost time: 191.83089685440063
Epoch: 18, Steps: 284 | Train Loss: 0.3381126 Vali Loss: 0.4137967 Test Loss: 0.1624086
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.2300618
	speed: 1.5370s/iter; left time: 35642.6312s
	iters: 200, epoch: 19 | loss: 0.4863990
	speed: 0.6842s/iter; left time: 15797.6789s
Epoch: 19 cost time: 200.50004315376282
Epoch: 19, Steps: 284 | Train Loss: 0.3375180 Vali Loss: 0.4126906 Test Loss: 0.1631760
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.2304225
	speed: 1.5513s/iter; left time: 35532.7372s
	iters: 200, epoch: 20 | loss: 0.2148297
	speed: 0.7646s/iter; left time: 17436.1002s
Epoch: 20 cost time: 209.10563707351685
Epoch: 20, Steps: 284 | Train Loss: 0.3360918 Vali Loss: 0.4149261 Test Loss: 0.1629839
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.2820878
	speed: 1.6225s/iter; left time: 36702.2364s
	iters: 200, epoch: 21 | loss: 0.2489008
	speed: 0.7798s/iter; left time: 17561.3783s
Epoch: 21 cost time: 219.7671582698822
Epoch: 21, Steps: 284 | Train Loss: 0.3355532 Vali Loss: 0.4157681 Test Loss: 0.1630614
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.2156011
	speed: 1.6551s/iter; left time: 36969.3310s
	iters: 200, epoch: 22 | loss: 0.3296874
	speed: 0.7490s/iter; left time: 16654.8420s
Epoch: 22 cost time: 215.384441614151
Epoch: 22, Steps: 284 | Train Loss: 0.3343506 Vali Loss: 0.4163012 Test Loss: 0.1636130
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : weather_336_96_CIPatchTSF_custom_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.15207254886627197, mae:0.20405283570289612, rse:0.5137306451797485
