Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_Autoformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9714310
	speed: 0.0961s/iter; left time: 1711.6400s
	iters: 200, epoch: 1 | loss: 1.0470567
	speed: 0.0744s/iter; left time: 1317.9737s
	iters: 300, epoch: 1 | loss: 0.7481812
	speed: 0.0744s/iter; left time: 1311.4391s
	iters: 400, epoch: 1 | loss: 0.8110026
	speed: 0.0734s/iter; left time: 1286.2556s
	iters: 500, epoch: 1 | loss: 0.7379853
	speed: 0.0744s/iter; left time: 1295.9895s
	iters: 600, epoch: 1 | loss: 0.5557051
	speed: 0.0748s/iter; left time: 1295.3417s
	iters: 700, epoch: 1 | loss: 1.0715314
	speed: 0.0724s/iter; left time: 1245.9027s
	iters: 800, epoch: 1 | loss: 0.7888529
	speed: 0.0735s/iter; left time: 1258.6781s
	iters: 900, epoch: 1 | loss: 0.7772713
	speed: 0.0751s/iter; left time: 1277.6262s
	iters: 1000, epoch: 1 | loss: 0.6672680
	speed: 0.0740s/iter; left time: 1251.4898s
	iters: 1100, epoch: 1 | loss: 0.9481919
	speed: 0.0752s/iter; left time: 1264.2943s
	iters: 1200, epoch: 1 | loss: 0.6427011
	speed: 0.0748s/iter; left time: 1249.6385s
	iters: 1300, epoch: 1 | loss: 0.9125000
	speed: 0.0735s/iter; left time: 1222.0891s
	iters: 1400, epoch: 1 | loss: 0.5417894
	speed: 0.0743s/iter; left time: 1227.4235s
	iters: 1500, epoch: 1 | loss: 1.1154231
	speed: 0.0752s/iter; left time: 1235.3570s
	iters: 1600, epoch: 1 | loss: 1.5117500
	speed: 0.0753s/iter; left time: 1229.3551s
	iters: 1700, epoch: 1 | loss: 0.7698014
	speed: 0.0740s/iter; left time: 1199.7610s
	iters: 1800, epoch: 1 | loss: 0.7075672
	speed: 0.0740s/iter; left time: 1192.0206s
	iters: 1900, epoch: 1 | loss: 0.5770153
	speed: 0.0740s/iter; left time: 1185.6165s
	iters: 2000, epoch: 1 | loss: 0.5335245
	speed: 0.0738s/iter; left time: 1175.3613s
	iters: 2100, epoch: 1 | loss: 0.5564944
	speed: 0.0737s/iter; left time: 1165.5971s
	iters: 2200, epoch: 1 | loss: 0.6398326
	speed: 0.0726s/iter; left time: 1140.8315s
	iters: 2300, epoch: 1 | loss: 0.5940525
	speed: 0.0747s/iter; left time: 1166.0334s
	iters: 2400, epoch: 1 | loss: 0.6314939
	speed: 0.0742s/iter; left time: 1150.7771s
	iters: 2500, epoch: 1 | loss: 0.9975793
	speed: 0.0732s/iter; left time: 1128.8374s
	iters: 2600, epoch: 1 | loss: 0.6452321
	speed: 0.0739s/iter; left time: 1131.5116s
	iters: 2700, epoch: 1 | loss: 0.6742420
	speed: 0.0730s/iter; left time: 1110.5653s
	iters: 2800, epoch: 1 | loss: 0.5541028
	speed: 0.0741s/iter; left time: 1119.7696s
	iters: 2900, epoch: 1 | loss: 0.7190768
	speed: 0.0732s/iter; left time: 1099.6797s
	iters: 3000, epoch: 1 | loss: 0.5906936
	speed: 0.0747s/iter; left time: 1114.4880s
	iters: 3100, epoch: 1 | loss: 0.5341812
	speed: 0.0735s/iter; left time: 1089.2306s
	iters: 3200, epoch: 1 | loss: 0.5979221
	speed: 0.0740s/iter; left time: 1088.3677s
	iters: 3300, epoch: 1 | loss: 0.8410680
	speed: 0.0727s/iter; left time: 1063.0285s
	iters: 3400, epoch: 1 | loss: 0.6305131
	speed: 0.0723s/iter; left time: 1050.0916s
	iters: 3500, epoch: 1 | loss: 0.5714903
	speed: 0.0744s/iter; left time: 1072.2370s
	iters: 3600, epoch: 1 | loss: 0.5664809
	speed: 0.0781s/iter; left time: 1118.3630s
	iters: 3700, epoch: 1 | loss: 0.5383365
	speed: 0.0778s/iter; left time: 1106.2105s
	iters: 3800, epoch: 1 | loss: 0.5285380
	speed: 0.0777s/iter; left time: 1096.3982s
	iters: 3900, epoch: 1 | loss: 0.5056229
	speed: 0.0771s/iter; left time: 1080.7101s
	iters: 4000, epoch: 1 | loss: 0.4063953
	speed: 0.0772s/iter; left time: 1073.7635s
	iters: 4100, epoch: 1 | loss: 0.7050106
	speed: 0.0807s/iter; left time: 1114.6390s
	iters: 4200, epoch: 1 | loss: 0.7068965
	speed: 0.0773s/iter; left time: 1060.4704s
	iters: 4300, epoch: 1 | loss: 0.5266414
	speed: 0.0759s/iter; left time: 1033.9070s
	iters: 4400, epoch: 1 | loss: 0.5235218
	speed: 0.0771s/iter; left time: 1041.8752s
	iters: 4500, epoch: 1 | loss: 1.7036098
	speed: 0.0775s/iter; left time: 1039.5999s
	iters: 4600, epoch: 1 | loss: 0.5984770
	speed: 0.0771s/iter; left time: 1027.2118s
	iters: 4700, epoch: 1 | loss: 0.7991492
	speed: 0.0782s/iter; left time: 1033.6807s
	iters: 4800, epoch: 1 | loss: 0.6233592
	speed: 0.0764s/iter; left time: 1001.6515s
	iters: 4900, epoch: 1 | loss: 0.6405532
	speed: 0.0780s/iter; left time: 1015.7708s
	iters: 5000, epoch: 1 | loss: 0.5558156
	speed: 0.0766s/iter; left time: 989.1307s
	iters: 5100, epoch: 1 | loss: 0.9113820
	speed: 0.0765s/iter; left time: 981.0661s
	iters: 5200, epoch: 1 | loss: 0.4983724
	speed: 0.0764s/iter; left time: 971.4595s
	iters: 5300, epoch: 1 | loss: 0.5092030
	speed: 0.0745s/iter; left time: 940.3656s
	iters: 5400, epoch: 1 | loss: 0.4794283
	speed: 0.0742s/iter; left time: 928.6924s
	iters: 5500, epoch: 1 | loss: 0.6819234
	speed: 0.0718s/iter; left time: 892.1312s
	iters: 5600, epoch: 1 | loss: 1.6273520
	speed: 0.0737s/iter; left time: 907.6350s
	iters: 5700, epoch: 1 | loss: 0.6321468
	speed: 0.0737s/iter; left time: 900.5120s
	iters: 5800, epoch: 1 | loss: 0.4838985
	speed: 0.0750s/iter; left time: 909.1036s
	iters: 5900, epoch: 1 | loss: 0.4068766
	speed: 0.0743s/iter; left time: 893.0329s
	iters: 6000, epoch: 1 | loss: 1.6925614
	speed: 0.0748s/iter; left time: 891.3870s
	iters: 6100, epoch: 1 | loss: 0.9411312
	speed: 0.0737s/iter; left time: 870.5771s
	iters: 6200, epoch: 1 | loss: 0.6397082
	speed: 0.0736s/iter; left time: 861.9989s
	iters: 6300, epoch: 1 | loss: 0.6466889
	speed: 0.0726s/iter; left time: 843.8273s
	iters: 6400, epoch: 1 | loss: 0.5772380
	speed: 0.0710s/iter; left time: 817.9590s
	iters: 6500, epoch: 1 | loss: 0.4270039
	speed: 0.0740s/iter; left time: 845.3693s
	iters: 6600, epoch: 1 | loss: 0.5132091
	speed: 0.0739s/iter; left time: 836.8449s
	iters: 6700, epoch: 1 | loss: 0.5513508
	speed: 0.0747s/iter; left time: 838.1328s
	iters: 6800, epoch: 1 | loss: 0.5298524
	speed: 0.0746s/iter; left time: 829.6562s
	iters: 6900, epoch: 1 | loss: 0.4504296
	speed: 0.0732s/iter; left time: 806.5738s
	iters: 7000, epoch: 1 | loss: 0.7364434
	speed: 0.0749s/iter; left time: 817.2948s
	iters: 7100, epoch: 1 | loss: 1.4876610
	speed: 0.0753s/iter; left time: 814.9420s
	iters: 7200, epoch: 1 | loss: 0.5631490
	speed: 0.0747s/iter; left time: 800.9438s
	iters: 7300, epoch: 1 | loss: 0.3937955
	speed: 0.0735s/iter; left time: 779.9558s
	iters: 7400, epoch: 1 | loss: 0.7852526
	speed: 0.0735s/iter; left time: 772.9325s
	iters: 7500, epoch: 1 | loss: 0.6276323
	speed: 0.0731s/iter; left time: 761.9114s
	iters: 7600, epoch: 1 | loss: 0.5295761
	speed: 0.0733s/iter; left time: 755.9623s
	iters: 7700, epoch: 1 | loss: 0.5587357
	speed: 0.0734s/iter; left time: 749.9892s
	iters: 7800, epoch: 1 | loss: 0.4923097
	speed: 0.0740s/iter; left time: 749.0428s
	iters: 7900, epoch: 1 | loss: 0.5172476
	speed: 0.0742s/iter; left time: 743.6369s
	iters: 8000, epoch: 1 | loss: 0.5790981
	speed: 0.0740s/iter; left time: 733.6684s
	iters: 8100, epoch: 1 | loss: 0.4046716
	speed: 0.0752s/iter; left time: 738.0257s
	iters: 8200, epoch: 1 | loss: 0.4768744
	speed: 0.0734s/iter; left time: 713.5130s
	iters: 8300, epoch: 1 | loss: 0.5650631
	speed: 0.0738s/iter; left time: 710.0691s
	iters: 8400, epoch: 1 | loss: 0.5270416
	speed: 0.0746s/iter; left time: 709.6369s
	iters: 8500, epoch: 1 | loss: 0.5386940
	speed: 0.0732s/iter; left time: 689.0289s
	iters: 8600, epoch: 1 | loss: 0.6765947
	speed: 0.0736s/iter; left time: 685.5608s
	iters: 8700, epoch: 1 | loss: 0.4755591
	speed: 0.0732s/iter; left time: 674.9971s
	iters: 8800, epoch: 1 | loss: 0.4976405
	speed: 0.0733s/iter; left time: 668.6419s
	iters: 8900, epoch: 1 | loss: 0.5812915
	speed: 0.0737s/iter; left time: 664.7039s
Epoch: 1 cost time: 670.2141382694244
Epoch: 1, Steps: 8958 | Train Loss: 0.7141301 Vali Loss: 0.7642766 Test Loss: 0.4089365
Validation loss decreased (inf --> 0.764277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5076566
	speed: 1.3847s/iter; left time: 12267.1354s
	iters: 200, epoch: 2 | loss: 0.5945702
	speed: 0.0741s/iter; left time: 649.2587s
	iters: 300, epoch: 2 | loss: 0.7568029
	speed: 0.0734s/iter; left time: 635.4818s
	iters: 400, epoch: 2 | loss: 0.5145629
	speed: 0.0732s/iter; left time: 626.9259s
	iters: 500, epoch: 2 | loss: 0.5470619
	speed: 0.0732s/iter; left time: 619.1900s
	iters: 600, epoch: 2 | loss: 1.4309207
	speed: 0.0734s/iter; left time: 613.9053s
	iters: 700, epoch: 2 | loss: 0.4375803
	speed: 0.0722s/iter; left time: 596.5588s
	iters: 800, epoch: 2 | loss: 0.4368066
	speed: 0.0720s/iter; left time: 587.5059s
	iters: 900, epoch: 2 | loss: 0.5463964
	speed: 0.0712s/iter; left time: 574.1863s
	iters: 1000, epoch: 2 | loss: 0.3454365
	speed: 0.0717s/iter; left time: 570.8510s
	iters: 1100, epoch: 2 | loss: 0.9198521
	speed: 0.0710s/iter; left time: 557.8254s
	iters: 1200, epoch: 2 | loss: 0.6369515
	speed: 0.0716s/iter; left time: 555.4275s
	iters: 1300, epoch: 2 | loss: 0.6432429
	speed: 0.0704s/iter; left time: 539.5213s
	iters: 1400, epoch: 2 | loss: 0.7419917
	speed: 0.0716s/iter; left time: 540.8484s
	iters: 1500, epoch: 2 | loss: 0.6638144
	speed: 0.0730s/iter; left time: 544.4469s
	iters: 1600, epoch: 2 | loss: 0.5688420
	speed: 0.0731s/iter; left time: 538.2236s
	iters: 1700, epoch: 2 | loss: 1.6344732
	speed: 0.0739s/iter; left time: 536.4893s
	iters: 1800, epoch: 2 | loss: 0.6247812
	speed: 0.0732s/iter; left time: 524.2800s
	iters: 1900, epoch: 2 | loss: 0.7607053
	speed: 0.0747s/iter; left time: 527.6516s
	iters: 2000, epoch: 2 | loss: 0.5858236
	speed: 0.0748s/iter; left time: 520.4835s
	iters: 2100, epoch: 2 | loss: 0.5179365
	speed: 0.0741s/iter; left time: 508.3514s
	iters: 2200, epoch: 2 | loss: 0.4913238
	speed: 0.0746s/iter; left time: 503.9065s
	iters: 2300, epoch: 2 | loss: 0.4646387
	speed: 0.0731s/iter; left time: 486.5805s
	iters: 2400, epoch: 2 | loss: 0.6774739
	speed: 0.0722s/iter; left time: 473.3247s
	iters: 2500, epoch: 2 | loss: 0.6518387
	speed: 0.0733s/iter; left time: 473.3483s
	iters: 2600, epoch: 2 | loss: 0.6208820
	speed: 0.0730s/iter; left time: 464.3869s
	iters: 2700, epoch: 2 | loss: 0.6843482
	speed: 0.0735s/iter; left time: 460.1005s
	iters: 2800, epoch: 2 | loss: 0.6797999
	speed: 0.0734s/iter; left time: 452.3138s
	iters: 2900, epoch: 2 | loss: 0.6130000
	speed: 0.0725s/iter; left time: 439.1746s
	iters: 3000, epoch: 2 | loss: 1.4399052
	speed: 0.0731s/iter; left time: 435.5299s
	iters: 3100, epoch: 2 | loss: 0.6856642
	speed: 0.0737s/iter; left time: 431.6814s
	iters: 3200, epoch: 2 | loss: 0.7186921
	speed: 0.0745s/iter; left time: 428.8903s
	iters: 3300, epoch: 2 | loss: 0.7075338
	speed: 0.0744s/iter; left time: 421.0477s
	iters: 3400, epoch: 2 | loss: 0.5090435
	speed: 0.0743s/iter; left time: 413.0785s
	iters: 3500, epoch: 2 | loss: 0.4013868
	speed: 0.0741s/iter; left time: 404.4124s
	iters: 3600, epoch: 2 | loss: 0.5067915
	speed: 0.0735s/iter; left time: 393.9231s
	iters: 3700, epoch: 2 | loss: 0.5133457
	speed: 0.0743s/iter; left time: 390.7532s
	iters: 3800, epoch: 2 | loss: 0.4708292
	speed: 0.0772s/iter; left time: 398.4716s
	iters: 3900, epoch: 2 | loss: 0.5695177
	speed: 0.0792s/iter; left time: 400.7790s
	iters: 4000, epoch: 2 | loss: 0.7974815
	speed: 0.0774s/iter; left time: 383.9314s
	iters: 4100, epoch: 2 | loss: 0.5339275
	speed: 0.0757s/iter; left time: 367.7174s
	iters: 4200, epoch: 2 | loss: 0.4810724
	speed: 0.0761s/iter; left time: 362.2462s
	iters: 4300, epoch: 2 | loss: 0.4683305
	speed: 0.0751s/iter; left time: 350.0870s
	iters: 4400, epoch: 2 | loss: 0.4029575
	speed: 0.0763s/iter; left time: 347.8364s
	iters: 4500, epoch: 2 | loss: 0.5152658
	speed: 0.0761s/iter; left time: 339.3654s
	iters: 4600, epoch: 2 | loss: 0.4918263
	speed: 0.0722s/iter; left time: 314.8273s
	iters: 4700, epoch: 2 | loss: 0.6535499
	speed: 0.0752s/iter; left time: 320.1649s
	iters: 4800, epoch: 2 | loss: 0.5474615
	speed: 0.0763s/iter; left time: 317.3064s
	iters: 4900, epoch: 2 | loss: 0.4097072
	speed: 0.0751s/iter; left time: 304.7617s
	iters: 5000, epoch: 2 | loss: 0.3520343
	speed: 0.0735s/iter; left time: 290.9459s
	iters: 5100, epoch: 2 | loss: 0.5794592
	speed: 0.0754s/iter; left time: 290.8890s
	iters: 5200, epoch: 2 | loss: 0.6759909
	speed: 0.0747s/iter; left time: 280.7967s
	iters: 5300, epoch: 2 | loss: 0.6662393
	speed: 0.0747s/iter; left time: 273.1955s
	iters: 5400, epoch: 2 | loss: 0.4006371
	speed: 0.0687s/iter; left time: 244.3629s
	iters: 5500, epoch: 2 | loss: 0.7286000
	speed: 0.0640s/iter; left time: 221.2072s
	iters: 5600, epoch: 2 | loss: 0.3601132
	speed: 0.0681s/iter; left time: 228.6528s
	iters: 5700, epoch: 2 | loss: 0.3064383
	speed: 0.0679s/iter; left time: 221.1392s
	iters: 5800, epoch: 2 | loss: 0.3935480
	speed: 0.0682s/iter; left time: 215.3809s
	iters: 5900, epoch: 2 | loss: 0.5686930
	speed: 0.0651s/iter; left time: 199.0006s
	iters: 6000, epoch: 2 | loss: 0.4885783
	speed: 0.0611s/iter; left time: 180.8744s
	iters: 6100, epoch: 2 | loss: 0.4270846
	speed: 0.0634s/iter; left time: 181.3445s
	iters: 6200, epoch: 2 | loss: 0.5856363
	speed: 0.0623s/iter; left time: 171.8946s
	iters: 6300, epoch: 2 | loss: 1.3248786
	speed: 0.0626s/iter; left time: 166.4694s
	iters: 6400, epoch: 2 | loss: 0.4658408
	speed: 0.0683s/iter; left time: 174.8275s
	iters: 6500, epoch: 2 | loss: 0.6276565
	speed: 0.0689s/iter; left time: 169.3173s
	iters: 6600, epoch: 2 | loss: 1.2020255
	speed: 0.0703s/iter; left time: 165.8087s
	iters: 6700, epoch: 2 | loss: 0.3726954
	speed: 0.0666s/iter; left time: 150.3951s
	iters: 6800, epoch: 2 | loss: 0.5013319
	speed: 0.0513s/iter; left time: 110.6675s
	iters: 6900, epoch: 2 | loss: 0.5563909
	speed: 0.0470s/iter; left time: 96.7749s
	iters: 7000, epoch: 2 | loss: 0.5134921
	speed: 0.0521s/iter; left time: 102.0010s
	iters: 7100, epoch: 2 | loss: 0.3010614
	speed: 0.0761s/iter; left time: 141.5398s
	iters: 7200, epoch: 2 | loss: 0.5217777
	speed: 0.0898s/iter; left time: 157.8708s
	iters: 7300, epoch: 2 | loss: 0.7922725
	speed: 0.0898s/iter; left time: 149.0202s
	iters: 7400, epoch: 2 | loss: 0.6038758
	speed: 0.0898s/iter; left time: 139.9542s
	iters: 7500, epoch: 2 | loss: 0.4176809
	speed: 0.0900s/iter; left time: 131.3385s
	iters: 7600, epoch: 2 | loss: 0.6643591
	speed: 0.0897s/iter; left time: 121.8834s
	iters: 7700, epoch: 2 | loss: 0.5351765
	speed: 0.0905s/iter; left time: 113.9901s
	iters: 7800, epoch: 2 | loss: 0.4900299
	speed: 0.0903s/iter; left time: 104.6291s
	iters: 7900, epoch: 2 | loss: 0.6321335
	speed: 0.0899s/iter; left time: 95.2395s
	iters: 8000, epoch: 2 | loss: 0.5588089
	speed: 0.0898s/iter; left time: 86.1406s
	iters: 8100, epoch: 2 | loss: 0.4089572
	speed: 0.0900s/iter; left time: 77.2709s
	iters: 8200, epoch: 2 | loss: 0.4527173
	speed: 0.0900s/iter; left time: 68.2823s
	iters: 8300, epoch: 2 | loss: 0.4248567
	speed: 0.0900s/iter; left time: 59.3133s
	iters: 8400, epoch: 2 | loss: 0.3935609
	speed: 0.0899s/iter; left time: 50.2396s
	iters: 8500, epoch: 2 | loss: 0.3792761
	speed: 0.0898s/iter; left time: 41.2052s
	iters: 8600, epoch: 2 | loss: 0.5349956
	speed: 0.0898s/iter; left time: 32.2204s
	iters: 8700, epoch: 2 | loss: 0.4055690
	speed: 0.0900s/iter; left time: 23.3008s
	iters: 8800, epoch: 2 | loss: 0.7509927
	speed: 0.0901s/iter; left time: 14.3228s
	iters: 8900, epoch: 2 | loss: 0.3702269
	speed: 0.0897s/iter; left time: 5.2941s
Epoch: 2 cost time: 675.9466977119446
Epoch: 2, Steps: 8958 | Train Loss: 0.6117907 Vali Loss: 0.7760270 Test Loss: 0.4734320
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_720_Autoformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4089357852935791, mae:0.42341598868370056, rse:0.8415106534957886
