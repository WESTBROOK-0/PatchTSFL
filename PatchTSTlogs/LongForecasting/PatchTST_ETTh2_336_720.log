Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=4, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTh2_ftM_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 1.8169376850128174
Epoch: 1, Steps: 59 | Train Loss: 0.9805826 Vali Loss: 0.7655950 Test Loss: 0.4363662
Validation loss decreased (inf --> 0.765595).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.8304061889648438
Epoch: 2, Steps: 59 | Train Loss: 0.9206291 Vali Loss: 0.6814907 Test Loss: 0.3995905
Validation loss decreased (0.765595 --> 0.681491).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.8957209587097168
Epoch: 3, Steps: 59 | Train Loss: 0.8670351 Vali Loss: 0.6533428 Test Loss: 0.3906071
Validation loss decreased (0.681491 --> 0.653343).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.8150582313537598
Epoch: 4, Steps: 59 | Train Loss: 0.8414775 Vali Loss: 0.6426685 Test Loss: 0.3861083
Validation loss decreased (0.653343 --> 0.642669).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.8424031734466553
Epoch: 5, Steps: 59 | Train Loss: 0.8279850 Vali Loss: 0.6313765 Test Loss: 0.3836883
Validation loss decreased (0.642669 --> 0.631377).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.818021535873413
Epoch: 6, Steps: 59 | Train Loss: 0.8190613 Vali Loss: 0.6255742 Test Loss: 0.3819404
Validation loss decreased (0.631377 --> 0.625574).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 2.081812620162964
Epoch: 7, Steps: 59 | Train Loss: 0.8146823 Vali Loss: 0.6203300 Test Loss: 0.3815827
Validation loss decreased (0.625574 --> 0.620330).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 2.034266233444214
Epoch: 8, Steps: 59 | Train Loss: 0.8109069 Vali Loss: 0.6191944 Test Loss: 0.3809363
Validation loss decreased (0.620330 --> 0.619194).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.091815233230591
Epoch: 9, Steps: 59 | Train Loss: 0.8074214 Vali Loss: 0.6188971 Test Loss: 0.3805531
Validation loss decreased (0.619194 --> 0.618897).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.8736121654510498
Epoch: 10, Steps: 59 | Train Loss: 0.8042874 Vali Loss: 0.6221340 Test Loss: 0.3799904
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.8551933765411377
Epoch: 11, Steps: 59 | Train Loss: 0.8037113 Vali Loss: 0.6150299 Test Loss: 0.3796122
Validation loss decreased (0.618897 --> 0.615030).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.8168506622314453
Epoch: 12, Steps: 59 | Train Loss: 0.8025310 Vali Loss: 0.6173890 Test Loss: 0.3792915
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.030270576477051
Epoch: 13, Steps: 59 | Train Loss: 0.8018042 Vali Loss: 0.6123744 Test Loss: 0.3787081
Validation loss decreased (0.615030 --> 0.612374).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 1.769343376159668
Epoch: 14, Steps: 59 | Train Loss: 0.8002612 Vali Loss: 0.6169618 Test Loss: 0.3783810
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.09588360786438
Epoch: 15, Steps: 59 | Train Loss: 0.7976627 Vali Loss: 0.6168306 Test Loss: 0.3780696
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 1.8157548904418945
Epoch: 16, Steps: 59 | Train Loss: 0.7977518 Vali Loss: 0.6151211 Test Loss: 0.3776410
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.774623155593872
Epoch: 17, Steps: 59 | Train Loss: 0.7954531 Vali Loss: 0.6148463 Test Loss: 0.3771197
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 1.839015007019043
Epoch: 18, Steps: 59 | Train Loss: 0.7953137 Vali Loss: 0.6221287 Test Loss: 0.3764266
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 1.8461103439331055
Epoch: 19, Steps: 59 | Train Loss: 0.7939800 Vali Loss: 0.6151599 Test Loss: 0.3760619
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 1.9518167972564697
Epoch: 20, Steps: 59 | Train Loss: 0.7929667 Vali Loss: 0.6178524 Test Loss: 0.3757856
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 1.9592022895812988
Epoch: 21, Steps: 59 | Train Loss: 0.7906515 Vali Loss: 0.6207980 Test Loss: 0.3754765
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 1.7655282020568848
Epoch: 22, Steps: 59 | Train Loss: 0.7925550 Vali Loss: 0.6197277 Test Loss: 0.3751789
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 1.9115386009216309
Epoch: 23, Steps: 59 | Train Loss: 0.7920524 Vali Loss: 0.6199794 Test Loss: 0.3748295
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 1.8777580261230469
Epoch: 24, Steps: 59 | Train Loss: 0.7896057 Vali Loss: 0.6185078 Test Loss: 0.3746124
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 1.9290106296539307
Epoch: 25, Steps: 59 | Train Loss: 0.7881370 Vali Loss: 0.6221116 Test Loss: 0.3744869
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 1.7811367511749268
Epoch: 26, Steps: 59 | Train Loss: 0.7888363 Vali Loss: 0.6218410 Test Loss: 0.3742747
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.9234652519226074
Epoch: 27, Steps: 59 | Train Loss: 0.7881339 Vali Loss: 0.6224043 Test Loss: 0.3741400
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 1.8650662899017334
Epoch: 28, Steps: 59 | Train Loss: 0.7889684 Vali Loss: 0.6212498 Test Loss: 0.3741430
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 1.9973344802856445
Epoch: 29, Steps: 59 | Train Loss: 0.7888859 Vali Loss: 0.6217746 Test Loss: 0.3740464
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 1.8216171264648438
Epoch: 30, Steps: 59 | Train Loss: 0.7874566 Vali Loss: 0.6214421 Test Loss: 0.3739239
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 1.7574172019958496
Epoch: 31, Steps: 59 | Train Loss: 0.7876142 Vali Loss: 0.6199178 Test Loss: 0.3740542
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.8205018043518066
Epoch: 32, Steps: 59 | Train Loss: 0.7876417 Vali Loss: 0.6263207 Test Loss: 0.3738854
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 1.896838903427124
Epoch: 33, Steps: 59 | Train Loss: 0.7863101 Vali Loss: 0.6228814 Test Loss: 0.3739387
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 1.786238431930542
Epoch: 34, Steps: 59 | Train Loss: 0.7851069 Vali Loss: 0.6196363 Test Loss: 0.3739041
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 1.8455705642700195
Epoch: 35, Steps: 59 | Train Loss: 0.7861449 Vali Loss: 0.6257936 Test Loss: 0.3738605
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 1.9439220428466797
Epoch: 36, Steps: 59 | Train Loss: 0.7859867 Vali Loss: 0.6242927 Test Loss: 0.3738208
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 1.888822078704834
Epoch: 37, Steps: 59 | Train Loss: 0.7868381 Vali Loss: 0.6219568 Test Loss: 0.3739228
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 1.843076229095459
Epoch: 38, Steps: 59 | Train Loss: 0.7840586 Vali Loss: 0.6284101 Test Loss: 0.3738448
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 1.8897998332977295
Epoch: 39, Steps: 59 | Train Loss: 0.7852516 Vali Loss: 0.6283741 Test Loss: 0.3737741
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 1.8752248287200928
Epoch: 40, Steps: 59 | Train Loss: 0.7864720 Vali Loss: 0.6206189 Test Loss: 0.3738239
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 2.0316967964172363
Epoch: 41, Steps: 59 | Train Loss: 0.7836703 Vali Loss: 0.6217911 Test Loss: 0.3738049
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 1.8594491481781006
Epoch: 42, Steps: 59 | Train Loss: 0.7871864 Vali Loss: 0.6236333 Test Loss: 0.3738136
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 1.9748644828796387
Epoch: 43, Steps: 59 | Train Loss: 0.7852417 Vali Loss: 0.6222587 Test Loss: 0.3738024
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 1.8732478618621826
Epoch: 44, Steps: 59 | Train Loss: 0.7872154 Vali Loss: 0.6223687 Test Loss: 0.3738066
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 1.8972618579864502
Epoch: 45, Steps: 59 | Train Loss: 0.7848485 Vali Loss: 0.6234548 Test Loss: 0.3738411
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.8907876014709473
Epoch: 46, Steps: 59 | Train Loss: 0.7849801 Vali Loss: 0.6217889 Test Loss: 0.3738486
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 1.8074774742126465
Epoch: 47, Steps: 59 | Train Loss: 0.7854152 Vali Loss: 0.6242089 Test Loss: 0.3738202
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 1.7417702674865723
Epoch: 48, Steps: 59 | Train Loss: 0.7840812 Vali Loss: 0.6231213 Test Loss: 0.3738371
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 1.709284782409668
Epoch: 49, Steps: 59 | Train Loss: 0.7840253 Vali Loss: 0.6208647 Test Loss: 0.3738759
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 2.065032958984375
Epoch: 50, Steps: 59 | Train Loss: 0.7859878 Vali Loss: 0.6262770 Test Loss: 0.3738856
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 1.881711483001709
Epoch: 51, Steps: 59 | Train Loss: 0.7853770 Vali Loss: 0.6232305 Test Loss: 0.3738391
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 1.7629272937774658
Epoch: 52, Steps: 59 | Train Loss: 0.7840634 Vali Loss: 0.6235226 Test Loss: 0.3739071
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 1.858828067779541
Epoch: 53, Steps: 59 | Train Loss: 0.7856067 Vali Loss: 0.6224210 Test Loss: 0.3738231
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.274380922317505
Epoch: 54, Steps: 59 | Train Loss: 0.7848883 Vali Loss: 0.6264912 Test Loss: 0.3738200
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 1.9760615825653076
Epoch: 55, Steps: 59 | Train Loss: 0.7845662 Vali Loss: 0.6268218 Test Loss: 0.3737657
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 1.7967760562896729
Epoch: 56, Steps: 59 | Train Loss: 0.7854261 Vali Loss: 0.6243465 Test Loss: 0.3738134
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 1.8263349533081055
Epoch: 57, Steps: 59 | Train Loss: 0.7855074 Vali Loss: 0.6221099 Test Loss: 0.3738580
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 1.8953163623809814
Epoch: 58, Steps: 59 | Train Loss: 0.7867916 Vali Loss: 0.6215283 Test Loss: 0.3737726
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 2.007770538330078
Epoch: 59, Steps: 59 | Train Loss: 0.7835310 Vali Loss: 0.6224635 Test Loss: 0.3738504
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 2.0625836849212646
Epoch: 60, Steps: 59 | Train Loss: 0.7862071 Vali Loss: 0.6241820 Test Loss: 0.3739316
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 2.1372931003570557
Epoch: 61, Steps: 59 | Train Loss: 0.7846083 Vali Loss: 0.6260467 Test Loss: 0.3737922
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 2.1012184619903564
Epoch: 62, Steps: 59 | Train Loss: 0.7860854 Vali Loss: 0.6207464 Test Loss: 0.3738272
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 1.840994119644165
Epoch: 63, Steps: 59 | Train Loss: 0.7832560 Vali Loss: 0.6240996 Test Loss: 0.3738843
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 1.9676077365875244
Epoch: 64, Steps: 59 | Train Loss: 0.7858353 Vali Loss: 0.6221116 Test Loss: 0.3738777
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 1.8400111198425293
Epoch: 65, Steps: 59 | Train Loss: 0.7838435 Vali Loss: 0.6243513 Test Loss: 0.3738241
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 2.133868455886841
Epoch: 66, Steps: 59 | Train Loss: 0.7839149 Vali Loss: 0.6211778 Test Loss: 0.3738650
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 1.8413612842559814
Epoch: 67, Steps: 59 | Train Loss: 0.7848914 Vali Loss: 0.6255493 Test Loss: 0.3738282
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 1.871750831604004
Epoch: 68, Steps: 59 | Train Loss: 0.7834110 Vali Loss: 0.6245057 Test Loss: 0.3737847
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 1.8525853157043457
Epoch: 69, Steps: 59 | Train Loss: 0.7840332 Vali Loss: 0.6232744 Test Loss: 0.3739171
EarlyStopping counter: 56 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 1.8671033382415771
Epoch: 70, Steps: 59 | Train Loss: 0.7854252 Vali Loss: 0.6213945 Test Loss: 0.3738235
EarlyStopping counter: 57 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 1.9028279781341553
Epoch: 71, Steps: 59 | Train Loss: 0.7845103 Vali Loss: 0.6231412 Test Loss: 0.3738504
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 1.7469151020050049
Epoch: 72, Steps: 59 | Train Loss: 0.7837812 Vali Loss: 0.6231817 Test Loss: 0.3738857
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 1.8195393085479736
Epoch: 73, Steps: 59 | Train Loss: 0.7827625 Vali Loss: 0.6271888 Test Loss: 0.3739100
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 1.827639102935791
Epoch: 74, Steps: 59 | Train Loss: 0.7848627 Vali Loss: 0.6258488 Test Loss: 0.3737460
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 1.929307460784912
Epoch: 75, Steps: 59 | Train Loss: 0.7851171 Vali Loss: 0.6250392 Test Loss: 0.3737180
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 1.852480411529541
Epoch: 76, Steps: 59 | Train Loss: 0.7847179 Vali Loss: 0.6203343 Test Loss: 0.3738822
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 1.8233506679534912
Epoch: 77, Steps: 59 | Train Loss: 0.7847641 Vali Loss: 0.6256250 Test Loss: 0.3737866
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 1.8297162055969238
Epoch: 78, Steps: 59 | Train Loss: 0.7843886 Vali Loss: 0.6245470 Test Loss: 0.3738545
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 1.9436604976654053
Epoch: 79, Steps: 59 | Train Loss: 0.7845174 Vali Loss: 0.6251855 Test Loss: 0.3737859
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 1.8785147666931152
Epoch: 80, Steps: 59 | Train Loss: 0.7856764 Vali Loss: 0.6197678 Test Loss: 0.3738137
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 1.8468918800354004
Epoch: 81, Steps: 59 | Train Loss: 0.7837079 Vali Loss: 0.6207864 Test Loss: 0.3738123
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 1.8589224815368652
Epoch: 82, Steps: 59 | Train Loss: 0.7861416 Vali Loss: 0.6236159 Test Loss: 0.3737885
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 2.0869224071502686
Epoch: 83, Steps: 59 | Train Loss: 0.7838267 Vali Loss: 0.6220947 Test Loss: 0.3738193
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 1.8231384754180908
Epoch: 84, Steps: 59 | Train Loss: 0.7842978 Vali Loss: 0.6239628 Test Loss: 0.3737983
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 1.973738193511963
Epoch: 85, Steps: 59 | Train Loss: 0.7858949 Vali Loss: 0.6263289 Test Loss: 0.3738576
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 1.8562953472137451
Epoch: 86, Steps: 59 | Train Loss: 0.7860430 Vali Loss: 0.6246451 Test Loss: 0.3738118
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 2.0337986946105957
Epoch: 87, Steps: 59 | Train Loss: 0.7846571 Vali Loss: 0.6231608 Test Loss: 0.3738575
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 1.9302630424499512
Epoch: 88, Steps: 59 | Train Loss: 0.7863195 Vali Loss: 0.6238101 Test Loss: 0.3738427
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 1.799009084701538
Epoch: 89, Steps: 59 | Train Loss: 0.7858821 Vali Loss: 0.6264066 Test Loss: 0.3738514
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 2.1376559734344482
Epoch: 90, Steps: 59 | Train Loss: 0.7853216 Vali Loss: 0.6269547 Test Loss: 0.3738219
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 1.8807001113891602
Epoch: 91, Steps: 59 | Train Loss: 0.7855583 Vali Loss: 0.6223185 Test Loss: 0.3738402
EarlyStopping counter: 78 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 1.8041472434997559
Epoch: 92, Steps: 59 | Train Loss: 0.7855259 Vali Loss: 0.6191568 Test Loss: 0.3737772
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 1.8182871341705322
Epoch: 93, Steps: 59 | Train Loss: 0.7851354 Vali Loss: 0.6229883 Test Loss: 0.3738519
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 2.094853162765503
Epoch: 94, Steps: 59 | Train Loss: 0.7848379 Vali Loss: 0.6214001 Test Loss: 0.3739102
EarlyStopping counter: 81 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 2.060755968093872
Epoch: 95, Steps: 59 | Train Loss: 0.7827388 Vali Loss: 0.6209041 Test Loss: 0.3738137
EarlyStopping counter: 82 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 1.980017900466919
Epoch: 96, Steps: 59 | Train Loss: 0.7837498 Vali Loss: 0.6254537 Test Loss: 0.3737845
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 1.8490369319915771
Epoch: 97, Steps: 59 | Train Loss: 0.7844758 Vali Loss: 0.6231089 Test Loss: 0.3737649
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 2.069880485534668
Epoch: 98, Steps: 59 | Train Loss: 0.7849710 Vali Loss: 0.6240932 Test Loss: 0.3738489
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 1.8086950778961182
Epoch: 99, Steps: 59 | Train Loss: 0.7852475 Vali Loss: 0.6217046 Test Loss: 0.3737795
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 1.8717191219329834
Epoch: 100, Steps: 59 | Train Loss: 0.7842266 Vali Loss: 0.6242086 Test Loss: 0.3738086
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_720_PatchTST_ETTh2_ftM_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3787079453468323, mae:0.42125099897384644, rse:0.4933776259422302
