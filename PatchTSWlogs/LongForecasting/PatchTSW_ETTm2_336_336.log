Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_336_PatchTSW_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4501477
	speed: 0.3621s/iter; left time: 9522.5287s
	iters: 200, epoch: 1 | loss: 0.3582117
	speed: 0.3465s/iter; left time: 9078.0636s
Epoch: 1 cost time: 93.17303323745728
Epoch: 1, Steps: 264 | Train Loss: 0.4991533 Vali Loss: 0.2235622 Test Loss: 0.3047696
Validation loss decreased (inf --> 0.223562).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.5802699
	speed: 0.8001s/iter; left time: 20832.9265s
	iters: 200, epoch: 2 | loss: 0.3853518
	speed: 0.3471s/iter; left time: 9001.9570s
Epoch: 2 cost time: 93.35022163391113
Epoch: 2, Steps: 264 | Train Loss: 0.4300530 Vali Loss: 0.2108755 Test Loss: 0.2912193
Validation loss decreased (0.223562 --> 0.210875).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.3811019
	speed: 0.8086s/iter; left time: 20839.0253s
	iters: 200, epoch: 3 | loss: 0.4240062
	speed: 0.3474s/iter; left time: 8918.7768s
Epoch: 3 cost time: 93.62135601043701
Epoch: 3, Steps: 264 | Train Loss: 0.4140371 Vali Loss: 0.2070633 Test Loss: 0.2855285
Validation loss decreased (0.210875 --> 0.207063).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.4649877
	speed: 0.8130s/iter; left time: 20740.0527s
	iters: 200, epoch: 4 | loss: 0.3781493
	speed: 0.3473s/iter; left time: 8824.7171s
Epoch: 4 cost time: 93.6445472240448
Epoch: 4, Steps: 264 | Train Loss: 0.4050249 Vali Loss: 0.2057383 Test Loss: 0.2837805
Validation loss decreased (0.207063 --> 0.205738).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3200050
	speed: 0.8087s/iter; left time: 20414.6654s
	iters: 200, epoch: 5 | loss: 0.5808730
	speed: 0.3474s/iter; left time: 8735.9533s
Epoch: 5 cost time: 93.59276795387268
Epoch: 5, Steps: 264 | Train Loss: 0.3984459 Vali Loss: 0.2050428 Test Loss: 0.2828435
Validation loss decreased (0.205738 --> 0.205043).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.4520072
	speed: 0.8126s/iter; left time: 20298.5869s
	iters: 200, epoch: 6 | loss: 0.3611168
	speed: 0.3474s/iter; left time: 8643.3391s
Epoch: 6 cost time: 93.87906646728516
Epoch: 6, Steps: 264 | Train Loss: 0.3917890 Vali Loss: 0.2064542 Test Loss: 0.2813549
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.4193254
	speed: 0.7957s/iter; left time: 19666.6708s
	iters: 200, epoch: 7 | loss: 0.3383733
	speed: 0.3473s/iter; left time: 8549.7617s
Epoch: 7 cost time: 93.42531204223633
Epoch: 7, Steps: 264 | Train Loss: 0.3828570 Vali Loss: 0.2042389 Test Loss: 0.2831766
Validation loss decreased (0.205043 --> 0.204239).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3076018
	speed: 0.8082s/iter; left time: 19761.9456s
	iters: 200, epoch: 8 | loss: 0.3442100
	speed: 0.3476s/iter; left time: 8464.4289s
Epoch: 8 cost time: 93.89311075210571
Epoch: 8, Steps: 264 | Train Loss: 0.3731234 Vali Loss: 0.2062314 Test Loss: 0.2820897
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.4014698
	speed: 0.7973s/iter; left time: 19286.0736s
	iters: 200, epoch: 9 | loss: 0.2989989
	speed: 0.3478s/iter; left time: 8377.8142s
Epoch: 9 cost time: 93.69268560409546
Epoch: 9, Steps: 264 | Train Loss: 0.3608750 Vali Loss: 0.2063614 Test Loss: 0.2862614
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.3318750
	speed: 0.8064s/iter; left time: 19292.5063s
	iters: 200, epoch: 10 | loss: 0.3262691
	speed: 0.3475s/iter; left time: 8279.7488s
Epoch: 10 cost time: 93.75527667999268
Epoch: 10, Steps: 264 | Train Loss: 0.3481435 Vali Loss: 0.2093799 Test Loss: 0.2859958
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3339151
	speed: 0.8043s/iter; left time: 19030.3506s
	iters: 200, epoch: 11 | loss: 0.3020300
	speed: 0.3476s/iter; left time: 8188.7343s
Epoch: 11 cost time: 94.03493976593018
Epoch: 11, Steps: 264 | Train Loss: 0.3369180 Vali Loss: 0.2162200 Test Loss: 0.2878599
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3601921
	speed: 0.8024s/iter; left time: 18773.8844s
	iters: 200, epoch: 12 | loss: 0.3096385
	speed: 0.3477s/iter; left time: 8099.5298s
Epoch: 12 cost time: 93.8474349975586
Epoch: 12, Steps: 264 | Train Loss: 0.3278460 Vali Loss: 0.2132598 Test Loss: 0.2888941
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.2475141
	speed: 0.8002s/iter; left time: 18510.1802s
	iters: 200, epoch: 13 | loss: 0.3183924
	speed: 0.3479s/iter; left time: 8012.7937s
Epoch: 13 cost time: 93.83960962295532
Epoch: 13, Steps: 264 | Train Loss: 0.3182783 Vali Loss: 0.2166169 Test Loss: 0.2906573
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3179744
	speed: 0.8014s/iter; left time: 18327.5103s
	iters: 200, epoch: 14 | loss: 0.3073657
	speed: 0.3477s/iter; left time: 7917.2241s
Epoch: 14 cost time: 93.84253907203674
Epoch: 14, Steps: 264 | Train Loss: 0.3104416 Vali Loss: 0.2172788 Test Loss: 0.2917482
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.2101218
	speed: 0.8004s/iter; left time: 18092.1484s
	iters: 200, epoch: 15 | loss: 0.3312727
	speed: 0.3476s/iter; left time: 7822.7877s
Epoch: 15 cost time: 93.8664481639862
Epoch: 15, Steps: 264 | Train Loss: 0.3027169 Vali Loss: 0.2198931 Test Loss: 0.2905895
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.2874783
	speed: 0.7985s/iter; left time: 17839.2710s
	iters: 200, epoch: 16 | loss: 0.3067581
	speed: 0.3475s/iter; left time: 7729.3866s
Epoch: 16 cost time: 93.71662044525146
Epoch: 16, Steps: 264 | Train Loss: 0.2944802 Vali Loss: 0.2182817 Test Loss: 0.2965469
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.2863585
	speed: 0.7972s/iter; left time: 17598.7540s
	iters: 200, epoch: 17 | loss: 0.2780294
	speed: 0.3477s/iter; left time: 7641.6720s
Epoch: 17 cost time: 93.63349914550781
Epoch: 17, Steps: 264 | Train Loss: 0.2878176 Vali Loss: 0.2213186 Test Loss: 0.3003767
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.2806942
	speed: 0.7997s/iter; left time: 17443.6673s
	iters: 200, epoch: 18 | loss: 0.2629810
	speed: 0.3476s/iter; left time: 7546.4858s
Epoch: 18 cost time: 93.68837261199951
Epoch: 18, Steps: 264 | Train Loss: 0.2799826 Vali Loss: 0.2204151 Test Loss: 0.3022707
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3567103
	speed: 0.7987s/iter; left time: 17212.1119s
	iters: 200, epoch: 19 | loss: 0.2570084
	speed: 0.3477s/iter; left time: 7456.7576s
Epoch: 19 cost time: 93.60593318939209
Epoch: 19, Steps: 264 | Train Loss: 0.2716755 Vali Loss: 0.2259537 Test Loss: 0.3045284
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.2856669
	speed: 0.7985s/iter; left time: 16996.4623s
	iters: 200, epoch: 20 | loss: 0.2417173
	speed: 0.3476s/iter; left time: 7363.7444s
Epoch: 20 cost time: 93.73029446601868
Epoch: 20, Steps: 264 | Train Loss: 0.2656207 Vali Loss: 0.2291776 Test Loss: 0.3051058
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.2450806
	speed: 0.7954s/iter; left time: 16720.2291s
	iters: 200, epoch: 21 | loss: 0.2950636
	speed: 0.3471s/iter; left time: 7262.3399s
Epoch: 21 cost time: 93.54232883453369
Epoch: 21, Steps: 264 | Train Loss: 0.2589766 Vali Loss: 0.2303747 Test Loss: 0.3008418
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.2212047
	speed: 0.7975s/iter; left time: 16554.1233s
	iters: 200, epoch: 22 | loss: 0.2277626
	speed: 0.3469s/iter; left time: 7166.3060s
Epoch: 22 cost time: 93.52641916275024
Epoch: 22, Steps: 264 | Train Loss: 0.2534907 Vali Loss: 0.2310434 Test Loss: 0.2998019
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.1994640
	speed: 0.7948s/iter; left time: 16287.6726s
	iters: 200, epoch: 23 | loss: 0.2795867
	speed: 0.3469s/iter; left time: 7073.9996s
Epoch: 23 cost time: 93.42718863487244
Epoch: 23, Steps: 264 | Train Loss: 0.2466102 Vali Loss: 0.2345740 Test Loss: 0.3008874
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2463866
	speed: 0.8003s/iter; left time: 16189.3173s
	iters: 200, epoch: 24 | loss: 0.2552179
	speed: 0.3468s/iter; left time: 6979.7906s
Epoch: 24 cost time: 93.45271873474121
Epoch: 24, Steps: 264 | Train Loss: 0.2421578 Vali Loss: 0.2384845 Test Loss: 0.3095960
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.2297561
	speed: 0.7961s/iter; left time: 15894.4011s
	iters: 200, epoch: 25 | loss: 0.2535591
	speed: 0.3469s/iter; left time: 6890.8576s
Epoch: 25 cost time: 93.57816696166992
Epoch: 25, Steps: 264 | Train Loss: 0.2380208 Vali Loss: 0.2439840 Test Loss: 0.3035971
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2254863
	speed: 0.7962s/iter; left time: 15686.5953s
	iters: 200, epoch: 26 | loss: 0.2160368
	speed: 0.3466s/iter; left time: 6793.7448s
Epoch: 26 cost time: 93.4067862033844
Epoch: 26, Steps: 264 | Train Loss: 0.2332102 Vali Loss: 0.2487184 Test Loss: 0.3052155
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2145776
	speed: 0.7929s/iter; left time: 15411.2510s
	iters: 200, epoch: 27 | loss: 0.2515106
	speed: 0.3465s/iter; left time: 6699.4350s
Epoch: 27 cost time: 93.36344933509827
Epoch: 27, Steps: 264 | Train Loss: 0.2305902 Vali Loss: 0.2458570 Test Loss: 0.3091132
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTSW_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2831765115261078, mae:0.33324134349823, rse:0.4293314218521118
