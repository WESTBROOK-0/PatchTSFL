Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.3, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='ETTh2_336_96', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_336_96_PatchTST_ETTh2_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 3.2744569778442383
Epoch: 1, Steps: 64 | Train Loss: 0.3494225 Vali Loss: 0.2895112 Test Loss: 0.2695430
Validation loss decreased (inf --> 0.289511).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 3.4636330604553223
Epoch: 2, Steps: 64 | Train Loss: 0.2734204 Vali Loss: 0.2125967 Test Loss: 0.1718231
Validation loss decreased (0.289511 --> 0.212597).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 3.407306432723999
Epoch: 3, Steps: 64 | Train Loss: 0.2236667 Vali Loss: 0.1982422 Test Loss: 0.1489656
Validation loss decreased (0.212597 --> 0.198242).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 3.4394752979278564
Epoch: 4, Steps: 64 | Train Loss: 0.2048240 Vali Loss: 0.1916399 Test Loss: 0.1417826
Validation loss decreased (0.198242 --> 0.191640).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 3.4975991249084473
Epoch: 5, Steps: 64 | Train Loss: 0.1939638 Vali Loss: 0.1863035 Test Loss: 0.1373654
Validation loss decreased (0.191640 --> 0.186303).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 3.828366279602051
Epoch: 6, Steps: 64 | Train Loss: 0.1889359 Vali Loss: 0.1847620 Test Loss: 0.1352902
Validation loss decreased (0.186303 --> 0.184762).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 3.4932219982147217
Epoch: 7, Steps: 64 | Train Loss: 0.1847824 Vali Loss: 0.1829788 Test Loss: 0.1337790
Validation loss decreased (0.184762 --> 0.182979).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 3.26147723197937
Epoch: 8, Steps: 64 | Train Loss: 0.1815282 Vali Loss: 0.1815663 Test Loss: 0.1323044
Validation loss decreased (0.182979 --> 0.181566).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 3.407196521759033
Epoch: 9, Steps: 64 | Train Loss: 0.1797256 Vali Loss: 0.1817481 Test Loss: 0.1325207
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 3.317089796066284
Epoch: 10, Steps: 64 | Train Loss: 0.1777495 Vali Loss: 0.1811908 Test Loss: 0.1319518
Validation loss decreased (0.181566 --> 0.181191).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 3.584489583969116
Epoch: 11, Steps: 64 | Train Loss: 0.1761247 Vali Loss: 0.1818581 Test Loss: 0.1309484
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 3.4552338123321533
Epoch: 12, Steps: 64 | Train Loss: 0.1751807 Vali Loss: 0.1805076 Test Loss: 0.1304377
Validation loss decreased (0.181191 --> 0.180508).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 3.738257884979248
Epoch: 13, Steps: 64 | Train Loss: 0.1740840 Vali Loss: 0.1806515 Test Loss: 0.1300238
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 3.582836389541626
Epoch: 14, Steps: 64 | Train Loss: 0.1732698 Vali Loss: 0.1806805 Test Loss: 0.1298841
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 3.405179738998413
Epoch: 15, Steps: 64 | Train Loss: 0.1726517 Vali Loss: 0.1803620 Test Loss: 0.1295461
Validation loss decreased (0.180508 --> 0.180362).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 3.350703239440918
Epoch: 16, Steps: 64 | Train Loss: 0.1709358 Vali Loss: 0.1802278 Test Loss: 0.1290320
Validation loss decreased (0.180362 --> 0.180228).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 3.5368361473083496
Epoch: 17, Steps: 64 | Train Loss: 0.1709846 Vali Loss: 0.1801257 Test Loss: 0.1291736
Validation loss decreased (0.180228 --> 0.180126).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 3.813169479370117
Epoch: 18, Steps: 64 | Train Loss: 0.1700374 Vali Loss: 0.1798252 Test Loss: 0.1292856
Validation loss decreased (0.180126 --> 0.179825).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 3.3749959468841553
Epoch: 19, Steps: 64 | Train Loss: 0.1694085 Vali Loss: 0.1812327 Test Loss: 0.1289626
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 3.734804153442383
Epoch: 20, Steps: 64 | Train Loss: 0.1683567 Vali Loss: 0.1800940 Test Loss: 0.1288517
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 3.389265537261963
Epoch: 21, Steps: 64 | Train Loss: 0.1684613 Vali Loss: 0.1801165 Test Loss: 0.1286413
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 3.2933731079101562
Epoch: 22, Steps: 64 | Train Loss: 0.1681784 Vali Loss: 0.1803503 Test Loss: 0.1282326
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 3.405168056488037
Epoch: 23, Steps: 64 | Train Loss: 0.1676866 Vali Loss: 0.1804217 Test Loss: 0.1285751
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 3.6295502185821533
Epoch: 24, Steps: 64 | Train Loss: 0.1676338 Vali Loss: 0.1806454 Test Loss: 0.1285609
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 3.2953264713287354
Epoch: 25, Steps: 64 | Train Loss: 0.1675154 Vali Loss: 0.1810387 Test Loss: 0.1287223
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 3.681687355041504
Epoch: 26, Steps: 64 | Train Loss: 0.1671094 Vali Loss: 0.1810195 Test Loss: 0.1284112
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 3.653998851776123
Epoch: 27, Steps: 64 | Train Loss: 0.1664734 Vali Loss: 0.1799598 Test Loss: 0.1282500
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 3.3250961303710938
Epoch: 28, Steps: 64 | Train Loss: 0.1664635 Vali Loss: 0.1812155 Test Loss: 0.1282749
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 3.628863573074341
Epoch: 29, Steps: 64 | Train Loss: 0.1661438 Vali Loss: 0.1808070 Test Loss: 0.1280393
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 3.5153684616088867
Epoch: 30, Steps: 64 | Train Loss: 0.1667027 Vali Loss: 0.1815797 Test Loss: 0.1282619
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 3.3249447345733643
Epoch: 31, Steps: 64 | Train Loss: 0.1665376 Vali Loss: 0.1803166 Test Loss: 0.1282180
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 3.7333483695983887
Epoch: 32, Steps: 64 | Train Loss: 0.1656171 Vali Loss: 0.1813605 Test Loss: 0.1283514
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 3.51629376411438
Epoch: 33, Steps: 64 | Train Loss: 0.1655295 Vali Loss: 0.1814411 Test Loss: 0.1280949
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 3.3200459480285645
Epoch: 34, Steps: 64 | Train Loss: 0.1654365 Vali Loss: 0.1811388 Test Loss: 0.1278636
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 3.9513797760009766
Epoch: 35, Steps: 64 | Train Loss: 0.1656626 Vali Loss: 0.1811948 Test Loss: 0.1282165
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 3.4468319416046143
Epoch: 36, Steps: 64 | Train Loss: 0.1653765 Vali Loss: 0.1804061 Test Loss: 0.1281409
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 3.3711342811584473
Epoch: 37, Steps: 64 | Train Loss: 0.1656972 Vali Loss: 0.1813801 Test Loss: 0.1282737
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 3.2503511905670166
Epoch: 38, Steps: 64 | Train Loss: 0.1649982 Vali Loss: 0.1805325 Test Loss: 0.1281159
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 3.6334235668182373
Epoch: 39, Steps: 64 | Train Loss: 0.1647819 Vali Loss: 0.1804704 Test Loss: 0.1283249
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 3.4960005283355713
Epoch: 40, Steps: 64 | Train Loss: 0.1650161 Vali Loss: 0.1812703 Test Loss: 0.1282169
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 3.615353584289551
Epoch: 41, Steps: 64 | Train Loss: 0.1653890 Vali Loss: 0.1809262 Test Loss: 0.1282915
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 3.661166191101074
Epoch: 42, Steps: 64 | Train Loss: 0.1649372 Vali Loss: 0.1815988 Test Loss: 0.1282975
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 3.3523614406585693
Epoch: 43, Steps: 64 | Train Loss: 0.1647089 Vali Loss: 0.1815942 Test Loss: 0.1281958
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 3.6193907260894775
Epoch: 44, Steps: 64 | Train Loss: 0.1655145 Vali Loss: 0.1815122 Test Loss: 0.1282130
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 3.729572057723999
Epoch: 45, Steps: 64 | Train Loss: 0.1651869 Vali Loss: 0.1810471 Test Loss: 0.1281441
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 3.752291440963745
Epoch: 46, Steps: 64 | Train Loss: 0.1652863 Vali Loss: 0.1815196 Test Loss: 0.1282360
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 3.44504451751709
Epoch: 47, Steps: 64 | Train Loss: 0.1650378 Vali Loss: 0.1817372 Test Loss: 0.1280809
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 3.341552734375
Epoch: 48, Steps: 64 | Train Loss: 0.1652545 Vali Loss: 0.1807865 Test Loss: 0.1280772
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 3.688962936401367
Epoch: 49, Steps: 64 | Train Loss: 0.1652779 Vali Loss: 0.1815097 Test Loss: 0.1283898
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 3.5980374813079834
Epoch: 50, Steps: 64 | Train Loss: 0.1649090 Vali Loss: 0.1805740 Test Loss: 0.1282477
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 3.6277594566345215
Epoch: 51, Steps: 64 | Train Loss: 0.1655205 Vali Loss: 0.1808515 Test Loss: 0.1283427
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 3.404658555984497
Epoch: 52, Steps: 64 | Train Loss: 0.1650093 Vali Loss: 0.1816536 Test Loss: 0.1281423
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 3.498330593109131
Epoch: 53, Steps: 64 | Train Loss: 0.1653241 Vali Loss: 0.1808245 Test Loss: 0.1282635
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 3.47611665725708
Epoch: 54, Steps: 64 | Train Loss: 0.1650061 Vali Loss: 0.1806742 Test Loss: 0.1281423
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 3.649733304977417
Epoch: 55, Steps: 64 | Train Loss: 0.1653400 Vali Loss: 0.1823744 Test Loss: 0.1281821
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 3.410301446914673
Epoch: 56, Steps: 64 | Train Loss: 0.1646460 Vali Loss: 0.1809622 Test Loss: 0.1281750
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 3.8745369911193848
Epoch: 57, Steps: 64 | Train Loss: 0.1653711 Vali Loss: 0.1813755 Test Loss: 0.1284886
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 3.7101798057556152
Epoch: 58, Steps: 64 | Train Loss: 0.1651825 Vali Loss: 0.1811694 Test Loss: 0.1282983
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 3.245917797088623
Epoch: 59, Steps: 64 | Train Loss: 0.1646714 Vali Loss: 0.1818910 Test Loss: 0.1281613
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 3.3914272785186768
Epoch: 60, Steps: 64 | Train Loss: 0.1649223 Vali Loss: 0.1811242 Test Loss: 0.1284054
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 3.3946518898010254
Epoch: 61, Steps: 64 | Train Loss: 0.1653437 Vali Loss: 0.1826514 Test Loss: 0.1282650
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 3.46728777885437
Epoch: 62, Steps: 64 | Train Loss: 0.1658308 Vali Loss: 0.1819537 Test Loss: 0.1283569
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 3.4472415447235107
Epoch: 63, Steps: 64 | Train Loss: 0.1651516 Vali Loss: 0.1815140 Test Loss: 0.1283147
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 3.4112000465393066
Epoch: 64, Steps: 64 | Train Loss: 0.1647041 Vali Loss: 0.1816419 Test Loss: 0.1283099
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 3.498661994934082
Epoch: 65, Steps: 64 | Train Loss: 0.1654143 Vali Loss: 0.1809245 Test Loss: 0.1282346
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 3.4553072452545166
Epoch: 66, Steps: 64 | Train Loss: 0.1647667 Vali Loss: 0.1810916 Test Loss: 0.1282272
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 3.3095924854278564
Epoch: 67, Steps: 64 | Train Loss: 0.1647275 Vali Loss: 0.1819659 Test Loss: 0.1281774
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 3.2921879291534424
Epoch: 68, Steps: 64 | Train Loss: 0.1647585 Vali Loss: 0.1821055 Test Loss: 0.1282029
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 3.39467191696167
Epoch: 69, Steps: 64 | Train Loss: 0.1649712 Vali Loss: 0.1825309 Test Loss: 0.1282155
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 3.6865687370300293
Epoch: 70, Steps: 64 | Train Loss: 0.1646940 Vali Loss: 0.1808906 Test Loss: 0.1282796
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 3.637786626815796
Epoch: 71, Steps: 64 | Train Loss: 0.1655110 Vali Loss: 0.1818202 Test Loss: 0.1282576
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 3.3910722732543945
Epoch: 72, Steps: 64 | Train Loss: 0.1651692 Vali Loss: 0.1819969 Test Loss: 0.1282888
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 3.5258562564849854
Epoch: 73, Steps: 64 | Train Loss: 0.1650207 Vali Loss: 0.1824797 Test Loss: 0.1281382
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 3.587298631668091
Epoch: 74, Steps: 64 | Train Loss: 0.1649862 Vali Loss: 0.1817280 Test Loss: 0.1284372
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 3.7002387046813965
Epoch: 75, Steps: 64 | Train Loss: 0.1648738 Vali Loss: 0.1815563 Test Loss: 0.1281277
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 3.4239890575408936
Epoch: 76, Steps: 64 | Train Loss: 0.1649501 Vali Loss: 0.1816272 Test Loss: 0.1282583
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 3.4272959232330322
Epoch: 77, Steps: 64 | Train Loss: 0.1643576 Vali Loss: 0.1821965 Test Loss: 0.1282364
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 3.3392415046691895
Epoch: 78, Steps: 64 | Train Loss: 0.1651461 Vali Loss: 0.1809445 Test Loss: 0.1282987
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 3.3057820796966553
Epoch: 79, Steps: 64 | Train Loss: 0.1652569 Vali Loss: 0.1823137 Test Loss: 0.1281969
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 3.3718936443328857
Epoch: 80, Steps: 64 | Train Loss: 0.1660817 Vali Loss: 0.1825952 Test Loss: 0.1281053
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 3.570277452468872
Epoch: 81, Steps: 64 | Train Loss: 0.1649130 Vali Loss: 0.1815058 Test Loss: 0.1284188
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 3.3087081909179688
Epoch: 82, Steps: 64 | Train Loss: 0.1649164 Vali Loss: 0.1818527 Test Loss: 0.1282079
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 3.4936137199401855
Epoch: 83, Steps: 64 | Train Loss: 0.1653559 Vali Loss: 0.1823427 Test Loss: 0.1282327
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 3.454150676727295
Epoch: 84, Steps: 64 | Train Loss: 0.1648974 Vali Loss: 0.1819562 Test Loss: 0.1281013
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 3.5493946075439453
Epoch: 85, Steps: 64 | Train Loss: 0.1656127 Vali Loss: 0.1817444 Test Loss: 0.1283306
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 3.5728514194488525
Epoch: 86, Steps: 64 | Train Loss: 0.1653383 Vali Loss: 0.1816181 Test Loss: 0.1281677
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 3.2268009185791016
Epoch: 87, Steps: 64 | Train Loss: 0.1648752 Vali Loss: 0.1809595 Test Loss: 0.1282264
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 3.2994325160980225
Epoch: 88, Steps: 64 | Train Loss: 0.1650159 Vali Loss: 0.1819098 Test Loss: 0.1282033
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 3.3163206577301025
Epoch: 89, Steps: 64 | Train Loss: 0.1652502 Vali Loss: 0.1818257 Test Loss: 0.1280239
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 3.4592185020446777
Epoch: 90, Steps: 64 | Train Loss: 0.1649744 Vali Loss: 0.1818812 Test Loss: 0.1281695
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 3.2474470138549805
Epoch: 91, Steps: 64 | Train Loss: 0.1651928 Vali Loss: 0.1806765 Test Loss: 0.1282487
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 3.3570473194122314
Epoch: 92, Steps: 64 | Train Loss: 0.1650535 Vali Loss: 0.1817616 Test Loss: 0.1282104
EarlyStopping counter: 74 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 3.3155696392059326
Epoch: 93, Steps: 64 | Train Loss: 0.1646305 Vali Loss: 0.1817026 Test Loss: 0.1284117
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 3.694946765899658
Epoch: 94, Steps: 64 | Train Loss: 0.1643474 Vali Loss: 0.1814423 Test Loss: 0.1282500
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 3.3601274490356445
Epoch: 95, Steps: 64 | Train Loss: 0.1651049 Vali Loss: 0.1810110 Test Loss: 0.1281587
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 3.557530403137207
Epoch: 96, Steps: 64 | Train Loss: 0.1661874 Vali Loss: 0.1819225 Test Loss: 0.1284654
EarlyStopping counter: 78 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 3.5147721767425537
Epoch: 97, Steps: 64 | Train Loss: 0.1649557 Vali Loss: 0.1814542 Test Loss: 0.1284578
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 3.4132673740386963
Epoch: 98, Steps: 64 | Train Loss: 0.1650663 Vali Loss: 0.1817643 Test Loss: 0.1281864
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 3.865551471710205
Epoch: 99, Steps: 64 | Train Loss: 0.1649525 Vali Loss: 0.1805298 Test Loss: 0.1282032
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 3.5746614933013916
Epoch: 100, Steps: 64 | Train Loss: 0.1653423 Vali Loss: 0.1815964 Test Loss: 0.1283959
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : ETTh2_336_96_PatchTST_ETTh2_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.12928566336631775, mae:0.2821313738822937, rse:0.5812907218933105
