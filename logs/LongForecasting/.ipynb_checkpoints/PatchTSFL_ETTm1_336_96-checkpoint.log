Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_96', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_96_PatchTSFL_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5305150
	speed: 0.0117s/iter; left time: 309.9484s
	iters: 200, epoch: 1 | loss: 0.4988352
	speed: 0.0064s/iter; left time: 168.7253s
Epoch: 1 cost time: 2.3434383869171143
Epoch: 1, Steps: 266 | Train Loss: 0.4917769 Vali Loss: 0.9057132 Test Loss: 0.6812291
Validation loss decreased (inf --> 0.905713).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.4774347
	speed: 0.0404s/iter; left time: 1058.6336s
	iters: 200, epoch: 2 | loss: 0.5334008
	speed: 0.0067s/iter; left time: 174.3713s
Epoch: 2 cost time: 2.3630740642547607
Epoch: 2, Steps: 266 | Train Loss: 0.4919604 Vali Loss: 0.9054772 Test Loss: 0.6812336
Validation loss decreased (0.905713 --> 0.905477).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.4560559
	speed: 0.0412s/iter; left time: 1069.6985s
	iters: 200, epoch: 3 | loss: 0.5137805
	speed: 0.0070s/iter; left time: 180.7248s
Epoch: 3 cost time: 2.472083568572998
Epoch: 3, Steps: 266 | Train Loss: 0.4917854 Vali Loss: 0.9063841 Test Loss: 0.6812390
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.5184184
	speed: 0.0419s/iter; left time: 1076.4036s
	iters: 200, epoch: 4 | loss: 0.4766287
	speed: 0.0067s/iter; left time: 172.4083s
Epoch: 4 cost time: 2.4323439598083496
Epoch: 4, Steps: 266 | Train Loss: 0.4916709 Vali Loss: 0.9058026 Test Loss: 0.6812456
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.4917479
	speed: 0.0419s/iter; left time: 1065.3237s
	iters: 200, epoch: 5 | loss: 0.5030859
	speed: 0.0066s/iter; left time: 166.4375s
Epoch: 5 cost time: 2.386348009109497
Epoch: 5, Steps: 266 | Train Loss: 0.4917759 Vali Loss: 0.9059630 Test Loss: 0.6812531
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.4769663
	speed: 0.0418s/iter; left time: 1051.7137s
	iters: 200, epoch: 6 | loss: 0.4779353
	speed: 0.0070s/iter; left time: 174.9755s
Epoch: 6 cost time: 2.4570116996765137
Epoch: 6, Steps: 266 | Train Loss: 0.4915984 Vali Loss: 0.9061805 Test Loss: 0.6812623
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.4857842
	speed: 0.0413s/iter; left time: 1028.5030s
	iters: 200, epoch: 7 | loss: 0.4645791
	speed: 0.0066s/iter; left time: 163.6001s
Epoch: 7 cost time: 2.4291040897369385
Epoch: 7, Steps: 266 | Train Loss: 0.4918316 Vali Loss: 0.9052529 Test Loss: 0.6812738
Validation loss decreased (0.905477 --> 0.905253).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.4965019
	speed: 0.0413s/iter; left time: 1017.2851s
	iters: 200, epoch: 8 | loss: 0.5273219
	speed: 0.0067s/iter; left time: 164.2756s
Epoch: 8 cost time: 2.3337228298187256
Epoch: 8, Steps: 266 | Train Loss: 0.4916868 Vali Loss: 0.9060943 Test Loss: 0.6812882
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.5378173
	speed: 0.0434s/iter; left time: 1058.4250s
	iters: 200, epoch: 9 | loss: 0.4618597
	speed: 0.0068s/iter; left time: 166.1792s
Epoch: 9 cost time: 2.442444324493408
Epoch: 9, Steps: 266 | Train Loss: 0.4916051 Vali Loss: 0.9057887 Test Loss: 0.6813037
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.4863358
	speed: 0.0430s/iter; left time: 1036.0738s
	iters: 200, epoch: 10 | loss: 0.5126693
	speed: 0.0065s/iter; left time: 155.8320s
Epoch: 10 cost time: 2.4339964389801025
Epoch: 10, Steps: 266 | Train Loss: 0.4915955 Vali Loss: 0.9055442 Test Loss: 0.6813238
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.4976453
	speed: 0.0402s/iter; left time: 957.3988s
	iters: 200, epoch: 11 | loss: 0.4798344
	speed: 0.0064s/iter; left time: 152.4323s
Epoch: 11 cost time: 2.3552396297454834
Epoch: 11, Steps: 266 | Train Loss: 0.4918202 Vali Loss: 0.9059045 Test Loss: 0.6813440
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.5247077
	speed: 0.0443s/iter; left time: 1043.9164s
	iters: 200, epoch: 12 | loss: 0.4932670
	speed: 0.0071s/iter; left time: 166.5847s
Epoch: 12 cost time: 2.622941732406616
Epoch: 12, Steps: 266 | Train Loss: 0.4916340 Vali Loss: 0.9060595 Test Loss: 0.6813695
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.4650157
	speed: 0.0443s/iter; left time: 1033.1297s
	iters: 200, epoch: 13 | loss: 0.5045785
	speed: 0.0067s/iter; left time: 156.6582s
Epoch: 13 cost time: 2.468008279800415
Epoch: 13, Steps: 266 | Train Loss: 0.4915025 Vali Loss: 0.9058761 Test Loss: 0.6813958
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.4986700
	speed: 0.0439s/iter; left time: 1011.5468s
	iters: 200, epoch: 14 | loss: 0.4400406
	speed: 0.0065s/iter; left time: 149.9778s
Epoch: 14 cost time: 2.3635401725769043
Epoch: 14, Steps: 266 | Train Loss: 0.4916648 Vali Loss: 0.9058879 Test Loss: 0.6814295
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.4749356
	speed: 0.0427s/iter; left time: 972.5786s
	iters: 200, epoch: 15 | loss: 0.5534953
	speed: 0.0067s/iter; left time: 152.1748s
Epoch: 15 cost time: 2.4210598468780518
Epoch: 15, Steps: 266 | Train Loss: 0.4917128 Vali Loss: 0.9062580 Test Loss: 0.6814602
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.5093160
	speed: 0.0411s/iter; left time: 925.4198s
	iters: 200, epoch: 16 | loss: 0.5474757
	speed: 0.0064s/iter; left time: 143.3700s
Epoch: 16 cost time: 2.394517660140991
Epoch: 16, Steps: 266 | Train Loss: 0.4915462 Vali Loss: 0.9063464 Test Loss: 0.6814958
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.4985131
	speed: 0.0423s/iter; left time: 940.3728s
	iters: 200, epoch: 17 | loss: 0.4884225
	speed: 0.0066s/iter; left time: 145.5755s
Epoch: 17 cost time: 2.477572441101074
Epoch: 17, Steps: 266 | Train Loss: 0.4914924 Vali Loss: 0.9062882 Test Loss: 0.6815352
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.4304320
	speed: 0.0414s/iter; left time: 909.8894s
	iters: 200, epoch: 18 | loss: 0.5187331
	speed: 0.0065s/iter; left time: 142.7617s
Epoch: 18 cost time: 2.399686098098755
Epoch: 18, Steps: 266 | Train Loss: 0.4915057 Vali Loss: 0.9064945 Test Loss: 0.6815664
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.5160329
	speed: 0.0419s/iter; left time: 909.4626s
	iters: 200, epoch: 19 | loss: 0.4705246
	speed: 0.0065s/iter; left time: 140.6096s
Epoch: 19 cost time: 2.394333600997925
Epoch: 19, Steps: 266 | Train Loss: 0.4916631 Vali Loss: 0.9060565 Test Loss: 0.6816004
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.5118135
	speed: 0.0423s/iter; left time: 906.2114s
	iters: 200, epoch: 20 | loss: 0.4914635
	speed: 0.0068s/iter; left time: 144.1626s
Epoch: 20 cost time: 2.4334449768066406
Epoch: 20, Steps: 266 | Train Loss: 0.4917358 Vali Loss: 0.9063746 Test Loss: 0.6816326
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.5107611
	speed: 0.0417s/iter; left time: 883.4179s
	iters: 200, epoch: 21 | loss: 0.4893323
	speed: 0.0068s/iter; left time: 144.0170s
Epoch: 21 cost time: 2.40889573097229
Epoch: 21, Steps: 266 | Train Loss: 0.4916953 Vali Loss: 0.9062713 Test Loss: 0.6816612
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.4495140
	speed: 0.0420s/iter; left time: 877.5915s
	iters: 200, epoch: 22 | loss: 0.5251571
	speed: 0.0066s/iter; left time: 137.7267s
Epoch: 22 cost time: 2.4520177841186523
Epoch: 22, Steps: 266 | Train Loss: 0.4917600 Vali Loss: 0.9062206 Test Loss: 0.6816930
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.4808980
	speed: 0.0434s/iter; left time: 896.0253s
	iters: 200, epoch: 23 | loss: 0.5262405
	speed: 0.0064s/iter; left time: 132.2726s
Epoch: 23 cost time: 2.38043212890625
Epoch: 23, Steps: 266 | Train Loss: 0.4916052 Vali Loss: 0.9064842 Test Loss: 0.6817173
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.4744643
	speed: 0.0416s/iter; left time: 848.3041s
	iters: 200, epoch: 24 | loss: 0.4898643
	speed: 0.0064s/iter; left time: 129.0899s
Epoch: 24 cost time: 2.3273890018463135
Epoch: 24, Steps: 266 | Train Loss: 0.4916472 Vali Loss: 0.9059304 Test Loss: 0.6817409
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.5280712
	speed: 0.0412s/iter; left time: 828.4894s
	iters: 200, epoch: 25 | loss: 0.4563513
	speed: 0.0067s/iter; left time: 133.7976s
Epoch: 25 cost time: 2.4081618785858154
Epoch: 25, Steps: 266 | Train Loss: 0.4915756 Vali Loss: 0.9058492 Test Loss: 0.6817549
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.5271012
	speed: 0.0426s/iter; left time: 845.0883s
	iters: 200, epoch: 26 | loss: 0.4876730
	speed: 0.0066s/iter; left time: 131.2323s
Epoch: 26 cost time: 2.4759714603424072
Epoch: 26, Steps: 266 | Train Loss: 0.4915980 Vali Loss: 0.9063967 Test Loss: 0.6817692
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.4687311
	speed: 0.0429s/iter; left time: 840.0305s
	iters: 200, epoch: 27 | loss: 0.5219149
	speed: 0.0069s/iter; left time: 133.9525s
Epoch: 27 cost time: 2.4153316020965576
Epoch: 27, Steps: 266 | Train Loss: 0.4916627 Vali Loss: 0.9066306 Test Loss: 0.6817812
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTSFL_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.6812731027603149, mae:0.5449174046516418, rse:0.7851417660713196
