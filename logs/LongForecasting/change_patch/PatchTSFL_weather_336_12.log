Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', mode_select='random', model='PatchTSFL', model_id='weather_336_96', modes=64, moving_avg=25, n_heads=8, num_workers=0, output_attention=False, padding_patch='end', patch_len=12, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=12, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : weather_336_96_PatchTSFL_custom_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6817690
	speed: 0.1221s/iter; left time: 3456.4455s
	iters: 200, epoch: 1 | loss: 0.5958209
	speed: 0.1223s/iter; left time: 3449.5361s
Epoch: 1 cost time: 34.779868602752686
Epoch: 1, Steps: 284 | Train Loss: 0.7095156 Vali Loss: 0.6070191 Test Loss: 0.2692801
Validation loss decreased (inf --> 0.607019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4879401
	speed: 0.2500s/iter; left time: 7003.4631s
	iters: 200, epoch: 2 | loss: 0.4272806
	speed: 0.1228s/iter; left time: 3428.7472s
Epoch: 2 cost time: 34.82749629020691
Epoch: 2, Steps: 284 | Train Loss: 0.5078000 Vali Loss: 0.4261941 Test Loss: 0.1690537
Validation loss decreased (0.607019 --> 0.426194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3323081
	speed: 0.2502s/iter; left time: 6937.9761s
	iters: 200, epoch: 3 | loss: 0.6239470
	speed: 0.1228s/iter; left time: 3392.4698s
Epoch: 3 cost time: 34.81482553482056
Epoch: 3, Steps: 284 | Train Loss: 0.4538363 Vali Loss: 0.4033855 Test Loss: 0.1637858
Validation loss decreased (0.426194 --> 0.403385).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3546294
	speed: 0.2507s/iter; left time: 6880.9099s
	iters: 200, epoch: 4 | loss: 0.3451558
	speed: 0.1225s/iter; left time: 3350.8975s
Epoch: 4 cost time: 34.78431749343872
Epoch: 4, Steps: 284 | Train Loss: 0.4419184 Vali Loss: 0.4011732 Test Loss: 0.1593870
Validation loss decreased (0.403385 --> 0.401173).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5883583
	speed: 0.2514s/iter; left time: 6829.1307s
	iters: 200, epoch: 5 | loss: 0.2665393
	speed: 0.1234s/iter; left time: 3340.9552s
Epoch: 5 cost time: 34.9156973361969
Epoch: 5, Steps: 284 | Train Loss: 0.4354519 Vali Loss: 0.4004665 Test Loss: 0.1576688
Validation loss decreased (0.401173 --> 0.400467).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2962808
	speed: 0.2504s/iter; left time: 6732.0103s
	iters: 200, epoch: 6 | loss: 0.5164683
	speed: 0.1233s/iter; left time: 3302.7399s
Epoch: 6 cost time: 34.94394826889038
Epoch: 6, Steps: 284 | Train Loss: 0.4291487 Vali Loss: 0.3941423 Test Loss: 0.1563754
Validation loss decreased (0.400467 --> 0.394142).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3402714
	speed: 0.2519s/iter; left time: 6699.4885s
	iters: 200, epoch: 7 | loss: 0.3572805
	speed: 0.1225s/iter; left time: 3246.4822s
Epoch: 7 cost time: 34.779754400253296
Epoch: 7, Steps: 284 | Train Loss: 0.4265118 Vali Loss: 0.3950323 Test Loss: 0.1552660
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3810301
	speed: 0.2506s/iter; left time: 6593.7380s
	iters: 200, epoch: 8 | loss: 0.5632854
	speed: 0.1225s/iter; left time: 3211.6034s
Epoch: 8 cost time: 34.77861285209656
Epoch: 8, Steps: 284 | Train Loss: 0.4238695 Vali Loss: 0.3939218 Test Loss: 0.1555727
Validation loss decreased (0.394142 --> 0.393922).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5801933
	speed: 0.2497s/iter; left time: 6498.1599s
	iters: 200, epoch: 9 | loss: 0.3186951
	speed: 0.1225s/iter; left time: 3176.1536s
Epoch: 9 cost time: 34.76408386230469
Epoch: 9, Steps: 284 | Train Loss: 0.4205978 Vali Loss: 0.3894487 Test Loss: 0.1539490
Validation loss decreased (0.393922 --> 0.389449).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5571592
	speed: 0.2508s/iter; left time: 6455.9700s
	iters: 200, epoch: 10 | loss: 0.5267281
	speed: 0.1225s/iter; left time: 3142.3640s
Epoch: 10 cost time: 34.76981520652771
Epoch: 10, Steps: 284 | Train Loss: 0.4197177 Vali Loss: 0.3904347 Test Loss: 0.1547658
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5539443
	speed: 0.2501s/iter; left time: 6367.9996s
	iters: 200, epoch: 11 | loss: 0.3467986
	speed: 0.1224s/iter; left time: 3104.5792s
Epoch: 11 cost time: 34.7627112865448
Epoch: 11, Steps: 284 | Train Loss: 0.4181220 Vali Loss: 0.3892423 Test Loss: 0.1535145
Validation loss decreased (0.389449 --> 0.389242).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3623852
	speed: 0.2501s/iter; left time: 6295.7014s
	iters: 200, epoch: 12 | loss: 0.5324836
	speed: 0.1226s/iter; left time: 3074.5620s
Epoch: 12 cost time: 34.770248889923096
Epoch: 12, Steps: 284 | Train Loss: 0.4166350 Vali Loss: 0.3877584 Test Loss: 0.1533020
Validation loss decreased (0.389242 --> 0.387758).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.3211343
	speed: 0.2512s/iter; left time: 6253.7420s
	iters: 200, epoch: 13 | loss: 0.5451173
	speed: 0.1227s/iter; left time: 3041.1220s
Epoch: 13 cost time: 34.78202033042908
Epoch: 13, Steps: 284 | Train Loss: 0.4151684 Vali Loss: 0.3886065 Test Loss: 0.1530764
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3432461
	speed: 0.2508s/iter; left time: 6172.3846s
	iters: 200, epoch: 14 | loss: 0.3324116
	speed: 0.1232s/iter; left time: 3018.5298s
Epoch: 14 cost time: 34.85167479515076
Epoch: 14, Steps: 284 | Train Loss: 0.4136857 Vali Loss: 0.3886121 Test Loss: 0.1532983
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.8050640
	speed: 0.2501s/iter; left time: 6082.6809s
	iters: 200, epoch: 15 | loss: 0.6496340
	speed: 0.1227s/iter; left time: 2971.8369s
Epoch: 15 cost time: 34.78808951377869
Epoch: 15, Steps: 284 | Train Loss: 0.4139198 Vali Loss: 0.3880657 Test Loss: 0.1534906
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3470526
	speed: 0.2509s/iter; left time: 6032.1158s
	iters: 200, epoch: 16 | loss: 0.3191214
	speed: 0.1226s/iter; left time: 2935.6243s
Epoch: 16 cost time: 34.783379793167114
Epoch: 16, Steps: 284 | Train Loss: 0.4127338 Vali Loss: 0.3882197 Test Loss: 0.1524882
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.7845342
	speed: 0.2498s/iter; left time: 5935.1776s
	iters: 200, epoch: 17 | loss: 0.3874577
	speed: 0.1228s/iter; left time: 2903.9040s
Epoch: 17 cost time: 34.78929686546326
Epoch: 17, Steps: 284 | Train Loss: 0.4120445 Vali Loss: 0.3845633 Test Loss: 0.1526364
Validation loss decreased (0.387758 --> 0.384563).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3839529
	speed: 0.2500s/iter; left time: 5867.3903s
	iters: 200, epoch: 18 | loss: 0.3205346
	speed: 0.1225s/iter; left time: 2863.6155s
Epoch: 18 cost time: 34.76474714279175
Epoch: 18, Steps: 284 | Train Loss: 0.4105340 Vali Loss: 0.3875729 Test Loss: 0.1533970
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.3460086
	speed: 0.2505s/iter; left time: 5808.9187s
	iters: 200, epoch: 19 | loss: 0.3884856
	speed: 0.1228s/iter; left time: 2835.0705s
Epoch: 19 cost time: 34.858248233795166
Epoch: 19, Steps: 284 | Train Loss: 0.4106733 Vali Loss: 0.3838968 Test Loss: 0.1519935
Validation loss decreased (0.384563 --> 0.383897).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3812216
	speed: 0.2504s/iter; left time: 5735.8695s
	iters: 200, epoch: 20 | loss: 0.3196625
	speed: 0.1228s/iter; left time: 2801.0857s
Epoch: 20 cost time: 34.85406017303467
Epoch: 20, Steps: 284 | Train Loss: 0.4103656 Vali Loss: 0.3841667 Test Loss: 0.1524186
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.5040160
	speed: 0.2510s/iter; left time: 5677.4801s
	iters: 200, epoch: 21 | loss: 0.6433366
	speed: 0.1225s/iter; left time: 2758.7585s
Epoch: 21 cost time: 34.73814415931702
Epoch: 21, Steps: 284 | Train Loss: 0.4090284 Vali Loss: 0.3825945 Test Loss: 0.1517338
Validation loss decreased (0.383897 --> 0.382595).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.3815921
	speed: 0.2507s/iter; left time: 5599.2399s
	iters: 200, epoch: 22 | loss: 0.3017608
	speed: 0.1226s/iter; left time: 2725.1956s
Epoch: 22 cost time: 34.782697439193726
Epoch: 22, Steps: 284 | Train Loss: 0.4076788 Vali Loss: 0.3868050 Test Loss: 0.1523372
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.3424453
	speed: 0.2501s/iter; left time: 5514.9962s
	iters: 200, epoch: 23 | loss: 0.2701326
	speed: 0.1226s/iter; left time: 2692.2262s
Epoch: 23 cost time: 34.815194845199585
Epoch: 23, Steps: 284 | Train Loss: 0.4079496 Vali Loss: 0.3860016 Test Loss: 0.1520585
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.3598603
	speed: 0.2509s/iter; left time: 5461.7109s
	iters: 200, epoch: 24 | loss: 0.9733666
	speed: 0.1225s/iter; left time: 2655.0113s
Epoch: 24 cost time: 34.775699615478516
Epoch: 24, Steps: 284 | Train Loss: 0.4085256 Vali Loss: 0.3854816 Test Loss: 0.1521434
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.7722000
	speed: 0.2501s/iter; left time: 5373.3483s
	iters: 200, epoch: 25 | loss: 0.4591407
	speed: 0.1229s/iter; left time: 2628.0778s
Epoch: 25 cost time: 34.819687843322754
Epoch: 25, Steps: 284 | Train Loss: 0.4084162 Vali Loss: 0.3847454 Test Loss: 0.1521718
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.5557787
	speed: 0.2502s/iter; left time: 5303.6738s
	iters: 200, epoch: 26 | loss: 0.4193535
	speed: 0.1225s/iter; left time: 2585.8173s
Epoch: 26 cost time: 34.82540702819824
Epoch: 26, Steps: 284 | Train Loss: 0.4081789 Vali Loss: 0.3862521 Test Loss: 0.1519698
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.5269784
	speed: 0.2514s/iter; left time: 5259.2386s
	iters: 200, epoch: 27 | loss: 0.3307697
	speed: 0.1225s/iter; left time: 2550.5123s
Epoch: 27 cost time: 34.762085914611816
Epoch: 27, Steps: 284 | Train Loss: 0.4080171 Vali Loss: 0.3843165 Test Loss: 0.1519682
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.3101216
	speed: 0.2502s/iter; left time: 5161.7385s
	iters: 200, epoch: 28 | loss: 0.3248248
	speed: 0.1227s/iter; left time: 2520.2346s
Epoch: 28 cost time: 34.783040046691895
Epoch: 28, Steps: 284 | Train Loss: 0.4069095 Vali Loss: 0.3872511 Test Loss: 0.1520332
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6106951
	speed: 0.2499s/iter; left time: 5085.9271s
	iters: 200, epoch: 29 | loss: 0.2883870
	speed: 0.1225s/iter; left time: 2480.0784s
Epoch: 29 cost time: 34.77402353286743
Epoch: 29, Steps: 284 | Train Loss: 0.4077738 Vali Loss: 0.3869425 Test Loss: 0.1518456
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.3021644
	speed: 0.2511s/iter; left time: 5037.9735s
	iters: 200, epoch: 30 | loss: 0.2934019
	speed: 0.1226s/iter; left time: 2446.8985s
Epoch: 30 cost time: 34.79488658905029
Epoch: 30, Steps: 284 | Train Loss: 0.4069442 Vali Loss: 0.3838544 Test Loss: 0.1518028
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.5663961
	speed: 0.2502s/iter; left time: 4949.3957s
	iters: 200, epoch: 31 | loss: 0.2897874
	speed: 0.1233s/iter; left time: 2427.0942s
Epoch: 31 cost time: 34.87832045555115
Epoch: 31, Steps: 284 | Train Loss: 0.4070490 Vali Loss: 0.3864524 Test Loss: 0.1517293
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.3484774
	speed: 0.2508s/iter; left time: 4889.1198s
	iters: 200, epoch: 32 | loss: 0.5736251
	speed: 0.1225s/iter; left time: 2377.0567s
Epoch: 32 cost time: 34.781795024871826
Epoch: 32, Steps: 284 | Train Loss: 0.4069681 Vali Loss: 0.3848088 Test Loss: 0.1518013
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.4121043
	speed: 0.2513s/iter; left time: 4829.0430s
	iters: 200, epoch: 33 | loss: 0.3570551
	speed: 0.1228s/iter; left time: 2347.6127s
Epoch: 33 cost time: 34.84057021141052
Epoch: 33, Steps: 284 | Train Loss: 0.4069177 Vali Loss: 0.3871907 Test Loss: 0.1517750
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.3651294
	speed: 0.2503s/iter; left time: 4738.8103s
	iters: 200, epoch: 34 | loss: 0.5061292
	speed: 0.1229s/iter; left time: 2314.9210s
Epoch: 34 cost time: 34.867385387420654
Epoch: 34, Steps: 284 | Train Loss: 0.4069574 Vali Loss: 0.3863183 Test Loss: 0.1518996
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.3434604
	speed: 0.2519s/iter; left time: 4696.3586s
	iters: 200, epoch: 35 | loss: 0.3273833
	speed: 0.1226s/iter; left time: 2273.5120s
Epoch: 35 cost time: 34.785441398620605
Epoch: 35, Steps: 284 | Train Loss: 0.4058249 Vali Loss: 0.3847531 Test Loss: 0.1517852
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.3293047
	speed: 0.2506s/iter; left time: 4601.9948s
	iters: 200, epoch: 36 | loss: 0.5783228
	speed: 0.1231s/iter; left time: 2247.1501s
Epoch: 36 cost time: 34.88009977340698
Epoch: 36, Steps: 284 | Train Loss: 0.4068503 Vali Loss: 0.3845151 Test Loss: 0.1518595
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.4024679
	speed: 0.2502s/iter; left time: 4523.7264s
	iters: 200, epoch: 37 | loss: 0.3649786
	speed: 0.1225s/iter; left time: 2202.8939s
Epoch: 37 cost time: 34.80514669418335
Epoch: 37, Steps: 284 | Train Loss: 0.4064460 Vali Loss: 0.3850873 Test Loss: 0.1517885
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.4666780
	speed: 0.2509s/iter; left time: 4464.9922s
	iters: 200, epoch: 38 | loss: 0.7144221
	speed: 0.1229s/iter; left time: 2173.6888s
Epoch: 38 cost time: 34.82808756828308
Epoch: 38, Steps: 284 | Train Loss: 0.4062851 Vali Loss: 0.3859735 Test Loss: 0.1517249
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.3395976
	speed: 0.2503s/iter; left time: 4381.8739s
	iters: 200, epoch: 39 | loss: 0.5603371
	speed: 0.1226s/iter; left time: 2133.8515s
Epoch: 39 cost time: 34.78271436691284
Epoch: 39, Steps: 284 | Train Loss: 0.4061825 Vali Loss: 0.3855577 Test Loss: 0.1517998
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.3585556
	speed: 0.2501s/iter; left time: 4307.7026s
	iters: 200, epoch: 40 | loss: 0.3374105
	speed: 0.1226s/iter; left time: 2098.8329s
Epoch: 40 cost time: 34.768513202667236
Epoch: 40, Steps: 284 | Train Loss: 0.4045873 Vali Loss: 0.3860466 Test Loss: 0.1517558
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.3351884
	speed: 0.2501s/iter; left time: 4237.5638s
	iters: 200, epoch: 41 | loss: 0.3068584
	speed: 0.1227s/iter; left time: 2066.4806s
Epoch: 41 cost time: 34.803194761276245
Epoch: 41, Steps: 284 | Train Loss: 0.4063937 Vali Loss: 0.3865842 Test Loss: 0.1517490
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : weather_336_96_PatchTSFL_custom_ftM_sl336_ll48_pl96_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.15173393487930298, mae:0.199481800198555, rse:0.51315838098526
