Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_96_Informer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6263382
	speed: 0.0514s/iter; left time: 932.3781s
	iters: 200, epoch: 1 | loss: 0.7043982
	speed: 0.0308s/iter; left time: 555.2557s
	iters: 300, epoch: 1 | loss: 0.3697986
	speed: 0.0304s/iter; left time: 545.4679s
	iters: 400, epoch: 1 | loss: 0.4557980
	speed: 0.0304s/iter; left time: 541.2964s
	iters: 500, epoch: 1 | loss: 0.5863239
	speed: 0.0328s/iter; left time: 580.8927s
	iters: 600, epoch: 1 | loss: 0.4579362
	speed: 0.0317s/iter; left time: 558.0594s
	iters: 700, epoch: 1 | loss: 0.5293859
	speed: 0.0335s/iter; left time: 587.5082s
	iters: 800, epoch: 1 | loss: 0.4443190
	speed: 0.0366s/iter; left time: 637.6672s
	iters: 900, epoch: 1 | loss: 0.3917867
	speed: 0.0330s/iter; left time: 571.0926s
	iters: 1000, epoch: 1 | loss: 0.4778954
	speed: 0.0322s/iter; left time: 555.1066s
	iters: 1100, epoch: 1 | loss: 0.2946429
	speed: 0.0314s/iter; left time: 538.4058s
	iters: 1200, epoch: 1 | loss: 0.4032029
	speed: 0.0320s/iter; left time: 544.4451s
	iters: 1300, epoch: 1 | loss: 0.4605756
	speed: 0.0306s/iter; left time: 517.2385s
	iters: 1400, epoch: 1 | loss: 0.4279963
	speed: 0.0309s/iter; left time: 519.3955s
	iters: 1500, epoch: 1 | loss: 0.4070452
	speed: 0.0310s/iter; left time: 517.9566s
	iters: 1600, epoch: 1 | loss: 0.3148576
	speed: 0.0304s/iter; left time: 504.9562s
	iters: 1700, epoch: 1 | loss: 1.1872150
	speed: 0.0321s/iter; left time: 530.4519s
	iters: 1800, epoch: 1 | loss: 0.3556437
	speed: 0.0332s/iter; left time: 545.3684s
	iters: 1900, epoch: 1 | loss: 0.3450980
	speed: 0.0331s/iter; left time: 541.0202s
	iters: 2000, epoch: 1 | loss: 0.2702425
	speed: 0.0314s/iter; left time: 509.6929s
	iters: 2100, epoch: 1 | loss: 0.3307164
	speed: 0.0310s/iter; left time: 500.5817s
	iters: 2200, epoch: 1 | loss: 0.4276015
	speed: 0.0317s/iter; left time: 507.6538s
	iters: 2300, epoch: 1 | loss: 0.5579293
	speed: 0.0319s/iter; left time: 507.8666s
	iters: 2400, epoch: 1 | loss: 0.4345250
	speed: 0.0301s/iter; left time: 476.8573s
	iters: 2500, epoch: 1 | loss: 0.3613569
	speed: 0.0328s/iter; left time: 515.6974s
	iters: 2600, epoch: 1 | loss: 0.2551936
	speed: 0.0307s/iter; left time: 480.1370s
	iters: 2700, epoch: 1 | loss: 0.2692785
	speed: 0.0317s/iter; left time: 491.5987s
	iters: 2800, epoch: 1 | loss: 0.3501951
	speed: 0.0313s/iter; left time: 482.8741s
	iters: 2900, epoch: 1 | loss: 0.2777113
	speed: 0.0306s/iter; left time: 469.0153s
	iters: 3000, epoch: 1 | loss: 0.2367393
	speed: 0.0308s/iter; left time: 469.1415s
	iters: 3100, epoch: 1 | loss: 0.4107376
	speed: 0.0320s/iter; left time: 483.6508s
	iters: 3200, epoch: 1 | loss: 0.3103466
	speed: 0.0313s/iter; left time: 469.7924s
	iters: 3300, epoch: 1 | loss: 0.3767893
	speed: 0.0315s/iter; left time: 470.2726s
	iters: 3400, epoch: 1 | loss: 0.3139081
	speed: 0.0311s/iter; left time: 460.5559s
	iters: 3500, epoch: 1 | loss: 0.3478630
	speed: 0.0320s/iter; left time: 471.0498s
	iters: 3600, epoch: 1 | loss: 0.3714933
	speed: 0.0332s/iter; left time: 485.7256s
	iters: 3700, epoch: 1 | loss: 0.2053498
	speed: 0.0333s/iter; left time: 484.2889s
	iters: 3800, epoch: 1 | loss: 0.2167311
	speed: 0.0307s/iter; left time: 442.8064s
	iters: 3900, epoch: 1 | loss: 0.3709381
	speed: 0.0310s/iter; left time: 444.0166s
	iters: 4000, epoch: 1 | loss: 0.2196524
	speed: 0.0315s/iter; left time: 447.8810s
	iters: 4100, epoch: 1 | loss: 0.3315151
	speed: 0.0312s/iter; left time: 441.0393s
	iters: 4200, epoch: 1 | loss: 0.2409075
	speed: 0.0314s/iter; left time: 440.8944s
	iters: 4300, epoch: 1 | loss: 0.2379718
	speed: 0.0313s/iter; left time: 436.3746s
	iters: 4400, epoch: 1 | loss: 0.3066455
	speed: 0.0311s/iter; left time: 430.0153s
	iters: 4500, epoch: 1 | loss: 0.4770118
	speed: 0.0311s/iter; left time: 427.2633s
	iters: 4600, epoch: 1 | loss: 0.5176902
	speed: 0.0311s/iter; left time: 424.3629s
	iters: 4700, epoch: 1 | loss: 0.2216742
	speed: 0.0315s/iter; left time: 425.9993s
	iters: 4800, epoch: 1 | loss: 0.3169067
	speed: 0.0316s/iter; left time: 424.7933s
	iters: 4900, epoch: 1 | loss: 0.8799782
	speed: 0.0325s/iter; left time: 432.6375s
	iters: 5000, epoch: 1 | loss: 0.3687127
	speed: 0.0309s/iter; left time: 408.8206s
	iters: 5100, epoch: 1 | loss: 0.4050924
	speed: 0.0311s/iter; left time: 407.8775s
	iters: 5200, epoch: 1 | loss: 0.2535032
	speed: 0.0314s/iter; left time: 409.3171s
	iters: 5300, epoch: 1 | loss: 0.2534210
	speed: 0.0311s/iter; left time: 402.5359s
	iters: 5400, epoch: 1 | loss: 0.2644263
	speed: 0.0325s/iter; left time: 416.9032s
	iters: 5500, epoch: 1 | loss: 0.2735117
	speed: 0.0313s/iter; left time: 398.0030s
	iters: 5600, epoch: 1 | loss: 0.3523132
	speed: 0.0312s/iter; left time: 393.9498s
	iters: 5700, epoch: 1 | loss: 0.3323363
	speed: 0.0311s/iter; left time: 389.5492s
	iters: 5800, epoch: 1 | loss: 6.7515678
	speed: 0.0325s/iter; left time: 403.4085s
	iters: 5900, epoch: 1 | loss: 0.2852346
	speed: 0.0317s/iter; left time: 390.3976s
	iters: 6000, epoch: 1 | loss: 0.3026679
	speed: 0.0321s/iter; left time: 392.4553s
	iters: 6100, epoch: 1 | loss: 0.2381239
	speed: 0.0321s/iter; left time: 388.8039s
	iters: 6200, epoch: 1 | loss: 0.5100544
	speed: 0.0329s/iter; left time: 395.2488s
	iters: 6300, epoch: 1 | loss: 0.3725895
	speed: 0.0341s/iter; left time: 406.2212s
	iters: 6400, epoch: 1 | loss: 0.1929093
	speed: 0.0368s/iter; left time: 435.1861s
	iters: 6500, epoch: 1 | loss: 0.1831350
	speed: 0.0336s/iter; left time: 394.0830s
	iters: 6600, epoch: 1 | loss: 0.1566958
	speed: 0.0335s/iter; left time: 389.3681s
	iters: 6700, epoch: 1 | loss: 0.2708471
	speed: 0.0323s/iter; left time: 371.8587s
	iters: 6800, epoch: 1 | loss: 0.2763861
	speed: 0.0312s/iter; left time: 357.0423s
	iters: 6900, epoch: 1 | loss: 0.9827604
	speed: 0.0308s/iter; left time: 349.0806s
	iters: 7000, epoch: 1 | loss: 0.4416763
	speed: 0.0313s/iter; left time: 350.9514s
	iters: 7100, epoch: 1 | loss: 0.3941810
	speed: 0.0311s/iter; left time: 346.1988s
	iters: 7200, epoch: 1 | loss: 0.1849107
	speed: 0.0317s/iter; left time: 349.8591s
	iters: 7300, epoch: 1 | loss: 0.1663426
	speed: 0.0334s/iter; left time: 364.5035s
	iters: 7400, epoch: 1 | loss: 0.1579271
	speed: 0.0342s/iter; left time: 370.3828s
	iters: 7500, epoch: 1 | loss: 0.1942444
	speed: 0.0343s/iter; left time: 367.7627s
	iters: 7600, epoch: 1 | loss: 0.1624449
	speed: 0.0329s/iter; left time: 349.6939s
	iters: 7700, epoch: 1 | loss: 0.2487022
	speed: 0.0307s/iter; left time: 323.7320s
	iters: 7800, epoch: 1 | loss: 0.2227968
	speed: 0.0336s/iter; left time: 349.9692s
	iters: 7900, epoch: 1 | loss: 0.2201468
	speed: 0.0315s/iter; left time: 325.8402s
	iters: 8000, epoch: 1 | loss: 0.3113167
	speed: 0.0345s/iter; left time: 352.6997s
	iters: 8100, epoch: 1 | loss: 0.2642479
	speed: 0.0322s/iter; left time: 326.6527s
	iters: 8200, epoch: 1 | loss: 0.2591884
	speed: 0.0304s/iter; left time: 304.8893s
	iters: 8300, epoch: 1 | loss: 0.4918886
	speed: 0.0307s/iter; left time: 304.3614s
	iters: 8400, epoch: 1 | loss: 0.2319261
	speed: 0.0303s/iter; left time: 297.5215s
	iters: 8500, epoch: 1 | loss: 0.2254462
	speed: 0.0310s/iter; left time: 301.6097s
	iters: 8600, epoch: 1 | loss: 0.3740681
	speed: 0.0304s/iter; left time: 293.1970s
	iters: 8700, epoch: 1 | loss: 0.7232066
	speed: 0.0310s/iter; left time: 294.9418s
	iters: 8800, epoch: 1 | loss: 0.2406140
	speed: 0.0315s/iter; left time: 297.3308s
	iters: 8900, epoch: 1 | loss: 0.4146454
	speed: 0.0337s/iter; left time: 314.6899s
	iters: 9000, epoch: 1 | loss: 0.4188838
	speed: 0.0320s/iter; left time: 295.7107s
	iters: 9100, epoch: 1 | loss: 0.2312938
	speed: 0.0336s/iter; left time: 306.7841s
Epoch: 1 cost time: 292.7761199474335
Epoch: 1, Steps: 9114 | Train Loss: 0.4991046 Vali Loss: 0.4747986 Test Loss: 0.2940790
Validation loss decreased (inf --> 0.474799).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3557420
	speed: 0.5432s/iter; left time: 4897.0355s
	iters: 200, epoch: 2 | loss: 0.3193369
	speed: 0.0346s/iter; left time: 308.7122s
	iters: 300, epoch: 2 | loss: 0.2936813
	speed: 0.0339s/iter; left time: 299.2683s
	iters: 400, epoch: 2 | loss: 0.3795387
	speed: 0.0345s/iter; left time: 301.0077s
	iters: 500, epoch: 2 | loss: 0.2701904
	speed: 0.0345s/iter; left time: 296.8246s
	iters: 600, epoch: 2 | loss: 0.2526353
	speed: 0.0327s/iter; left time: 278.3272s
	iters: 700, epoch: 2 | loss: 0.5699908
	speed: 0.0340s/iter; left time: 285.8121s
	iters: 800, epoch: 2 | loss: 0.2719076
	speed: 0.0363s/iter; left time: 301.9662s
	iters: 900, epoch: 2 | loss: 0.4500329
	speed: 0.0376s/iter; left time: 308.7778s
	iters: 1000, epoch: 2 | loss: 0.2698422
	speed: 0.0385s/iter; left time: 312.6147s
	iters: 1100, epoch: 2 | loss: 0.1579235
	speed: 0.0347s/iter; left time: 278.2944s
	iters: 1200, epoch: 2 | loss: 0.3637655
	speed: 0.0351s/iter; left time: 277.7508s
	iters: 1300, epoch: 2 | loss: 0.2064012
	speed: 0.0355s/iter; left time: 277.0692s
	iters: 1400, epoch: 2 | loss: 0.3015728
	speed: 0.0360s/iter; left time: 277.9770s
	iters: 1500, epoch: 2 | loss: 0.3692656
	speed: 0.0328s/iter; left time: 249.7693s
	iters: 1600, epoch: 2 | loss: 0.2551548
	speed: 0.0339s/iter; left time: 255.0739s
	iters: 1700, epoch: 2 | loss: 0.2421615
	speed: 0.0336s/iter; left time: 249.1974s
	iters: 1800, epoch: 2 | loss: 0.3729804
	speed: 0.0338s/iter; left time: 247.2042s
	iters: 1900, epoch: 2 | loss: 0.3720292
	speed: 0.0347s/iter; left time: 250.5300s
	iters: 2000, epoch: 2 | loss: 0.2444500
	speed: 0.0351s/iter; left time: 249.4564s
	iters: 2100, epoch: 2 | loss: 0.2252663
	speed: 0.0351s/iter; left time: 246.2525s
	iters: 2200, epoch: 2 | loss: 0.1902061
	speed: 0.0362s/iter; left time: 250.4894s
	iters: 2300, epoch: 2 | loss: 0.3267977
	speed: 0.0371s/iter; left time: 252.6091s
	iters: 2400, epoch: 2 | loss: 0.1380810
	speed: 0.0341s/iter; left time: 229.1329s
	iters: 2500, epoch: 2 | loss: 0.1844488
	speed: 0.0341s/iter; left time: 225.4295s
	iters: 2600, epoch: 2 | loss: 0.6549149
	speed: 0.0346s/iter; left time: 225.2812s
	iters: 2700, epoch: 2 | loss: 0.2984610
	speed: 0.0353s/iter; left time: 226.5862s
	iters: 2800, epoch: 2 | loss: 0.2304508
	speed: 0.0347s/iter; left time: 218.9750s
	iters: 2900, epoch: 2 | loss: 0.1857246
	speed: 0.0319s/iter; left time: 198.2341s
	iters: 3000, epoch: 2 | loss: 0.4236229
	speed: 0.0324s/iter; left time: 197.8203s
	iters: 3100, epoch: 2 | loss: 0.2288252
	speed: 0.0345s/iter; left time: 207.3570s
	iters: 3200, epoch: 2 | loss: 0.1712309
	speed: 0.0369s/iter; left time: 217.9701s
	iters: 3300, epoch: 2 | loss: 0.3613292
	speed: 0.0371s/iter; left time: 215.4514s
	iters: 3400, epoch: 2 | loss: 0.1838677
	speed: 0.0390s/iter; left time: 223.0389s
	iters: 3500, epoch: 2 | loss: 0.1840755
	speed: 0.0360s/iter; left time: 202.0318s
	iters: 3600, epoch: 2 | loss: 0.2271731
	speed: 0.0338s/iter; left time: 186.4318s
	iters: 3700, epoch: 2 | loss: 0.2053361
	speed: 0.0334s/iter; left time: 180.8434s
	iters: 3800, epoch: 2 | loss: 0.2499886
	speed: 0.0368s/iter; left time: 195.7108s
	iters: 3900, epoch: 2 | loss: 0.1433554
	speed: 0.0373s/iter; left time: 194.5229s
	iters: 4000, epoch: 2 | loss: 0.2282192
	speed: 0.0370s/iter; left time: 189.2805s
	iters: 4100, epoch: 2 | loss: 0.6120924
	speed: 0.0343s/iter; left time: 172.1831s
	iters: 4200, epoch: 2 | loss: 0.4188993
	speed: 0.0371s/iter; left time: 182.2089s
	iters: 4300, epoch: 2 | loss: 0.1835697
	speed: 0.0355s/iter; left time: 170.8411s
	iters: 4400, epoch: 2 | loss: 1.9102991
	speed: 0.0409s/iter; left time: 192.6340s
	iters: 4500, epoch: 2 | loss: 0.3326674
	speed: 0.0381s/iter; left time: 175.8387s
	iters: 4600, epoch: 2 | loss: 0.2410038
	speed: 0.0377s/iter; left time: 170.0966s
	iters: 4700, epoch: 2 | loss: 0.1356327
	speed: 0.0346s/iter; left time: 152.5495s
	iters: 4800, epoch: 2 | loss: 0.1064709
	speed: 0.0382s/iter; left time: 164.8718s
	iters: 4900, epoch: 2 | loss: 0.0782378
	speed: 0.0365s/iter; left time: 153.8452s
	iters: 5000, epoch: 2 | loss: 0.2281290
	speed: 0.0344s/iter; left time: 141.3966s
	iters: 5100, epoch: 2 | loss: 0.1471735
	speed: 0.0347s/iter; left time: 139.2477s
	iters: 5200, epoch: 2 | loss: 0.1401582
	speed: 0.0355s/iter; left time: 139.0311s
	iters: 5300, epoch: 2 | loss: 0.1297846
	speed: 0.0354s/iter; left time: 134.9720s
	iters: 5400, epoch: 2 | loss: 0.1707372
	speed: 0.0339s/iter; left time: 125.8270s
	iters: 5500, epoch: 2 | loss: 0.2788970
	speed: 0.0351s/iter; left time: 127.0414s
	iters: 5600, epoch: 2 | loss: 0.6577858
	speed: 0.0382s/iter; left time: 134.1145s
	iters: 5700, epoch: 2 | loss: 0.7570292
	speed: 0.0378s/iter; left time: 129.0254s
	iters: 5800, epoch: 2 | loss: 0.2841176
	speed: 0.0362s/iter; left time: 119.9510s
	iters: 5900, epoch: 2 | loss: 0.1329367
	speed: 0.0353s/iter; left time: 113.5705s
	iters: 6000, epoch: 2 | loss: 0.2362208
	speed: 0.0349s/iter; left time: 108.6658s
	iters: 6100, epoch: 2 | loss: 0.3498673
	speed: 0.0354s/iter; left time: 106.8476s
	iters: 6200, epoch: 2 | loss: 0.1530443
	speed: 0.0355s/iter; left time: 103.5849s
	iters: 6300, epoch: 2 | loss: 0.1838062
	speed: 0.0356s/iter; left time: 100.1519s
	iters: 6400, epoch: 2 | loss: 0.1517747
	speed: 0.0354s/iter; left time: 96.1805s
	iters: 6500, epoch: 2 | loss: 0.1334775
	speed: 0.0331s/iter; left time: 86.5412s
	iters: 6600, epoch: 2 | loss: 0.1958456
	speed: 0.0360s/iter; left time: 90.5742s
	iters: 6700, epoch: 2 | loss: 0.1858016
	speed: 0.0357s/iter; left time: 86.1383s
	iters: 6800, epoch: 2 | loss: 0.2456832
	speed: 0.0372s/iter; left time: 86.1057s
	iters: 6900, epoch: 2 | loss: 0.2277198
	speed: 0.0385s/iter; left time: 85.2488s
	iters: 7000, epoch: 2 | loss: 0.1740037
	speed: 0.0359s/iter; left time: 75.8402s
	iters: 7100, epoch: 2 | loss: 0.3753125
	speed: 0.0351s/iter; left time: 70.6830s
	iters: 7200, epoch: 2 | loss: 0.1355230
	speed: 0.0349s/iter; left time: 66.7755s
	iters: 7300, epoch: 2 | loss: 0.2929643
	speed: 0.0333s/iter; left time: 60.5002s
	iters: 7400, epoch: 2 | loss: 0.1477321
	speed: 0.0335s/iter; left time: 57.4843s
	iters: 7500, epoch: 2 | loss: 0.2615255
	speed: 0.0344s/iter; left time: 55.5201s
	iters: 7600, epoch: 2 | loss: 0.1885897
	speed: 0.0324s/iter; left time: 49.0437s
	iters: 7700, epoch: 2 | loss: 0.3809912
	speed: 0.0361s/iter; left time: 51.1107s
	iters: 7800, epoch: 2 | loss: 0.1865391
	speed: 0.0353s/iter; left time: 46.3928s
	iters: 7900, epoch: 2 | loss: 0.1558504
	speed: 0.0374s/iter; left time: 45.3981s
	iters: 8000, epoch: 2 | loss: 0.4514819
	speed: 0.0413s/iter; left time: 46.0656s
	iters: 8100, epoch: 2 | loss: 0.2187904
	speed: 0.0404s/iter; left time: 41.0503s
	iters: 8200, epoch: 2 | loss: 0.2133783
	speed: 0.0390s/iter; left time: 35.6620s
	iters: 8300, epoch: 2 | loss: 0.1700882
	speed: 0.0337s/iter; left time: 27.4547s
	iters: 8400, epoch: 2 | loss: 0.1521410
	speed: 0.0305s/iter; left time: 21.8228s
	iters: 8500, epoch: 2 | loss: 0.1664262
	speed: 0.0337s/iter; left time: 20.7395s
	iters: 8600, epoch: 2 | loss: 0.3679302
	speed: 0.0328s/iter; left time: 16.8930s
	iters: 8700, epoch: 2 | loss: 0.1462122
	speed: 0.0359s/iter; left time: 14.9188s
	iters: 8800, epoch: 2 | loss: 0.1588192
	speed: 0.0361s/iter; left time: 11.3714s
	iters: 8900, epoch: 2 | loss: 0.1565928
	speed: 0.0335s/iter; left time: 7.2028s
	iters: 9000, epoch: 2 | loss: 0.0881607
	speed: 0.0359s/iter; left time: 4.1300s
	iters: 9100, epoch: 2 | loss: 0.1461945
	speed: 0.0361s/iter; left time: 0.5411s
Epoch: 2 cost time: 325.9315938949585
Epoch: 2, Steps: 9114 | Train Loss: 0.3774098 Vali Loss: 0.5636611 Test Loss: 0.3457530
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_96_Informer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.294052392244339, mae:0.37666910886764526, rse:0.714602530002594
