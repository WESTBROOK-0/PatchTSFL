Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=128, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTSFL', model_id='336_96', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : 336_96_PatchTSFL_ETTh1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 5.622531890869141
Epoch: 1, Steps: 64 | Train Loss: 0.6830885 Vali Loss: 1.3143437 Test Loss: 0.6788107
Validation loss decreased (inf --> 1.314344).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 6.289055109024048
Epoch: 2, Steps: 64 | Train Loss: 0.5245527 Vali Loss: 0.8750432 Test Loss: 0.4845995
Validation loss decreased (1.314344 --> 0.875043).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 6.270298957824707
Epoch: 3, Steps: 64 | Train Loss: 0.4159872 Vali Loss: 0.7674065 Test Loss: 0.4776644
Validation loss decreased (0.875043 --> 0.767406).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 6.077874660491943
Epoch: 4, Steps: 64 | Train Loss: 0.3931409 Vali Loss: 0.7270359 Test Loss: 0.4460130
Validation loss decreased (0.767406 --> 0.727036).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 5.924527645111084
Epoch: 5, Steps: 64 | Train Loss: 0.3815649 Vali Loss: 0.7228853 Test Loss: 0.4458394
Validation loss decreased (0.727036 --> 0.722885).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 5.883517503738403
Epoch: 6, Steps: 64 | Train Loss: 0.3736003 Vali Loss: 0.7053790 Test Loss: 0.4366886
Validation loss decreased (0.722885 --> 0.705379).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 6.331695556640625
Epoch: 7, Steps: 64 | Train Loss: 0.3672302 Vali Loss: 0.6993822 Test Loss: 0.4233113
Validation loss decreased (0.705379 --> 0.699382).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 6.56577205657959
Epoch: 8, Steps: 64 | Train Loss: 0.3618580 Vali Loss: 0.6986345 Test Loss: 0.4212090
Validation loss decreased (0.699382 --> 0.698635).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 6.254655122756958
Epoch: 9, Steps: 64 | Train Loss: 0.3570520 Vali Loss: 0.6956624 Test Loss: 0.4177984
Validation loss decreased (0.698635 --> 0.695662).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 6.3478844165802
Epoch: 10, Steps: 64 | Train Loss: 0.3530898 Vali Loss: 0.6854714 Test Loss: 0.4097348
Validation loss decreased (0.695662 --> 0.685471).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 6.199207305908203
Epoch: 11, Steps: 64 | Train Loss: 0.3494297 Vali Loss: 0.6749175 Test Loss: 0.4040468
Validation loss decreased (0.685471 --> 0.674917).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 6.95893669128418
Epoch: 12, Steps: 64 | Train Loss: 0.3462349 Vali Loss: 0.6799771 Test Loss: 0.4006499
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 6.398590326309204
Epoch: 13, Steps: 64 | Train Loss: 0.3440915 Vali Loss: 0.6786512 Test Loss: 0.3981808
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 6.3377134799957275
Epoch: 14, Steps: 64 | Train Loss: 0.3416805 Vali Loss: 0.6697758 Test Loss: 0.3959080
Validation loss decreased (0.674917 --> 0.669776).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 6.681124925613403
Epoch: 15, Steps: 64 | Train Loss: 0.3403342 Vali Loss: 0.6785789 Test Loss: 0.3976080
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 6.430240869522095
Epoch: 16, Steps: 64 | Train Loss: 0.3381241 Vali Loss: 0.6683764 Test Loss: 0.3957049
Validation loss decreased (0.669776 --> 0.668376).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 6.221644163131714
Epoch: 17, Steps: 64 | Train Loss: 0.3366700 Vali Loss: 0.6676475 Test Loss: 0.3930337
Validation loss decreased (0.668376 --> 0.667648).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 6.530378580093384
Epoch: 18, Steps: 64 | Train Loss: 0.3357120 Vali Loss: 0.6723010 Test Loss: 0.3938429
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 6.330761671066284
Epoch: 19, Steps: 64 | Train Loss: 0.3345226 Vali Loss: 0.6677125 Test Loss: 0.3935385
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 6.696444511413574
Epoch: 20, Steps: 64 | Train Loss: 0.3335354 Vali Loss: 0.6692377 Test Loss: 0.3926086
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 6.579975366592407
Epoch: 21, Steps: 64 | Train Loss: 0.3326136 Vali Loss: 0.6701744 Test Loss: 0.3931208
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 6.674348592758179
Epoch: 22, Steps: 64 | Train Loss: 0.3320277 Vali Loss: 0.6744164 Test Loss: 0.3935004
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 6.47593092918396
Epoch: 23, Steps: 64 | Train Loss: 0.3313584 Vali Loss: 0.6659729 Test Loss: 0.3943015
Validation loss decreased (0.667648 --> 0.665973).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 6.732200860977173
Epoch: 24, Steps: 64 | Train Loss: 0.3306962 Vali Loss: 0.6625381 Test Loss: 0.3923434
Validation loss decreased (0.665973 --> 0.662538).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 6.554665803909302
Epoch: 25, Steps: 64 | Train Loss: 0.3302057 Vali Loss: 0.6687874 Test Loss: 0.3935820
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 6.33062219619751
Epoch: 26, Steps: 64 | Train Loss: 0.3295446 Vali Loss: 0.6728986 Test Loss: 0.3919589
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 6.144011974334717
Epoch: 27, Steps: 64 | Train Loss: 0.3294951 Vali Loss: 0.6639655 Test Loss: 0.3924777
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 6.543234348297119
Epoch: 28, Steps: 64 | Train Loss: 0.3285724 Vali Loss: 0.6731157 Test Loss: 0.3928879
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 6.298418998718262
Epoch: 29, Steps: 64 | Train Loss: 0.3283456 Vali Loss: 0.6692239 Test Loss: 0.3910192
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 6.354238748550415
Epoch: 30, Steps: 64 | Train Loss: 0.3280685 Vali Loss: 0.6696412 Test Loss: 0.3929655
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 6.401780605316162
Epoch: 31, Steps: 64 | Train Loss: 0.3276003 Vali Loss: 0.6712623 Test Loss: 0.3929226
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 6.295732021331787
Epoch: 32, Steps: 64 | Train Loss: 0.3272272 Vali Loss: 0.6723565 Test Loss: 0.3929592
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 6.3966898918151855
Epoch: 33, Steps: 64 | Train Loss: 0.3269857 Vali Loss: 0.6737358 Test Loss: 0.3927134
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 6.474985122680664
Epoch: 34, Steps: 64 | Train Loss: 0.3271278 Vali Loss: 0.6738105 Test Loss: 0.3925984
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 6.459956645965576
Epoch: 35, Steps: 64 | Train Loss: 0.3268386 Vali Loss: 0.6724914 Test Loss: 0.3929972
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 6.753861427307129
Epoch: 36, Steps: 64 | Train Loss: 0.3266166 Vali Loss: 0.6708676 Test Loss: 0.3925914
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 6.373494386672974
Epoch: 37, Steps: 64 | Train Loss: 0.3263088 Vali Loss: 0.6682444 Test Loss: 0.3926542
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 6.406463861465454
Epoch: 38, Steps: 64 | Train Loss: 0.3263416 Vali Loss: 0.6747398 Test Loss: 0.3929120
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 6.247661828994751
Epoch: 39, Steps: 64 | Train Loss: 0.3263015 Vali Loss: 0.6707339 Test Loss: 0.3926788
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 6.268952369689941
Epoch: 40, Steps: 64 | Train Loss: 0.3261854 Vali Loss: 0.6700339 Test Loss: 0.3930341
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 6.442736625671387
Epoch: 41, Steps: 64 | Train Loss: 0.3257965 Vali Loss: 0.6723686 Test Loss: 0.3927263
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 6.382735729217529
Epoch: 42, Steps: 64 | Train Loss: 0.3260443 Vali Loss: 0.6707017 Test Loss: 0.3926993
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 6.307939291000366
Epoch: 43, Steps: 64 | Train Loss: 0.3257474 Vali Loss: 0.6716046 Test Loss: 0.3927088
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 6.377772331237793
Epoch: 44, Steps: 64 | Train Loss: 0.3255282 Vali Loss: 0.6708152 Test Loss: 0.3929914
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 6.262738943099976
Epoch: 45, Steps: 64 | Train Loss: 0.3257037 Vali Loss: 0.6716089 Test Loss: 0.3929425
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 6.28040075302124
Epoch: 46, Steps: 64 | Train Loss: 0.3253068 Vali Loss: 0.6683302 Test Loss: 0.3929753
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 6.688077211380005
Epoch: 47, Steps: 64 | Train Loss: 0.3255565 Vali Loss: 0.6712430 Test Loss: 0.3928328
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 6.375969409942627
Epoch: 48, Steps: 64 | Train Loss: 0.3256171 Vali Loss: 0.6729747 Test Loss: 0.3930270
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 6.280073165893555
Epoch: 49, Steps: 64 | Train Loss: 0.3252018 Vali Loss: 0.6679571 Test Loss: 0.3929441
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 6.517053842544556
Epoch: 50, Steps: 64 | Train Loss: 0.3252807 Vali Loss: 0.6724153 Test Loss: 0.3929474
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 6.514187335968018
Epoch: 51, Steps: 64 | Train Loss: 0.3252279 Vali Loss: 0.6698014 Test Loss: 0.3929145
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 6.098916053771973
Epoch: 52, Steps: 64 | Train Loss: 0.3252223 Vali Loss: 0.6679801 Test Loss: 0.3930231
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 6.268441677093506
Epoch: 53, Steps: 64 | Train Loss: 0.3253996 Vali Loss: 0.6698060 Test Loss: 0.3928778
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 6.293651342391968
Epoch: 54, Steps: 64 | Train Loss: 0.3254748 Vali Loss: 0.6698741 Test Loss: 0.3928713
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 6.393163204193115
Epoch: 55, Steps: 64 | Train Loss: 0.3252681 Vali Loss: 0.6739171 Test Loss: 0.3929604
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 6.150960683822632
Epoch: 56, Steps: 64 | Train Loss: 0.3253604 Vali Loss: 0.6675359 Test Loss: 0.3929656
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 6.4911205768585205
Epoch: 57, Steps: 64 | Train Loss: 0.3252839 Vali Loss: 0.6693583 Test Loss: 0.3928781
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 7.038209915161133
Epoch: 58, Steps: 64 | Train Loss: 0.3250935 Vali Loss: 0.6719266 Test Loss: 0.3928877
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 6.476337671279907
Epoch: 59, Steps: 64 | Train Loss: 0.3251040 Vali Loss: 0.6738867 Test Loss: 0.3929275
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 6.499624252319336
Epoch: 60, Steps: 64 | Train Loss: 0.3250595 Vali Loss: 0.6719889 Test Loss: 0.3929156
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 6.584677457809448
Epoch: 61, Steps: 64 | Train Loss: 0.3247422 Vali Loss: 0.6718014 Test Loss: 0.3929576
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 6.4987428188323975
Epoch: 62, Steps: 64 | Train Loss: 0.3249101 Vali Loss: 0.6720164 Test Loss: 0.3929105
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 6.2508885860443115
Epoch: 63, Steps: 64 | Train Loss: 0.3251303 Vali Loss: 0.6702313 Test Loss: 0.3929249
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 6.450103759765625
Epoch: 64, Steps: 64 | Train Loss: 0.3252694 Vali Loss: 0.6734438 Test Loss: 0.3929529
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 6.161314964294434
Epoch: 65, Steps: 64 | Train Loss: 0.3248577 Vali Loss: 0.6729096 Test Loss: 0.3929081
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 6.90125846862793
Epoch: 66, Steps: 64 | Train Loss: 0.3248911 Vali Loss: 0.6672072 Test Loss: 0.3929299
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 6.309715747833252
Epoch: 67, Steps: 64 | Train Loss: 0.3250086 Vali Loss: 0.6741630 Test Loss: 0.3929316
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 6.284269332885742
Epoch: 68, Steps: 64 | Train Loss: 0.3249703 Vali Loss: 0.6713539 Test Loss: 0.3929180
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 6.25373911857605
Epoch: 69, Steps: 64 | Train Loss: 0.3251296 Vali Loss: 0.6692231 Test Loss: 0.3929387
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 6.312711954116821
Epoch: 70, Steps: 64 | Train Loss: 0.3250489 Vali Loss: 0.6675103 Test Loss: 0.3929366
EarlyStopping counter: 46 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 6.182112216949463
Epoch: 71, Steps: 64 | Train Loss: 0.3251787 Vali Loss: 0.6717781 Test Loss: 0.3929259
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 6.330909967422485
Epoch: 72, Steps: 64 | Train Loss: 0.3246286 Vali Loss: 0.6704065 Test Loss: 0.3929136
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 6.373384952545166
Epoch: 73, Steps: 64 | Train Loss: 0.3250815 Vali Loss: 0.6710702 Test Loss: 0.3929074
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 6.244588851928711
Epoch: 74, Steps: 64 | Train Loss: 0.3249135 Vali Loss: 0.6723865 Test Loss: 0.3929169
EarlyStopping counter: 50 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 6.339898586273193
Epoch: 75, Steps: 64 | Train Loss: 0.3250896 Vali Loss: 0.6752330 Test Loss: 0.3929203
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 6.4942779541015625
Epoch: 76, Steps: 64 | Train Loss: 0.3249319 Vali Loss: 0.6715245 Test Loss: 0.3929221
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 6.429391860961914
Epoch: 77, Steps: 64 | Train Loss: 0.3250311 Vali Loss: 0.6734527 Test Loss: 0.3929272
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 6.2771031856536865
Epoch: 78, Steps: 64 | Train Loss: 0.3250358 Vali Loss: 0.6731580 Test Loss: 0.3929245
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 6.253451824188232
Epoch: 79, Steps: 64 | Train Loss: 0.3249129 Vali Loss: 0.6712366 Test Loss: 0.3929266
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 6.146197080612183
Epoch: 80, Steps: 64 | Train Loss: 0.3250454 Vali Loss: 0.6710200 Test Loss: 0.3929181
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 5.923194408416748
Epoch: 81, Steps: 64 | Train Loss: 0.3249939 Vali Loss: 0.6683860 Test Loss: 0.3929199
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 5.89986515045166
Epoch: 82, Steps: 64 | Train Loss: 0.3250961 Vali Loss: 0.6722904 Test Loss: 0.3929240
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 5.9704430103302
Epoch: 83, Steps: 64 | Train Loss: 0.3249738 Vali Loss: 0.6670297 Test Loss: 0.3929207
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 5.999139308929443
Epoch: 84, Steps: 64 | Train Loss: 0.3251544 Vali Loss: 0.6723426 Test Loss: 0.3929212
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 6.0129523277282715
Epoch: 85, Steps: 64 | Train Loss: 0.3252797 Vali Loss: 0.6715280 Test Loss: 0.3929202
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 6.351964235305786
Epoch: 86, Steps: 64 | Train Loss: 0.3249040 Vali Loss: 0.6692924 Test Loss: 0.3929208
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 6.086045980453491
Epoch: 87, Steps: 64 | Train Loss: 0.3251016 Vali Loss: 0.6703031 Test Loss: 0.3929201
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 6.415803670883179
Epoch: 88, Steps: 64 | Train Loss: 0.3248876 Vali Loss: 0.6724967 Test Loss: 0.3929233
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 6.243454217910767
Epoch: 89, Steps: 64 | Train Loss: 0.3250404 Vali Loss: 0.6722051 Test Loss: 0.3929205
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 6.694531679153442
Epoch: 90, Steps: 64 | Train Loss: 0.3251288 Vali Loss: 0.6717845 Test Loss: 0.3929228
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 6.954046249389648
Epoch: 91, Steps: 64 | Train Loss: 0.3245487 Vali Loss: 0.6720630 Test Loss: 0.3929227
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 6.3106629848480225
Epoch: 92, Steps: 64 | Train Loss: 0.3247248 Vali Loss: 0.6750179 Test Loss: 0.3929214
EarlyStopping counter: 68 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 6.154980659484863
Epoch: 93, Steps: 64 | Train Loss: 0.3250989 Vali Loss: 0.6724787 Test Loss: 0.3929215
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 6.261120557785034
Epoch: 94, Steps: 64 | Train Loss: 0.3251730 Vali Loss: 0.6699826 Test Loss: 0.3929216
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 5.93666934967041
Epoch: 95, Steps: 64 | Train Loss: 0.3245701 Vali Loss: 0.6735125 Test Loss: 0.3929223
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 6.0539398193359375
Epoch: 96, Steps: 64 | Train Loss: 0.3248719 Vali Loss: 0.6692188 Test Loss: 0.3929233
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 6.454801559448242
Epoch: 97, Steps: 64 | Train Loss: 0.3244866 Vali Loss: 0.6767160 Test Loss: 0.3929221
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 6.069368839263916
Epoch: 98, Steps: 64 | Train Loss: 0.3247354 Vali Loss: 0.6736666 Test Loss: 0.3929225
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 5.94716739654541
Epoch: 99, Steps: 64 | Train Loss: 0.3252139 Vali Loss: 0.6712199 Test Loss: 0.3929232
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 5.985020637512207
Epoch: 100, Steps: 64 | Train Loss: 0.3251085 Vali Loss: 0.6736507 Test Loss: 0.3929227
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_96_PatchTSFL_ETTh1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.39234352111816406, mae:0.41431063413619995, rse:0.5939483642578125
