Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=1, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='CIPatchTSF', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : weather_336_720_CIPatchTSF_custom_ftM_sl336_ll48_pl720_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7012565
	speed: 0.7106s/iter; left time: 19754.0866s
	iters: 200, epoch: 1 | loss: 0.6886512
	speed: 0.6624s/iter; left time: 18350.4126s
Epoch: 1 cost time: 190.0495409965515
Epoch: 1, Steps: 279 | Train Loss: 0.7587475 Vali Loss: 0.7394864 Test Loss: 0.3684520
Validation loss decreased (inf --> 0.739486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6353793
	speed: 1.4425s/iter; left time: 39701.6526s
	iters: 200, epoch: 2 | loss: 0.5589525
	speed: 0.6686s/iter; left time: 18335.6386s
Epoch: 2 cost time: 188.95904421806335
Epoch: 2, Steps: 279 | Train Loss: 0.6327574 Vali Loss: 0.6448306 Test Loss: 0.3232378
Validation loss decreased (0.739486 --> 0.644831).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5649546
	speed: 1.5636s/iter; left time: 42598.2186s
	iters: 200, epoch: 3 | loss: 0.6226944
	speed: 0.7087s/iter; left time: 19236.4330s
Epoch: 3 cost time: 206.64598393440247
Epoch: 3, Steps: 279 | Train Loss: 0.5878633 Vali Loss: 0.6395040 Test Loss: 0.3270678
Validation loss decreased (0.644831 --> 0.639504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5475587
	speed: 1.5286s/iter; left time: 41217.5292s
	iters: 200, epoch: 4 | loss: 0.5925748
	speed: 0.6894s/iter; left time: 18520.0553s
Epoch: 4 cost time: 192.54388046264648
Epoch: 4, Steps: 279 | Train Loss: 0.5692210 Vali Loss: 0.6424494 Test Loss: 0.3305358
EarlyStopping counter: 1 out of 20
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6233301
	speed: 1.5204s/iter; left time: 40573.0036s
	iters: 200, epoch: 5 | loss: 0.6243893
	speed: 0.7415s/iter; left time: 19712.3693s
Epoch: 5 cost time: 213.45564460754395
Epoch: 5, Steps: 279 | Train Loss: 0.5546622 Vali Loss: 0.6535791 Test Loss: 0.3338587
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5105928
	speed: 1.6369s/iter; left time: 43223.4407s
	iters: 200, epoch: 6 | loss: 0.5575346
	speed: 0.7370s/iter; left time: 19388.6145s
Epoch: 6 cost time: 210.53652954101562
Epoch: 6, Steps: 279 | Train Loss: 0.5429179 Vali Loss: 0.6527890 Test Loss: 0.3396264
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5797481
	speed: 1.6817s/iter; left time: 43938.8617s
	iters: 200, epoch: 7 | loss: 0.5852593
	speed: 0.7757s/iter; left time: 20190.2623s
Epoch: 7 cost time: 222.92421340942383
Epoch: 7, Steps: 279 | Train Loss: 0.5341895 Vali Loss: 0.6566160 Test Loss: 0.3400055
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4462951
	speed: 1.5903s/iter; left time: 41106.8220s
	iters: 200, epoch: 8 | loss: 0.5505517
	speed: 0.6965s/iter; left time: 17933.8352s
Epoch: 8 cost time: 195.8724684715271
Epoch: 8, Steps: 279 | Train Loss: 0.5260547 Vali Loss: 0.6568881 Test Loss: 0.3426704
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5174586
	speed: 1.5789s/iter; left time: 40370.9021s
	iters: 200, epoch: 9 | loss: 0.5501790
	speed: 0.7132s/iter; left time: 18163.7277s
Epoch: 9 cost time: 205.95256161689758
Epoch: 9, Steps: 279 | Train Loss: 0.5194044 Vali Loss: 0.6605972 Test Loss: 0.3459771
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4886881
	speed: 1.5468s/iter; left time: 39118.4013s
	iters: 200, epoch: 10 | loss: 0.4701370
	speed: 0.6802s/iter; left time: 17134.6328s
Epoch: 10 cost time: 196.1133418083191
Epoch: 10, Steps: 279 | Train Loss: 0.5131517 Vali Loss: 0.6639208 Test Loss: 0.3477040
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5048780
	speed: 1.5643s/iter; left time: 39124.8806s
	iters: 200, epoch: 11 | loss: 0.4987025
	speed: 0.6674s/iter; left time: 16625.1985s
Epoch: 11 cost time: 201.9463062286377
Epoch: 11, Steps: 279 | Train Loss: 0.5079897 Vali Loss: 0.6674787 Test Loss: 0.3503140
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.4659371
	speed: 1.5553s/iter; left time: 38464.9750s
	iters: 200, epoch: 12 | loss: 0.5186592
	speed: 0.6724s/iter; left time: 16561.8499s
Epoch: 12 cost time: 195.73549222946167
Epoch: 12, Steps: 279 | Train Loss: 0.5033875 Vali Loss: 0.6727042 Test Loss: 0.3517798
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.4944554
	speed: 1.5286s/iter; left time: 37379.1585s
	iters: 200, epoch: 13 | loss: 0.5359071
	speed: 0.7121s/iter; left time: 17342.6289s
Epoch: 13 cost time: 200.21293377876282
Epoch: 13, Steps: 279 | Train Loss: 0.4999060 Vali Loss: 0.6727287 Test Loss: 0.3539800
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.4649642
	speed: 1.6250s/iter; left time: 39282.6995s
	iters: 200, epoch: 14 | loss: 0.5172090
	speed: 0.7868s/iter; left time: 18940.3206s
Epoch: 14 cost time: 222.5022530555725
Epoch: 14, Steps: 279 | Train Loss: 0.4961459 Vali Loss: 0.6743520 Test Loss: 0.3550815
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4424329
	speed: 1.7246s/iter; left time: 41208.6709s
	iters: 200, epoch: 15 | loss: 0.5196670
	speed: 0.7437s/iter; left time: 17696.6169s
Epoch: 15 cost time: 221.11532068252563
Epoch: 15, Steps: 279 | Train Loss: 0.4931052 Vali Loss: 0.6778204 Test Loss: 0.3571914
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5008451
	speed: 1.7073s/iter; left time: 40318.8509s
	iters: 200, epoch: 16 | loss: 0.4728595
	speed: 0.7219s/iter; left time: 16977.2111s
Epoch: 16 cost time: 212.38769030570984
Epoch: 16, Steps: 279 | Train Loss: 0.4903694 Vali Loss: 0.6800587 Test Loss: 0.3571006
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.4665339
	speed: 1.7193s/iter; left time: 40123.5118s
	iters: 200, epoch: 17 | loss: 0.4906178
	speed: 0.7453s/iter; left time: 17317.9659s
Epoch: 17 cost time: 217.87473893165588
Epoch: 17, Steps: 279 | Train Loss: 0.4875472 Vali Loss: 0.6797011 Test Loss: 0.3591601
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.5100964
	speed: 1.6428s/iter; left time: 37880.5492s
	iters: 200, epoch: 18 | loss: 0.4574697
	speed: 0.7361s/iter; left time: 16899.6477s
Epoch: 18 cost time: 211.23161840438843
Epoch: 18, Steps: 279 | Train Loss: 0.4858364 Vali Loss: 0.6812514 Test Loss: 0.3601767
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5173448
	speed: 1.6834s/iter; left time: 38347.1517s
	iters: 200, epoch: 19 | loss: 0.4509631
	speed: 0.8364s/iter; left time: 18969.5331s
Epoch: 19 cost time: 221.11186170578003
Epoch: 19, Steps: 279 | Train Loss: 0.4839451 Vali Loss: 0.6825164 Test Loss: 0.3603272
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.5598236
	speed: 1.6889s/iter; left time: 37999.4177s
	iters: 200, epoch: 20 | loss: 0.4648349
	speed: 0.7234s/iter; left time: 16204.6663s
Epoch: 20 cost time: 214.17534494400024
Epoch: 20, Steps: 279 | Train Loss: 0.4817590 Vali Loss: 0.6852869 Test Loss: 0.3610461
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.4635763
	speed: 1.7388s/iter; left time: 38638.2576s
	iters: 200, epoch: 21 | loss: 0.5015829
	speed: 0.7575s/iter; left time: 16757.4402s
Epoch: 21 cost time: 216.3982436656952
Epoch: 21, Steps: 279 | Train Loss: 0.4804954 Vali Loss: 0.6850615 Test Loss: 0.3616663
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.4237140
	speed: 1.6454s/iter; left time: 36102.7862s
	iters: 200, epoch: 22 | loss: 0.4525917
	speed: 0.7320s/iter; left time: 15987.7968s
Epoch: 22 cost time: 216.22791695594788
Epoch: 22, Steps: 279 | Train Loss: 0.4791699 Vali Loss: 0.6858315 Test Loss: 0.3617243
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.5069438
	speed: 1.8123s/iter; left time: 39260.6258s
	iters: 200, epoch: 23 | loss: 0.4401480
	speed: 0.7879s/iter; left time: 16989.4682s
Epoch: 23 cost time: 231.500470161438
Epoch: 23, Steps: 279 | Train Loss: 0.4774902 Vali Loss: 0.6873498 Test Loss: 0.3628348
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : weather_336_720_CIPatchTSF_custom_ftM_sl336_ll48_pl720_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3270670473575592, mae:0.34247055649757385, rse:0.7544595003128052
