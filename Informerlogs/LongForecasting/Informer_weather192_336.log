Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_192_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_336_Informer_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7145725
	speed: 0.0509s/iter; left time: 919.8227s
	iters: 200, epoch: 1 | loss: 3.1801577
	speed: 0.0325s/iter; left time: 584.0031s
	iters: 300, epoch: 1 | loss: 1.0667471
	speed: 0.0321s/iter; left time: 574.3688s
	iters: 400, epoch: 1 | loss: 0.5420726
	speed: 0.0326s/iter; left time: 579.5458s
	iters: 500, epoch: 1 | loss: 0.5244964
	speed: 0.0315s/iter; left time: 556.3716s
	iters: 600, epoch: 1 | loss: 0.5408248
	speed: 0.0313s/iter; left time: 549.7302s
	iters: 700, epoch: 1 | loss: 0.7254342
	speed: 0.0313s/iter; left time: 547.3357s
	iters: 800, epoch: 1 | loss: 0.5843990
	speed: 0.0311s/iter; left time: 539.7474s
	iters: 900, epoch: 1 | loss: 0.4938611
	speed: 0.0312s/iter; left time: 538.7965s
	iters: 1000, epoch: 1 | loss: 0.4651150
	speed: 0.0316s/iter; left time: 542.2064s
	iters: 1100, epoch: 1 | loss: 0.4635007
	speed: 0.0326s/iter; left time: 557.5142s
	iters: 1200, epoch: 1 | loss: 0.4793895
	speed: 0.0324s/iter; left time: 550.4948s
	iters: 1300, epoch: 1 | loss: 2.9517148
	speed: 0.0309s/iter; left time: 522.0134s
	iters: 1400, epoch: 1 | loss: 0.3279321
	speed: 0.0308s/iter; left time: 517.1130s
	iters: 1500, epoch: 1 | loss: 0.4228334
	speed: 0.0308s/iter; left time: 513.4567s
	iters: 1600, epoch: 1 | loss: 0.6238795
	speed: 0.0305s/iter; left time: 506.4391s
	iters: 1700, epoch: 1 | loss: 0.5547080
	speed: 0.0315s/iter; left time: 518.9881s
	iters: 1800, epoch: 1 | loss: 0.3870029
	speed: 0.0328s/iter; left time: 537.7109s
	iters: 1900, epoch: 1 | loss: 0.5333555
	speed: 0.0323s/iter; left time: 525.4436s
	iters: 2000, epoch: 1 | loss: 0.5103305
	speed: 0.0318s/iter; left time: 514.0353s
	iters: 2100, epoch: 1 | loss: 0.4349244
	speed: 0.0316s/iter; left time: 508.1133s
	iters: 2200, epoch: 1 | loss: 2.5399499
	speed: 0.0312s/iter; left time: 498.5410s
	iters: 2300, epoch: 1 | loss: 0.7137882
	speed: 0.0312s/iter; left time: 495.3673s
	iters: 2400, epoch: 1 | loss: 0.4622602
	speed: 0.0309s/iter; left time: 487.3236s
	iters: 2500, epoch: 1 | loss: 0.4230271
	speed: 0.0311s/iter; left time: 486.9366s
	iters: 2600, epoch: 1 | loss: 0.4072938
	speed: 0.0313s/iter; left time: 487.8817s
	iters: 2700, epoch: 1 | loss: 0.3154148
	speed: 0.0310s/iter; left time: 479.9346s
	iters: 2800, epoch: 1 | loss: 0.6917767
	speed: 0.0312s/iter; left time: 479.8935s
	iters: 2900, epoch: 1 | loss: 0.3257812
	speed: 0.0304s/iter; left time: 464.6464s
	iters: 3000, epoch: 1 | loss: 0.4649860
	speed: 0.0314s/iter; left time: 476.6296s
	iters: 3100, epoch: 1 | loss: 0.2730294
	speed: 0.0311s/iter; left time: 468.9829s
	iters: 3200, epoch: 1 | loss: 0.3571192
	speed: 0.0312s/iter; left time: 467.1419s
	iters: 3300, epoch: 1 | loss: 0.7339386
	speed: 0.0311s/iter; left time: 462.8078s
	iters: 3400, epoch: 1 | loss: 0.9156075
	speed: 0.0309s/iter; left time: 456.4554s
	iters: 3500, epoch: 1 | loss: 0.3273504
	speed: 0.0337s/iter; left time: 495.2083s
	iters: 3600, epoch: 1 | loss: 0.4052921
	speed: 0.0334s/iter; left time: 487.1827s
	iters: 3700, epoch: 1 | loss: 0.2542196
	speed: 0.0325s/iter; left time: 471.2490s
	iters: 3800, epoch: 1 | loss: 0.3134436
	speed: 0.0327s/iter; left time: 469.8438s
	iters: 3900, epoch: 1 | loss: 0.3888410
	speed: 0.0316s/iter; left time: 451.8853s
	iters: 4000, epoch: 1 | loss: 0.7269841
	speed: 0.0319s/iter; left time: 452.1528s
	iters: 4100, epoch: 1 | loss: 0.4602233
	speed: 0.0319s/iter; left time: 448.5009s
	iters: 4200, epoch: 1 | loss: 0.6201927
	speed: 0.0310s/iter; left time: 432.9990s
	iters: 4300, epoch: 1 | loss: 0.3536441
	speed: 0.0309s/iter; left time: 428.2687s
	iters: 4400, epoch: 1 | loss: 0.4468837
	speed: 0.0305s/iter; left time: 420.0814s
	iters: 4500, epoch: 1 | loss: 0.4938968
	speed: 0.0310s/iter; left time: 424.7801s
	iters: 4600, epoch: 1 | loss: 0.3382545
	speed: 0.0323s/iter; left time: 439.2393s
	iters: 4700, epoch: 1 | loss: 0.4971426
	speed: 0.0310s/iter; left time: 417.8134s
	iters: 4800, epoch: 1 | loss: 0.4222915
	speed: 0.0310s/iter; left time: 414.8176s
	iters: 4900, epoch: 1 | loss: 0.3152176
	speed: 0.0308s/iter; left time: 409.0063s
	iters: 5000, epoch: 1 | loss: 0.3697024
	speed: 0.0306s/iter; left time: 403.9552s
	iters: 5100, epoch: 1 | loss: 0.7174584
	speed: 0.0323s/iter; left time: 423.0166s
	iters: 5200, epoch: 1 | loss: 0.3307083
	speed: 0.0309s/iter; left time: 400.6975s
	iters: 5300, epoch: 1 | loss: 0.5085074
	speed: 0.0311s/iter; left time: 400.3906s
	iters: 5400, epoch: 1 | loss: 0.5153323
	speed: 0.0291s/iter; left time: 371.7358s
	iters: 5500, epoch: 1 | loss: 0.5616807
	speed: 0.0312s/iter; left time: 396.1337s
	iters: 5600, epoch: 1 | loss: 0.3232601
	speed: 0.0311s/iter; left time: 391.0526s
	iters: 5700, epoch: 1 | loss: 0.4633653
	speed: 0.0311s/iter; left time: 388.3941s
	iters: 5800, epoch: 1 | loss: 0.3469598
	speed: 0.0309s/iter; left time: 383.0235s
	iters: 5900, epoch: 1 | loss: 0.3979937
	speed: 0.0314s/iter; left time: 385.3883s
	iters: 6000, epoch: 1 | loss: 0.4588774
	speed: 0.0309s/iter; left time: 376.0451s
	iters: 6100, epoch: 1 | loss: 0.7356085
	speed: 0.0321s/iter; left time: 387.8668s
	iters: 6200, epoch: 1 | loss: 0.4192666
	speed: 0.0332s/iter; left time: 397.6580s
	iters: 6300, epoch: 1 | loss: 0.2570325
	speed: 0.0321s/iter; left time: 380.9658s
	iters: 6400, epoch: 1 | loss: 0.3906559
	speed: 0.0321s/iter; left time: 378.0655s
	iters: 6500, epoch: 1 | loss: 0.1794022
	speed: 0.0348s/iter; left time: 406.3954s
	iters: 6600, epoch: 1 | loss: 0.5000039
	speed: 0.0352s/iter; left time: 407.9461s
	iters: 6700, epoch: 1 | loss: 0.5675623
	speed: 0.0325s/iter; left time: 373.5953s
	iters: 6800, epoch: 1 | loss: 0.2842092
	speed: 0.0320s/iter; left time: 364.6697s
	iters: 6900, epoch: 1 | loss: 0.3462195
	speed: 0.0316s/iter; left time: 355.9718s
	iters: 7000, epoch: 1 | loss: 0.4581933
	speed: 0.0312s/iter; left time: 349.2336s
	iters: 7100, epoch: 1 | loss: 0.3754576
	speed: 0.0313s/iter; left time: 346.8128s
	iters: 7200, epoch: 1 | loss: 0.4414357
	speed: 0.0320s/iter; left time: 351.7905s
	iters: 7300, epoch: 1 | loss: 0.3410416
	speed: 0.0345s/iter; left time: 375.4674s
	iters: 7400, epoch: 1 | loss: 0.5326688
	speed: 0.0330s/iter; left time: 355.4066s
	iters: 7500, epoch: 1 | loss: 0.4139977
	speed: 0.0316s/iter; left time: 337.1767s
	iters: 7600, epoch: 1 | loss: 0.5766042
	speed: 0.0308s/iter; left time: 326.1042s
	iters: 7700, epoch: 1 | loss: 0.2595954
	speed: 0.0302s/iter; left time: 316.2145s
	iters: 7800, epoch: 1 | loss: 0.6318239
	speed: 0.0312s/iter; left time: 323.4325s
	iters: 7900, epoch: 1 | loss: 0.2092866
	speed: 0.0312s/iter; left time: 320.6380s
	iters: 8000, epoch: 1 | loss: 0.8374513
	speed: 0.0309s/iter; left time: 315.0854s
	iters: 8100, epoch: 1 | loss: 0.3345130
	speed: 0.0310s/iter; left time: 312.6747s
	iters: 8200, epoch: 1 | loss: 0.5606088
	speed: 0.0314s/iter; left time: 313.1648s
	iters: 8300, epoch: 1 | loss: 0.3820543
	speed: 0.0314s/iter; left time: 309.8446s
	iters: 8400, epoch: 1 | loss: 0.4109113
	speed: 0.0316s/iter; left time: 309.0254s
	iters: 8500, epoch: 1 | loss: 0.3271763
	speed: 0.0312s/iter; left time: 302.4744s
	iters: 8600, epoch: 1 | loss: 0.4664476
	speed: 0.0311s/iter; left time: 297.8794s
	iters: 8700, epoch: 1 | loss: 2.6390755
	speed: 0.0315s/iter; left time: 298.6732s
	iters: 8800, epoch: 1 | loss: 0.7008291
	speed: 0.0311s/iter; left time: 291.8042s
	iters: 8900, epoch: 1 | loss: 0.4381398
	speed: 0.0313s/iter; left time: 290.1868s
	iters: 9000, epoch: 1 | loss: 0.3449250
	speed: 0.0311s/iter; left time: 285.6597s
Epoch: 1 cost time: 289.0266788005829
Epoch: 1, Steps: 9090 | Train Loss: 0.5793300 Vali Loss: 0.7382725 Test Loss: 0.9276295
Validation loss decreased (inf --> 0.738272).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2692507
	speed: 0.5010s/iter; left time: 4504.3253s
	iters: 200, epoch: 2 | loss: 0.3694722
	speed: 0.0312s/iter; left time: 276.9947s
	iters: 300, epoch: 2 | loss: 0.2392780
	speed: 0.0315s/iter; left time: 277.3486s
	iters: 400, epoch: 2 | loss: 0.6365191
	speed: 0.0314s/iter; left time: 273.1536s
	iters: 500, epoch: 2 | loss: 0.2968890
	speed: 0.0322s/iter; left time: 276.4663s
	iters: 600, epoch: 2 | loss: 0.5077932
	speed: 0.0305s/iter; left time: 258.8149s
	iters: 700, epoch: 2 | loss: 0.3684892
	speed: 0.0307s/iter; left time: 257.2797s
	iters: 800, epoch: 2 | loss: 0.4454790
	speed: 0.0314s/iter; left time: 260.5345s
	iters: 900, epoch: 2 | loss: 0.2415849
	speed: 0.0305s/iter; left time: 249.8446s
	iters: 1000, epoch: 2 | loss: 0.4835658
	speed: 0.0312s/iter; left time: 252.6864s
	iters: 1100, epoch: 2 | loss: 0.4763816
	speed: 0.0316s/iter; left time: 252.8593s
	iters: 1200, epoch: 2 | loss: 0.2942060
	speed: 0.0317s/iter; left time: 249.8202s
	iters: 1300, epoch: 2 | loss: 0.2832956
	speed: 0.0310s/iter; left time: 241.7637s
	iters: 1400, epoch: 2 | loss: 0.2855826
	speed: 0.0328s/iter; left time: 252.2549s
	iters: 1500, epoch: 2 | loss: 0.3839743
	speed: 0.0320s/iter; left time: 243.0718s
	iters: 1600, epoch: 2 | loss: 0.3359263
	speed: 0.0316s/iter; left time: 236.6007s
	iters: 1700, epoch: 2 | loss: 0.2637049
	speed: 0.0334s/iter; left time: 246.4927s
	iters: 1800, epoch: 2 | loss: 0.2001797
	speed: 0.0319s/iter; left time: 232.7796s
	iters: 1900, epoch: 2 | loss: 0.2589360
	speed: 0.0309s/iter; left time: 222.3050s
	iters: 2000, epoch: 2 | loss: 0.3448299
	speed: 0.0311s/iter; left time: 220.2449s
	iters: 2100, epoch: 2 | loss: 0.2735042
	speed: 0.0320s/iter; left time: 223.7675s
	iters: 2200, epoch: 2 | loss: 0.6005387
	speed: 0.0340s/iter; left time: 234.2503s
	iters: 2300, epoch: 2 | loss: 0.2560612
	speed: 0.0334s/iter; left time: 226.6335s
	iters: 2400, epoch: 2 | loss: 0.4683895
	speed: 0.0308s/iter; left time: 205.8250s
	iters: 2500, epoch: 2 | loss: 0.3412043
	speed: 0.0312s/iter; left time: 205.6428s
	iters: 2600, epoch: 2 | loss: 2.4867411
	speed: 0.0311s/iter; left time: 201.9958s
	iters: 2700, epoch: 2 | loss: 0.4868432
	speed: 0.0325s/iter; left time: 207.9955s
	iters: 2800, epoch: 2 | loss: 0.2918213
	speed: 0.0311s/iter; left time: 195.8179s
	iters: 2900, epoch: 2 | loss: 0.3075600
	speed: 0.0313s/iter; left time: 193.7277s
	iters: 3000, epoch: 2 | loss: 0.2830508
	speed: 0.0310s/iter; left time: 189.1190s
	iters: 3100, epoch: 2 | loss: 0.7566786
	speed: 0.0306s/iter; left time: 183.4570s
	iters: 3200, epoch: 2 | loss: 0.2996919
	speed: 0.0311s/iter; left time: 183.5034s
	iters: 3300, epoch: 2 | loss: 0.2355166
	speed: 0.0314s/iter; left time: 181.8192s
	iters: 3400, epoch: 2 | loss: 0.3852967
	speed: 0.0327s/iter; left time: 185.8575s
	iters: 3500, epoch: 2 | loss: 0.3834229
	speed: 0.0330s/iter; left time: 184.4446s
	iters: 3600, epoch: 2 | loss: 0.1508674
	speed: 0.0337s/iter; left time: 185.1336s
	iters: 3700, epoch: 2 | loss: 0.3370927
	speed: 0.0313s/iter; left time: 168.8980s
	iters: 3800, epoch: 2 | loss: 0.3222239
	speed: 0.0309s/iter; left time: 163.2424s
	iters: 3900, epoch: 2 | loss: 0.2750183
	speed: 0.0307s/iter; left time: 159.3358s
	iters: 4000, epoch: 2 | loss: 0.1959489
	speed: 0.0335s/iter; left time: 170.4570s
	iters: 4100, epoch: 2 | loss: 0.2830584
	speed: 0.0331s/iter; left time: 164.9638s
	iters: 4200, epoch: 2 | loss: 0.2179719
	speed: 0.0306s/iter; left time: 149.4860s
	iters: 4300, epoch: 2 | loss: 0.2663872
	speed: 0.0308s/iter; left time: 147.4286s
	iters: 4400, epoch: 2 | loss: 0.3771285
	speed: 0.0308s/iter; left time: 144.5371s
	iters: 4500, epoch: 2 | loss: 0.3222961
	speed: 0.0311s/iter; left time: 142.9662s
	iters: 4600, epoch: 2 | loss: 0.2105203
	speed: 0.0314s/iter; left time: 140.9303s
	iters: 4700, epoch: 2 | loss: 0.2693761
	speed: 0.0313s/iter; left time: 137.2657s
	iters: 4800, epoch: 2 | loss: 0.4258530
	speed: 0.0341s/iter; left time: 146.4600s
	iters: 4900, epoch: 2 | loss: 0.2583188
	speed: 0.0339s/iter; left time: 141.9411s
	iters: 5000, epoch: 2 | loss: 0.7127413
	speed: 0.0324s/iter; left time: 132.7075s
	iters: 5100, epoch: 2 | loss: 0.2978713
	speed: 0.0310s/iter; left time: 123.9198s
	iters: 5200, epoch: 2 | loss: 0.6560149
	speed: 0.0314s/iter; left time: 122.1417s
	iters: 5300, epoch: 2 | loss: 0.3061233
	speed: 0.0312s/iter; left time: 118.4196s
	iters: 5400, epoch: 2 | loss: 0.2207730
	speed: 0.0322s/iter; left time: 118.8418s
	iters: 5500, epoch: 2 | loss: 0.2995969
	speed: 0.0313s/iter; left time: 112.4704s
	iters: 5600, epoch: 2 | loss: 0.1970204
	speed: 0.0319s/iter; left time: 111.4213s
	iters: 5700, epoch: 2 | loss: 0.3354554
	speed: 0.0318s/iter; left time: 107.9256s
	iters: 5800, epoch: 2 | loss: 0.3205453
	speed: 0.0312s/iter; left time: 102.7702s
	iters: 5900, epoch: 2 | loss: 0.2223125
	speed: 0.0336s/iter; left time: 107.3542s
	iters: 6000, epoch: 2 | loss: 1.1082581
	speed: 0.0340s/iter; left time: 105.2190s
	iters: 6100, epoch: 2 | loss: 0.3578962
	speed: 0.0333s/iter; left time: 99.4940s
	iters: 6200, epoch: 2 | loss: 0.2654137
	speed: 0.0340s/iter; left time: 98.3048s
	iters: 6300, epoch: 2 | loss: 0.2219096
	speed: 0.0319s/iter; left time: 89.1393s
	iters: 6400, epoch: 2 | loss: 0.1993709
	speed: 0.0306s/iter; left time: 82.3300s
	iters: 6500, epoch: 2 | loss: 0.2908674
	speed: 0.0314s/iter; left time: 81.4433s
	iters: 6600, epoch: 2 | loss: 0.3254807
	speed: 0.0312s/iter; left time: 77.7013s
	iters: 6700, epoch: 2 | loss: 0.3108024
	speed: 0.0312s/iter; left time: 74.4818s
	iters: 6800, epoch: 2 | loss: 0.2380010
	speed: 0.0311s/iter; left time: 71.3394s
	iters: 6900, epoch: 2 | loss: 0.3268037
	speed: 0.0333s/iter; left time: 72.8974s
	iters: 7000, epoch: 2 | loss: 0.2431409
	speed: 0.0313s/iter; left time: 65.4876s
	iters: 7100, epoch: 2 | loss: 0.2485267
	speed: 0.0314s/iter; left time: 62.5405s
	iters: 7200, epoch: 2 | loss: 1.7628407
	speed: 0.0311s/iter; left time: 58.7949s
	iters: 7300, epoch: 2 | loss: 0.3229785
	speed: 0.0311s/iter; left time: 55.6292s
	iters: 7400, epoch: 2 | loss: 0.1902569
	speed: 0.0312s/iter; left time: 52.7279s
	iters: 7500, epoch: 2 | loss: 0.2111765
	speed: 0.0314s/iter; left time: 50.0293s
	iters: 7600, epoch: 2 | loss: 0.2793711
	speed: 0.0313s/iter; left time: 46.5970s
	iters: 7700, epoch: 2 | loss: 0.2741974
	speed: 0.0314s/iter; left time: 43.6710s
	iters: 7800, epoch: 2 | loss: 0.3677225
	speed: 0.0312s/iter; left time: 40.3369s
	iters: 7900, epoch: 2 | loss: 0.2893354
	speed: 0.0343s/iter; left time: 40.8653s
	iters: 8000, epoch: 2 | loss: 0.1839106
	speed: 0.0327s/iter; left time: 35.6547s
	iters: 8100, epoch: 2 | loss: 0.1877489
	speed: 0.0324s/iter; left time: 32.0986s
	iters: 8200, epoch: 2 | loss: 0.2910192
	speed: 0.0319s/iter; left time: 28.4512s
	iters: 8300, epoch: 2 | loss: 0.4884237
	speed: 0.0308s/iter; left time: 24.3848s
	iters: 8400, epoch: 2 | loss: 0.2375523
	speed: 0.0313s/iter; left time: 21.6262s
	iters: 8500, epoch: 2 | loss: 0.1529685
	speed: 0.0339s/iter; left time: 20.0481s
	iters: 8600, epoch: 2 | loss: 0.2968906
	speed: 0.0302s/iter; left time: 14.8297s
	iters: 8700, epoch: 2 | loss: 0.1621742
	speed: 0.0309s/iter; left time: 12.0672s
	iters: 8800, epoch: 2 | loss: 0.2582574
	speed: 0.0307s/iter; left time: 8.9282s
	iters: 8900, epoch: 2 | loss: 0.1848817
	speed: 0.0308s/iter; left time: 5.8912s
	iters: 9000, epoch: 2 | loss: 0.1766562
	speed: 0.0311s/iter; left time: 2.8341s
Epoch: 2 cost time: 290.9669280052185
Epoch: 2, Steps: 9090 | Train Loss: 0.4166439 Vali Loss: 0.7451097 Test Loss: 0.7333785
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_336_Informer_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.9276799559593201, mae:0.7172900438308716, rse:1.2649827003479004
