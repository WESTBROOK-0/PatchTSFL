Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_336_Informer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7029341
	speed: 0.0540s/iter; left time: 973.0384s
	iters: 200, epoch: 1 | loss: 0.5630726
	speed: 0.0330s/iter; left time: 591.6006s
	iters: 300, epoch: 1 | loss: 0.5449886
	speed: 0.0319s/iter; left time: 567.5627s
	iters: 400, epoch: 1 | loss: 0.9152390
	speed: 0.0315s/iter; left time: 558.1023s
	iters: 500, epoch: 1 | loss: 0.7629957
	speed: 0.0317s/iter; left time: 557.8330s
	iters: 600, epoch: 1 | loss: 0.5187846
	speed: 0.0319s/iter; left time: 558.8363s
	iters: 700, epoch: 1 | loss: 0.4631455
	speed: 0.0317s/iter; left time: 551.0035s
	iters: 800, epoch: 1 | loss: 0.4434341
	speed: 0.0332s/iter; left time: 574.3370s
	iters: 900, epoch: 1 | loss: 0.4772914
	speed: 0.0327s/iter; left time: 562.8077s
	iters: 1000, epoch: 1 | loss: 0.6240943
	speed: 0.0331s/iter; left time: 565.9263s
	iters: 1100, epoch: 1 | loss: 0.4325696
	speed: 0.0315s/iter; left time: 536.2310s
	iters: 1200, epoch: 1 | loss: 0.5810493
	speed: 0.0312s/iter; left time: 528.2656s
	iters: 1300, epoch: 1 | loss: 1.0330641
	speed: 0.0312s/iter; left time: 524.0609s
	iters: 1400, epoch: 1 | loss: 0.5510169
	speed: 0.0317s/iter; left time: 528.9073s
	iters: 1500, epoch: 1 | loss: 0.4900617
	speed: 0.0331s/iter; left time: 550.2653s
	iters: 1600, epoch: 1 | loss: 0.5422410
	speed: 0.0315s/iter; left time: 519.8516s
	iters: 1700, epoch: 1 | loss: 1.0956237
	speed: 0.0322s/iter; left time: 527.8208s
	iters: 1800, epoch: 1 | loss: 0.4227640
	speed: 0.0316s/iter; left time: 515.0297s
	iters: 1900, epoch: 1 | loss: 0.3555561
	speed: 0.0317s/iter; left time: 513.9895s
	iters: 2000, epoch: 1 | loss: 0.4483421
	speed: 0.0319s/iter; left time: 513.9055s
	iters: 2100, epoch: 1 | loss: 0.5397900
	speed: 0.0317s/iter; left time: 506.8741s
	iters: 2200, epoch: 1 | loss: 0.3981574
	speed: 0.0319s/iter; left time: 508.1716s
	iters: 2300, epoch: 1 | loss: 0.6161576
	speed: 0.0320s/iter; left time: 505.9710s
	iters: 2400, epoch: 1 | loss: 0.4653783
	speed: 0.0324s/iter; left time: 508.8716s
	iters: 2500, epoch: 1 | loss: 0.4650967
	speed: 0.0331s/iter; left time: 516.2843s
	iters: 2600, epoch: 1 | loss: 0.7262369
	speed: 0.0323s/iter; left time: 501.4901s
	iters: 2700, epoch: 1 | loss: 0.4516368
	speed: 0.0325s/iter; left time: 500.8956s
	iters: 2800, epoch: 1 | loss: 0.3941556
	speed: 0.0333s/iter; left time: 509.9946s
	iters: 2900, epoch: 1 | loss: 0.4235232
	speed: 0.0318s/iter; left time: 483.7394s
	iters: 3000, epoch: 1 | loss: 0.3552392
	speed: 0.0316s/iter; left time: 477.2009s
	iters: 3100, epoch: 1 | loss: 0.7885089
	speed: 0.0333s/iter; left time: 499.5163s
	iters: 3200, epoch: 1 | loss: 0.3375933
	speed: 0.0348s/iter; left time: 518.3001s
	iters: 3300, epoch: 1 | loss: 0.3316484
	speed: 0.0327s/iter; left time: 484.0380s
	iters: 3400, epoch: 1 | loss: 0.3518999
	speed: 0.0324s/iter; left time: 476.7841s
	iters: 3500, epoch: 1 | loss: 0.5253008
	speed: 0.0318s/iter; left time: 464.9376s
	iters: 3600, epoch: 1 | loss: 0.4832121
	speed: 0.0318s/iter; left time: 461.1972s
	iters: 3700, epoch: 1 | loss: 2.5872374
	speed: 0.0318s/iter; left time: 458.3830s
	iters: 3800, epoch: 1 | loss: 0.4330571
	speed: 0.0318s/iter; left time: 455.2487s
	iters: 3900, epoch: 1 | loss: 0.6908122
	speed: 0.0325s/iter; left time: 461.4267s
	iters: 4000, epoch: 1 | loss: 0.5450018
	speed: 0.0322s/iter; left time: 454.1432s
	iters: 4100, epoch: 1 | loss: 2.7480078
	speed: 0.0318s/iter; left time: 445.2640s
	iters: 4200, epoch: 1 | loss: 0.3382248
	speed: 0.0317s/iter; left time: 441.3466s
	iters: 4300, epoch: 1 | loss: 0.4413869
	speed: 0.0314s/iter; left time: 433.2974s
	iters: 4400, epoch: 1 | loss: 0.4305263
	speed: 0.0320s/iter; left time: 438.9093s
	iters: 4500, epoch: 1 | loss: 0.4448468
	speed: 0.0315s/iter; left time: 429.2353s
	iters: 4600, epoch: 1 | loss: 0.2706819
	speed: 0.0320s/iter; left time: 431.9346s
	iters: 4700, epoch: 1 | loss: 0.9153617
	speed: 0.0331s/iter; left time: 443.8806s
	iters: 4800, epoch: 1 | loss: 2.4588542
	speed: 0.0321s/iter; left time: 426.7092s
	iters: 4900, epoch: 1 | loss: 0.3510961
	speed: 0.0335s/iter; left time: 442.2800s
	iters: 5000, epoch: 1 | loss: 0.4090069
	speed: 0.0338s/iter; left time: 443.1518s
	iters: 5100, epoch: 1 | loss: 0.4409263
	speed: 0.0315s/iter; left time: 409.6056s
	iters: 5200, epoch: 1 | loss: 0.7970030
	speed: 0.0319s/iter; left time: 411.6246s
	iters: 5300, epoch: 1 | loss: 0.4445578
	speed: 0.0320s/iter; left time: 409.8478s
	iters: 5400, epoch: 1 | loss: 0.3792365
	speed: 0.0321s/iter; left time: 407.7854s
	iters: 5500, epoch: 1 | loss: 0.5293152
	speed: 0.0327s/iter; left time: 411.8597s
	iters: 5600, epoch: 1 | loss: 0.3498499
	speed: 0.0337s/iter; left time: 421.1898s
	iters: 5700, epoch: 1 | loss: 0.3554895
	speed: 0.0324s/iter; left time: 402.3059s
	iters: 5800, epoch: 1 | loss: 0.4253604
	speed: 0.0327s/iter; left time: 401.9157s
	iters: 5900, epoch: 1 | loss: 0.4781290
	speed: 0.0320s/iter; left time: 390.7467s
	iters: 6000, epoch: 1 | loss: 0.4578242
	speed: 0.0329s/iter; left time: 398.8499s
	iters: 6100, epoch: 1 | loss: 0.3183882
	speed: 0.0331s/iter; left time: 397.4612s
	iters: 6200, epoch: 1 | loss: 0.4933355
	speed: 0.0318s/iter; left time: 378.8929s
	iters: 6300, epoch: 1 | loss: 0.2932723
	speed: 0.0314s/iter; left time: 371.1745s
	iters: 6400, epoch: 1 | loss: 0.4685084
	speed: 0.0325s/iter; left time: 380.3282s
	iters: 6500, epoch: 1 | loss: 0.5355019
	speed: 0.0330s/iter; left time: 383.5174s
	iters: 6600, epoch: 1 | loss: 0.5405024
	speed: 0.0342s/iter; left time: 394.0268s
	iters: 6700, epoch: 1 | loss: 0.3633617
	speed: 0.0336s/iter; left time: 383.9119s
	iters: 6800, epoch: 1 | loss: 0.4265317
	speed: 0.0315s/iter; left time: 355.8077s
	iters: 6900, epoch: 1 | loss: 0.3773478
	speed: 0.0316s/iter; left time: 353.7035s
	iters: 7000, epoch: 1 | loss: 0.2911046
	speed: 0.0314s/iter; left time: 349.0307s
	iters: 7100, epoch: 1 | loss: 0.3808177
	speed: 0.0316s/iter; left time: 347.5462s
	iters: 7200, epoch: 1 | loss: 0.4964930
	speed: 0.0315s/iter; left time: 343.8734s
	iters: 7300, epoch: 1 | loss: 0.3622783
	speed: 0.0321s/iter; left time: 346.7196s
	iters: 7400, epoch: 1 | loss: 0.2846815
	speed: 0.0317s/iter; left time: 339.4361s
	iters: 7500, epoch: 1 | loss: 0.3295549
	speed: 0.0318s/iter; left time: 337.3969s
	iters: 7600, epoch: 1 | loss: 0.2804209
	speed: 0.0320s/iter; left time: 336.3901s
	iters: 7700, epoch: 1 | loss: 0.5580863
	speed: 0.0318s/iter; left time: 331.3765s
	iters: 7800, epoch: 1 | loss: 0.4945504
	speed: 0.0315s/iter; left time: 324.4115s
	iters: 7900, epoch: 1 | loss: 0.3657334
	speed: 0.0318s/iter; left time: 324.9239s
	iters: 8000, epoch: 1 | loss: 0.3839401
	speed: 0.0323s/iter; left time: 326.2080s
	iters: 8100, epoch: 1 | loss: 0.3757253
	speed: 0.0317s/iter; left time: 317.5118s
	iters: 8200, epoch: 1 | loss: 0.3724302
	speed: 0.0315s/iter; left time: 312.3604s
	iters: 8300, epoch: 1 | loss: 0.6869648
	speed: 0.0318s/iter; left time: 312.3956s
	iters: 8400, epoch: 1 | loss: 0.7368693
	speed: 0.0320s/iter; left time: 310.8865s
	iters: 8500, epoch: 1 | loss: 0.5740535
	speed: 0.0324s/iter; left time: 310.9070s
	iters: 8600, epoch: 1 | loss: 0.7759086
	speed: 0.0323s/iter; left time: 307.2534s
	iters: 8700, epoch: 1 | loss: 0.3628019
	speed: 0.0328s/iter; left time: 308.3293s
	iters: 8800, epoch: 1 | loss: 0.2762813
	speed: 0.0321s/iter; left time: 298.5684s
	iters: 8900, epoch: 1 | loss: 0.6940392
	speed: 0.0322s/iter; left time: 296.1910s
	iters: 9000, epoch: 1 | loss: 0.4051553
	speed: 0.0321s/iter; left time: 292.2812s
Epoch: 1 cost time: 293.851056098938
Epoch: 1, Steps: 9054 | Train Loss: 0.5809989 Vali Loss: 0.6606511 Test Loss: 0.6029927
Validation loss decreased (inf --> 0.660651).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7635012
	speed: 0.4780s/iter; left time: 4280.7278s
	iters: 200, epoch: 2 | loss: 0.2050965
	speed: 0.0330s/iter; left time: 292.6417s
	iters: 300, epoch: 2 | loss: 0.8042002
	speed: 0.0318s/iter; left time: 278.7194s
	iters: 400, epoch: 2 | loss: 0.4373579
	speed: 0.0320s/iter; left time: 276.6035s
	iters: 500, epoch: 2 | loss: 0.3194321
	speed: 0.0316s/iter; left time: 269.9965s
	iters: 600, epoch: 2 | loss: 0.7257210
	speed: 0.0330s/iter; left time: 278.9759s
	iters: 700, epoch: 2 | loss: 0.3047657
	speed: 0.0315s/iter; left time: 262.9136s
	iters: 800, epoch: 2 | loss: 0.3505324
	speed: 0.0312s/iter; left time: 257.2429s
	iters: 900, epoch: 2 | loss: 0.4362715
	speed: 0.0356s/iter; left time: 290.1989s
	iters: 1000, epoch: 2 | loss: 0.3723679
	speed: 0.0346s/iter; left time: 278.6443s
	iters: 1100, epoch: 2 | loss: 0.3032638
	speed: 0.0321s/iter; left time: 255.3717s
	iters: 1200, epoch: 2 | loss: 2.4918318
	speed: 0.0323s/iter; left time: 253.6909s
	iters: 1300, epoch: 2 | loss: 0.2314766
	speed: 0.0321s/iter; left time: 248.6573s
	iters: 1400, epoch: 2 | loss: 0.2964394
	speed: 0.0320s/iter; left time: 244.6990s
	iters: 1500, epoch: 2 | loss: 0.2177978
	speed: 0.0316s/iter; left time: 238.8563s
	iters: 1600, epoch: 2 | loss: 0.3543783
	speed: 0.0315s/iter; left time: 234.8192s
	iters: 1700, epoch: 2 | loss: 0.3091218
	speed: 0.0325s/iter; left time: 239.1284s
	iters: 1800, epoch: 2 | loss: 0.2443292
	speed: 0.0318s/iter; left time: 231.0506s
	iters: 1900, epoch: 2 | loss: 0.2125261
	speed: 0.0319s/iter; left time: 228.3246s
	iters: 2000, epoch: 2 | loss: 0.6314210
	speed: 0.0318s/iter; left time: 224.0700s
	iters: 2100, epoch: 2 | loss: 0.7528265
	speed: 0.0317s/iter; left time: 220.1553s
	iters: 2200, epoch: 2 | loss: 0.2546193
	speed: 0.0320s/iter; left time: 219.6116s
	iters: 2300, epoch: 2 | loss: 0.4105566
	speed: 0.0320s/iter; left time: 216.2534s
	iters: 2400, epoch: 2 | loss: 0.3034399
	speed: 0.0318s/iter; left time: 211.6199s
	iters: 2500, epoch: 2 | loss: 0.4430762
	speed: 0.0318s/iter; left time: 208.4699s
	iters: 2600, epoch: 2 | loss: 0.3094913
	speed: 0.0315s/iter; left time: 203.4470s
	iters: 2700, epoch: 2 | loss: 0.1934782
	speed: 0.0319s/iter; left time: 202.7684s
	iters: 2800, epoch: 2 | loss: 0.2791385
	speed: 0.0303s/iter; left time: 189.3190s
	iters: 2900, epoch: 2 | loss: 0.6142989
	speed: 0.0308s/iter; left time: 189.8584s
	iters: 3000, epoch: 2 | loss: 0.3207975
	speed: 0.0310s/iter; left time: 187.9425s
	iters: 3100, epoch: 2 | loss: 0.6991119
	speed: 0.0339s/iter; left time: 201.6749s
	iters: 3200, epoch: 2 | loss: 0.5407313
	speed: 0.0318s/iter; left time: 186.1799s
	iters: 3300, epoch: 2 | loss: 0.4395743
	speed: 0.0313s/iter; left time: 180.3671s
	iters: 3400, epoch: 2 | loss: 0.2832906
	speed: 0.0315s/iter; left time: 178.3539s
	iters: 3500, epoch: 2 | loss: 0.8858131
	speed: 0.0318s/iter; left time: 176.6375s
	iters: 3600, epoch: 2 | loss: 0.4600727
	speed: 0.0320s/iter; left time: 174.6583s
	iters: 3700, epoch: 2 | loss: 0.2759269
	speed: 0.0320s/iter; left time: 171.4243s
	iters: 3800, epoch: 2 | loss: 0.3516137
	speed: 0.0316s/iter; left time: 165.8263s
	iters: 3900, epoch: 2 | loss: 0.2163833
	speed: 0.0326s/iter; left time: 168.0582s
	iters: 4000, epoch: 2 | loss: 1.1378680
	speed: 0.0343s/iter; left time: 173.3074s
	iters: 4100, epoch: 2 | loss: 0.2710957
	speed: 0.0322s/iter; left time: 159.6966s
	iters: 4200, epoch: 2 | loss: 0.4017186
	speed: 0.0315s/iter; left time: 152.7698s
	iters: 4300, epoch: 2 | loss: 0.3469774
	speed: 0.0329s/iter; left time: 156.2391s
	iters: 4400, epoch: 2 | loss: 0.3836894
	speed: 0.0310s/iter; left time: 144.1940s
	iters: 4500, epoch: 2 | loss: 0.2555189
	speed: 0.0318s/iter; left time: 144.7205s
	iters: 4600, epoch: 2 | loss: 0.3533118
	speed: 0.0321s/iter; left time: 142.9768s
	iters: 4700, epoch: 2 | loss: 0.3378918
	speed: 0.0335s/iter; left time: 145.7629s
	iters: 4800, epoch: 2 | loss: 0.3677655
	speed: 0.0342s/iter; left time: 145.5115s
	iters: 4900, epoch: 2 | loss: 0.2261828
	speed: 0.0326s/iter; left time: 135.5007s
	iters: 5000, epoch: 2 | loss: 0.2862363
	speed: 0.0337s/iter; left time: 136.7778s
	iters: 5100, epoch: 2 | loss: 0.5247355
	speed: 0.0332s/iter; left time: 131.1432s
	iters: 5200, epoch: 2 | loss: 0.1731234
	speed: 0.0321s/iter; left time: 123.8146s
	iters: 5300, epoch: 2 | loss: 0.2273449
	speed: 0.0323s/iter; left time: 121.2327s
	iters: 5400, epoch: 2 | loss: 0.2319110
	speed: 0.0315s/iter; left time: 115.0501s
	iters: 5500, epoch: 2 | loss: 0.2069506
	speed: 0.0317s/iter; left time: 112.8582s
	iters: 5600, epoch: 2 | loss: 0.1660846
	speed: 0.0316s/iter; left time: 109.3313s
	iters: 5700, epoch: 2 | loss: 0.1989408
	speed: 0.0324s/iter; left time: 108.6247s
	iters: 5800, epoch: 2 | loss: 0.2652151
	speed: 0.0325s/iter; left time: 105.8496s
	iters: 5900, epoch: 2 | loss: 0.4264894
	speed: 0.0324s/iter; left time: 102.2141s
	iters: 6000, epoch: 2 | loss: 0.3649189
	speed: 0.0310s/iter; left time: 94.6212s
	iters: 6100, epoch: 2 | loss: 0.2575676
	speed: 0.0322s/iter; left time: 95.1662s
	iters: 6200, epoch: 2 | loss: 0.3265989
	speed: 0.0322s/iter; left time: 91.8389s
	iters: 6300, epoch: 2 | loss: 0.3097661
	speed: 0.0308s/iter; left time: 84.9550s
	iters: 6400, epoch: 2 | loss: 0.2107225
	speed: 0.0330s/iter; left time: 87.7217s
	iters: 6500, epoch: 2 | loss: 0.1996479
	speed: 0.0339s/iter; left time: 86.6150s
	iters: 6600, epoch: 2 | loss: 0.3529843
	speed: 0.0331s/iter; left time: 81.2329s
	iters: 6700, epoch: 2 | loss: 0.6133153
	speed: 0.0325s/iter; left time: 76.5300s
	iters: 6800, epoch: 2 | loss: 0.2650532
	speed: 0.0341s/iter; left time: 76.9072s
	iters: 6900, epoch: 2 | loss: 0.7205437
	speed: 0.0352s/iter; left time: 75.8852s
	iters: 7000, epoch: 2 | loss: 0.7064439
	speed: 0.0330s/iter; left time: 67.8710s
	iters: 7100, epoch: 2 | loss: 0.3693619
	speed: 0.0319s/iter; left time: 62.4609s
	iters: 7200, epoch: 2 | loss: 0.3562970
	speed: 0.0315s/iter; left time: 58.3626s
	iters: 7300, epoch: 2 | loss: 0.1774478
	speed: 0.0315s/iter; left time: 55.2849s
	iters: 7400, epoch: 2 | loss: 0.1988622
	speed: 0.0313s/iter; left time: 51.8653s
	iters: 7500, epoch: 2 | loss: 0.2539546
	speed: 0.0313s/iter; left time: 48.6786s
	iters: 7600, epoch: 2 | loss: 0.2582123
	speed: 0.0318s/iter; left time: 46.2418s
	iters: 7700, epoch: 2 | loss: 0.2565300
	speed: 0.0318s/iter; left time: 43.1400s
	iters: 7800, epoch: 2 | loss: 0.2469441
	speed: 0.0321s/iter; left time: 40.2476s
	iters: 7900, epoch: 2 | loss: 0.2342902
	speed: 0.0316s/iter; left time: 36.5101s
	iters: 8000, epoch: 2 | loss: 0.2986829
	speed: 0.0319s/iter; left time: 33.6865s
	iters: 8100, epoch: 2 | loss: 0.2131670
	speed: 0.0329s/iter; left time: 31.4192s
	iters: 8200, epoch: 2 | loss: 0.1685577
	speed: 0.0324s/iter; left time: 27.7418s
	iters: 8300, epoch: 2 | loss: 0.3192235
	speed: 0.0336s/iter; left time: 25.3456s
	iters: 8400, epoch: 2 | loss: 0.3000263
	speed: 0.0337s/iter; left time: 22.0992s
	iters: 8500, epoch: 2 | loss: 0.2368967
	speed: 0.0357s/iter; left time: 19.8173s
	iters: 8600, epoch: 2 | loss: 1.9135121
	speed: 0.0333s/iter; left time: 15.1334s
	iters: 8700, epoch: 2 | loss: 0.2230635
	speed: 0.0325s/iter; left time: 11.5361s
	iters: 8800, epoch: 2 | loss: 0.1940639
	speed: 0.0325s/iter; left time: 8.2841s
	iters: 8900, epoch: 2 | loss: 0.1647317
	speed: 0.0347s/iter; left time: 5.3862s
	iters: 9000, epoch: 2 | loss: 0.2529002
	speed: 0.0331s/iter; left time: 1.8194s
Epoch: 2 cost time: 295.24375462532043
Epoch: 2, Steps: 9054 | Train Loss: 0.4041833 Vali Loss: 0.6692140 Test Loss: 0.5979959
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_336_Informer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.6029325127601624, mae:0.5660027861595154, rse:1.0198113918304443
