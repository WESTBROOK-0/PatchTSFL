Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_192', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_192_PatchTSFL_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3806697
	speed: 0.0136s/iter; left time: 358.0040s
	iters: 200, epoch: 1 | loss: 0.5434795
	speed: 0.0069s/iter; left time: 180.6065s
Epoch: 1 cost time: 2.6025803089141846
Epoch: 1, Steps: 265 | Train Loss: 0.4428968 Vali Loss: 0.2303777 Test Loss: 0.3058690
Validation loss decreased (inf --> 0.230378).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3752089
	speed: 0.0478s/iter; left time: 1248.7255s
	iters: 200, epoch: 2 | loss: 0.4972025
	speed: 0.0067s/iter; left time: 174.5167s
Epoch: 2 cost time: 2.5424396991729736
Epoch: 2, Steps: 265 | Train Loss: 0.4430452 Vali Loss: 0.2305152 Test Loss: 0.3058636
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.5544478
	speed: 0.0453s/iter; left time: 1171.3999s
	iters: 200, epoch: 3 | loss: 0.4598564
	speed: 0.0067s/iter; left time: 173.4644s
Epoch: 3 cost time: 2.604778528213501
Epoch: 3, Steps: 265 | Train Loss: 0.4432386 Vali Loss: 0.2304962 Test Loss: 0.3058577
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.5225478
	speed: 0.0490s/iter; left time: 1253.7783s
	iters: 200, epoch: 4 | loss: 0.4236946
	speed: 0.0069s/iter; left time: 176.7260s
Epoch: 4 cost time: 2.770134687423706
Epoch: 4, Steps: 265 | Train Loss: 0.4439677 Vali Loss: 0.2305427 Test Loss: 0.3058516
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.4864004
	speed: 0.0500s/iter; left time: 1266.2479s
	iters: 200, epoch: 5 | loss: 0.3789116
	speed: 0.0070s/iter; left time: 176.2853s
Epoch: 5 cost time: 2.684002637863159
Epoch: 5, Steps: 265 | Train Loss: 0.4431246 Vali Loss: 0.2304114 Test Loss: 0.3058430
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.6185319
	speed: 0.0476s/iter; left time: 1192.3987s
	iters: 200, epoch: 6 | loss: 0.4963146
	speed: 0.0067s/iter; left time: 167.9317s
Epoch: 6 cost time: 2.628587007522583
Epoch: 6, Steps: 265 | Train Loss: 0.4436996 Vali Loss: 0.2305062 Test Loss: 0.3058333
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.3678466
	speed: 0.0474s/iter; left time: 1175.3777s
	iters: 200, epoch: 7 | loss: 0.7507837
	speed: 0.0070s/iter; left time: 173.5934s
Epoch: 7 cost time: 2.6377902030944824
Epoch: 7, Steps: 265 | Train Loss: 0.4437953 Vali Loss: 0.2305316 Test Loss: 0.3058211
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.5617508
	speed: 0.0501s/iter; left time: 1230.5898s
	iters: 200, epoch: 8 | loss: 0.3185551
	speed: 0.0071s/iter; left time: 172.4346s
Epoch: 8 cost time: 2.7157931327819824
Epoch: 8, Steps: 265 | Train Loss: 0.4440281 Vali Loss: 0.2305065 Test Loss: 0.3058091
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.4713652
	speed: 0.0486s/iter; left time: 1181.0509s
	iters: 200, epoch: 9 | loss: 0.7092931
	speed: 0.0068s/iter; left time: 165.5513s
Epoch: 9 cost time: 2.674943208694458
Epoch: 9, Steps: 265 | Train Loss: 0.4440396 Vali Loss: 0.2305361 Test Loss: 0.3057939
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.4303619
	speed: 0.0491s/iter; left time: 1178.8761s
	iters: 200, epoch: 10 | loss: 0.5774267
	speed: 0.0069s/iter; left time: 164.0401s
Epoch: 10 cost time: 2.6884050369262695
Epoch: 10, Steps: 265 | Train Loss: 0.4439516 Vali Loss: 0.2305085 Test Loss: 0.3057773
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.5160091
	speed: 0.0479s/iter; left time: 1137.8824s
	iters: 200, epoch: 11 | loss: 0.4128590
	speed: 0.0070s/iter; left time: 165.6301s
Epoch: 11 cost time: 2.6684482097625732
Epoch: 11, Steps: 265 | Train Loss: 0.4426594 Vali Loss: 0.2306851 Test Loss: 0.3057589
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3348156
	speed: 0.0504s/iter; left time: 1182.8369s
	iters: 200, epoch: 12 | loss: 0.5604706
	speed: 0.0071s/iter; left time: 165.1209s
Epoch: 12 cost time: 2.7391421794891357
Epoch: 12, Steps: 265 | Train Loss: 0.4438144 Vali Loss: 0.2307754 Test Loss: 0.3057366
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.5015072
	speed: 0.0500s/iter; left time: 1161.0632s
	iters: 200, epoch: 13 | loss: 0.3366946
	speed: 0.0069s/iter; left time: 158.5439s
Epoch: 13 cost time: 2.601670503616333
Epoch: 13, Steps: 265 | Train Loss: 0.4435401 Vali Loss: 0.2308864 Test Loss: 0.3057125
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.5457639
	speed: 0.0488s/iter; left time: 1120.7342s
	iters: 200, epoch: 14 | loss: 0.3734328
	speed: 0.0069s/iter; left time: 157.6734s
Epoch: 14 cost time: 2.633469581604004
Epoch: 14, Steps: 265 | Train Loss: 0.4432447 Vali Loss: 0.2307869 Test Loss: 0.3056906
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.3404403
	speed: 0.0470s/iter; left time: 1065.6095s
	iters: 200, epoch: 15 | loss: 0.3019506
	speed: 0.0073s/iter; left time: 164.4331s
Epoch: 15 cost time: 2.599870443344116
Epoch: 15, Steps: 265 | Train Loss: 0.4439217 Vali Loss: 0.2308261 Test Loss: 0.3056641
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.5441212
	speed: 0.0499s/iter; left time: 1119.9998s
	iters: 200, epoch: 16 | loss: 0.2937841
	speed: 0.0069s/iter; left time: 154.1009s
Epoch: 16 cost time: 2.6405656337738037
Epoch: 16, Steps: 265 | Train Loss: 0.4428101 Vali Loss: 0.2309382 Test Loss: 0.3056387
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.5311683
	speed: 0.0481s/iter; left time: 1067.0265s
	iters: 200, epoch: 17 | loss: 0.3716281
	speed: 0.0068s/iter; left time: 150.8333s
Epoch: 17 cost time: 2.630199909210205
Epoch: 17, Steps: 265 | Train Loss: 0.4437598 Vali Loss: 0.2310499 Test Loss: 0.3056120
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.3937602
	speed: 0.0472s/iter; left time: 1033.3962s
	iters: 200, epoch: 18 | loss: 0.4648770
	speed: 0.0068s/iter; left time: 148.1684s
Epoch: 18 cost time: 2.4752893447875977
Epoch: 18, Steps: 265 | Train Loss: 0.4437380 Vali Loss: 0.2310541 Test Loss: 0.3055842
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.5426753
	speed: 0.0493s/iter; left time: 1066.4411s
	iters: 200, epoch: 19 | loss: 0.3935176
	speed: 0.0069s/iter; left time: 149.4914s
Epoch: 19 cost time: 2.581403970718384
Epoch: 19, Steps: 265 | Train Loss: 0.4433972 Vali Loss: 0.2310823 Test Loss: 0.3055587
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.3933846
	speed: 0.0480s/iter; left time: 1025.4966s
	iters: 200, epoch: 20 | loss: 0.4886063
	speed: 0.0069s/iter; left time: 145.7274s
Epoch: 20 cost time: 2.7144649028778076
Epoch: 20, Steps: 265 | Train Loss: 0.4433191 Vali Loss: 0.2310913 Test Loss: 0.3055324
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.6938643
	speed: 0.0491s/iter; left time: 1035.7818s
	iters: 200, epoch: 21 | loss: 0.4484397
	speed: 0.0070s/iter; left time: 146.9891s
Epoch: 21 cost time: 2.7130165100097656
Epoch: 21, Steps: 265 | Train Loss: 0.4432518 Vali Loss: 0.2311332 Test Loss: 0.3055043
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTSFL_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.305868923664093, mae:0.3613666892051697, rse:0.446967750787735
