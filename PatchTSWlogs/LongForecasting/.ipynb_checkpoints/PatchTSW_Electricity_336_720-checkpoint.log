Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='electricity.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=321, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='Electricity_336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : Electricity_336_720_PatchTSW_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.5705001
	speed: 0.7201s/iter; left time: 312385.0345s
	iters: 200, epoch: 1 | loss: 0.3967225
	speed: 0.7062s/iter; left time: 306262.8873s
	iters: 300, epoch: 1 | loss: 0.3581926
	speed: 0.7066s/iter; left time: 306379.0389s
	iters: 400, epoch: 1 | loss: 0.3973934
	speed: 0.7070s/iter; left time: 306464.4712s
	iters: 500, epoch: 1 | loss: 0.3767304
	speed: 0.7072s/iter; left time: 306515.2166s
	iters: 600, epoch: 1 | loss: 0.3304550
	speed: 0.7070s/iter; left time: 306361.6318s
	iters: 700, epoch: 1 | loss: 0.3493893
	speed: 0.7065s/iter; left time: 306070.3706s
	iters: 800, epoch: 1 | loss: 0.5055284
	speed: 0.7071s/iter; left time: 306229.9909s
	iters: 900, epoch: 1 | loss: 0.3011187
	speed: 0.7072s/iter; left time: 306212.8410s
	iters: 1000, epoch: 1 | loss: 0.3300619
	speed: 0.7070s/iter; left time: 306053.1229s
	iters: 1100, epoch: 1 | loss: 0.3594290
	speed: 0.7068s/iter; left time: 305914.5591s
	iters: 1200, epoch: 1 | loss: 0.4096420
	speed: 0.7069s/iter; left time: 305871.6298s
	iters: 1300, epoch: 1 | loss: 0.3374713
	speed: 0.7070s/iter; left time: 305859.8081s
	iters: 1400, epoch: 1 | loss: 0.3281566
	speed: 0.7072s/iter; left time: 305853.5873s
	iters: 1500, epoch: 1 | loss: 0.2938724
	speed: 0.7071s/iter; left time: 305738.0958s
	iters: 1600, epoch: 1 | loss: 0.3063304
	speed: 0.7067s/iter; left time: 305495.8042s
	iters: 1700, epoch: 1 | loss: 0.3195094
	speed: 0.7067s/iter; left time: 305422.0424s
	iters: 1800, epoch: 1 | loss: 0.4366136
	speed: 0.7069s/iter; left time: 305446.1735s
	iters: 1900, epoch: 1 | loss: 0.2620422
	speed: 0.7069s/iter; left time: 305379.2783s
	iters: 2000, epoch: 1 | loss: 0.3615876
	speed: 0.7068s/iter; left time: 305287.5668s
	iters: 2100, epoch: 1 | loss: 0.3047988
	speed: 0.7067s/iter; left time: 305167.0444s
	iters: 2200, epoch: 1 | loss: 0.2986787
	speed: 0.7066s/iter; left time: 305053.9207s
	iters: 2300, epoch: 1 | loss: 0.2722197
	speed: 0.7067s/iter; left time: 305024.4377s
	iters: 2400, epoch: 1 | loss: 0.2675143
	speed: 0.7069s/iter; left time: 305006.5989s
	iters: 2500, epoch: 1 | loss: 0.2771814
	speed: 0.7069s/iter; left time: 304962.8668s
	iters: 2600, epoch: 1 | loss: 0.2583832
	speed: 0.7070s/iter; left time: 304940.0984s
	iters: 2700, epoch: 1 | loss: 0.2633864
	speed: 0.7068s/iter; left time: 304771.9542s
	iters: 2800, epoch: 1 | loss: 0.3719155
	speed: 0.7068s/iter; left time: 304685.6741s
	iters: 2900, epoch: 1 | loss: 0.4082082
	speed: 0.7070s/iter; left time: 304700.9586s
	iters: 3000, epoch: 1 | loss: 0.3066956
	speed: 0.7070s/iter; left time: 304662.5171s
	iters: 3100, epoch: 1 | loss: 0.2655539
	speed: 0.7067s/iter; left time: 304440.5890s
	iters: 3200, epoch: 1 | loss: 0.2668868
	speed: 0.7069s/iter; left time: 304471.3795s
	iters: 3300, epoch: 1 | loss: 0.3428221
	speed: 0.7070s/iter; left time: 304431.7616s
	iters: 3400, epoch: 1 | loss: 0.2343591
	speed: 0.7071s/iter; left time: 304425.4614s
	iters: 3500, epoch: 1 | loss: 0.2792771
	speed: 0.7070s/iter; left time: 304295.4415s
	iters: 3600, epoch: 1 | loss: 0.2375117
	speed: 0.7070s/iter; left time: 304227.4905s
	iters: 3700, epoch: 1 | loss: 0.2829233
	speed: 0.7071s/iter; left time: 304196.9560s
	iters: 3800, epoch: 1 | loss: 0.2633046
	speed: 0.7071s/iter; left time: 304137.2096s
	iters: 3900, epoch: 1 | loss: 0.3231876
	speed: 0.7071s/iter; left time: 304056.1729s
	iters: 4000, epoch: 1 | loss: 0.2443572
	speed: 0.7069s/iter; left time: 303885.4761s
	iters: 4100, epoch: 1 | loss: 0.2935997
	speed: 0.7070s/iter; left time: 303864.9757s
	iters: 4200, epoch: 1 | loss: 0.2448514
	speed: 0.7069s/iter; left time: 303750.9122s
	iters: 4300, epoch: 1 | loss: 0.2224590
	speed: 0.7072s/iter; left time: 303799.4458s
Epoch: 1 cost time: 3068.8993513584137
Epoch: 1, Steps: 4339 | Train Loss: 0.3106000 Vali Loss: 0.2013633 Test Loss: 0.2290232
Validation loss decreased (inf --> 0.201363).  Saving model ...
Updating learning rate to 4.590973243371753e-06
	iters: 100, epoch: 2 | loss: 0.2522041
	speed: 4.2437s/iter; left time: 1822519.1387s
	iters: 200, epoch: 2 | loss: 0.2366267
	speed: 0.7070s/iter; left time: 303572.4621s
	iters: 300, epoch: 2 | loss: 0.2185912
	speed: 0.7075s/iter; left time: 303690.2624s
	iters: 400, epoch: 2 | loss: 0.3484834
	speed: 0.7069s/iter; left time: 303373.4772s
	iters: 500, epoch: 2 | loss: 0.2671165
	speed: 0.7070s/iter; left time: 303364.3238s
	iters: 600, epoch: 2 | loss: 0.3673337
	speed: 0.7070s/iter; left time: 303277.9465s
	iters: 700, epoch: 2 | loss: 0.2257164
	speed: 0.7068s/iter; left time: 303141.0237s
	iters: 800, epoch: 2 | loss: 0.2499532
	speed: 0.7070s/iter; left time: 303146.7078s
	iters: 900, epoch: 2 | loss: 0.2209412
	speed: 0.7070s/iter; left time: 303056.7657s
	iters: 1000, epoch: 2 | loss: 0.2982537
	speed: 0.7069s/iter; left time: 302940.0856s
	iters: 1100, epoch: 2 | loss: 0.2447103
	speed: 0.7071s/iter; left time: 302954.9177s
	iters: 1200, epoch: 2 | loss: 0.2817870
	speed: 0.7068s/iter; left time: 302775.9489s
	iters: 1300, epoch: 2 | loss: 0.2608421
	speed: 0.7069s/iter; left time: 302719.4817s
	iters: 1400, epoch: 2 | loss: 0.2779522
	speed: 0.7069s/iter; left time: 302673.1743s
	iters: 1500, epoch: 2 | loss: 0.2462018
	speed: 0.7070s/iter; left time: 302638.8902s
	iters: 1600, epoch: 2 | loss: 0.2392222
	speed: 0.7071s/iter; left time: 302631.2607s
	iters: 1700, epoch: 2 | loss: 0.2694488
	speed: 0.7072s/iter; left time: 302599.5712s
	iters: 1800, epoch: 2 | loss: 0.3870953
	speed: 0.7071s/iter; left time: 302460.0741s
	iters: 1900, epoch: 2 | loss: 0.2517888
	speed: 0.7069s/iter; left time: 302309.9601s
	iters: 2000, epoch: 2 | loss: 0.2563927
	speed: 0.7067s/iter; left time: 302152.7863s
	iters: 2100, epoch: 2 | loss: 0.3271046
	speed: 0.7067s/iter; left time: 302079.4922s
	iters: 2200, epoch: 2 | loss: 0.1875822
	speed: 0.7069s/iter; left time: 302101.4430s
	iters: 2300, epoch: 2 | loss: 0.2055849
	speed: 0.7070s/iter; left time: 302072.3548s
	iters: 2400, epoch: 2 | loss: 0.2626405
	speed: 0.7070s/iter; left time: 302007.8707s
	iters: 2500, epoch: 2 | loss: 0.1961300
	speed: 0.7067s/iter; left time: 301818.9745s
	iters: 2600, epoch: 2 | loss: 0.2677912
	speed: 0.7067s/iter; left time: 301750.7300s
	iters: 2700, epoch: 2 | loss: 0.2261619
	speed: 0.7070s/iter; left time: 301785.2505s
	iters: 2800, epoch: 2 | loss: 0.2365899
	speed: 0.7072s/iter; left time: 301802.6627s
	iters: 2900, epoch: 2 | loss: 0.2220497
	speed: 0.7069s/iter; left time: 301619.9564s
	iters: 3000, epoch: 2 | loss: 0.2631345
	speed: 0.7069s/iter; left time: 301554.5895s
