Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=24, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='traffic.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=862, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_336_PatchTSFL_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.9840891
	speed: 0.0810s/iter; left time: 3902.5784s
	iters: 200, epoch: 1 | loss: 1.0188856
	speed: 0.0610s/iter; left time: 2934.9531s
	iters: 300, epoch: 1 | loss: 0.9837374
	speed: 0.0618s/iter; left time: 2965.8707s
	iters: 400, epoch: 1 | loss: 0.9707758
	speed: 0.0611s/iter; left time: 2927.8778s
Epoch: 1 cost time: 31.85352325439453
Epoch: 1, Steps: 483 | Train Loss: 0.9884564 Vali Loss: 1.2018565 Test Loss: 1.4090294
Validation loss decreased (inf --> 1.201856).  Saving model ...
Updating learning rate to 4.5910817705587865e-06
	iters: 100, epoch: 2 | loss: 0.9843562
	speed: 0.3266s/iter; left time: 15582.3778s
	iters: 200, epoch: 2 | loss: 0.9912663
	speed: 0.0609s/iter; left time: 2898.7951s
	iters: 300, epoch: 2 | loss: 0.9779558
	speed: 0.0615s/iter; left time: 2923.2153s
	iters: 400, epoch: 2 | loss: 0.9893529
	speed: 0.0609s/iter; left time: 2888.1270s
Epoch: 2 cost time: 31.460328578948975
Epoch: 2, Steps: 483 | Train Loss: 0.9885309 Vali Loss: 1.2015158 Test Loss: 1.4090276
Validation loss decreased (1.201856 --> 1.201516).  Saving model ...
Updating learning rate to 6.349769679756483e-06
	iters: 100, epoch: 3 | loss: 1.0057086
	speed: 0.3400s/iter; left time: 16061.8424s
	iters: 200, epoch: 3 | loss: 0.9873859
	speed: 0.0606s/iter; left time: 2858.0525s
	iters: 300, epoch: 3 | loss: 0.9849631
	speed: 0.0624s/iter; left time: 2935.4316s
	iters: 400, epoch: 3 | loss: 0.9903325
	speed: 0.0612s/iter; left time: 2874.6344s
Epoch: 3 cost time: 31.383291006088257
Epoch: 3, Steps: 483 | Train Loss: 0.9885390 Vali Loss: 1.2018983 Test Loss: 1.4090252
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.232750045791923e-06
	iters: 100, epoch: 4 | loss: 1.0245225
	speed: 0.3465s/iter; left time: 16201.7742s
	iters: 200, epoch: 4 | loss: 0.9478350
	speed: 0.0616s/iter; left time: 2871.5297s
	iters: 300, epoch: 4 | loss: 0.9745135
	speed: 0.0609s/iter; left time: 2834.4639s
	iters: 400, epoch: 4 | loss: 0.9949608
	speed: 0.0607s/iter; left time: 2818.4312s
Epoch: 4 cost time: 31.379467487335205
Epoch: 4, Steps: 483 | Train Loss: 0.9885111 Vali Loss: 1.2017908 Test Loss: 1.4090214
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.316901965452998e-05
	iters: 100, epoch: 5 | loss: 0.9876625
	speed: 0.3302s/iter; left time: 15279.6563s
	iters: 200, epoch: 5 | loss: 0.9939269
	speed: 0.0610s/iter; left time: 2818.4565s
	iters: 300, epoch: 5 | loss: 0.9705396
	speed: 0.0603s/iter; left time: 2778.1440s
	iters: 400, epoch: 5 | loss: 0.9757383
	speed: 0.0607s/iter; left time: 2788.3259s
Epoch: 5 cost time: 31.51211977005005
