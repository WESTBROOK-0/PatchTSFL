Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_96_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_1440_Informer_custom_ftM_sl96_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35352
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 0.8393458
	speed: 0.0602s/iter; left time: 1058.8723s
	iters: 200, epoch: 1 | loss: 1.1509373
	speed: 0.0396s/iter; left time: 691.4594s
	iters: 300, epoch: 1 | loss: 1.1152277
	speed: 0.0376s/iter; left time: 654.2176s
	iters: 400, epoch: 1 | loss: 0.8128488
	speed: 0.0363s/iter; left time: 626.5297s
	iters: 500, epoch: 1 | loss: 0.6829082
	speed: 0.0376s/iter; left time: 645.6039s
	iters: 600, epoch: 1 | loss: 0.6032175
	speed: 0.0383s/iter; left time: 653.5939s
	iters: 700, epoch: 1 | loss: 0.6143365
	speed: 0.0399s/iter; left time: 677.6830s
	iters: 800, epoch: 1 | loss: 0.8941399
	speed: 0.0381s/iter; left time: 642.8924s
	iters: 900, epoch: 1 | loss: 0.7116545
	speed: 0.0370s/iter; left time: 621.0125s
	iters: 1000, epoch: 1 | loss: 0.5083200
	speed: 0.0362s/iter; left time: 603.8630s
	iters: 1100, epoch: 1 | loss: 1.0548193
	speed: 0.0372s/iter; left time: 616.9130s
	iters: 1200, epoch: 1 | loss: 0.5728934
	speed: 0.0372s/iter; left time: 612.9100s
	iters: 1300, epoch: 1 | loss: 0.6512061
	speed: 0.0394s/iter; left time: 645.6190s
	iters: 1400, epoch: 1 | loss: 0.7108246
	speed: 0.0393s/iter; left time: 639.8278s
	iters: 1500, epoch: 1 | loss: 0.6538658
	speed: 0.0424s/iter; left time: 685.4214s
	iters: 1600, epoch: 1 | loss: 1.0770926
	speed: 0.0400s/iter; left time: 643.1215s
	iters: 1700, epoch: 1 | loss: 0.8764820
	speed: 0.0375s/iter; left time: 599.5191s
	iters: 1800, epoch: 1 | loss: 0.6602170
	speed: 0.0371s/iter; left time: 588.3106s
	iters: 1900, epoch: 1 | loss: 1.0471090
	speed: 0.0373s/iter; left time: 589.1155s
	iters: 2000, epoch: 1 | loss: 0.5637808
	speed: 0.0385s/iter; left time: 604.2161s
	iters: 2100, epoch: 1 | loss: 0.6815851
	speed: 0.0388s/iter; left time: 604.1649s
	iters: 2200, epoch: 1 | loss: 1.0071751
	speed: 0.0394s/iter; left time: 610.0143s
	iters: 2300, epoch: 1 | loss: 1.0893575
	speed: 0.0388s/iter; left time: 596.5216s
	iters: 2400, epoch: 1 | loss: 0.5468659
	speed: 0.0369s/iter; left time: 564.3820s
	iters: 2500, epoch: 1 | loss: 1.0873239
	speed: 0.0387s/iter; left time: 587.3604s
	iters: 2600, epoch: 1 | loss: 0.7837194
	speed: 0.0412s/iter; left time: 620.4777s
	iters: 2700, epoch: 1 | loss: 0.9572281
	speed: 0.0412s/iter; left time: 617.0219s
	iters: 2800, epoch: 1 | loss: 0.6425161
	speed: 0.0375s/iter; left time: 557.6702s
	iters: 2900, epoch: 1 | loss: 0.7443397
	speed: 0.0403s/iter; left time: 595.8367s
	iters: 3000, epoch: 1 | loss: 0.8026560
	speed: 0.0379s/iter; left time: 556.8147s
	iters: 3100, epoch: 1 | loss: 0.8365505
	speed: 0.0385s/iter; left time: 560.6606s
	iters: 3200, epoch: 1 | loss: 0.6660838
	speed: 0.0399s/iter; left time: 577.0940s
	iters: 3300, epoch: 1 | loss: 0.6978939
	speed: 0.0398s/iter; left time: 571.5489s
	iters: 3400, epoch: 1 | loss: 0.6004612
	speed: 0.0400s/iter; left time: 570.7774s
	iters: 3500, epoch: 1 | loss: 1.5224733
	speed: 0.0409s/iter; left time: 579.7881s
	iters: 3600, epoch: 1 | loss: 0.5552987
	speed: 0.0404s/iter; left time: 568.4502s
	iters: 3700, epoch: 1 | loss: 0.7102248
	speed: 0.0364s/iter; left time: 509.1762s
	iters: 3800, epoch: 1 | loss: 0.5120836
	speed: 0.0375s/iter; left time: 520.6745s
	iters: 3900, epoch: 1 | loss: 0.9793444
	speed: 0.0371s/iter; left time: 510.5179s
	iters: 4000, epoch: 1 | loss: 0.9641051
	speed: 0.0373s/iter; left time: 510.4845s
	iters: 4100, epoch: 1 | loss: 0.7711636
	speed: 0.0381s/iter; left time: 517.8102s
	iters: 4200, epoch: 1 | loss: 0.6843935
	speed: 0.0376s/iter; left time: 506.7288s
	iters: 4300, epoch: 1 | loss: 0.6000255
	speed: 0.0366s/iter; left time: 488.9460s
	iters: 4400, epoch: 1 | loss: 0.7293627
	speed: 0.0374s/iter; left time: 496.4446s
	iters: 4500, epoch: 1 | loss: 0.5462780
	speed: 0.0377s/iter; left time: 496.1467s
	iters: 4600, epoch: 1 | loss: 0.6032546
	speed: 0.0379s/iter; left time: 495.1108s
	iters: 4700, epoch: 1 | loss: 0.8916944
	speed: 0.0380s/iter; left time: 493.2886s
	iters: 4800, epoch: 1 | loss: 0.5873426
	speed: 0.0399s/iter; left time: 514.1073s
	iters: 4900, epoch: 1 | loss: 0.5725659
	speed: 0.0381s/iter; left time: 486.8927s
	iters: 5000, epoch: 1 | loss: 0.5547060
	speed: 0.0366s/iter; left time: 463.4190s
	iters: 5100, epoch: 1 | loss: 0.5265811
	speed: 0.0373s/iter; left time: 469.0082s
	iters: 5200, epoch: 1 | loss: 0.6943578
	speed: 0.0368s/iter; left time: 458.9188s
	iters: 5300, epoch: 1 | loss: 0.5598702
	speed: 0.0373s/iter; left time: 461.9276s
	iters: 5400, epoch: 1 | loss: 1.0311871
	speed: 0.0390s/iter; left time: 478.2270s
	iters: 5500, epoch: 1 | loss: 0.6671007
	speed: 0.0416s/iter; left time: 506.9839s
	iters: 5600, epoch: 1 | loss: 0.6666506
	speed: 0.0419s/iter; left time: 506.4770s
	iters: 5700, epoch: 1 | loss: 0.6270248
	speed: 0.0376s/iter; left time: 450.3532s
	iters: 5800, epoch: 1 | loss: 0.7719169
	speed: 0.0388s/iter; left time: 461.1548s
	iters: 5900, epoch: 1 | loss: 0.5937687
	speed: 0.0372s/iter; left time: 437.7463s
	iters: 6000, epoch: 1 | loss: 0.4404675
	speed: 0.0385s/iter; left time: 449.5240s
	iters: 6100, epoch: 1 | loss: 0.5435793
	speed: 0.0409s/iter; left time: 474.0544s
	iters: 6200, epoch: 1 | loss: 0.4811099
	speed: 0.0460s/iter; left time: 527.8011s
	iters: 6300, epoch: 1 | loss: 0.6348717
	speed: 0.0443s/iter; left time: 504.4442s
	iters: 6400, epoch: 1 | loss: 1.1463177
	speed: 0.0366s/iter; left time: 412.7063s
	iters: 6500, epoch: 1 | loss: 0.5333533
	speed: 0.0369s/iter; left time: 412.5696s
	iters: 6600, epoch: 1 | loss: 1.1931230
	speed: 0.0373s/iter; left time: 412.7613s
	iters: 6700, epoch: 1 | loss: 0.5155012
	speed: 0.0395s/iter; left time: 433.1905s
	iters: 6800, epoch: 1 | loss: 0.5303392
	speed: 0.0366s/iter; left time: 398.6258s
	iters: 6900, epoch: 1 | loss: 0.5707360
	speed: 0.0386s/iter; left time: 416.5171s
	iters: 7000, epoch: 1 | loss: 0.6015163
	speed: 0.0371s/iter; left time: 396.5590s
	iters: 7100, epoch: 1 | loss: 0.5447216
	speed: 0.0367s/iter; left time: 388.2432s
	iters: 7200, epoch: 1 | loss: 0.7530097
	speed: 0.0384s/iter; left time: 402.2586s
	iters: 7300, epoch: 1 | loss: 0.4748829
	speed: 0.0391s/iter; left time: 405.4199s
	iters: 7400, epoch: 1 | loss: 0.5329032
	speed: 0.0401s/iter; left time: 412.5514s
	iters: 7500, epoch: 1 | loss: 0.5906379
	speed: 0.0409s/iter; left time: 415.9210s
	iters: 7600, epoch: 1 | loss: 0.6041074
	speed: 0.0411s/iter; left time: 414.6317s
	iters: 7700, epoch: 1 | loss: 0.8233976
	speed: 0.0365s/iter; left time: 363.7691s
	iters: 7800, epoch: 1 | loss: 0.6838578
	speed: 0.0369s/iter; left time: 364.5538s
	iters: 7900, epoch: 1 | loss: 0.4511856
	speed: 0.0380s/iter; left time: 371.0495s
	iters: 8000, epoch: 1 | loss: 0.6026736
	speed: 0.0384s/iter; left time: 371.6250s
	iters: 8100, epoch: 1 | loss: 0.6213576
	speed: 0.0373s/iter; left time: 357.5503s
	iters: 8200, epoch: 1 | loss: 0.7610873
	speed: 0.0397s/iter; left time: 376.5514s
	iters: 8300, epoch: 1 | loss: 1.0077875
	speed: 0.0382s/iter; left time: 358.3040s
	iters: 8400, epoch: 1 | loss: 0.6455816
	speed: 0.0372s/iter; left time: 344.9222s
	iters: 8500, epoch: 1 | loss: 0.4638054
	speed: 0.0369s/iter; left time: 339.0583s
	iters: 8600, epoch: 1 | loss: 0.4788661
	speed: 0.0382s/iter; left time: 346.2880s
	iters: 8700, epoch: 1 | loss: 1.1105485
	speed: 0.0376s/iter; left time: 337.9492s
	iters: 8800, epoch: 1 | loss: 0.5691370
	speed: 0.0370s/iter; left time: 328.3181s
Epoch: 1 cost time: 342.82841086387634
Epoch: 1, Steps: 8838 | Train Loss: 0.7153367 Vali Loss: 1.3033898 Test Loss: 2.6089275
Validation loss decreased (inf --> 1.303390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7581367
	speed: 0.5555s/iter; left time: 4854.5269s
	iters: 200, epoch: 2 | loss: 0.4629633
	speed: 0.0360s/iter; left time: 311.0664s
	iters: 300, epoch: 2 | loss: 1.0039556
	speed: 0.0374s/iter; left time: 319.4223s
	iters: 400, epoch: 2 | loss: 0.7286841
	speed: 0.0372s/iter; left time: 314.1139s
	iters: 500, epoch: 2 | loss: 0.5045895
	speed: 0.0375s/iter; left time: 312.5523s
	iters: 600, epoch: 2 | loss: 0.4765753
	speed: 0.0368s/iter; left time: 303.3749s
	iters: 700, epoch: 2 | loss: 0.4773879
	speed: 0.0371s/iter; left time: 301.8631s
	iters: 800, epoch: 2 | loss: 0.5316619
	speed: 0.0374s/iter; left time: 300.7853s
	iters: 900, epoch: 2 | loss: 0.7097157
	speed: 0.0370s/iter; left time: 293.6828s
	iters: 1000, epoch: 2 | loss: 0.4453760
	speed: 0.0371s/iter; left time: 291.1604s
	iters: 1100, epoch: 2 | loss: 0.4390057
	speed: 0.0388s/iter; left time: 300.2707s
	iters: 1200, epoch: 2 | loss: 0.4576689
	speed: 0.0390s/iter; left time: 298.2340s
	iters: 1300, epoch: 2 | loss: 1.0583353
	speed: 0.0399s/iter; left time: 300.7287s
	iters: 1400, epoch: 2 | loss: 0.6069087
	speed: 0.0401s/iter; left time: 298.2012s
	iters: 1500, epoch: 2 | loss: 0.8941198
	speed: 0.0402s/iter; left time: 294.7467s
	iters: 1600, epoch: 2 | loss: 0.5355873
	speed: 0.0369s/iter; left time: 267.3737s
	iters: 1700, epoch: 2 | loss: 0.5037453
	speed: 0.0369s/iter; left time: 263.2097s
	iters: 1800, epoch: 2 | loss: 0.5397752
	speed: 0.0375s/iter; left time: 264.2909s
	iters: 1900, epoch: 2 | loss: 0.4144638
	speed: 0.0373s/iter; left time: 258.8522s
	iters: 2000, epoch: 2 | loss: 0.6462523
	speed: 0.0372s/iter; left time: 254.4472s
	iters: 2100, epoch: 2 | loss: 0.4082130
	speed: 0.0374s/iter; left time: 251.8546s
	iters: 2200, epoch: 2 | loss: 0.3710127
	speed: 0.0384s/iter; left time: 254.9896s
	iters: 2300, epoch: 2 | loss: 0.3999377
	speed: 0.0378s/iter; left time: 247.2360s
	iters: 2400, epoch: 2 | loss: 0.4162216
	speed: 0.0364s/iter; left time: 234.4074s
	iters: 2500, epoch: 2 | loss: 0.4060333
	speed: 0.0392s/iter; left time: 248.6608s
	iters: 2600, epoch: 2 | loss: 0.3973354
	speed: 0.0407s/iter; left time: 253.6675s
	iters: 2700, epoch: 2 | loss: 0.3937909
	speed: 0.0373s/iter; left time: 229.2146s
	iters: 2800, epoch: 2 | loss: 0.4650639
	speed: 0.0377s/iter; left time: 227.8467s
	iters: 2900, epoch: 2 | loss: 0.3126398
	speed: 0.0387s/iter; left time: 229.7764s
	iters: 3000, epoch: 2 | loss: 0.3973613
	speed: 0.0395s/iter; left time: 230.6450s
	iters: 3100, epoch: 2 | loss: 0.9644746
	speed: 0.0409s/iter; left time: 234.7553s
	iters: 3200, epoch: 2 | loss: 0.3594253
	speed: 0.0420s/iter; left time: 237.0679s
	iters: 3300, epoch: 2 | loss: 0.8751532
	speed: 0.0402s/iter; left time: 222.4836s
	iters: 3400, epoch: 2 | loss: 0.4611917
	speed: 0.0380s/iter; left time: 206.5821s
	iters: 3500, epoch: 2 | loss: 1.1569510
	speed: 0.0396s/iter; left time: 211.3849s
	iters: 3600, epoch: 2 | loss: 0.3167153
	speed: 0.0408s/iter; left time: 213.6676s
	iters: 3700, epoch: 2 | loss: 0.4760854
	speed: 0.0398s/iter; left time: 204.7391s
	iters: 3800, epoch: 2 | loss: 0.3377307
	speed: 0.0385s/iter; left time: 194.2161s
	iters: 3900, epoch: 2 | loss: 0.4677605
	speed: 0.0379s/iter; left time: 187.2103s
	iters: 4000, epoch: 2 | loss: 0.5971434
	speed: 0.0370s/iter; left time: 179.2699s
	iters: 4100, epoch: 2 | loss: 0.4594971
	speed: 0.0373s/iter; left time: 176.8924s
	iters: 4200, epoch: 2 | loss: 0.4024326
	speed: 0.0384s/iter; left time: 177.9490s
	iters: 4300, epoch: 2 | loss: 0.2509638
	speed: 0.0391s/iter; left time: 177.4727s
	iters: 4400, epoch: 2 | loss: 0.3246350
	speed: 0.0395s/iter; left time: 175.2751s
	iters: 4500, epoch: 2 | loss: 0.3111735
	speed: 0.0405s/iter; left time: 175.7543s
	iters: 4600, epoch: 2 | loss: 0.2910863
	speed: 0.0395s/iter; left time: 167.4650s
	iters: 4700, epoch: 2 | loss: 0.3335344
	speed: 0.0362s/iter; left time: 149.9456s
	iters: 4800, epoch: 2 | loss: 0.9396402
	speed: 0.0385s/iter; left time: 155.6520s
	iters: 4900, epoch: 2 | loss: 0.3558080
	speed: 0.0402s/iter; left time: 158.4468s
	iters: 5000, epoch: 2 | loss: 0.2978606
	speed: 0.0404s/iter; left time: 155.0922s
	iters: 5100, epoch: 2 | loss: 0.3050735
	speed: 0.0421s/iter; left time: 157.3522s
	iters: 5200, epoch: 2 | loss: 0.3351411
	speed: 0.0414s/iter; left time: 150.5131s
	iters: 5300, epoch: 2 | loss: 0.4894945
	speed: 0.0366s/iter; left time: 129.3686s
	iters: 5400, epoch: 2 | loss: 0.3572223
	speed: 0.0371s/iter; left time: 127.6823s
	iters: 5500, epoch: 2 | loss: 0.3242128
	speed: 0.0387s/iter; left time: 129.1323s
	iters: 5600, epoch: 2 | loss: 0.3098674
	speed: 0.0388s/iter; left time: 125.8015s
	iters: 5700, epoch: 2 | loss: 0.8213964
	speed: 0.0382s/iter; left time: 119.9568s
	iters: 5800, epoch: 2 | loss: 0.2773367
	speed: 0.0391s/iter; left time: 118.8999s
	iters: 5900, epoch: 2 | loss: 0.2895376
	speed: 0.0400s/iter; left time: 117.6239s
	iters: 6000, epoch: 2 | loss: 0.5634080
	speed: 0.0361s/iter; left time: 102.4003s
	iters: 6100, epoch: 2 | loss: 0.9401600
	speed: 0.0364s/iter; left time: 99.6529s
	iters: 6200, epoch: 2 | loss: 0.3446641
	speed: 0.0372s/iter; left time: 98.1330s
	iters: 6300, epoch: 2 | loss: 0.8073859
	speed: 0.0386s/iter; left time: 98.0613s
	iters: 6400, epoch: 2 | loss: 0.8280802
	speed: 0.0375s/iter; left time: 91.4302s
	iters: 6500, epoch: 2 | loss: 0.3309698
	speed: 0.0390s/iter; left time: 91.2066s
	iters: 6600, epoch: 2 | loss: 0.3570561
	speed: 0.0362s/iter; left time: 81.0200s
	iters: 6700, epoch: 2 | loss: 0.7823572
	speed: 0.0364s/iter; left time: 77.8205s
	iters: 6800, epoch: 2 | loss: 0.4729896
	speed: 0.0395s/iter; left time: 80.4655s
	iters: 6900, epoch: 2 | loss: 0.9618508
	speed: 0.0402s/iter; left time: 77.9283s
	iters: 7000, epoch: 2 | loss: 0.2763969
	speed: 0.0436s/iter; left time: 80.2564s
	iters: 7100, epoch: 2 | loss: 0.4113893
	speed: 0.0438s/iter; left time: 76.2217s
	iters: 7200, epoch: 2 | loss: 0.3329752
	speed: 0.0415s/iter; left time: 67.9636s
	iters: 7300, epoch: 2 | loss: 0.8462521
	speed: 0.0368s/iter; left time: 56.6601s
	iters: 7400, epoch: 2 | loss: 0.5536705
	speed: 0.0374s/iter; left time: 53.7811s
	iters: 7500, epoch: 2 | loss: 0.2187894
	speed: 0.0383s/iter; left time: 51.2711s
	iters: 7600, epoch: 2 | loss: 0.2124436
	speed: 0.0390s/iter; left time: 48.2716s
	iters: 7700, epoch: 2 | loss: 0.2983593
	speed: 0.0393s/iter; left time: 44.8000s
	iters: 7800, epoch: 2 | loss: 0.7478466
	speed: 0.0414s/iter; left time: 43.0528s
	iters: 7900, epoch: 2 | loss: 0.4502212
	speed: 0.0386s/iter; left time: 36.2917s
	iters: 8000, epoch: 2 | loss: 0.2552315
	speed: 0.0366s/iter; left time: 30.7068s
	iters: 8100, epoch: 2 | loss: 0.7001371
	speed: 0.0384s/iter; left time: 28.3726s
	iters: 8200, epoch: 2 | loss: 0.3247610
	speed: 0.0383s/iter; left time: 24.4834s
	iters: 8300, epoch: 2 | loss: 0.3897670
	speed: 0.0397s/iter; left time: 21.3811s
	iters: 8400, epoch: 2 | loss: 0.2175733
	speed: 0.0384s/iter; left time: 16.8683s
	iters: 8500, epoch: 2 | loss: 0.3391395
	speed: 0.0393s/iter; left time: 13.3129s
	iters: 8600, epoch: 2 | loss: 0.3457363
	speed: 0.0376s/iter; left time: 8.9930s
	iters: 8700, epoch: 2 | loss: 0.2132187
	speed: 0.0374s/iter; left time: 5.1934s
	iters: 8800, epoch: 2 | loss: 0.2828827
	speed: 0.0387s/iter; left time: 1.5103s
Epoch: 2 cost time: 343.08138489723206
Epoch: 2, Steps: 8838 | Train Loss: 0.4759220 Vali Loss: 0.9800411 Test Loss: 1.1395199
Validation loss decreased (1.303390 --> 0.980041).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_96_1440_Informer_custom_ftM_sl96_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:1.1394578218460083, mae:0.807050883769989, rse:1.4103765487670898
