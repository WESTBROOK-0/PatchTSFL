Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.3, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='ETTh2_336_720', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_336_720_PatchTST_ETTh2_ftS_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 3.2457122802734375
Epoch: 1, Steps: 59 | Train Loss: 0.4741452 Vali Loss: 0.4782071 Test Loss: 0.3561160
Validation loss decreased (inf --> 0.478207).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 3.296384334564209
Epoch: 2, Steps: 59 | Train Loss: 0.4006693 Vali Loss: 0.3933781 Test Loss: 0.2746614
Validation loss decreased (0.478207 --> 0.393378).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 3.427110195159912
Epoch: 3, Steps: 59 | Train Loss: 0.3492127 Vali Loss: 0.3737317 Test Loss: 0.2528939
Validation loss decreased (0.393378 --> 0.373732).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 3.5540082454681396
Epoch: 4, Steps: 59 | Train Loss: 0.3322358 Vali Loss: 0.3659723 Test Loss: 0.2462267
Validation loss decreased (0.373732 --> 0.365972).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 3.3227925300598145
Epoch: 5, Steps: 59 | Train Loss: 0.3239152 Vali Loss: 0.3632565 Test Loss: 0.2421611
Validation loss decreased (0.365972 --> 0.363257).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 3.2351605892181396
Epoch: 6, Steps: 59 | Train Loss: 0.3199017 Vali Loss: 0.3594135 Test Loss: 0.2398654
Validation loss decreased (0.363257 --> 0.359414).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 3.425692558288574
Epoch: 7, Steps: 59 | Train Loss: 0.3166677 Vali Loss: 0.3568958 Test Loss: 0.2374699
Validation loss decreased (0.359414 --> 0.356896).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 3.33303165435791
Epoch: 8, Steps: 59 | Train Loss: 0.3140771 Vali Loss: 0.3557588 Test Loss: 0.2362521
Validation loss decreased (0.356896 --> 0.355759).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 3.1090030670166016
Epoch: 9, Steps: 59 | Train Loss: 0.3122893 Vali Loss: 0.3556796 Test Loss: 0.2350272
Validation loss decreased (0.355759 --> 0.355680).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 3.2855565547943115
Epoch: 10, Steps: 59 | Train Loss: 0.3112925 Vali Loss: 0.3541162 Test Loss: 0.2338881
Validation loss decreased (0.355680 --> 0.354116).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 3.447152853012085
Epoch: 11, Steps: 59 | Train Loss: 0.3106151 Vali Loss: 0.3527192 Test Loss: 0.2330268
Validation loss decreased (0.354116 --> 0.352719).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 3.17954683303833
Epoch: 12, Steps: 59 | Train Loss: 0.3088649 Vali Loss: 0.3530035 Test Loss: 0.2322258
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 3.5536282062530518
Epoch: 13, Steps: 59 | Train Loss: 0.3091180 Vali Loss: 0.3543518 Test Loss: 0.2313656
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 3.2974774837493896
Epoch: 14, Steps: 59 | Train Loss: 0.3078771 Vali Loss: 0.3531885 Test Loss: 0.2308175
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 3.3949244022369385
Epoch: 15, Steps: 59 | Train Loss: 0.3081730 Vali Loss: 0.3499718 Test Loss: 0.2300094
Validation loss decreased (0.352719 --> 0.349972).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 3.4650816917419434
Epoch: 16, Steps: 59 | Train Loss: 0.3072509 Vali Loss: 0.3493819 Test Loss: 0.2295891
Validation loss decreased (0.349972 --> 0.349382).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 3.5316274166107178
Epoch: 17, Steps: 59 | Train Loss: 0.3066188 Vali Loss: 0.3507768 Test Loss: 0.2288951
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 3.310415744781494
Epoch: 18, Steps: 59 | Train Loss: 0.3059813 Vali Loss: 0.3495291 Test Loss: 0.2287545
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 3.7108724117279053
Epoch: 19, Steps: 59 | Train Loss: 0.3058742 Vali Loss: 0.3490296 Test Loss: 0.2280610
Validation loss decreased (0.349382 --> 0.349030).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 3.3727529048919678
Epoch: 20, Steps: 59 | Train Loss: 0.3052102 Vali Loss: 0.3500777 Test Loss: 0.2275888
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 3.1546359062194824
Epoch: 21, Steps: 59 | Train Loss: 0.3056022 Vali Loss: 0.3483434 Test Loss: 0.2274462
Validation loss decreased (0.349030 --> 0.348343).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 3.4112331867218018
Epoch: 22, Steps: 59 | Train Loss: 0.3043990 Vali Loss: 0.3505706 Test Loss: 0.2269610
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 3.4215750694274902
Epoch: 23, Steps: 59 | Train Loss: 0.3045689 Vali Loss: 0.3484254 Test Loss: 0.2267378
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 3.3978986740112305
Epoch: 24, Steps: 59 | Train Loss: 0.3042103 Vali Loss: 0.3491706 Test Loss: 0.2263369
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 3.3936266899108887
Epoch: 25, Steps: 59 | Train Loss: 0.3040219 Vali Loss: 0.3486499 Test Loss: 0.2261401
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 3.357999324798584
Epoch: 26, Steps: 59 | Train Loss: 0.3045968 Vali Loss: 0.3488237 Test Loss: 0.2259028
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 3.271191358566284
Epoch: 27, Steps: 59 | Train Loss: 0.3038439 Vali Loss: 0.3474894 Test Loss: 0.2255136
Validation loss decreased (0.348343 --> 0.347489).  Saving model ...
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 3.491366147994995
Epoch: 28, Steps: 59 | Train Loss: 0.3041114 Vali Loss: 0.3481949 Test Loss: 0.2256063
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 3.4714062213897705
Epoch: 29, Steps: 59 | Train Loss: 0.3039101 Vali Loss: 0.3480534 Test Loss: 0.2253372
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 3.4990293979644775
Epoch: 30, Steps: 59 | Train Loss: 0.3038346 Vali Loss: 0.3473607 Test Loss: 0.2252312
Validation loss decreased (0.347489 --> 0.347361).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 3.4981892108917236
Epoch: 31, Steps: 59 | Train Loss: 0.3038659 Vali Loss: 0.3481646 Test Loss: 0.2250981
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 3.4841160774230957
Epoch: 32, Steps: 59 | Train Loss: 0.3032711 Vali Loss: 0.3465834 Test Loss: 0.2249487
Validation loss decreased (0.347361 --> 0.346583).  Saving model ...
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 3.7106053829193115
Epoch: 33, Steps: 59 | Train Loss: 0.3032495 Vali Loss: 0.3460562 Test Loss: 0.2246696
Validation loss decreased (0.346583 --> 0.346056).  Saving model ...
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 3.4950320720672607
Epoch: 34, Steps: 59 | Train Loss: 0.3032216 Vali Loss: 0.3479639 Test Loss: 0.2248098
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 3.425717830657959
Epoch: 35, Steps: 59 | Train Loss: 0.3040396 Vali Loss: 0.3461069 Test Loss: 0.2247211
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 3.5840721130371094
Epoch: 36, Steps: 59 | Train Loss: 0.3027223 Vali Loss: 0.3462958 Test Loss: 0.2243084
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 3.3792059421539307
Epoch: 37, Steps: 59 | Train Loss: 0.3026819 Vali Loss: 0.3463109 Test Loss: 0.2242121
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 3.437990188598633
Epoch: 38, Steps: 59 | Train Loss: 0.3034538 Vali Loss: 0.3477805 Test Loss: 0.2244592
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 3.4574074745178223
Epoch: 39, Steps: 59 | Train Loss: 0.3031927 Vali Loss: 0.3468788 Test Loss: 0.2243688
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 3.624445676803589
Epoch: 40, Steps: 59 | Train Loss: 0.3030823 Vali Loss: 0.3469349 Test Loss: 0.2241612
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 3.466421604156494
Epoch: 41, Steps: 59 | Train Loss: 0.3023620 Vali Loss: 0.3464704 Test Loss: 0.2243707
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 3.369349718093872
Epoch: 42, Steps: 59 | Train Loss: 0.3032945 Vali Loss: 0.3462622 Test Loss: 0.2240998
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 3.508848190307617
Epoch: 43, Steps: 59 | Train Loss: 0.3025093 Vali Loss: 0.3460954 Test Loss: 0.2239549
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 3.4571104049682617
Epoch: 44, Steps: 59 | Train Loss: 0.3030720 Vali Loss: 0.3449618 Test Loss: 0.2238232
Validation loss decreased (0.346056 --> 0.344962).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 3.318910598754883
Epoch: 45, Steps: 59 | Train Loss: 0.3032589 Vali Loss: 0.3461198 Test Loss: 0.2238028
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 3.3810999393463135
Epoch: 46, Steps: 59 | Train Loss: 0.3024802 Vali Loss: 0.3472053 Test Loss: 0.2240722
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 3.6685454845428467
Epoch: 47, Steps: 59 | Train Loss: 0.3027011 Vali Loss: 0.3457503 Test Loss: 0.2238557
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 3.315847158432007
Epoch: 48, Steps: 59 | Train Loss: 0.3026664 Vali Loss: 0.3475727 Test Loss: 0.2238887
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 3.341282844543457
Epoch: 49, Steps: 59 | Train Loss: 0.3026614 Vali Loss: 0.3473781 Test Loss: 0.2240389
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 3.299999952316284
Epoch: 50, Steps: 59 | Train Loss: 0.3030506 Vali Loss: 0.3454346 Test Loss: 0.2239986
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 3.3228094577789307
Epoch: 51, Steps: 59 | Train Loss: 0.3029256 Vali Loss: 0.3468039 Test Loss: 0.2238423
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 3.516873836517334
Epoch: 52, Steps: 59 | Train Loss: 0.3021385 Vali Loss: 0.3460226 Test Loss: 0.2239503
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 3.4130473136901855
Epoch: 53, Steps: 59 | Train Loss: 0.3028851 Vali Loss: 0.3477157 Test Loss: 0.2237249
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 3.3304293155670166
Epoch: 54, Steps: 59 | Train Loss: 0.3030775 Vali Loss: 0.3459238 Test Loss: 0.2238295
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 3.3648147583007812
Epoch: 55, Steps: 59 | Train Loss: 0.3028430 Vali Loss: 0.3450481 Test Loss: 0.2237668
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 3.4995412826538086
Epoch: 56, Steps: 59 | Train Loss: 0.3029068 Vali Loss: 0.3455783 Test Loss: 0.2237036
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 3.508368492126465
Epoch: 57, Steps: 59 | Train Loss: 0.3027858 Vali Loss: 0.3456406 Test Loss: 0.2238090
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 3.365166187286377
Epoch: 58, Steps: 59 | Train Loss: 0.3031128 Vali Loss: 0.3456844 Test Loss: 0.2236237
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 3.383605480194092
Epoch: 59, Steps: 59 | Train Loss: 0.3020335 Vali Loss: 0.3455303 Test Loss: 0.2238160
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 3.241823434829712
Epoch: 60, Steps: 59 | Train Loss: 0.3027759 Vali Loss: 0.3469142 Test Loss: 0.2237909
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 3.5304973125457764
Epoch: 61, Steps: 59 | Train Loss: 0.3017969 Vali Loss: 0.3458076 Test Loss: 0.2236146
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 3.4705519676208496
Epoch: 62, Steps: 59 | Train Loss: 0.3027209 Vali Loss: 0.3469538 Test Loss: 0.2238704
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 3.6748790740966797
Epoch: 63, Steps: 59 | Train Loss: 0.3022468 Vali Loss: 0.3460843 Test Loss: 0.2236796
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 3.415675163269043
Epoch: 64, Steps: 59 | Train Loss: 0.3025191 Vali Loss: 0.3471808 Test Loss: 0.2236703
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 3.2793350219726562
Epoch: 65, Steps: 59 | Train Loss: 0.3020487 Vali Loss: 0.3474173 Test Loss: 0.2238080
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 3.445695400238037
Epoch: 66, Steps: 59 | Train Loss: 0.3024249 Vali Loss: 0.3452732 Test Loss: 0.2237063
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 3.3812012672424316
Epoch: 67, Steps: 59 | Train Loss: 0.3032660 Vali Loss: 0.3449631 Test Loss: 0.2238488
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 3.371999979019165
Epoch: 68, Steps: 59 | Train Loss: 0.3027350 Vali Loss: 0.3474205 Test Loss: 0.2238434
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 3.379039764404297
Epoch: 69, Steps: 59 | Train Loss: 0.3018215 Vali Loss: 0.3465057 Test Loss: 0.2238416
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 3.7432961463928223
Epoch: 70, Steps: 59 | Train Loss: 0.3025514 Vali Loss: 0.3457967 Test Loss: 0.2236475
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 3.498945474624634
Epoch: 71, Steps: 59 | Train Loss: 0.3028046 Vali Loss: 0.3471381 Test Loss: 0.2236952
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 3.276918888092041
Epoch: 72, Steps: 59 | Train Loss: 0.3025602 Vali Loss: 0.3463788 Test Loss: 0.2237577
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 3.362020969390869
Epoch: 73, Steps: 59 | Train Loss: 0.3027798 Vali Loss: 0.3460240 Test Loss: 0.2238695
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 3.3929522037506104
Epoch: 74, Steps: 59 | Train Loss: 0.3020802 Vali Loss: 0.3455880 Test Loss: 0.2236287
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 3.335526466369629
Epoch: 75, Steps: 59 | Train Loss: 0.3025161 Vali Loss: 0.3466197 Test Loss: 0.2235826
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 3.346445322036743
Epoch: 76, Steps: 59 | Train Loss: 0.3024983 Vali Loss: 0.3476754 Test Loss: 0.2237700
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 3.3426854610443115
Epoch: 77, Steps: 59 | Train Loss: 0.3026948 Vali Loss: 0.3464249 Test Loss: 0.2237465
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 3.6140336990356445
Epoch: 78, Steps: 59 | Train Loss: 0.3030341 Vali Loss: 0.3461394 Test Loss: 0.2236219
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 3.6915555000305176
Epoch: 79, Steps: 59 | Train Loss: 0.3032653 Vali Loss: 0.3456579 Test Loss: 0.2234694
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 3.2651102542877197
Epoch: 80, Steps: 59 | Train Loss: 0.3025012 Vali Loss: 0.3468198 Test Loss: 0.2235981
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 3.5939104557037354
Epoch: 81, Steps: 59 | Train Loss: 0.3027290 Vali Loss: 0.3476937 Test Loss: 0.2234767
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 3.3752620220184326
Epoch: 82, Steps: 59 | Train Loss: 0.3030622 Vali Loss: 0.3468348 Test Loss: 0.2237339
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 3.5157217979431152
Epoch: 83, Steps: 59 | Train Loss: 0.3029768 Vali Loss: 0.3458511 Test Loss: 0.2236645
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 3.243820905685425
Epoch: 84, Steps: 59 | Train Loss: 0.3029771 Vali Loss: 0.3470362 Test Loss: 0.2236628
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 3.5050501823425293
Epoch: 85, Steps: 59 | Train Loss: 0.3025944 Vali Loss: 0.3453501 Test Loss: 0.2234445
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 3.4983890056610107
Epoch: 86, Steps: 59 | Train Loss: 0.3027123 Vali Loss: 0.3465591 Test Loss: 0.2237884
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 3.3176732063293457
Epoch: 87, Steps: 59 | Train Loss: 0.3021938 Vali Loss: 0.3470417 Test Loss: 0.2237391
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 3.2943356037139893
Epoch: 88, Steps: 59 | Train Loss: 0.3026198 Vali Loss: 0.3470978 Test Loss: 0.2237026
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 3.1382803916931152
Epoch: 89, Steps: 59 | Train Loss: 0.3028568 Vali Loss: 0.3463321 Test Loss: 0.2238596
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 3.2336723804473877
Epoch: 90, Steps: 59 | Train Loss: 0.3030577 Vali Loss: 0.3476009 Test Loss: 0.2236715
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 3.313474178314209
Epoch: 91, Steps: 59 | Train Loss: 0.3036731 Vali Loss: 0.3471251 Test Loss: 0.2236070
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 3.3195924758911133
Epoch: 92, Steps: 59 | Train Loss: 0.3022450 Vali Loss: 0.3493661 Test Loss: 0.2237802
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 3.4392647743225098
Epoch: 93, Steps: 59 | Train Loss: 0.3028388 Vali Loss: 0.3446326 Test Loss: 0.2236754
Validation loss decreased (0.344962 --> 0.344633).  Saving model ...
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 3.568538188934326
Epoch: 94, Steps: 59 | Train Loss: 0.3026245 Vali Loss: 0.3482055 Test Loss: 0.2235537
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 3.505371332168579
Epoch: 95, Steps: 59 | Train Loss: 0.3021211 Vali Loss: 0.3471267 Test Loss: 0.2234733
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 3.7372889518737793
Epoch: 96, Steps: 59 | Train Loss: 0.3024172 Vali Loss: 0.3477965 Test Loss: 0.2235326
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 3.2553515434265137
Epoch: 97, Steps: 59 | Train Loss: 0.3031657 Vali Loss: 0.3454534 Test Loss: 0.2238578
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 3.511566162109375
Epoch: 98, Steps: 59 | Train Loss: 0.3026987 Vali Loss: 0.3470404 Test Loss: 0.2238816
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 3.532442569732666
Epoch: 99, Steps: 59 | Train Loss: 0.3024491 Vali Loss: 0.3465592 Test Loss: 0.2239271
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 3.2445151805877686
Epoch: 100, Steps: 59 | Train Loss: 0.3026210 Vali Loss: 0.3473941 Test Loss: 0.2233907
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : ETTh2_336_720_PatchTST_ETTh2_ftS_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.22367537021636963, mae:0.38273340463638306, rse:0.8488608598709106
