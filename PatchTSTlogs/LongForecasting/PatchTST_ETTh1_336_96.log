Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=4, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTh1_ftM_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 2.0264668464660645
Epoch: 1, Steps: 64 | Train Loss: 0.7409745 Vali Loss: 1.4724211 Test Loss: 0.8136704
Validation loss decreased (inf --> 1.472421).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.004640579223633
Epoch: 2, Steps: 64 | Train Loss: 0.5745882 Vali Loss: 0.8927532 Test Loss: 0.4753607
Validation loss decreased (1.472421 --> 0.892753).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 2.0235447883605957
Epoch: 3, Steps: 64 | Train Loss: 0.4583781 Vali Loss: 0.7671736 Test Loss: 0.4292049
Validation loss decreased (0.892753 --> 0.767174).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.8687548637390137
Epoch: 4, Steps: 64 | Train Loss: 0.4207649 Vali Loss: 0.7252784 Test Loss: 0.4125583
Validation loss decreased (0.767174 --> 0.725278).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.8385612964630127
Epoch: 5, Steps: 64 | Train Loss: 0.4006962 Vali Loss: 0.7067396 Test Loss: 0.4029128
Validation loss decreased (0.725278 --> 0.706740).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.875464916229248
Epoch: 6, Steps: 64 | Train Loss: 0.3898895 Vali Loss: 0.6984802 Test Loss: 0.3963423
Validation loss decreased (0.706740 --> 0.698480).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 1.9057214260101318
Epoch: 7, Steps: 64 | Train Loss: 0.3828329 Vali Loss: 0.6938562 Test Loss: 0.3916863
Validation loss decreased (0.698480 --> 0.693856).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.8707928657531738
Epoch: 8, Steps: 64 | Train Loss: 0.3780237 Vali Loss: 0.6897548 Test Loss: 0.3887233
Validation loss decreased (0.693856 --> 0.689755).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 1.7456421852111816
Epoch: 9, Steps: 64 | Train Loss: 0.3749578 Vali Loss: 0.6891225 Test Loss: 0.3861059
Validation loss decreased (0.689755 --> 0.689122).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.8490450382232666
Epoch: 10, Steps: 64 | Train Loss: 0.3720562 Vali Loss: 0.6861588 Test Loss: 0.3843188
Validation loss decreased (0.689122 --> 0.686159).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.8161125183105469
Epoch: 11, Steps: 64 | Train Loss: 0.3702342 Vali Loss: 0.6887407 Test Loss: 0.3828991
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.7925407886505127
Epoch: 12, Steps: 64 | Train Loss: 0.3689264 Vali Loss: 0.6757089 Test Loss: 0.3816176
Validation loss decreased (0.686159 --> 0.675709).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 1.7980399131774902
Epoch: 13, Steps: 64 | Train Loss: 0.3670468 Vali Loss: 0.6863027 Test Loss: 0.3805316
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 1.9474000930786133
Epoch: 14, Steps: 64 | Train Loss: 0.3663319 Vali Loss: 0.6866559 Test Loss: 0.3799920
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 1.8835139274597168
Epoch: 15, Steps: 64 | Train Loss: 0.3653381 Vali Loss: 0.6831148 Test Loss: 0.3791217
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 1.8908894062042236
Epoch: 16, Steps: 64 | Train Loss: 0.3647435 Vali Loss: 0.6808398 Test Loss: 0.3787514
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.785707712173462
Epoch: 17, Steps: 64 | Train Loss: 0.3636086 Vali Loss: 0.6836312 Test Loss: 0.3782534
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 1.9410030841827393
Epoch: 18, Steps: 64 | Train Loss: 0.3629099 Vali Loss: 0.6792331 Test Loss: 0.3776945
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 1.7524802684783936
Epoch: 19, Steps: 64 | Train Loss: 0.3626404 Vali Loss: 0.6850011 Test Loss: 0.3773962
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 1.8333661556243896
Epoch: 20, Steps: 64 | Train Loss: 0.3622839 Vali Loss: 0.6822824 Test Loss: 0.3771316
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 1.806812047958374
Epoch: 21, Steps: 64 | Train Loss: 0.3616639 Vali Loss: 0.6862922 Test Loss: 0.3769404
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.0311856269836426
Epoch: 22, Steps: 64 | Train Loss: 0.3616847 Vali Loss: 0.6819209 Test Loss: 0.3766575
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 1.782954216003418
Epoch: 23, Steps: 64 | Train Loss: 0.3612064 Vali Loss: 0.6827372 Test Loss: 0.3765081
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 1.7608325481414795
Epoch: 24, Steps: 64 | Train Loss: 0.3607934 Vali Loss: 0.6830648 Test Loss: 0.3763477
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 1.7344191074371338
Epoch: 25, Steps: 64 | Train Loss: 0.3606237 Vali Loss: 0.6783056 Test Loss: 0.3761687
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 1.7513344287872314
Epoch: 26, Steps: 64 | Train Loss: 0.3603045 Vali Loss: 0.6803613 Test Loss: 0.3761137
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.8056426048278809
Epoch: 27, Steps: 64 | Train Loss: 0.3603168 Vali Loss: 0.6810055 Test Loss: 0.3759959
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 1.7612545490264893
Epoch: 28, Steps: 64 | Train Loss: 0.3603660 Vali Loss: 0.6785893 Test Loss: 0.3758786
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 1.8523766994476318
Epoch: 29, Steps: 64 | Train Loss: 0.3596535 Vali Loss: 0.6824939 Test Loss: 0.3757362
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 1.7340466976165771
Epoch: 30, Steps: 64 | Train Loss: 0.3596217 Vali Loss: 0.6820580 Test Loss: 0.3756677
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 1.923546552658081
Epoch: 31, Steps: 64 | Train Loss: 0.3592482 Vali Loss: 0.6783150 Test Loss: 0.3755974
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.8651025295257568
Epoch: 32, Steps: 64 | Train Loss: 0.3592913 Vali Loss: 0.6797135 Test Loss: 0.3755140
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 1.8191578388214111
Epoch: 33, Steps: 64 | Train Loss: 0.3593404 Vali Loss: 0.6820282 Test Loss: 0.3754432
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 1.8060672283172607
Epoch: 34, Steps: 64 | Train Loss: 0.3596012 Vali Loss: 0.6787391 Test Loss: 0.3754706
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 2.0436179637908936
Epoch: 35, Steps: 64 | Train Loss: 0.3591747 Vali Loss: 0.6820095 Test Loss: 0.3754016
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 1.9741318225860596
Epoch: 36, Steps: 64 | Train Loss: 0.3595012 Vali Loss: 0.6797540 Test Loss: 0.3753141
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 1.8635234832763672
Epoch: 37, Steps: 64 | Train Loss: 0.3588280 Vali Loss: 0.6812189 Test Loss: 0.3752676
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 1.8265900611877441
Epoch: 38, Steps: 64 | Train Loss: 0.3589541 Vali Loss: 0.6772323 Test Loss: 0.3752266
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 1.8019580841064453
Epoch: 39, Steps: 64 | Train Loss: 0.3588180 Vali Loss: 0.6810247 Test Loss: 0.3752514
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 1.7583720684051514
Epoch: 40, Steps: 64 | Train Loss: 0.3588153 Vali Loss: 0.6818448 Test Loss: 0.3751793
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 1.8917393684387207
Epoch: 41, Steps: 64 | Train Loss: 0.3588604 Vali Loss: 0.6802655 Test Loss: 0.3751910
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 1.7582004070281982
Epoch: 42, Steps: 64 | Train Loss: 0.3587413 Vali Loss: 0.6793546 Test Loss: 0.3750923
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 1.7688548564910889
Epoch: 43, Steps: 64 | Train Loss: 0.3587018 Vali Loss: 0.6818963 Test Loss: 0.3751204
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 1.9745731353759766
Epoch: 44, Steps: 64 | Train Loss: 0.3590024 Vali Loss: 0.6787347 Test Loss: 0.3751213
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 1.861510992050171
Epoch: 45, Steps: 64 | Train Loss: 0.3584967 Vali Loss: 0.6820554 Test Loss: 0.3750937
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.80442214012146
Epoch: 46, Steps: 64 | Train Loss: 0.3586559 Vali Loss: 0.6783322 Test Loss: 0.3751070
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 1.839003324508667
Epoch: 47, Steps: 64 | Train Loss: 0.3583349 Vali Loss: 0.6809694 Test Loss: 0.3751071
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 1.8209104537963867
Epoch: 48, Steps: 64 | Train Loss: 0.3584186 Vali Loss: 0.6802174 Test Loss: 0.3750828
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 1.819213628768921
Epoch: 49, Steps: 64 | Train Loss: 0.3585370 Vali Loss: 0.6810430 Test Loss: 0.3750462
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 1.8628976345062256
Epoch: 50, Steps: 64 | Train Loss: 0.3586430 Vali Loss: 0.6760240 Test Loss: 0.3751117
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 1.750288963317871
Epoch: 51, Steps: 64 | Train Loss: 0.3587942 Vali Loss: 0.6784579 Test Loss: 0.3750316
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 1.8146247863769531
Epoch: 52, Steps: 64 | Train Loss: 0.3585421 Vali Loss: 0.6808465 Test Loss: 0.3750263
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 1.7005815505981445
Epoch: 53, Steps: 64 | Train Loss: 0.3587695 Vali Loss: 0.6774324 Test Loss: 0.3750427
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.004007577896118
Epoch: 54, Steps: 64 | Train Loss: 0.3582620 Vali Loss: 0.6769406 Test Loss: 0.3750452
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 1.8265116214752197
Epoch: 55, Steps: 64 | Train Loss: 0.3588583 Vali Loss: 0.6823708 Test Loss: 0.3750094
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 1.8035154342651367
Epoch: 56, Steps: 64 | Train Loss: 0.3584949 Vali Loss: 0.6784219 Test Loss: 0.3750260
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 1.7902021408081055
Epoch: 57, Steps: 64 | Train Loss: 0.3585577 Vali Loss: 0.6774690 Test Loss: 0.3750233
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 1.723022699356079
Epoch: 58, Steps: 64 | Train Loss: 0.3588190 Vali Loss: 0.6800881 Test Loss: 0.3749738
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 1.8000438213348389
Epoch: 59, Steps: 64 | Train Loss: 0.3583600 Vali Loss: 0.6807439 Test Loss: 0.3750142
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 1.7431161403656006
Epoch: 60, Steps: 64 | Train Loss: 0.3581757 Vali Loss: 0.6773327 Test Loss: 0.3749935
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 1.7362103462219238
Epoch: 61, Steps: 64 | Train Loss: 0.3587123 Vali Loss: 0.6820911 Test Loss: 0.3749844
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 1.7992382049560547
Epoch: 62, Steps: 64 | Train Loss: 0.3584755 Vali Loss: 0.6800841 Test Loss: 0.3749287
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 1.8125684261322021
Epoch: 63, Steps: 64 | Train Loss: 0.3587931 Vali Loss: 0.6814822 Test Loss: 0.3749441
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 1.8795459270477295
Epoch: 64, Steps: 64 | Train Loss: 0.3585227 Vali Loss: 0.6787645 Test Loss: 0.3749734
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 1.6963257789611816
Epoch: 65, Steps: 64 | Train Loss: 0.3587093 Vali Loss: 0.6766739 Test Loss: 0.3749573
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 1.8079941272735596
Epoch: 66, Steps: 64 | Train Loss: 0.3587323 Vali Loss: 0.6787557 Test Loss: 0.3750314
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 1.7851018905639648
Epoch: 67, Steps: 64 | Train Loss: 0.3581239 Vali Loss: 0.6779634 Test Loss: 0.3749870
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 1.8699328899383545
Epoch: 68, Steps: 64 | Train Loss: 0.3583205 Vali Loss: 0.6813912 Test Loss: 0.3749889
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 1.922471046447754
Epoch: 69, Steps: 64 | Train Loss: 0.3583930 Vali Loss: 0.6822816 Test Loss: 0.3750028
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 1.869028091430664
Epoch: 70, Steps: 64 | Train Loss: 0.3579484 Vali Loss: 0.6810492 Test Loss: 0.3750457
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 1.934694766998291
Epoch: 71, Steps: 64 | Train Loss: 0.3586913 Vali Loss: 0.6824698 Test Loss: 0.3750032
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 1.8230364322662354
Epoch: 72, Steps: 64 | Train Loss: 0.3585495 Vali Loss: 0.6810202 Test Loss: 0.3749625
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 1.7998709678649902
Epoch: 73, Steps: 64 | Train Loss: 0.3584543 Vali Loss: 0.6821225 Test Loss: 0.3749958
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 1.9840443134307861
Epoch: 74, Steps: 64 | Train Loss: 0.3584665 Vali Loss: 0.6817315 Test Loss: 0.3749601
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 1.840834617614746
Epoch: 75, Steps: 64 | Train Loss: 0.3586935 Vali Loss: 0.6787257 Test Loss: 0.3749659
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 1.9219489097595215
Epoch: 76, Steps: 64 | Train Loss: 0.3583857 Vali Loss: 0.6807881 Test Loss: 0.3749631
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 1.9135065078735352
Epoch: 77, Steps: 64 | Train Loss: 0.3585637 Vali Loss: 0.6786458 Test Loss: 0.3749740
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 1.7391514778137207
Epoch: 78, Steps: 64 | Train Loss: 0.3588124 Vali Loss: 0.6772600 Test Loss: 0.3749594
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 1.8116042613983154
Epoch: 79, Steps: 64 | Train Loss: 0.3590584 Vali Loss: 0.6797130 Test Loss: 0.3749441
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 1.8118445873260498
Epoch: 80, Steps: 64 | Train Loss: 0.3587444 Vali Loss: 0.6791865 Test Loss: 0.3749619
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 1.7946982383728027
Epoch: 81, Steps: 64 | Train Loss: 0.3583563 Vali Loss: 0.6802882 Test Loss: 0.3749548
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 1.828495740890503
Epoch: 82, Steps: 64 | Train Loss: 0.3586596 Vali Loss: 0.6807527 Test Loss: 0.3749867
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 1.8058459758758545
Epoch: 83, Steps: 64 | Train Loss: 0.3585004 Vali Loss: 0.6781428 Test Loss: 0.3750003
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 1.7945654392242432
Epoch: 84, Steps: 64 | Train Loss: 0.3584504 Vali Loss: 0.6840258 Test Loss: 0.3749794
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 1.865760326385498
Epoch: 85, Steps: 64 | Train Loss: 0.3582432 Vali Loss: 0.6774379 Test Loss: 0.3749881
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 2.0350167751312256
Epoch: 86, Steps: 64 | Train Loss: 0.3585210 Vali Loss: 0.6805206 Test Loss: 0.3749437
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 1.836557149887085
Epoch: 87, Steps: 64 | Train Loss: 0.3581453 Vali Loss: 0.6765093 Test Loss: 0.3749493
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 1.738332748413086
Epoch: 88, Steps: 64 | Train Loss: 0.3584843 Vali Loss: 0.6813546 Test Loss: 0.3749558
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 1.852086067199707
Epoch: 89, Steps: 64 | Train Loss: 0.3585005 Vali Loss: 0.6796605 Test Loss: 0.3749915
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 2.037454605102539
Epoch: 90, Steps: 64 | Train Loss: 0.3584041 Vali Loss: 0.6802349 Test Loss: 0.3749962
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 1.8983497619628906
Epoch: 91, Steps: 64 | Train Loss: 0.3585429 Vali Loss: 0.6783525 Test Loss: 0.3749687
EarlyStopping counter: 79 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 1.7222166061401367
Epoch: 92, Steps: 64 | Train Loss: 0.3587992 Vali Loss: 0.6785148 Test Loss: 0.3749285
EarlyStopping counter: 80 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 1.7675676345825195
Epoch: 93, Steps: 64 | Train Loss: 0.3584873 Vali Loss: 0.6813939 Test Loss: 0.3749301
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 1.7260355949401855
Epoch: 94, Steps: 64 | Train Loss: 0.3587815 Vali Loss: 0.6833804 Test Loss: 0.3749301
EarlyStopping counter: 82 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 1.7056694030761719
Epoch: 95, Steps: 64 | Train Loss: 0.3584680 Vali Loss: 0.6769458 Test Loss: 0.3749329
EarlyStopping counter: 83 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 1.7750635147094727
Epoch: 96, Steps: 64 | Train Loss: 0.3584177 Vali Loss: 0.6777112 Test Loss: 0.3749794
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 1.7580673694610596
Epoch: 97, Steps: 64 | Train Loss: 0.3583870 Vali Loss: 0.6792796 Test Loss: 0.3749695
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 1.879384994506836
Epoch: 98, Steps: 64 | Train Loss: 0.3584201 Vali Loss: 0.6801593 Test Loss: 0.3749250
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 1.7553532123565674
Epoch: 99, Steps: 64 | Train Loss: 0.3587915 Vali Loss: 0.6785399 Test Loss: 0.3749758
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 1.8286850452423096
Epoch: 100, Steps: 64 | Train Loss: 0.3585078 Vali Loss: 0.6786937 Test Loss: 0.3748972
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_96_PatchTST_ETTh1_ftM_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38161760568618774, mae:0.40508726239204407, rse:0.5857734084129333
