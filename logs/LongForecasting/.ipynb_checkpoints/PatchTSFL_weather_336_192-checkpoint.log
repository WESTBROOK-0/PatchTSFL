Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTSFL', model_id='336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_192_PatchTSFL_custom_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5940805
	speed: 0.0273s/iter; left time: 771.9134s
	iters: 200, epoch: 1 | loss: 0.8596992
	speed: 0.0095s/iter; left time: 268.1035s
Epoch: 1 cost time: 4.5852882862091064
Epoch: 1, Steps: 284 | Train Loss: 0.7023026 Vali Loss: 0.6770727 Test Loss: 0.2844032
Validation loss decreased (inf --> 0.677073).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6229047
	speed: 0.0822s/iter; left time: 2304.1635s
	iters: 200, epoch: 2 | loss: 0.6454716
	speed: 0.0095s/iter; left time: 266.2984s
Epoch: 2 cost time: 4.568166017532349
Epoch: 2, Steps: 284 | Train Loss: 0.7021819 Vali Loss: 0.6736387 Test Loss: 0.2841366
Validation loss decreased (0.677073 --> 0.673639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6453061
	speed: 0.0819s/iter; left time: 2272.3301s
	iters: 200, epoch: 3 | loss: 0.6518899
	speed: 0.0098s/iter; left time: 271.6455s
Epoch: 3 cost time: 4.350001335144043
Epoch: 3, Steps: 284 | Train Loss: 0.7021140 Vali Loss: 0.6749657 Test Loss: 0.2839956
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6888573
	speed: 0.0813s/iter; left time: 2230.9233s
	iters: 200, epoch: 4 | loss: 0.6122462
	speed: 0.0096s/iter; left time: 263.0375s
Epoch: 4 cost time: 4.438151836395264
Epoch: 4, Steps: 284 | Train Loss: 0.7020603 Vali Loss: 0.6753478 Test Loss: 0.2839397
EarlyStopping counter: 2 out of 20
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6596152
	speed: 0.0810s/iter; left time: 2200.3053s
	iters: 200, epoch: 5 | loss: 0.7215220
	speed: 0.0096s/iter; left time: 260.2032s
Epoch: 5 cost time: 4.2188122272491455
Epoch: 5, Steps: 284 | Train Loss: 0.7020296 Vali Loss: 0.6748831 Test Loss: 0.2838980
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6195857
	speed: 0.0811s/iter; left time: 2180.1689s
	iters: 200, epoch: 6 | loss: 0.6236532
	speed: 0.0095s/iter; left time: 253.5614s
Epoch: 6 cost time: 4.54408860206604
Epoch: 6, Steps: 284 | Train Loss: 0.7020233 Vali Loss: 0.6757786 Test Loss: 0.2838884
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6642997
	speed: 0.0822s/iter; left time: 2185.6411s
	iters: 200, epoch: 7 | loss: 0.6608698
	speed: 0.0094s/iter; left time: 249.8605s
Epoch: 7 cost time: 4.379986763000488
Epoch: 7, Steps: 284 | Train Loss: 0.7020548 Vali Loss: 0.6738362 Test Loss: 0.2838766
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.8321404
	speed: 0.0819s/iter; left time: 2154.7048s
	iters: 200, epoch: 8 | loss: 0.6503188
	speed: 0.0096s/iter; left time: 251.1757s
Epoch: 8 cost time: 4.362551212310791
Epoch: 8, Steps: 284 | Train Loss: 0.7020882 Vali Loss: 0.6739120 Test Loss: 0.2838665
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7041383
	speed: 0.0827s/iter; left time: 2151.9907s
	iters: 200, epoch: 9 | loss: 0.5800936
	speed: 0.0097s/iter; left time: 251.3620s
Epoch: 9 cost time: 4.537414312362671
Epoch: 9, Steps: 284 | Train Loss: 0.7020478 Vali Loss: 0.6743782 Test Loss: 0.2838603
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5996041
	speed: 0.0803s/iter; left time: 2067.9311s
	iters: 200, epoch: 10 | loss: 0.6104634
	speed: 0.0096s/iter; left time: 247.1873s
Epoch: 10 cost time: 4.329623460769653
Epoch: 10, Steps: 284 | Train Loss: 0.7020981 Vali Loss: 0.6762550 Test Loss: 0.2838620
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.8528361
	speed: 0.0821s/iter; left time: 2089.2983s
	iters: 200, epoch: 11 | loss: 0.7342989
	speed: 0.0095s/iter; left time: 242.1207s
Epoch: 11 cost time: 4.433076858520508
Epoch: 11, Steps: 284 | Train Loss: 0.7020188 Vali Loss: 0.6730405 Test Loss: 0.2838641
Validation loss decreased (0.673639 --> 0.673041).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6322904
	speed: 0.0849s/iter; left time: 2137.8877s
	iters: 200, epoch: 12 | loss: 0.6016859
	speed: 0.0093s/iter; left time: 233.2564s
Epoch: 12 cost time: 4.536667823791504
Epoch: 12, Steps: 284 | Train Loss: 0.7020488 Vali Loss: 0.6759837 Test Loss: 0.2838599
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5897369
	speed: 0.0851s/iter; left time: 2118.3762s
	iters: 200, epoch: 13 | loss: 0.6705761
	speed: 0.0095s/iter; left time: 234.3022s
Epoch: 13 cost time: 4.560326337814331
Epoch: 13, Steps: 284 | Train Loss: 0.7020743 Vali Loss: 0.6731460 Test Loss: 0.2838603
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7055789
	speed: 0.0826s/iter; left time: 2031.5297s
	iters: 200, epoch: 14 | loss: 0.7883224
	speed: 0.0095s/iter; left time: 233.5486s
Epoch: 14 cost time: 4.345773458480835
Epoch: 14, Steps: 284 | Train Loss: 0.7020386 Vali Loss: 0.6725751 Test Loss: 0.2838603
Validation loss decreased (0.673041 --> 0.672575).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6546734
	speed: 0.0852s/iter; left time: 2073.5191s
	iters: 200, epoch: 15 | loss: 0.5889946
	speed: 0.0099s/iter; left time: 240.4919s
Epoch: 15 cost time: 4.708632946014404
Epoch: 15, Steps: 284 | Train Loss: 0.7020454 Vali Loss: 0.6741778 Test Loss: 0.2838581
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.9512247
	speed: 0.0871s/iter; left time: 2094.1851s
	iters: 200, epoch: 16 | loss: 0.8944280
	speed: 0.0105s/iter; left time: 251.1305s
Epoch: 16 cost time: 4.763125658035278
Epoch: 16, Steps: 284 | Train Loss: 0.7016191 Vali Loss: 0.6724094 Test Loss: 0.2838580
Validation loss decreased (0.672575 --> 0.672409).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6498588
	speed: 0.0865s/iter; left time: 2055.0165s
	iters: 200, epoch: 17 | loss: 0.5508761
	speed: 0.0105s/iter; left time: 247.8656s
Epoch: 17 cost time: 4.796888113021851
Epoch: 17, Steps: 284 | Train Loss: 0.7020728 Vali Loss: 0.6751899 Test Loss: 0.2838575
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.8323864
	speed: 0.0899s/iter; left time: 2110.8604s
	iters: 200, epoch: 18 | loss: 0.6101995
	speed: 0.0103s/iter; left time: 240.6857s
Epoch: 18 cost time: 5.013598918914795
Epoch: 18, Steps: 284 | Train Loss: 0.7020659 Vali Loss: 0.6735809 Test Loss: 0.2838553
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6234905
	speed: 0.0911s/iter; left time: 2111.6608s
	iters: 200, epoch: 19 | loss: 0.8500714
	speed: 0.0102s/iter; left time: 236.2227s
Epoch: 19 cost time: 4.7109153270721436
Epoch: 19, Steps: 284 | Train Loss: 0.7016470 Vali Loss: 0.6753035 Test Loss: 0.2838548
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.5905808
	speed: 0.0855s/iter; left time: 1957.4973s
	iters: 200, epoch: 20 | loss: 0.7545599
	speed: 0.0103s/iter; left time: 233.8976s
Epoch: 20 cost time: 4.62019157409668
Epoch: 20, Steps: 284 | Train Loss: 0.7019934 Vali Loss: 0.6739237 Test Loss: 0.2838550
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.7693173
	speed: 0.0869s/iter; left time: 1966.2100s
	iters: 200, epoch: 21 | loss: 0.5853210
	speed: 0.0101s/iter; left time: 227.9072s
Epoch: 21 cost time: 4.7904276847839355
Epoch: 21, Steps: 284 | Train Loss: 0.7020758 Vali Loss: 0.6720053 Test Loss: 0.2838525
Validation loss decreased (0.672409 --> 0.672005).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7965550
	speed: 0.0930s/iter; left time: 2076.3932s
	iters: 200, epoch: 22 | loss: 0.7059415
	speed: 0.0102s/iter; left time: 226.6492s
Epoch: 22 cost time: 5.046480655670166
Epoch: 22, Steps: 284 | Train Loss: 0.7020458 Vali Loss: 0.6747583 Test Loss: 0.2838546
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.7142843
	speed: 0.0897s/iter; left time: 1978.3549s
	iters: 200, epoch: 23 | loss: 0.5956740
	speed: 0.0102s/iter; left time: 223.5250s
Epoch: 23 cost time: 4.819408893585205
Epoch: 23, Steps: 284 | Train Loss: 0.7020628 Vali Loss: 0.6739596 Test Loss: 0.2838555
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6573032
	speed: 0.1005s/iter; left time: 2187.7960s
	iters: 200, epoch: 24 | loss: 0.7688000
	speed: 0.0103s/iter; left time: 222.8591s
Epoch: 24 cost time: 5.107047080993652
Epoch: 24, Steps: 284 | Train Loss: 0.7020390 Vali Loss: 0.6740763 Test Loss: 0.2838542
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6675213
	speed: 0.0884s/iter; left time: 1898.8043s
	iters: 200, epoch: 25 | loss: 0.5858628
	speed: 0.0100s/iter; left time: 214.1153s
Epoch: 25 cost time: 4.667972564697266
Epoch: 25, Steps: 284 | Train Loss: 0.7020278 Vali Loss: 0.6758345 Test Loss: 0.2838543
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.7627733
	speed: 0.0837s/iter; left time: 1774.4843s
	iters: 200, epoch: 26 | loss: 0.7201729
	speed: 0.0101s/iter; left time: 212.9930s
Epoch: 26 cost time: 4.5503668785095215
Epoch: 26, Steps: 284 | Train Loss: 0.7020437 Vali Loss: 0.6735863 Test Loss: 0.2838537
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6513469
	speed: 0.0900s/iter; left time: 1882.3973s
	iters: 200, epoch: 27 | loss: 0.8538414
	speed: 0.0101s/iter; left time: 209.3715s
Epoch: 27 cost time: 4.635976314544678
Epoch: 27, Steps: 284 | Train Loss: 0.7020661 Vali Loss: 0.6729004 Test Loss: 0.2838539
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.7079473
	speed: 0.0874s/iter; left time: 1803.2551s
	iters: 200, epoch: 28 | loss: 0.5882415
	speed: 0.0103s/iter; left time: 212.0792s
Epoch: 28 cost time: 4.707676887512207
Epoch: 28, Steps: 284 | Train Loss: 0.7020326 Vali Loss: 0.6738093 Test Loss: 0.2838541
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6784402
	speed: 0.0837s/iter; left time: 1704.2034s
	iters: 200, epoch: 29 | loss: 0.9290819
	speed: 0.0104s/iter; left time: 209.8820s
Epoch: 29 cost time: 4.621045351028442
Epoch: 29, Steps: 284 | Train Loss: 0.7020671 Vali Loss: 0.6724170 Test Loss: 0.2838539
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6940693
	speed: 0.0915s/iter; left time: 1836.0757s
	iters: 200, epoch: 30 | loss: 0.6245774
	speed: 0.0098s/iter; left time: 196.4111s
Epoch: 30 cost time: 4.641420125961304
Epoch: 30, Steps: 284 | Train Loss: 0.7020796 Vali Loss: 0.6747358 Test Loss: 0.2838538
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.7059652
	speed: 0.0918s/iter; left time: 1816.0868s
	iters: 200, epoch: 31 | loss: 0.7539843
	speed: 0.0101s/iter; left time: 198.4166s
Epoch: 31 cost time: 4.814913749694824
Epoch: 31, Steps: 284 | Train Loss: 0.7020859 Vali Loss: 0.6739388 Test Loss: 0.2838537
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6952500
	speed: 0.0904s/iter; left time: 1761.8029s
	iters: 200, epoch: 32 | loss: 0.6925149
	speed: 0.0101s/iter; left time: 195.0890s
Epoch: 32 cost time: 4.610088348388672
Epoch: 32, Steps: 284 | Train Loss: 0.7020623 Vali Loss: 0.6751422 Test Loss: 0.2838539
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.7233195
	speed: 0.0842s/iter; left time: 1616.8497s
	iters: 200, epoch: 33 | loss: 0.5556019
	speed: 0.0096s/iter; left time: 184.2356s
Epoch: 33 cost time: 4.541649580001831
Epoch: 33, Steps: 284 | Train Loss: 0.7019825 Vali Loss: 0.6743239 Test Loss: 0.2838538
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.6203018
	speed: 0.0807s/iter; left time: 1526.9361s
	iters: 200, epoch: 34 | loss: 0.6373472
	speed: 0.0096s/iter; left time: 180.7039s
Epoch: 34 cost time: 4.444555044174194
Epoch: 34, Steps: 284 | Train Loss: 0.7020519 Vali Loss: 0.6754153 Test Loss: 0.2838533
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.8232857
	speed: 0.0844s/iter; left time: 1573.6937s
	iters: 200, epoch: 35 | loss: 0.5848458
	speed: 0.0095s/iter; left time: 176.8455s
Epoch: 35 cost time: 4.69684624671936
Epoch: 35, Steps: 284 | Train Loss: 0.7017007 Vali Loss: 0.6763824 Test Loss: 0.2838535
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6794024
	speed: 0.0800s/iter; left time: 1468.9113s
	iters: 200, epoch: 36 | loss: 0.9028785
	speed: 0.0095s/iter; left time: 174.2984s
Epoch: 36 cost time: 4.340693712234497
Epoch: 36, Steps: 284 | Train Loss: 0.7020764 Vali Loss: 0.6746675 Test Loss: 0.2838538
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.5973303
	speed: 0.0873s/iter; left time: 1577.4388s
	iters: 200, epoch: 37 | loss: 0.8331616
	speed: 0.0106s/iter; left time: 191.1576s
Epoch: 37 cost time: 4.748837471008301
Epoch: 37, Steps: 284 | Train Loss: 0.7020983 Vali Loss: 0.6760683 Test Loss: 0.2838538
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.7441229
	speed: 0.0892s/iter; left time: 1587.6584s
	iters: 200, epoch: 38 | loss: 0.7115034
	speed: 0.0107s/iter; left time: 189.6084s
Epoch: 38 cost time: 4.958271741867065
Epoch: 38, Steps: 284 | Train Loss: 0.7020626 Vali Loss: 0.6745204 Test Loss: 0.2838538
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.6046418
	speed: 0.0895s/iter; left time: 1567.2248s
	iters: 200, epoch: 39 | loss: 0.5551097
	speed: 0.0100s/iter; left time: 174.1875s
Epoch: 39 cost time: 4.852449417114258
Epoch: 39, Steps: 284 | Train Loss: 0.7020757 Vali Loss: 0.6755931 Test Loss: 0.2838534
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7022789
	speed: 0.0822s/iter; left time: 1416.2134s
	iters: 200, epoch: 40 | loss: 0.6436310
	speed: 0.0099s/iter; left time: 169.5538s
Epoch: 40 cost time: 4.536208152770996
Epoch: 40, Steps: 284 | Train Loss: 0.7020295 Vali Loss: 0.6752642 Test Loss: 0.2838536
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.7778718
	speed: 0.0873s/iter; left time: 1478.2998s
	iters: 200, epoch: 41 | loss: 0.6006458
	speed: 0.0094s/iter; left time: 157.8119s
Epoch: 41 cost time: 5.046800374984741
Epoch: 41, Steps: 284 | Train Loss: 0.7020954 Vali Loss: 0.6728908 Test Loss: 0.2838534
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTSFL_custom_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2838525176048279, mae:0.3274291157722473, rse:0.7009098529815674
