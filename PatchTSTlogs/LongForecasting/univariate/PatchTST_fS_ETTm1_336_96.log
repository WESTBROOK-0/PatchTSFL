Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm1_336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_96_PatchTST_ETTm1_ftS_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1358990
	speed: 0.0378s/iter; left time: 1002.5620s
	iters: 200, epoch: 1 | loss: 0.0855954
	speed: 0.0178s/iter; left time: 468.6795s
Epoch: 1 cost time: 6.884821176528931
Epoch: 1, Steps: 266 | Train Loss: 0.1356956 Vali Loss: 0.0637178 Test Loss: 0.0323949
Validation loss decreased (inf --> 0.063718).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.1047687
	speed: 0.1125s/iter; left time: 2952.1284s
	iters: 200, epoch: 2 | loss: 0.0877356
	speed: 0.0204s/iter; left time: 532.5576s
Epoch: 2 cost time: 7.878685235977173
Epoch: 2, Steps: 266 | Train Loss: 0.1030496 Vali Loss: 0.0573261 Test Loss: 0.0291994
Validation loss decreased (0.063718 --> 0.057326).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.0850042
	speed: 0.1089s/iter; left time: 2828.7375s
	iters: 200, epoch: 3 | loss: 0.0845979
	speed: 0.0179s/iter; left time: 463.1017s
Epoch: 3 cost time: 7.105947971343994
Epoch: 3, Steps: 266 | Train Loss: 0.0938727 Vali Loss: 0.0544188 Test Loss: 0.0275484
Validation loss decreased (0.057326 --> 0.054419).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.0864651
	speed: 0.1079s/iter; left time: 2773.8162s
	iters: 200, epoch: 4 | loss: 0.0878491
	speed: 0.0181s/iter; left time: 463.4101s
Epoch: 4 cost time: 6.998382806777954
Epoch: 4, Steps: 266 | Train Loss: 0.0889239 Vali Loss: 0.0532249 Test Loss: 0.0266834
Validation loss decreased (0.054419 --> 0.053225).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.0766887
	speed: 0.1062s/iter; left time: 2700.3559s
	iters: 200, epoch: 5 | loss: 0.0797015
	speed: 0.0179s/iter; left time: 454.1744s
Epoch: 5 cost time: 6.934584856033325
Epoch: 5, Steps: 266 | Train Loss: 0.0860035 Vali Loss: 0.0523703 Test Loss: 0.0263072
Validation loss decreased (0.053225 --> 0.052370).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.0866856
	speed: 0.1101s/iter; left time: 2771.6510s
	iters: 200, epoch: 6 | loss: 0.0730058
	speed: 0.0179s/iter; left time: 447.5428s
Epoch: 6 cost time: 7.351168155670166
Epoch: 6, Steps: 266 | Train Loss: 0.0842918 Vali Loss: 0.0521741 Test Loss: 0.0260727
Validation loss decreased (0.052370 --> 0.052174).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.0741312
	speed: 0.1079s/iter; left time: 2687.1248s
	iters: 200, epoch: 7 | loss: 0.0884930
	speed: 0.0190s/iter; left time: 471.8129s
Epoch: 7 cost time: 7.186216115951538
Epoch: 7, Steps: 266 | Train Loss: 0.0831349 Vali Loss: 0.0518370 Test Loss: 0.0257679
Validation loss decreased (0.052174 --> 0.051837).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.0840537
	speed: 0.1080s/iter; left time: 2660.5455s
	iters: 200, epoch: 8 | loss: 0.0810975
	speed: 0.0168s/iter; left time: 411.9784s
Epoch: 8 cost time: 6.654190301895142
Epoch: 8, Steps: 266 | Train Loss: 0.0822303 Vali Loss: 0.0517930 Test Loss: 0.0257205
Validation loss decreased (0.051837 --> 0.051793).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.1033651
	speed: 0.1078s/iter; left time: 2627.5115s
	iters: 200, epoch: 9 | loss: 0.0989517
	speed: 0.0181s/iter; left time: 438.6732s
Epoch: 9 cost time: 6.93235445022583
Epoch: 9, Steps: 266 | Train Loss: 0.0815802 Vali Loss: 0.0518424 Test Loss: 0.0257960
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.0702337
	speed: 0.1132s/iter; left time: 2729.3480s
	iters: 200, epoch: 10 | loss: 0.0699089
	speed: 0.0191s/iter; left time: 458.2254s
Epoch: 10 cost time: 7.448124170303345
Epoch: 10, Steps: 266 | Train Loss: 0.0810230 Vali Loss: 0.0513886 Test Loss: 0.0257843
Validation loss decreased (0.051793 --> 0.051389).  Saving model ...
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.0930471
	speed: 0.1125s/iter; left time: 2682.8557s
	iters: 200, epoch: 11 | loss: 0.0675796
	speed: 0.0182s/iter; left time: 431.3373s
Epoch: 11 cost time: 7.217442512512207
Epoch: 11, Steps: 266 | Train Loss: 0.0807365 Vali Loss: 0.0519587 Test Loss: 0.0259477
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.0928209
	speed: 0.1091s/iter; left time: 2572.7200s
	iters: 200, epoch: 12 | loss: 0.0905907
	speed: 0.0174s/iter; left time: 408.7829s
Epoch: 12 cost time: 7.03620171546936
Epoch: 12, Steps: 266 | Train Loss: 0.0802866 Vali Loss: 0.0520586 Test Loss: 0.0256229
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.0723329
	speed: 0.1074s/iter; left time: 2503.2591s
	iters: 200, epoch: 13 | loss: 0.0593105
	speed: 0.0177s/iter; left time: 410.8936s
Epoch: 13 cost time: 7.007625102996826
Epoch: 13, Steps: 266 | Train Loss: 0.0795325 Vali Loss: 0.0521486 Test Loss: 0.0257709
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.0833983
	speed: 0.1068s/iter; left time: 2461.9098s
	iters: 200, epoch: 14 | loss: 0.0827371
	speed: 0.0179s/iter; left time: 409.9628s
Epoch: 14 cost time: 6.958287000656128
Epoch: 14, Steps: 266 | Train Loss: 0.0788996 Vali Loss: 0.0522398 Test Loss: 0.0258362
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.0713238
	speed: 0.1120s/iter; left time: 2551.7409s
	iters: 200, epoch: 15 | loss: 0.0699532
	speed: 0.0178s/iter; left time: 404.5552s
Epoch: 15 cost time: 7.325933456420898
Epoch: 15, Steps: 266 | Train Loss: 0.0779244 Vali Loss: 0.0524442 Test Loss: 0.0258746
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.0801321
	speed: 0.1101s/iter; left time: 2478.8892s
	iters: 200, epoch: 16 | loss: 0.0853284
	speed: 0.0183s/iter; left time: 410.2232s
Epoch: 16 cost time: 7.317517518997192
Epoch: 16, Steps: 266 | Train Loss: 0.0771343 Vali Loss: 0.0528831 Test Loss: 0.0258414
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.0970044
	speed: 0.1141s/iter; left time: 2538.0399s
	iters: 200, epoch: 17 | loss: 0.0792069
	speed: 0.0180s/iter; left time: 398.3419s
Epoch: 17 cost time: 7.1725640296936035
Epoch: 17, Steps: 266 | Train Loss: 0.0763885 Vali Loss: 0.0536023 Test Loss: 0.0261260
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.0954048
	speed: 0.1072s/iter; left time: 2356.1040s
	iters: 200, epoch: 18 | loss: 0.0786020
	speed: 0.0179s/iter; left time: 391.3199s
Epoch: 18 cost time: 6.957467079162598
Epoch: 18, Steps: 266 | Train Loss: 0.0751376 Vali Loss: 0.0531926 Test Loss: 0.0261857
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.0658079
	speed: 0.1068s/iter; left time: 2319.3874s
	iters: 200, epoch: 19 | loss: 0.0849683
	speed: 0.0180s/iter; left time: 389.4650s
Epoch: 19 cost time: 7.003403663635254
Epoch: 19, Steps: 266 | Train Loss: 0.0735480 Vali Loss: 0.0539546 Test Loss: 0.0269615
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.0979937
	speed: 0.1087s/iter; left time: 2332.3476s
	iters: 200, epoch: 20 | loss: 0.0763490
	speed: 0.0177s/iter; left time: 377.8637s
Epoch: 20 cost time: 7.15916109085083
Epoch: 20, Steps: 266 | Train Loss: 0.0717383 Vali Loss: 0.0536131 Test Loss: 0.0265430
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.0706984
	speed: 0.1101s/iter; left time: 2331.2535s
	iters: 200, epoch: 21 | loss: 0.0695569
	speed: 0.0192s/iter; left time: 404.1633s
Epoch: 21 cost time: 7.37933611869812
Epoch: 21, Steps: 266 | Train Loss: 0.0699314 Vali Loss: 0.0544233 Test Loss: 0.0273451
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.0649077
	speed: 0.1069s/iter; left time: 2235.3798s
	iters: 200, epoch: 22 | loss: 0.0706519
	speed: 0.0198s/iter; left time: 411.3762s
Epoch: 22 cost time: 7.23699951171875
Epoch: 22, Steps: 266 | Train Loss: 0.0679212 Vali Loss: 0.0554894 Test Loss: 0.0276727
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.0862211
	speed: 0.1088s/iter; left time: 2246.2051s
	iters: 200, epoch: 23 | loss: 0.0627026
	speed: 0.0176s/iter; left time: 362.3419s
Epoch: 23 cost time: 7.051947832107544
Epoch: 23, Steps: 266 | Train Loss: 0.0662069 Vali Loss: 0.0561661 Test Loss: 0.0284001
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.0592098
	speed: 0.1082s/iter; left time: 2204.4534s
	iters: 200, epoch: 24 | loss: 0.0604006
	speed: 0.0173s/iter; left time: 350.5328s
Epoch: 24 cost time: 6.854543685913086
Epoch: 24, Steps: 266 | Train Loss: 0.0643704 Vali Loss: 0.0576114 Test Loss: 0.0285982
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.0695527
	speed: 0.1108s/iter; left time: 2228.4225s
	iters: 200, epoch: 25 | loss: 0.0627079
	speed: 0.0182s/iter; left time: 364.3993s
Epoch: 25 cost time: 7.381840467453003
Epoch: 25, Steps: 266 | Train Loss: 0.0628328 Vali Loss: 0.0582502 Test Loss: 0.0284725
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.0646363
	speed: 0.1115s/iter; left time: 2213.0482s
	iters: 200, epoch: 26 | loss: 0.0691810
	speed: 0.0189s/iter; left time: 374.2071s
Epoch: 26 cost time: 7.304741382598877
Epoch: 26, Steps: 266 | Train Loss: 0.0608128 Vali Loss: 0.0616928 Test Loss: 0.0289777
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.0644460
	speed: 0.1087s/iter; left time: 2127.9753s
	iters: 200, epoch: 27 | loss: 0.0491810
	speed: 0.0179s/iter; left time: 347.8075s
Epoch: 27 cost time: 7.0468456745147705
Epoch: 27, Steps: 266 | Train Loss: 0.0592144 Vali Loss: 0.0614493 Test Loss: 0.0285164
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.0586756
	speed: 0.1062s/iter; left time: 2051.8507s
	iters: 200, epoch: 28 | loss: 0.0585079
	speed: 0.0179s/iter; left time: 344.0091s
Epoch: 28 cost time: 6.893489599227905
Epoch: 28, Steps: 266 | Train Loss: 0.0574146 Vali Loss: 0.0633510 Test Loss: 0.0295701
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.0595366
	speed: 0.1078s/iter; left time: 2054.2548s
	iters: 200, epoch: 29 | loss: 0.0637379
	speed: 0.0179s/iter; left time: 338.5767s
Epoch: 29 cost time: 6.872365236282349
Epoch: 29, Steps: 266 | Train Loss: 0.0555899 Vali Loss: 0.0645051 Test Loss: 0.0294760
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.0636880
	speed: 0.1096s/iter; left time: 2059.9010s
	iters: 200, epoch: 30 | loss: 0.0435925
	speed: 0.0188s/iter; left time: 351.1910s
Epoch: 30 cost time: 7.20167350769043
Epoch: 30, Steps: 266 | Train Loss: 0.0539682 Vali Loss: 0.0635489 Test Loss: 0.0298057
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_96_PatchTST_ETTm1_ftS_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.025784341618418694, mae:0.12117908895015717, rse:0.4702073335647583
