Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='electricity_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_96_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 1.2751112
	speed: 0.0543s/iter; left time: 23900.9171s
	iters: 200, epoch: 1 | loss: 1.0784931
	speed: 0.0354s/iter; left time: 15548.9051s
	iters: 300, epoch: 1 | loss: 1.0771168
	speed: 0.0352s/iter; left time: 15456.2780s
	iters: 400, epoch: 1 | loss: 0.9697364
	speed: 0.0342s/iter; left time: 15018.7753s
	iters: 500, epoch: 1 | loss: 1.0454233
	speed: 0.0347s/iter; left time: 15238.2106s
	iters: 600, epoch: 1 | loss: 0.8851605
	speed: 0.0343s/iter; left time: 15082.2029s
	iters: 700, epoch: 1 | loss: 1.0444914
	speed: 0.0346s/iter; left time: 15215.1896s
	iters: 800, epoch: 1 | loss: 1.0125498
	speed: 0.0343s/iter; left time: 15040.8872s
	iters: 900, epoch: 1 | loss: 0.9019936
	speed: 0.0340s/iter; left time: 14938.0333s
	iters: 1000, epoch: 1 | loss: 0.9589309
	speed: 0.0340s/iter; left time: 14917.3510s
	iters: 1100, epoch: 1 | loss: 0.9110717
	speed: 0.0342s/iter; left time: 15011.6898s
	iters: 1200, epoch: 1 | loss: 0.8172016
	speed: 0.0341s/iter; left time: 14954.7959s
	iters: 1300, epoch: 1 | loss: 0.9407648
	speed: 0.0342s/iter; left time: 14986.7162s
	iters: 1400, epoch: 1 | loss: 0.8718946
	speed: 0.0347s/iter; left time: 15205.1559s
	iters: 1500, epoch: 1 | loss: 0.8989697
	speed: 0.0349s/iter; left time: 15309.6689s
	iters: 1600, epoch: 1 | loss: 0.8345289
	speed: 0.0358s/iter; left time: 15678.4767s
	iters: 1700, epoch: 1 | loss: 0.8185278
	speed: 0.0364s/iter; left time: 15929.8391s
	iters: 1800, epoch: 1 | loss: 1.0157688
	speed: 0.0381s/iter; left time: 16683.4662s
	iters: 1900, epoch: 1 | loss: 0.9402425
	speed: 0.0428s/iter; left time: 18733.3569s
	iters: 2000, epoch: 1 | loss: 0.8586156
	speed: 0.0370s/iter; left time: 16185.5073s
	iters: 2100, epoch: 1 | loss: 0.9900680
	speed: 0.0365s/iter; left time: 15968.6236s
	iters: 2200, epoch: 1 | loss: 0.9613716
	speed: 0.0377s/iter; left time: 16503.5525s
	iters: 2300, epoch: 1 | loss: 0.9140799
	speed: 0.0376s/iter; left time: 16449.5544s
	iters: 2400, epoch: 1 | loss: 0.9551945
	speed: 0.0371s/iter; left time: 16243.5863s
	iters: 2500, epoch: 1 | loss: 0.8050956
	speed: 0.0371s/iter; left time: 16211.1973s
	iters: 2600, epoch: 1 | loss: 0.9490036
	speed: 0.0371s/iter; left time: 16214.8935s
	iters: 2700, epoch: 1 | loss: 0.8663810
	speed: 0.0379s/iter; left time: 16590.2408s
	iters: 2800, epoch: 1 | loss: 0.7939557
	speed: 0.0372s/iter; left time: 16273.0214s
	iters: 2900, epoch: 1 | loss: 0.8142774
	speed: 0.0363s/iter; left time: 15877.2451s
	iters: 3000, epoch: 1 | loss: 1.0281607
	speed: 0.0363s/iter; left time: 15842.8049s
	iters: 3100, epoch: 1 | loss: 0.8036496
	speed: 0.0373s/iter; left time: 16275.7409s
	iters: 3200, epoch: 1 | loss: 0.8420783
	speed: 0.0384s/iter; left time: 16780.8969s
	iters: 3300, epoch: 1 | loss: 0.9759675
	speed: 0.0370s/iter; left time: 16175.4328s
	iters: 3400, epoch: 1 | loss: 0.8244799
	speed: 0.0376s/iter; left time: 16423.4419s
	iters: 3500, epoch: 1 | loss: 0.7854604
	speed: 0.0375s/iter; left time: 16364.1354s
	iters: 3600, epoch: 1 | loss: 0.9081842
	speed: 0.0383s/iter; left time: 16708.7635s
	iters: 3700, epoch: 1 | loss: 0.7850586
	speed: 0.0377s/iter; left time: 16465.8373s
	iters: 3800, epoch: 1 | loss: 0.9442349
	speed: 0.0368s/iter; left time: 16049.8480s
	iters: 3900, epoch: 1 | loss: 0.8858535
	speed: 0.0366s/iter; left time: 15960.5289s
	iters: 4000, epoch: 1 | loss: 0.8790357
	speed: 0.0369s/iter; left time: 16104.3841s
	iters: 4100, epoch: 1 | loss: 0.8886040
	speed: 0.0374s/iter; left time: 16293.0152s
	iters: 4200, epoch: 1 | loss: 0.8419166
	speed: 0.0373s/iter; left time: 16249.4753s
	iters: 4300, epoch: 1 | loss: 0.8804120
	speed: 0.0379s/iter; left time: 16509.2819s
Epoch: 1 cost time: 162.56303310394287
Epoch: 1, Steps: 4399 | Train Loss: 0.9072328 Vali Loss: 0.7833232 Test Loss: 0.9166784
Validation loss decreased (inf --> 0.783323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8246648
	speed: 0.4074s/iter; left time: 177403.7316s
	iters: 200, epoch: 2 | loss: 0.7180521
	speed: 0.0362s/iter; left time: 15749.8793s
	iters: 300, epoch: 2 | loss: 0.7856032
	speed: 0.0365s/iter; left time: 15868.4430s
	iters: 400, epoch: 2 | loss: 0.7996961
	speed: 0.0365s/iter; left time: 15883.6685s
	iters: 500, epoch: 2 | loss: 0.7513618
	speed: 0.0365s/iter; left time: 15862.8836s
	iters: 600, epoch: 2 | loss: 0.7731935
	speed: 0.0374s/iter; left time: 16263.4612s
	iters: 700, epoch: 2 | loss: 0.7203154
	speed: 0.0370s/iter; left time: 16107.6867s
	iters: 800, epoch: 2 | loss: 0.9648881
	speed: 0.0378s/iter; left time: 16443.9485s
	iters: 900, epoch: 2 | loss: 0.8431606
	speed: 0.0376s/iter; left time: 16349.3442s
	iters: 1000, epoch: 2 | loss: 0.8425411
	speed: 0.0359s/iter; left time: 15619.8405s
	iters: 1100, epoch: 2 | loss: 0.8830464
	speed: 0.0356s/iter; left time: 15446.8680s
	iters: 1200, epoch: 2 | loss: 0.6999859
	speed: 0.0358s/iter; left time: 15553.4619s
	iters: 1300, epoch: 2 | loss: 0.8022463
	speed: 0.0360s/iter; left time: 15629.7757s
	iters: 1400, epoch: 2 | loss: 0.7456780
	speed: 0.0353s/iter; left time: 15332.6123s
	iters: 1500, epoch: 2 | loss: 0.7948157
	speed: 0.0346s/iter; left time: 15009.7932s
	iters: 1600, epoch: 2 | loss: 0.8959876
	speed: 0.0347s/iter; left time: 15035.2460s
	iters: 1700, epoch: 2 | loss: 0.6027629
	speed: 0.0357s/iter; left time: 15491.8683s
	iters: 1800, epoch: 2 | loss: 0.5990445
	speed: 0.0359s/iter; left time: 15559.8062s
	iters: 1900, epoch: 2 | loss: 0.6624599
	speed: 0.0363s/iter; left time: 15738.4371s
	iters: 2000, epoch: 2 | loss: 0.5020127
	speed: 0.0365s/iter; left time: 15806.9047s
	iters: 2100, epoch: 2 | loss: 0.5264436
	speed: 0.0372s/iter; left time: 16118.5577s
	iters: 2200, epoch: 2 | loss: 0.4087692
	speed: 0.0375s/iter; left time: 16231.0128s
	iters: 2300, epoch: 2 | loss: 0.4852549
	speed: 0.0378s/iter; left time: 16371.3545s
	iters: 2400, epoch: 2 | loss: 0.3193552
	speed: 0.0373s/iter; left time: 16148.5845s
	iters: 2500, epoch: 2 | loss: 0.3335362
	speed: 0.0366s/iter; left time: 15848.5911s
	iters: 2600, epoch: 2 | loss: 0.2808304
	speed: 0.0371s/iter; left time: 16053.3673s
	iters: 2700, epoch: 2 | loss: 0.2524220
	speed: 0.0372s/iter; left time: 16111.7070s
	iters: 2800, epoch: 2 | loss: 0.2733713
	speed: 0.0364s/iter; left time: 15770.4610s
	iters: 2900, epoch: 2 | loss: 0.2659225
	speed: 0.0374s/iter; left time: 16179.2158s
	iters: 3000, epoch: 2 | loss: 0.2289726
	speed: 0.0396s/iter; left time: 17138.0252s
	iters: 3100, epoch: 2 | loss: 0.2630974
	speed: 0.0367s/iter; left time: 15874.8578s
	iters: 3200, epoch: 2 | loss: 0.2271615
	speed: 0.0374s/iter; left time: 16168.1124s
	iters: 3300, epoch: 2 | loss: 0.2665188
	speed: 0.0378s/iter; left time: 16353.7268s
	iters: 3400, epoch: 2 | loss: 0.2487553
	speed: 0.0373s/iter; left time: 16127.4688s
	iters: 3500, epoch: 2 | loss: 0.2749624
	speed: 0.0383s/iter; left time: 16526.3220s
	iters: 3600, epoch: 2 | loss: 0.2230383
	speed: 0.0375s/iter; left time: 16209.8979s
	iters: 3700, epoch: 2 | loss: 0.2016797
	speed: 0.0369s/iter; left time: 15949.0693s
	iters: 3800, epoch: 2 | loss: 0.2648442
	speed: 0.0373s/iter; left time: 16121.5239s
	iters: 3900, epoch: 2 | loss: 0.3038953
	speed: 0.0371s/iter; left time: 16010.6665s
	iters: 4000, epoch: 2 | loss: 0.2098831
	speed: 0.0373s/iter; left time: 16103.5553s
	iters: 4100, epoch: 2 | loss: 0.2204946
	speed: 0.0373s/iter; left time: 16092.0321s
	iters: 4200, epoch: 2 | loss: 0.2436830
	speed: 0.0377s/iter; left time: 16266.6624s
	iters: 4300, epoch: 2 | loss: 0.2367981
	speed: 0.0374s/iter; left time: 16125.9905s
Epoch: 2 cost time: 164.0144979953766
Epoch: 2, Steps: 4399 | Train Loss: 0.5124567 Vali Loss: 0.3148935 Test Loss: 0.3571652
Validation loss decreased (0.783323 --> 0.314893).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1936318
	speed: 0.4059s/iter; left time: 174929.2460s
	iters: 200, epoch: 3 | loss: 0.2224961
	speed: 0.0359s/iter; left time: 15455.9087s
	iters: 300, epoch: 3 | loss: 0.1989235
	speed: 0.0357s/iter; left time: 15394.3720s
	iters: 400, epoch: 3 | loss: 0.2509293
	speed: 0.0358s/iter; left time: 15416.2723s
	iters: 500, epoch: 3 | loss: 0.2476936
	speed: 0.0355s/iter; left time: 15294.8873s
	iters: 600, epoch: 3 | loss: 0.2028503
	speed: 0.0358s/iter; left time: 15391.4565s
	iters: 700, epoch: 3 | loss: 0.1856405
	speed: 0.0361s/iter; left time: 15540.9137s
	iters: 800, epoch: 3 | loss: 0.2026092
	speed: 0.0357s/iter; left time: 15380.3214s
	iters: 900, epoch: 3 | loss: 0.1982877
	speed: 0.0358s/iter; left time: 15399.9327s
	iters: 1000, epoch: 3 | loss: 0.1845394
	speed: 0.0363s/iter; left time: 15604.5533s
	iters: 1100, epoch: 3 | loss: 0.1767277
	speed: 0.0364s/iter; left time: 15657.7124s
	iters: 1200, epoch: 3 | loss: 0.2416196
	speed: 0.0368s/iter; left time: 15827.5286s
	iters: 1300, epoch: 3 | loss: 0.1794974
	speed: 0.0378s/iter; left time: 16264.3016s
	iters: 1400, epoch: 3 | loss: 0.2277042
	speed: 0.0371s/iter; left time: 15943.1422s
	iters: 1500, epoch: 3 | loss: 0.2213261
	speed: 0.0366s/iter; left time: 15741.1181s
	iters: 1600, epoch: 3 | loss: 0.1975059
	speed: 0.0361s/iter; left time: 15510.7800s
	iters: 1700, epoch: 3 | loss: 0.1745098
	speed: 0.0360s/iter; left time: 15465.1580s
	iters: 1800, epoch: 3 | loss: 0.1668164
	speed: 0.0366s/iter; left time: 15696.1043s
	iters: 1900, epoch: 3 | loss: 0.1781430
	speed: 0.0362s/iter; left time: 15527.7951s
	iters: 2000, epoch: 3 | loss: 0.2097688
	speed: 0.0361s/iter; left time: 15505.3990s
	iters: 2100, epoch: 3 | loss: 0.1777086
	speed: 0.0360s/iter; left time: 15441.5833s
	iters: 2200, epoch: 3 | loss: 0.2040218
	speed: 0.0357s/iter; left time: 15311.2693s
	iters: 2300, epoch: 3 | loss: 0.1641627
	speed: 0.0354s/iter; left time: 15181.4744s
	iters: 2400, epoch: 3 | loss: 0.1808055
	speed: 0.0355s/iter; left time: 15236.6500s
	iters: 2500, epoch: 3 | loss: 0.1939008
	speed: 0.0367s/iter; left time: 15727.1972s
	iters: 2600, epoch: 3 | loss: 0.1714191
	speed: 0.0355s/iter; left time: 15225.7638s
	iters: 2700, epoch: 3 | loss: 0.1666003
	speed: 0.0345s/iter; left time: 14799.0855s
	iters: 2800, epoch: 3 | loss: 0.2177815
	speed: 0.0357s/iter; left time: 15301.2553s
	iters: 2900, epoch: 3 | loss: 0.1800834
	speed: 0.0366s/iter; left time: 15684.6251s
	iters: 3000, epoch: 3 | loss: 0.1858421
	speed: 0.0355s/iter; left time: 15184.0915s
	iters: 3100, epoch: 3 | loss: 0.2101942
	speed: 0.0358s/iter; left time: 15319.0100s
	iters: 3200, epoch: 3 | loss: 0.2066310
	speed: 0.0365s/iter; left time: 15630.9971s
	iters: 3300, epoch: 3 | loss: 0.1800005
	speed: 0.0362s/iter; left time: 15475.4454s
	iters: 3400, epoch: 3 | loss: 0.1663420
	speed: 0.0361s/iter; left time: 15421.4699s
	iters: 3500, epoch: 3 | loss: 0.1654515
	speed: 0.0357s/iter; left time: 15250.4057s
	iters: 3600, epoch: 3 | loss: 0.1784612
	speed: 0.0370s/iter; left time: 15824.3240s
	iters: 3700, epoch: 3 | loss: 0.1502775
	speed: 0.0365s/iter; left time: 15594.4556s
	iters: 3800, epoch: 3 | loss: 0.1986026
	speed: 0.0365s/iter; left time: 15585.8924s
	iters: 3900, epoch: 3 | loss: 0.1652673
	speed: 0.0365s/iter; left time: 15582.8427s
	iters: 4000, epoch: 3 | loss: 0.1544501
	speed: 0.0358s/iter; left time: 15299.9323s
	iters: 4100, epoch: 3 | loss: 0.1639718
	speed: 0.0357s/iter; left time: 15248.1187s
	iters: 4200, epoch: 3 | loss: 0.1948757
	speed: 0.0370s/iter; left time: 15784.2020s
	iters: 4300, epoch: 3 | loss: 0.1818476
	speed: 0.0360s/iter; left time: 15372.4875s
Epoch: 3 cost time: 160.60147285461426
Epoch: 3, Steps: 4399 | Train Loss: 0.1950945 Vali Loss: 0.2959493 Test Loss: 0.3450003
Validation loss decreased (0.314893 --> 0.295949).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1767700
	speed: 0.3737s/iter; left time: 159421.6112s
	iters: 200, epoch: 4 | loss: 0.1681976
	speed: 0.0354s/iter; left time: 15112.3454s
	iters: 300, epoch: 4 | loss: 0.1997082
	speed: 0.0350s/iter; left time: 14941.8801s
	iters: 400, epoch: 4 | loss: 0.1612857
	speed: 0.0343s/iter; left time: 14627.0482s
	iters: 500, epoch: 4 | loss: 0.1841259
	speed: 0.0346s/iter; left time: 14748.2864s
	iters: 600, epoch: 4 | loss: 0.1731895
	speed: 0.0348s/iter; left time: 14839.3942s
	iters: 700, epoch: 4 | loss: 0.2104127
	speed: 0.0357s/iter; left time: 15204.4271s
	iters: 800, epoch: 4 | loss: 0.1846742
	speed: 0.0354s/iter; left time: 15090.6773s
	iters: 900, epoch: 4 | loss: 0.1696692
	speed: 0.0356s/iter; left time: 15145.3200s
	iters: 1000, epoch: 4 | loss: 0.1709013
	speed: 0.0358s/iter; left time: 15222.6411s
	iters: 1100, epoch: 4 | loss: 0.1735206
	speed: 0.0350s/iter; left time: 14883.1029s
	iters: 1200, epoch: 4 | loss: 0.1484943
	speed: 0.0355s/iter; left time: 15107.7302s
	iters: 1300, epoch: 4 | loss: 0.1621989
	speed: 0.0353s/iter; left time: 15029.1429s
	iters: 1400, epoch: 4 | loss: 0.1706786
	speed: 0.0357s/iter; left time: 15171.1257s
	iters: 1500, epoch: 4 | loss: 0.1632123
	speed: 0.0352s/iter; left time: 14978.1294s
	iters: 1600, epoch: 4 | loss: 0.1792779
	speed: 0.0347s/iter; left time: 14744.2767s
	iters: 1700, epoch: 4 | loss: 0.1892288
	speed: 0.0350s/iter; left time: 14866.8412s
	iters: 1800, epoch: 4 | loss: 0.1391402
	speed: 0.0353s/iter; left time: 15019.2151s
	iters: 1900, epoch: 4 | loss: 0.1455031
	speed: 0.0355s/iter; left time: 15064.4908s
	iters: 2000, epoch: 4 | loss: 0.1773094
	speed: 0.0351s/iter; left time: 14892.0939s
	iters: 2100, epoch: 4 | loss: 0.1741992
	speed: 0.0354s/iter; left time: 15050.9963s
	iters: 2200, epoch: 4 | loss: 0.1691780
	speed: 0.0359s/iter; left time: 15219.6385s
	iters: 2300, epoch: 4 | loss: 0.1632562
	speed: 0.0354s/iter; left time: 15004.7652s
	iters: 2400, epoch: 4 | loss: 0.1609887
	speed: 0.0352s/iter; left time: 14955.3821s
