Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm2_336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_720_PatchTST_ETTm2_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2881147
	speed: 0.0389s/iter; left time: 1011.8477s
	iters: 200, epoch: 1 | loss: 0.2622945
	speed: 0.0184s/iter; left time: 475.5761s
Epoch: 1 cost time: 7.003057956695557
Epoch: 1, Steps: 261 | Train Loss: 0.2881225 Vali Loss: 0.2237724 Test Loss: 0.1794122
Validation loss decreased (inf --> 0.223772).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.2424762
	speed: 0.1078s/iter; left time: 2773.6291s
	iters: 200, epoch: 2 | loss: 0.2118174
	speed: 0.0193s/iter; left time: 494.9740s
Epoch: 2 cost time: 7.211247682571411
Epoch: 2, Steps: 261 | Train Loss: 0.2517706 Vali Loss: 0.2175913 Test Loss: 0.1739054
Validation loss decreased (0.223772 --> 0.217591).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.2649183
	speed: 0.1159s/iter; left time: 2954.1922s
	iters: 200, epoch: 3 | loss: 0.2434126
	speed: 0.0193s/iter; left time: 490.3980s
Epoch: 3 cost time: 7.813299179077148
Epoch: 3, Steps: 261 | Train Loss: 0.2433477 Vali Loss: 0.2162696 Test Loss: 0.1718264
Validation loss decreased (0.217591 --> 0.216270).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.2211663
	speed: 0.1077s/iter; left time: 2714.7662s
	iters: 200, epoch: 4 | loss: 0.2520703
	speed: 0.0189s/iter; left time: 474.0954s
Epoch: 4 cost time: 6.93242073059082
Epoch: 4, Steps: 261 | Train Loss: 0.2381374 Vali Loss: 0.2161701 Test Loss: 0.1713724
Validation loss decreased (0.216270 --> 0.216170).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.3149187
	speed: 0.1124s/iter; left time: 2805.8933s
	iters: 200, epoch: 5 | loss: 0.2314019
	speed: 0.0183s/iter; left time: 454.7669s
Epoch: 5 cost time: 7.309243679046631
Epoch: 5, Steps: 261 | Train Loss: 0.2341815 Vali Loss: 0.2151678 Test Loss: 0.1712979
Validation loss decreased (0.216170 --> 0.215168).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.2170950
	speed: 0.1095s/iter; left time: 2705.0349s
	iters: 200, epoch: 6 | loss: 0.2506951
	speed: 0.0191s/iter; left time: 469.1064s
Epoch: 6 cost time: 7.183201313018799
Epoch: 6, Steps: 261 | Train Loss: 0.2302463 Vali Loss: 0.2150581 Test Loss: 0.1719745
Validation loss decreased (0.215168 --> 0.215058).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.2166662
	speed: 0.1152s/iter; left time: 2813.9243s
	iters: 200, epoch: 7 | loss: 0.2367410
	speed: 0.0181s/iter; left time: 439.6948s
Epoch: 7 cost time: 7.220622777938843
Epoch: 7, Steps: 261 | Train Loss: 0.2273788 Vali Loss: 0.2160149 Test Loss: 0.1720114
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.2255826
	speed: 0.1117s/iter; left time: 2699.9191s
	iters: 200, epoch: 8 | loss: 0.1860522
	speed: 0.0189s/iter; left time: 455.0419s
Epoch: 8 cost time: 7.314842939376831
Epoch: 8, Steps: 261 | Train Loss: 0.2248095 Vali Loss: 0.2172432 Test Loss: 0.1711851
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.2293060
	speed: 0.1149s/iter; left time: 2746.9103s
	iters: 200, epoch: 9 | loss: 0.2225745
	speed: 0.0201s/iter; left time: 478.4226s
Epoch: 9 cost time: 7.591228008270264
Epoch: 9, Steps: 261 | Train Loss: 0.2223914 Vali Loss: 0.2191330 Test Loss: 0.1714096
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.2489324
	speed: 0.1079s/iter; left time: 2552.9411s
	iters: 200, epoch: 10 | loss: 0.2250114
	speed: 0.0190s/iter; left time: 448.4282s
Epoch: 10 cost time: 7.1347808837890625
Epoch: 10, Steps: 261 | Train Loss: 0.2205328 Vali Loss: 0.2240487 Test Loss: 0.1727159
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.2253276
	speed: 0.1120s/iter; left time: 2619.1966s
	iters: 200, epoch: 11 | loss: 0.2166624
	speed: 0.0194s/iter; left time: 452.2679s
Epoch: 11 cost time: 7.299855709075928
Epoch: 11, Steps: 261 | Train Loss: 0.2177730 Vali Loss: 0.2206347 Test Loss: 0.1709649
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.2253204
	speed: 0.1115s/iter; left time: 2579.6181s
	iters: 200, epoch: 12 | loss: 0.2380292
	speed: 0.0184s/iter; left time: 423.0036s
Epoch: 12 cost time: 7.019500255584717
Epoch: 12, Steps: 261 | Train Loss: 0.2165040 Vali Loss: 0.2196750 Test Loss: 0.1738222
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.1883375
	speed: 0.1190s/iter; left time: 2721.3150s
	iters: 200, epoch: 13 | loss: 0.2098026
	speed: 0.0196s/iter; left time: 445.5673s
Epoch: 13 cost time: 7.9171600341796875
Epoch: 13, Steps: 261 | Train Loss: 0.2140943 Vali Loss: 0.2225661 Test Loss: 0.1723300
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.2059697
	speed: 0.1166s/iter; left time: 2635.1609s
	iters: 200, epoch: 14 | loss: 0.2099426
	speed: 0.0200s/iter; left time: 450.2696s
Epoch: 14 cost time: 7.742239713668823
Epoch: 14, Steps: 261 | Train Loss: 0.2113976 Vali Loss: 0.2249287 Test Loss: 0.1715479
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.1979014
	speed: 0.1237s/iter; left time: 2763.5719s
	iters: 200, epoch: 15 | loss: 0.2479005
	speed: 0.0225s/iter; left time: 501.6303s
Epoch: 15 cost time: 8.03966474533081
Epoch: 15, Steps: 261 | Train Loss: 0.2086739 Vali Loss: 0.2303695 Test Loss: 0.1728889
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.1740415
	speed: 0.1136s/iter; left time: 2507.9936s
	iters: 200, epoch: 16 | loss: 0.2062431
	speed: 0.0232s/iter; left time: 509.2488s
Epoch: 16 cost time: 7.846823692321777
Epoch: 16, Steps: 261 | Train Loss: 0.2050382 Vali Loss: 0.2383986 Test Loss: 0.1749335
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.1918442
	speed: 0.1134s/iter; left time: 2474.1519s
	iters: 200, epoch: 17 | loss: 0.1968120
	speed: 0.0181s/iter; left time: 394.1808s
Epoch: 17 cost time: 7.103688716888428
Epoch: 17, Steps: 261 | Train Loss: 0.2010227 Vali Loss: 0.2356954 Test Loss: 0.1791755
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.1815123
	speed: 0.1139s/iter; left time: 2455.7189s
	iters: 200, epoch: 18 | loss: 0.2097250
	speed: 0.0182s/iter; left time: 391.4773s
Epoch: 18 cost time: 7.060187578201294
Epoch: 18, Steps: 261 | Train Loss: 0.1956605 Vali Loss: 0.2398557 Test Loss: 0.1829686
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.1819415
	speed: 0.1078s/iter; left time: 2295.3994s
	iters: 200, epoch: 19 | loss: 0.2177658
	speed: 0.0196s/iter; left time: 415.5199s
Epoch: 19 cost time: 7.080161094665527
Epoch: 19, Steps: 261 | Train Loss: 0.1916550 Vali Loss: 0.2402074 Test Loss: 0.1837593
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.2003024
	speed: 0.1164s/iter; left time: 2448.4024s
	iters: 200, epoch: 20 | loss: 0.1667879
	speed: 0.0190s/iter; left time: 397.5154s
Epoch: 20 cost time: 7.2490458488464355
Epoch: 20, Steps: 261 | Train Loss: 0.1869687 Vali Loss: 0.2421626 Test Loss: 0.1862828
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.1958706
	speed: 0.1072s/iter; left time: 2227.2737s
	iters: 200, epoch: 21 | loss: 0.1881573
	speed: 0.0182s/iter; left time: 376.5480s
Epoch: 21 cost time: 6.939000606536865
Epoch: 21, Steps: 261 | Train Loss: 0.1818132 Vali Loss: 0.2541250 Test Loss: 0.1903596
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.1724645
	speed: 0.1187s/iter; left time: 2436.1361s
	iters: 200, epoch: 22 | loss: 0.1778178
	speed: 0.0224s/iter; left time: 458.0257s
Epoch: 22 cost time: 7.897124767303467
Epoch: 22, Steps: 261 | Train Loss: 0.1762426 Vali Loss: 0.2635214 Test Loss: 0.1934900
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.1913056
	speed: 0.1111s/iter; left time: 2250.5750s
	iters: 200, epoch: 23 | loss: 0.1720217
	speed: 0.0190s/iter; left time: 382.3711s
Epoch: 23 cost time: 7.137175798416138
Epoch: 23, Steps: 261 | Train Loss: 0.1712974 Vali Loss: 0.2593077 Test Loss: 0.1958987
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.1687051
	speed: 0.1094s/iter; left time: 2187.6232s
	iters: 200, epoch: 24 | loss: 0.1541126
	speed: 0.0194s/iter; left time: 385.9112s
Epoch: 24 cost time: 7.18187689781189
Epoch: 24, Steps: 261 | Train Loss: 0.1652936 Vali Loss: 0.2718250 Test Loss: 0.2013431
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.1514813
	speed: 0.1192s/iter; left time: 2352.5739s
	iters: 200, epoch: 25 | loss: 0.1486564
	speed: 0.0210s/iter; left time: 413.2567s
Epoch: 25 cost time: 7.947309732437134
Epoch: 25, Steps: 261 | Train Loss: 0.1596741 Vali Loss: 0.2723251 Test Loss: 0.1991578
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.1409140
	speed: 0.1116s/iter; left time: 2173.7849s
	iters: 200, epoch: 26 | loss: 0.1554500
	speed: 0.0200s/iter; left time: 387.8931s
Epoch: 26 cost time: 7.380496263504028
Epoch: 26, Steps: 261 | Train Loss: 0.1542654 Vali Loss: 0.2892166 Test Loss: 0.2028557
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_720_PatchTST_ETTm2_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.17197446525096893, mae:0.3228435516357422, rse:0.6838995814323425
