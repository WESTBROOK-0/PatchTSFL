Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTSW', model_id='weather_336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : weather_336_336_PatchTSW_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6761731
	speed: 1.3810s/iter; left time: 38807.2610s
	iters: 200, epoch: 1 | loss: 0.5603045
	speed: 1.3704s/iter; left time: 38372.0634s
Epoch: 1 cost time: 388.0163161754608
Epoch: 1, Steps: 282 | Train Loss: 0.7107651 Vali Loss: 0.6641302 Test Loss: 0.2972660
Validation loss decreased (inf --> 0.664130).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6641518
	speed: 3.0185s/iter; left time: 83970.5577s
	iters: 200, epoch: 2 | loss: 0.5752310
	speed: 1.3705s/iter; left time: 37990.2066s
Epoch: 2 cost time: 388.3456463813782
Epoch: 2, Steps: 282 | Train Loss: 0.5786612 Vali Loss: 0.5652817 Test Loss: 0.2576134
Validation loss decreased (0.664130 --> 0.565282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5215523
	speed: 3.0191s/iter; left time: 83137.1921s
	iters: 200, epoch: 3 | loss: 0.5295757
	speed: 1.3709s/iter; left time: 37613.1472s
Epoch: 3 cost time: 388.3330042362213
Epoch: 3, Steps: 282 | Train Loss: 0.5535787 Vali Loss: 0.5551924 Test Loss: 0.2542294
Validation loss decreased (0.565282 --> 0.555192).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4576123
	speed: 3.0154s/iter; left time: 82183.6965s
	iters: 200, epoch: 4 | loss: 0.5241427
	speed: 1.3714s/iter; left time: 37239.4859s
Epoch: 4 cost time: 388.14653849601746
Epoch: 4, Steps: 282 | Train Loss: 0.5446994 Vali Loss: 0.5482220 Test Loss: 0.2535247
Validation loss decreased (0.555192 --> 0.548222).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4976015
	speed: 3.0176s/iter; left time: 81394.8362s
	iters: 200, epoch: 5 | loss: 0.8165631
	speed: 1.3711s/iter; left time: 36846.8470s
Epoch: 5 cost time: 388.2671468257904
Epoch: 5, Steps: 282 | Train Loss: 0.5377972 Vali Loss: 0.5520628 Test Loss: 0.2513360
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5601680
	speed: 3.0113s/iter; left time: 80373.7674s
	iters: 200, epoch: 6 | loss: 0.4873598
	speed: 1.3715s/iter; left time: 36469.2671s
Epoch: 6 cost time: 388.4445095062256
Epoch: 6, Steps: 282 | Train Loss: 0.5306893 Vali Loss: 0.5406202 Test Loss: 0.2492735
Validation loss decreased (0.548222 --> 0.540620).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6897732
	speed: 3.0156s/iter; left time: 79638.0184s
	iters: 200, epoch: 7 | loss: 0.3946761
	speed: 1.3708s/iter; left time: 36065.6387s
Epoch: 7 cost time: 388.1435880661011
Epoch: 7, Steps: 282 | Train Loss: 0.5247668 Vali Loss: 0.5418318 Test Loss: 0.2490556
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5379517
	speed: 3.0097s/iter; left time: 78634.8268s
	iters: 200, epoch: 8 | loss: 0.4380974
	speed: 1.3710s/iter; left time: 35683.2532s
Epoch: 8 cost time: 388.3225750923157
Epoch: 8, Steps: 282 | Train Loss: 0.5200429 Vali Loss: 0.5477659 Test Loss: 0.2495113
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.4892699
	speed: 3.0080s/iter; left time: 77741.6260s
	iters: 200, epoch: 9 | loss: 0.6042596
	speed: 1.3710s/iter; left time: 35296.2799s
Epoch: 9 cost time: 388.2563490867615
Epoch: 9, Steps: 282 | Train Loss: 0.5150339 Vali Loss: 0.5480486 Test Loss: 0.2507846
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7233654
	speed: 3.0091s/iter; left time: 76922.2768s
	iters: 200, epoch: 10 | loss: 0.4089841
	speed: 1.3713s/iter; left time: 34916.3751s
Epoch: 10 cost time: 388.33683228492737
Epoch: 10, Steps: 282 | Train Loss: 0.5119512 Vali Loss: 0.5469275 Test Loss: 0.2513002
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5897179
	speed: 3.0108s/iter; left time: 76116.8247s
	iters: 200, epoch: 11 | loss: 0.4622092
	speed: 1.3715s/iter; left time: 34536.0335s
Epoch: 11 cost time: 388.4666895866394
Epoch: 11, Steps: 282 | Train Loss: 0.5088401 Vali Loss: 0.5447542 Test Loss: 0.2505688
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5180807
	speed: 3.0098s/iter; left time: 75242.0368s
	iters: 200, epoch: 12 | loss: 0.5316451
	speed: 1.3714s/iter; left time: 34146.6494s
Epoch: 12 cost time: 388.27685284614563
Epoch: 12, Steps: 282 | Train Loss: 0.5053667 Vali Loss: 0.5517977 Test Loss: 0.2511298
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5177033
	speed: 3.0084s/iter; left time: 74357.4950s
	iters: 200, epoch: 13 | loss: 0.3909173
	speed: 1.3713s/iter; left time: 33756.2143s
Epoch: 13 cost time: 388.283411026001
Epoch: 13, Steps: 282 | Train Loss: 0.5024567 Vali Loss: 0.5545617 Test Loss: 0.2529449
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.5244111
	speed: 3.0072s/iter; left time: 73481.6989s
	iters: 200, epoch: 14 | loss: 0.3984203
	speed: 1.3713s/iter; left time: 33371.0249s
Epoch: 14 cost time: 388.34597539901733
Epoch: 14, Steps: 282 | Train Loss: 0.4995570 Vali Loss: 0.5549407 Test Loss: 0.2535309
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5695372
	speed: 3.0109s/iter; left time: 72722.3657s
	iters: 200, epoch: 15 | loss: 0.4513299
	speed: 1.3709s/iter; left time: 32974.4328s
Epoch: 15 cost time: 388.3624954223633
Epoch: 15, Steps: 282 | Train Loss: 0.4968797 Vali Loss: 0.5508494 Test Loss: 0.2530392
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4377761
	speed: 3.0091s/iter; left time: 71829.1561s
	iters: 200, epoch: 16 | loss: 0.4263451
	speed: 1.3708s/iter; left time: 32586.1319s
Epoch: 16 cost time: 388.2272033691406
Epoch: 16, Steps: 282 | Train Loss: 0.4948657 Vali Loss: 0.5555511 Test Loss: 0.2545565
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.5934853
	speed: 3.0082s/iter; left time: 70959.5139s
	iters: 200, epoch: 17 | loss: 0.4126002
	speed: 1.3712s/iter; left time: 32208.1890s
Epoch: 17 cost time: 388.1936411857605
Epoch: 17, Steps: 282 | Train Loss: 0.4922093 Vali Loss: 0.5566521 Test Loss: 0.2542891
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6391215
	speed: 3.0099s/iter; left time: 70152.0884s
	iters: 200, epoch: 18 | loss: 0.5230484
	speed: 1.3711s/iter; left time: 31820.2671s
Epoch: 18 cost time: 388.4281756877899
Epoch: 18, Steps: 282 | Train Loss: 0.4900623 Vali Loss: 0.5584791 Test Loss: 0.2555210
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5236254
	speed: 3.0131s/iter; left time: 69375.9181s
	iters: 200, epoch: 19 | loss: 0.4144371
	speed: 1.3714s/iter; left time: 31438.9891s
Epoch: 19 cost time: 388.5012791156769
Epoch: 19, Steps: 282 | Train Loss: 0.4884104 Vali Loss: 0.5584347 Test Loss: 0.2555163
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.4616172
	speed: 3.0097s/iter; left time: 68448.7420s
	iters: 200, epoch: 20 | loss: 0.4963110
	speed: 1.3711s/iter; left time: 31046.6680s
Epoch: 20 cost time: 388.3028733730316
Epoch: 20, Steps: 282 | Train Loss: 0.4857318 Vali Loss: 0.5612687 Test Loss: 0.2564025
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.4284904
	speed: 3.0088s/iter; left time: 67580.2041s
	iters: 200, epoch: 21 | loss: 0.6332029
	speed: 1.3713s/iter; left time: 30664.4403s
Epoch: 21 cost time: 388.3725447654724
Epoch: 21, Steps: 282 | Train Loss: 0.4842354 Vali Loss: 0.5621738 Test Loss: 0.2568908
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.5049420
	speed: 3.0067s/iter; left time: 66685.1067s
	iters: 200, epoch: 22 | loss: 0.4394761
	speed: 1.3714s/iter; left time: 30278.5035s
Epoch: 22 cost time: 388.2638657093048
Epoch: 22, Steps: 282 | Train Loss: 0.4830759 Vali Loss: 0.5626348 Test Loss: 0.2568867
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.4384886
	speed: 3.0077s/iter; left time: 65859.5274s
	iters: 200, epoch: 23 | loss: 0.4171603
	speed: 1.3717s/iter; left time: 29899.0910s
Epoch: 23 cost time: 388.43270468711853
Epoch: 23, Steps: 282 | Train Loss: 0.4818760 Vali Loss: 0.5655534 Test Loss: 0.2573882
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.4235018
	speed: 3.0075s/iter; left time: 65006.4459s
	iters: 200, epoch: 24 | loss: 0.4762646
	speed: 1.3715s/iter; left time: 29508.4648s
