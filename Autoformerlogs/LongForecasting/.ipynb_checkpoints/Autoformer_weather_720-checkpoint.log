Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7977108
	speed: 0.0662s/iter; left time: 1187.6792s
	iters: 200, epoch: 1 | loss: 0.7318285
	speed: 0.0469s/iter; left time: 837.3830s
	iters: 300, epoch: 1 | loss: 0.7333826
	speed: 0.0497s/iter; left time: 881.1766s
	iters: 400, epoch: 1 | loss: 0.9908153
	speed: 0.0484s/iter; left time: 853.4399s
	iters: 500, epoch: 1 | loss: 0.8763961
	speed: 0.0484s/iter; left time: 849.1449s
	iters: 600, epoch: 1 | loss: 0.7766861
	speed: 0.0448s/iter; left time: 781.0091s
	iters: 700, epoch: 1 | loss: 0.9363008
	speed: 0.0452s/iter; left time: 783.1517s
	iters: 800, epoch: 1 | loss: 1.1561421
	speed: 0.0459s/iter; left time: 790.8924s
	iters: 900, epoch: 1 | loss: 1.0175778
	speed: 0.0499s/iter; left time: 855.1489s
	iters: 1000, epoch: 1 | loss: 0.5816170
	speed: 0.0441s/iter; left time: 751.9237s
	iters: 1100, epoch: 1 | loss: 0.8863431
	speed: 0.0465s/iter; left time: 787.8366s
	iters: 1200, epoch: 1 | loss: 0.8922240
	speed: 0.0446s/iter; left time: 751.7184s
	iters: 1300, epoch: 1 | loss: 0.6494612
	speed: 0.0448s/iter; left time: 750.4774s
	iters: 1400, epoch: 1 | loss: 0.8639752
	speed: 0.0479s/iter; left time: 797.3632s
	iters: 1500, epoch: 1 | loss: 0.9074225
	speed: 0.0506s/iter; left time: 836.2350s
	iters: 1600, epoch: 1 | loss: 0.4834299
	speed: 0.0488s/iter; left time: 802.5230s
	iters: 1700, epoch: 1 | loss: 0.7456600
	speed: 0.0483s/iter; left time: 788.7068s
	iters: 1800, epoch: 1 | loss: 0.9176702
	speed: 0.0470s/iter; left time: 763.8896s
	iters: 1900, epoch: 1 | loss: 0.9219062
	speed: 0.0472s/iter; left time: 761.1136s
	iters: 2000, epoch: 1 | loss: 0.9152490
	speed: 0.0465s/iter; left time: 745.4519s
	iters: 2100, epoch: 1 | loss: 1.0985799
	speed: 0.0478s/iter; left time: 762.1311s
	iters: 2200, epoch: 1 | loss: 1.1050653
	speed: 0.0474s/iter; left time: 750.1533s
	iters: 2300, epoch: 1 | loss: 1.2261727
	speed: 0.0485s/iter; left time: 763.8303s
	iters: 2400, epoch: 1 | loss: 0.5883350
	speed: 0.0482s/iter; left time: 753.6007s
	iters: 2500, epoch: 1 | loss: 0.7300211
	speed: 0.0476s/iter; left time: 739.1970s
	iters: 2600, epoch: 1 | loss: 0.8191966
	speed: 0.0482s/iter; left time: 744.4837s
	iters: 2700, epoch: 1 | loss: 0.4540463
	speed: 0.0462s/iter; left time: 708.5329s
	iters: 2800, epoch: 1 | loss: 0.7755889
	speed: 0.0485s/iter; left time: 738.8879s
	iters: 2900, epoch: 1 | loss: 0.7355338
	speed: 0.0480s/iter; left time: 727.2153s
	iters: 3000, epoch: 1 | loss: 0.5507682
	speed: 0.0476s/iter; left time: 715.8940s
	iters: 3100, epoch: 1 | loss: 2.7238796
	speed: 0.0477s/iter; left time: 712.2535s
	iters: 3200, epoch: 1 | loss: 0.6316268
	speed: 0.0489s/iter; left time: 725.6437s
	iters: 3300, epoch: 1 | loss: 0.7576427
	speed: 0.0494s/iter; left time: 728.2728s
	iters: 3400, epoch: 1 | loss: 0.7111284
	speed: 0.0466s/iter; left time: 681.4046s
	iters: 3500, epoch: 1 | loss: 0.5619747
	speed: 0.0464s/iter; left time: 673.9191s
	iters: 3600, epoch: 1 | loss: 0.5907283
	speed: 0.0478s/iter; left time: 690.2570s
	iters: 3700, epoch: 1 | loss: 0.6316599
	speed: 0.0459s/iter; left time: 658.4322s
	iters: 3800, epoch: 1 | loss: 1.5892010
	speed: 0.0456s/iter; left time: 648.9986s
	iters: 3900, epoch: 1 | loss: 0.9175760
	speed: 0.0458s/iter; left time: 647.2748s
	iters: 4000, epoch: 1 | loss: 0.8076990
	speed: 0.0496s/iter; left time: 696.4685s
	iters: 4100, epoch: 1 | loss: 0.4826067
	speed: 0.0496s/iter; left time: 691.6897s
	iters: 4200, epoch: 1 | loss: 0.4448197
	speed: 0.0473s/iter; left time: 653.9286s
	iters: 4300, epoch: 1 | loss: 0.6265816
	speed: 0.0453s/iter; left time: 621.9699s
	iters: 4400, epoch: 1 | loss: 1.5097251
	speed: 0.0469s/iter; left time: 639.0625s
	iters: 4500, epoch: 1 | loss: 1.6359677
	speed: 0.0470s/iter; left time: 636.6073s
	iters: 4600, epoch: 1 | loss: 0.9802284
	speed: 0.0487s/iter; left time: 654.1722s
	iters: 4700, epoch: 1 | loss: 0.4161741
	speed: 0.0493s/iter; left time: 657.6743s
	iters: 4800, epoch: 1 | loss: 0.7275376
	speed: 0.0465s/iter; left time: 615.1954s
	iters: 4900, epoch: 1 | loss: 1.1469687
	speed: 0.0471s/iter; left time: 619.3529s
	iters: 5000, epoch: 1 | loss: 0.5810836
	speed: 0.0475s/iter; left time: 618.9961s
	iters: 5100, epoch: 1 | loss: 0.6690440
	speed: 0.0492s/iter; left time: 635.8698s
	iters: 5200, epoch: 1 | loss: 0.9677871
	speed: 0.0505s/iter; left time: 648.6641s
	iters: 5300, epoch: 1 | loss: 0.5598264
	speed: 0.0503s/iter; left time: 640.7917s
	iters: 5400, epoch: 1 | loss: 0.4731530
	speed: 0.0479s/iter; left time: 605.6674s
	iters: 5500, epoch: 1 | loss: 0.6833265
	speed: 0.0488s/iter; left time: 611.7935s
	iters: 5600, epoch: 1 | loss: 0.4649903
	speed: 0.0476s/iter; left time: 591.6673s
	iters: 5700, epoch: 1 | loss: 0.7243726
	speed: 0.0464s/iter; left time: 572.7191s
	iters: 5800, epoch: 1 | loss: 1.2710778
	speed: 0.0426s/iter; left time: 521.3807s
	iters: 5900, epoch: 1 | loss: 0.5998296
	speed: 0.0451s/iter; left time: 547.7483s
	iters: 6000, epoch: 1 | loss: 0.5047692
	speed: 0.0465s/iter; left time: 559.3869s
	iters: 6100, epoch: 1 | loss: 0.5668358
	speed: 0.0469s/iter; left time: 559.9334s
	iters: 6200, epoch: 1 | loss: 0.9767455
	speed: 0.0479s/iter; left time: 566.4618s
	iters: 6300, epoch: 1 | loss: 0.5935314
	speed: 0.0476s/iter; left time: 559.2098s
	iters: 6400, epoch: 1 | loss: 0.6850917
	speed: 0.0477s/iter; left time: 555.4765s
	iters: 6500, epoch: 1 | loss: 0.4808655
	speed: 0.0468s/iter; left time: 539.6014s
	iters: 6600, epoch: 1 | loss: 0.8236346
	speed: 0.0487s/iter; left time: 556.6006s
	iters: 6700, epoch: 1 | loss: 0.4918447
	speed: 0.0467s/iter; left time: 529.9413s
	iters: 6800, epoch: 1 | loss: 0.5615330
	speed: 0.0483s/iter; left time: 542.2752s
	iters: 6900, epoch: 1 | loss: 0.5868109
	speed: 0.0463s/iter; left time: 515.8968s
	iters: 7000, epoch: 1 | loss: 0.5083411
	speed: 0.0485s/iter; left time: 535.0047s
	iters: 7100, epoch: 1 | loss: 0.8907478
	speed: 0.0488s/iter; left time: 533.9258s
	iters: 7200, epoch: 1 | loss: 0.8992651
	speed: 0.0447s/iter; left time: 484.3497s
	iters: 7300, epoch: 1 | loss: 0.4797065
	speed: 0.0460s/iter; left time: 494.3254s
	iters: 7400, epoch: 1 | loss: 0.6516183
	speed: 0.0485s/iter; left time: 515.6022s
	iters: 7500, epoch: 1 | loss: 0.5024585
	speed: 0.0487s/iter; left time: 513.1186s
	iters: 7600, epoch: 1 | loss: 1.0515932
	speed: 0.0486s/iter; left time: 507.5786s
	iters: 7700, epoch: 1 | loss: 0.6309538
	speed: 0.0455s/iter; left time: 470.1511s
	iters: 7800, epoch: 1 | loss: 0.7120722
	speed: 0.0451s/iter; left time: 461.7950s
	iters: 7900, epoch: 1 | loss: 0.6978046
	speed: 0.0473s/iter; left time: 479.2158s
	iters: 8000, epoch: 1 | loss: 0.5106950
	speed: 0.0491s/iter; left time: 492.3580s
	iters: 8100, epoch: 1 | loss: 1.6102570
	speed: 0.0481s/iter; left time: 478.2144s
	iters: 8200, epoch: 1 | loss: 0.5944250
	speed: 0.0476s/iter; left time: 468.2480s
	iters: 8300, epoch: 1 | loss: 0.5340037
	speed: 0.0470s/iter; left time: 457.9340s
	iters: 8400, epoch: 1 | loss: 0.5770980
	speed: 0.0483s/iter; left time: 465.5302s
	iters: 8500, epoch: 1 | loss: 0.7001936
	speed: 0.0491s/iter; left time: 467.8901s
	iters: 8600, epoch: 1 | loss: 0.6033301
	speed: 0.0473s/iter; left time: 446.4108s
	iters: 8700, epoch: 1 | loss: 0.8855262
	speed: 0.0476s/iter; left time: 444.8092s
	iters: 8800, epoch: 1 | loss: 0.6766596
	speed: 0.0461s/iter; left time: 425.4336s
	iters: 8900, epoch: 1 | loss: 0.7305729
	speed: 0.0471s/iter; left time: 430.5688s
	iters: 9000, epoch: 1 | loss: 0.5255504
	speed: 0.0474s/iter; left time: 428.7449s
Epoch: 1 cost time: 429.7349491119385
Epoch: 1, Steps: 9018 | Train Loss: 0.8059456 Vali Loss: 0.8385004 Test Loss: 0.4223157
Validation loss decreased (inf --> 0.838500).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5456930
	speed: 0.8039s/iter; left time: 7170.1349s
	iters: 200, epoch: 2 | loss: 0.6756518
	speed: 0.0477s/iter; left time: 420.2603s
	iters: 300, epoch: 2 | loss: 1.6830378
	speed: 0.0473s/iter; left time: 412.1253s
	iters: 400, epoch: 2 | loss: 0.4547695
	speed: 0.0470s/iter; left time: 404.7510s
	iters: 500, epoch: 2 | loss: 0.7695420
	speed: 0.0481s/iter; left time: 409.8756s
	iters: 600, epoch: 2 | loss: 0.7903894
	speed: 0.0466s/iter; left time: 392.5140s
	iters: 700, epoch: 2 | loss: 0.7988019
	speed: 0.0486s/iter; left time: 404.2985s
	iters: 800, epoch: 2 | loss: 0.4757380
	speed: 0.0472s/iter; left time: 387.8532s
	iters: 900, epoch: 2 | loss: 0.8681246
	speed: 0.0461s/iter; left time: 374.6191s
	iters: 1000, epoch: 2 | loss: 0.6613358
	speed: 0.0472s/iter; left time: 378.6679s
	iters: 1100, epoch: 2 | loss: 1.8147289
	speed: 0.0464s/iter; left time: 367.5364s
	iters: 1200, epoch: 2 | loss: 0.7805655
	speed: 0.0479s/iter; left time: 374.4662s
	iters: 1300, epoch: 2 | loss: 0.6380970
	speed: 0.0493s/iter; left time: 380.4298s
	iters: 1400, epoch: 2 | loss: 0.9108111
	speed: 0.0492s/iter; left time: 374.5639s
	iters: 1500, epoch: 2 | loss: 0.8402879
	speed: 0.0462s/iter; left time: 347.3090s
	iters: 1600, epoch: 2 | loss: 1.6787875
	speed: 0.0467s/iter; left time: 346.3954s
	iters: 1700, epoch: 2 | loss: 0.6881612
	speed: 0.0478s/iter; left time: 349.5469s
	iters: 1800, epoch: 2 | loss: 0.4851568
	speed: 0.0495s/iter; left time: 357.5465s
	iters: 1900, epoch: 2 | loss: 0.6433266
	speed: 0.0496s/iter; left time: 353.3669s
	iters: 2000, epoch: 2 | loss: 0.7203019
	speed: 0.0476s/iter; left time: 334.2864s
	iters: 2100, epoch: 2 | loss: 0.5135840
	speed: 0.0466s/iter; left time: 322.7621s
	iters: 2200, epoch: 2 | loss: 1.6061249
	speed: 0.0457s/iter; left time: 311.6618s
	iters: 2300, epoch: 2 | loss: 0.4824149
	speed: 0.0467s/iter; left time: 313.9162s
	iters: 2400, epoch: 2 | loss: 0.7709489
	speed: 0.0473s/iter; left time: 312.8222s
	iters: 2500, epoch: 2 | loss: 0.6381019
	speed: 0.0458s/iter; left time: 298.4631s
	iters: 2600, epoch: 2 | loss: 0.4934306
	speed: 0.0491s/iter; left time: 315.3785s
	iters: 2700, epoch: 2 | loss: 0.6213315
	speed: 0.0473s/iter; left time: 299.0027s
	iters: 2800, epoch: 2 | loss: 0.5746799
	speed: 0.0461s/iter; left time: 286.6244s
	iters: 2900, epoch: 2 | loss: 0.4253205
	speed: 0.0475s/iter; left time: 290.7120s
	iters: 3000, epoch: 2 | loss: 0.6291596
	speed: 0.0491s/iter; left time: 295.2359s
	iters: 3100, epoch: 2 | loss: 0.5410843
	speed: 0.0508s/iter; left time: 300.4143s
	iters: 3200, epoch: 2 | loss: 0.5675461
	speed: 0.0432s/iter; left time: 251.5201s
	iters: 3300, epoch: 2 | loss: 1.2019953
	speed: 0.0441s/iter; left time: 251.9568s
	iters: 3400, epoch: 2 | loss: 0.6358464
	speed: 0.0442s/iter; left time: 248.5507s
	iters: 3500, epoch: 2 | loss: 0.7569937
	speed: 0.0469s/iter; left time: 258.9646s
	iters: 3600, epoch: 2 | loss: 0.5412889
	speed: 0.0478s/iter; left time: 259.1178s
	iters: 3700, epoch: 2 | loss: 0.4129457
	speed: 0.0464s/iter; left time: 247.0602s
	iters: 3800, epoch: 2 | loss: 0.8366137
	speed: 0.0451s/iter; left time: 235.4603s
	iters: 3900, epoch: 2 | loss: 0.4166155
	speed: 0.0483s/iter; left time: 247.0602s
	iters: 4000, epoch: 2 | loss: 0.6652951
	speed: 0.0478s/iter; left time: 239.6950s
	iters: 4100, epoch: 2 | loss: 0.6529610
	speed: 0.0478s/iter; left time: 235.3266s
	iters: 4200, epoch: 2 | loss: 0.6862901
	speed: 0.0487s/iter; left time: 234.5179s
	iters: 4300, epoch: 2 | loss: 0.5184483
	speed: 0.0485s/iter; left time: 228.9337s
	iters: 4400, epoch: 2 | loss: 1.2966950
	speed: 0.0471s/iter; left time: 217.4656s
	iters: 4500, epoch: 2 | loss: 0.5980377
	speed: 0.0453s/iter; left time: 204.7951s
	iters: 4600, epoch: 2 | loss: 1.0871347
	speed: 0.0478s/iter; left time: 211.1219s
	iters: 4700, epoch: 2 | loss: 0.7997004
	speed: 0.0482s/iter; left time: 208.1481s
	iters: 4800, epoch: 2 | loss: 0.5746536
	speed: 0.0477s/iter; left time: 201.0972s
	iters: 4900, epoch: 2 | loss: 0.5333698
	speed: 0.0478s/iter; left time: 196.8128s
	iters: 5000, epoch: 2 | loss: 0.5049962
	speed: 0.0468s/iter; left time: 187.9702s
	iters: 5100, epoch: 2 | loss: 0.3985073
	speed: 0.0447s/iter; left time: 174.9870s
	iters: 5200, epoch: 2 | loss: 0.7805623
	speed: 0.0454s/iter; left time: 173.3250s
	iters: 5300, epoch: 2 | loss: 0.5147687
	speed: 0.0455s/iter; left time: 169.0923s
	iters: 5400, epoch: 2 | loss: 0.7614474
	speed: 0.0454s/iter; left time: 164.4292s
	iters: 5500, epoch: 2 | loss: 0.7241058
	speed: 0.0481s/iter; left time: 169.1133s
	iters: 5600, epoch: 2 | loss: 0.6499186
	speed: 0.0470s/iter; left time: 160.6434s
	iters: 5700, epoch: 2 | loss: 0.4427523
	speed: 0.0470s/iter; left time: 155.9698s
	iters: 5800, epoch: 2 | loss: 0.6494899
	speed: 0.0482s/iter; left time: 155.3149s
	iters: 5900, epoch: 2 | loss: 1.5795785
	speed: 0.0470s/iter; left time: 146.4987s
	iters: 6000, epoch: 2 | loss: 0.5866368
	speed: 0.0488s/iter; left time: 147.4059s
	iters: 6100, epoch: 2 | loss: 0.5072846
	speed: 0.0480s/iter; left time: 140.2391s
	iters: 6200, epoch: 2 | loss: 0.8127500
	speed: 0.0493s/iter; left time: 138.9650s
	iters: 6300, epoch: 2 | loss: 0.5123392
	speed: 0.0462s/iter; left time: 125.6223s
	iters: 6400, epoch: 2 | loss: 0.5405329
	speed: 0.0469s/iter; left time: 122.8320s
	iters: 6500, epoch: 2 | loss: 1.1643622
	speed: 0.0483s/iter; left time: 121.6907s
	iters: 6600, epoch: 2 | loss: 1.5086728
	speed: 0.0495s/iter; left time: 119.6927s
	iters: 6700, epoch: 2 | loss: 1.4993844
	speed: 0.0470s/iter; left time: 108.9724s
	iters: 6800, epoch: 2 | loss: 0.6100264
	speed: 0.0484s/iter; left time: 107.3284s
	iters: 6900, epoch: 2 | loss: 0.6341496
	speed: 0.0478s/iter; left time: 101.2548s
	iters: 7000, epoch: 2 | loss: 0.5888092
	speed: 0.0460s/iter; left time: 92.9547s
	iters: 7100, epoch: 2 | loss: 0.6121261
	speed: 0.0493s/iter; left time: 94.5856s
	iters: 7200, epoch: 2 | loss: 0.3810245
	speed: 0.0478s/iter; left time: 87.0241s
	iters: 7300, epoch: 2 | loss: 0.6062809
	speed: 0.0489s/iter; left time: 84.0251s
	iters: 7400, epoch: 2 | loss: 0.6007105
	speed: 0.0460s/iter; left time: 74.4713s
	iters: 7500, epoch: 2 | loss: 0.5533906
	speed: 0.0452s/iter; left time: 68.7302s
	iters: 7600, epoch: 2 | loss: 0.8969892
	speed: 0.0473s/iter; left time: 67.0769s
	iters: 7700, epoch: 2 | loss: 1.0002278
	speed: 0.0493s/iter; left time: 65.0776s
	iters: 7800, epoch: 2 | loss: 0.6185741
	speed: 0.0480s/iter; left time: 58.5722s
	iters: 7900, epoch: 2 | loss: 0.5497962
	speed: 0.0464s/iter; left time: 51.8921s
	iters: 8000, epoch: 2 | loss: 0.6013774
	speed: 0.0454s/iter; left time: 46.2762s
	iters: 8100, epoch: 2 | loss: 0.6033188
	speed: 0.0450s/iter; left time: 41.3183s
	iters: 8200, epoch: 2 | loss: 0.5845042
	speed: 0.0458s/iter; left time: 37.5467s
	iters: 8300, epoch: 2 | loss: 0.8271708
	speed: 0.0476s/iter; left time: 34.1929s
	iters: 8400, epoch: 2 | loss: 0.4546925
	speed: 0.0481s/iter; left time: 29.7788s
	iters: 8500, epoch: 2 | loss: 0.4806768
	speed: 0.0479s/iter; left time: 24.8634s
	iters: 8600, epoch: 2 | loss: 1.3665227
	speed: 0.0472s/iter; left time: 19.7789s
	iters: 8700, epoch: 2 | loss: 0.9912109
	speed: 0.0464s/iter; left time: 14.7910s
	iters: 8800, epoch: 2 | loss: 0.5496997
	speed: 0.0470s/iter; left time: 10.2886s
	iters: 8900, epoch: 2 | loss: 0.5124581
	speed: 0.0474s/iter; left time: 5.6447s
	iters: 9000, epoch: 2 | loss: 0.4688871
	speed: 0.0469s/iter; left time: 0.8911s
Epoch: 2 cost time: 427.85646891593933
Epoch: 2, Steps: 9018 | Train Loss: 0.7189649 Vali Loss: 0.7997764 Test Loss: 0.4365975
Validation loss decreased (0.838500 --> 0.799776).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4365979731082916, mae:0.4434889256954193, rse:0.8695066571235657
