Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='custom', data_path='national_illness.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0025, loss='mse', lradj='constant', model='PatchTST', model_id='104_60', moving_avg=25, n_heads=4, num_workers=1, output_attention=False, padding_patch='end', patch_len=24, patience=100, pct_start=0.3, pred_len=60, random_seed=2021, revin=1, root_path='./dataset/', seq_len=104, stride=2, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 104_60_PatchTST_custom_ftM_sl104_ll48_pl60_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 513
val 38
test 134
Epoch: 1 cost time: 0.8008899688720703
Epoch: 1, Steps: 32 | Train Loss: 1.0068470 Vali Loss: 0.3636837 Test Loss: 2.9933138
Validation loss decreased (inf --> 0.363684).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 0.7344610691070557
Epoch: 2, Steps: 32 | Train Loss: 0.8541473 Vali Loss: 0.5273248 Test Loss: 2.0159993
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 3 cost time: 0.7434005737304688
Epoch: 3, Steps: 32 | Train Loss: 0.5980846 Vali Loss: 0.3467264 Test Loss: 1.9140340
Validation loss decreased (0.363684 --> 0.346726).  Saving model ...
Updating learning rate to 0.0025
Epoch: 4 cost time: 0.8091719150543213
Epoch: 4, Steps: 32 | Train Loss: 0.5062330 Vali Loss: 0.2900097 Test Loss: 2.1263027
Validation loss decreased (0.346726 --> 0.290010).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 0.795243501663208
Epoch: 5, Steps: 32 | Train Loss: 0.4719526 Vali Loss: 0.2760304 Test Loss: 2.1587806
Validation loss decreased (0.290010 --> 0.276030).  Saving model ...
Updating learning rate to 0.0025
Epoch: 6 cost time: 0.7189188003540039
Epoch: 6, Steps: 32 | Train Loss: 0.4490307 Vali Loss: 0.2983236 Test Loss: 1.7711077
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 7 cost time: 0.7928745746612549
Epoch: 7, Steps: 32 | Train Loss: 0.4126259 Vali Loss: 0.3095595 Test Loss: 1.7629042
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 8 cost time: 0.7299726009368896
Epoch: 8, Steps: 32 | Train Loss: 0.3777979 Vali Loss: 0.2876770 Test Loss: 1.7533872
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 9 cost time: 0.8226528167724609
Epoch: 9, Steps: 32 | Train Loss: 0.3409529 Vali Loss: 0.2486085 Test Loss: 1.7006027
Validation loss decreased (0.276030 --> 0.248608).  Saving model ...
Updating learning rate to 0.0025
Epoch: 10 cost time: 0.8049130439758301
Epoch: 10, Steps: 32 | Train Loss: 0.3246513 Vali Loss: 0.2590405 Test Loss: 1.8383358
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 11 cost time: 0.780590295791626
Epoch: 11, Steps: 32 | Train Loss: 0.2981030 Vali Loss: 0.2307586 Test Loss: 1.5405501
Validation loss decreased (0.248608 --> 0.230759).  Saving model ...
Updating learning rate to 0.0025
Epoch: 12 cost time: 0.8547720909118652
Epoch: 12, Steps: 32 | Train Loss: 0.2839967 Vali Loss: 0.2508345 Test Loss: 1.5979950
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 13 cost time: 0.7600574493408203
Epoch: 13, Steps: 32 | Train Loss: 0.2694804 Vali Loss: 0.2742984 Test Loss: 1.5380721
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 14 cost time: 0.7300634384155273
Epoch: 14, Steps: 32 | Train Loss: 0.2547859 Vali Loss: 0.2694857 Test Loss: 1.5352441
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 15 cost time: 0.7575852870941162
Epoch: 15, Steps: 32 | Train Loss: 0.2544560 Vali Loss: 0.2933774 Test Loss: 1.4276792
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 16 cost time: 0.7199335098266602
Epoch: 16, Steps: 32 | Train Loss: 0.2505253 Vali Loss: 0.2426033 Test Loss: 1.4878080
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 17 cost time: 0.7308473587036133
Epoch: 17, Steps: 32 | Train Loss: 0.2445005 Vali Loss: 0.2566242 Test Loss: 1.4369457
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 18 cost time: 0.7578949928283691
Epoch: 18, Steps: 32 | Train Loss: 0.2286363 Vali Loss: 0.3048995 Test Loss: 1.3579458
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 19 cost time: 0.9162619113922119
Epoch: 19, Steps: 32 | Train Loss: 0.2302824 Vali Loss: 0.2502580 Test Loss: 1.5733567
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 20 cost time: 0.9065325260162354
Epoch: 20, Steps: 32 | Train Loss: 0.2317125 Vali Loss: 0.3237273 Test Loss: 1.3098816
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
Epoch: 21 cost time: 0.8464441299438477
Epoch: 21, Steps: 32 | Train Loss: 0.2199096 Vali Loss: 0.2438249 Test Loss: 1.4487740
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.0025
Epoch: 22 cost time: 0.9009866714477539
Epoch: 22, Steps: 32 | Train Loss: 0.2227278 Vali Loss: 0.2984648 Test Loss: 1.4010673
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.0025
Epoch: 23 cost time: 0.8304290771484375
Epoch: 23, Steps: 32 | Train Loss: 0.2210315 Vali Loss: 0.3236520 Test Loss: 1.3545682
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.0025
Epoch: 24 cost time: 0.856086015701294
Epoch: 24, Steps: 32 | Train Loss: 0.2093584 Vali Loss: 0.2675143 Test Loss: 1.3497598
EarlyStopping counter: 13 out of 100
Updating learning rate to 0.0025
Epoch: 25 cost time: 0.8137524127960205
Epoch: 25, Steps: 32 | Train Loss: 0.2073830 Vali Loss: 0.3015712 Test Loss: 1.2985408
EarlyStopping counter: 14 out of 100
Updating learning rate to 0.0025
Epoch: 26 cost time: 0.7538511753082275
Epoch: 26, Steps: 32 | Train Loss: 0.2091289 Vali Loss: 0.3126836 Test Loss: 1.4455853
EarlyStopping counter: 15 out of 100
Updating learning rate to 0.0025
Epoch: 27 cost time: 0.9062650203704834
Epoch: 27, Steps: 32 | Train Loss: 0.2031261 Vali Loss: 0.3039206 Test Loss: 1.3218179
EarlyStopping counter: 16 out of 100
Updating learning rate to 0.0025
Epoch: 28 cost time: 0.7121849060058594
Epoch: 28, Steps: 32 | Train Loss: 0.2009029 Vali Loss: 0.2782980 Test Loss: 1.3055019
EarlyStopping counter: 17 out of 100
Updating learning rate to 0.0025
Epoch: 29 cost time: 0.7703187465667725
Epoch: 29, Steps: 32 | Train Loss: 0.2092291 Vali Loss: 0.3750321 Test Loss: 1.3797927
EarlyStopping counter: 18 out of 100
Updating learning rate to 0.0025
Epoch: 30 cost time: 0.8044970035552979
Epoch: 30, Steps: 32 | Train Loss: 0.2059620 Vali Loss: 0.3226340 Test Loss: 1.2918522
EarlyStopping counter: 19 out of 100
Updating learning rate to 0.0025
Epoch: 31 cost time: 0.7525484561920166
Epoch: 31, Steps: 32 | Train Loss: 0.1884439 Vali Loss: 0.3145416 Test Loss: 1.3256354
EarlyStopping counter: 20 out of 100
Updating learning rate to 0.0025
Epoch: 32 cost time: 0.7794606685638428
Epoch: 32, Steps: 32 | Train Loss: 0.1872661 Vali Loss: 0.2870809 Test Loss: 1.3818911
EarlyStopping counter: 21 out of 100
Updating learning rate to 0.0025
Epoch: 33 cost time: 0.7272875308990479
Epoch: 33, Steps: 32 | Train Loss: 0.1921870 Vali Loss: 0.3489512 Test Loss: 1.3701332
EarlyStopping counter: 22 out of 100
Updating learning rate to 0.0025
Epoch: 34 cost time: 0.8085124492645264
Epoch: 34, Steps: 32 | Train Loss: 0.1920807 Vali Loss: 0.3167858 Test Loss: 1.2510266
EarlyStopping counter: 23 out of 100
Updating learning rate to 0.0025
Epoch: 35 cost time: 0.7789201736450195
Epoch: 35, Steps: 32 | Train Loss: 0.1855471 Vali Loss: 0.2807176 Test Loss: 1.3635439
EarlyStopping counter: 24 out of 100
Updating learning rate to 0.0025
Epoch: 36 cost time: 0.7621383666992188
Epoch: 36, Steps: 32 | Train Loss: 0.1818529 Vali Loss: 0.3672791 Test Loss: 1.3390309
EarlyStopping counter: 25 out of 100
Updating learning rate to 0.0025
Epoch: 37 cost time: 0.7579524517059326
Epoch: 37, Steps: 32 | Train Loss: 0.1773560 Vali Loss: 0.3101302 Test Loss: 1.2026660
EarlyStopping counter: 26 out of 100
Updating learning rate to 0.0025
Epoch: 38 cost time: 0.7961082458496094
Epoch: 38, Steps: 32 | Train Loss: 0.1820706 Vali Loss: 0.3431466 Test Loss: 1.2885091
EarlyStopping counter: 27 out of 100
Updating learning rate to 0.0025
Epoch: 39 cost time: 0.7970993518829346
Epoch: 39, Steps: 32 | Train Loss: 0.1744915 Vali Loss: 0.3160606 Test Loss: 1.2465067
EarlyStopping counter: 28 out of 100
Updating learning rate to 0.0025
Epoch: 40 cost time: 0.8104574680328369
Epoch: 40, Steps: 32 | Train Loss: 0.1703816 Vali Loss: 0.3294664 Test Loss: 1.3823376
EarlyStopping counter: 29 out of 100
Updating learning rate to 0.0025
Epoch: 41 cost time: 0.7948348522186279
Epoch: 41, Steps: 32 | Train Loss: 0.1721385 Vali Loss: 0.2842480 Test Loss: 1.3540462
EarlyStopping counter: 30 out of 100
Updating learning rate to 0.0025
Epoch: 42 cost time: 0.7263600826263428
Epoch: 42, Steps: 32 | Train Loss: 0.1686029 Vali Loss: 0.3056577 Test Loss: 1.3086585
EarlyStopping counter: 31 out of 100
Updating learning rate to 0.0025
Epoch: 43 cost time: 0.8281252384185791
Epoch: 43, Steps: 32 | Train Loss: 0.1720741 Vali Loss: 0.2706648 Test Loss: 1.3745855
EarlyStopping counter: 32 out of 100
Updating learning rate to 0.0025
Epoch: 44 cost time: 0.7978334426879883
Epoch: 44, Steps: 32 | Train Loss: 0.1668767 Vali Loss: 0.3108264 Test Loss: 1.3083723
EarlyStopping counter: 33 out of 100
Updating learning rate to 0.0025
Epoch: 45 cost time: 0.7687458992004395
Epoch: 45, Steps: 32 | Train Loss: 0.1661854 Vali Loss: 0.3285433 Test Loss: 1.3572727
EarlyStopping counter: 34 out of 100
Updating learning rate to 0.0025
Epoch: 46 cost time: 0.7580041885375977
Epoch: 46, Steps: 32 | Train Loss: 0.1626465 Vali Loss: 0.3054963 Test Loss: 1.2980785
EarlyStopping counter: 35 out of 100
Updating learning rate to 0.0025
Epoch: 47 cost time: 0.7230331897735596
Epoch: 47, Steps: 32 | Train Loss: 0.1600699 Vali Loss: 0.3033886 Test Loss: 1.2383567
EarlyStopping counter: 36 out of 100
Updating learning rate to 0.0025
Epoch: 48 cost time: 0.7232275009155273
Epoch: 48, Steps: 32 | Train Loss: 0.1588160 Vali Loss: 0.3194600 Test Loss: 1.3539286
EarlyStopping counter: 37 out of 100
Updating learning rate to 0.0025
Epoch: 49 cost time: 0.8120307922363281
Epoch: 49, Steps: 32 | Train Loss: 0.1566504 Vali Loss: 0.3343217 Test Loss: 1.3601259
EarlyStopping counter: 38 out of 100
Updating learning rate to 0.0025
Epoch: 50 cost time: 0.852785587310791
Epoch: 50, Steps: 32 | Train Loss: 0.1693902 Vali Loss: 0.3155921 Test Loss: 1.3685405
EarlyStopping counter: 39 out of 100
Updating learning rate to 0.0025
Epoch: 51 cost time: 0.7912390232086182
Epoch: 51, Steps: 32 | Train Loss: 0.1617829 Vali Loss: 0.3215054 Test Loss: 1.3408369
EarlyStopping counter: 40 out of 100
Updating learning rate to 0.0025
Epoch: 52 cost time: 0.76759934425354
Epoch: 52, Steps: 32 | Train Loss: 0.1569526 Vali Loss: 0.3074902 Test Loss: 1.2678916
EarlyStopping counter: 41 out of 100
Updating learning rate to 0.0025
Epoch: 53 cost time: 0.7833611965179443
Epoch: 53, Steps: 32 | Train Loss: 0.1532596 Vali Loss: 0.2931439 Test Loss: 1.3958416
EarlyStopping counter: 42 out of 100
Updating learning rate to 0.0025
Epoch: 54 cost time: 0.7303140163421631
Epoch: 54, Steps: 32 | Train Loss: 0.1563743 Vali Loss: 0.3068069 Test Loss: 1.2724490
EarlyStopping counter: 43 out of 100
Updating learning rate to 0.0025
Epoch: 55 cost time: 0.736264705657959
Epoch: 55, Steps: 32 | Train Loss: 0.1525234 Vali Loss: 0.3199720 Test Loss: 1.3438176
EarlyStopping counter: 44 out of 100
Updating learning rate to 0.0025
Epoch: 56 cost time: 0.7206587791442871
Epoch: 56, Steps: 32 | Train Loss: 0.1556046 Vali Loss: 0.3018338 Test Loss: 1.2987150
EarlyStopping counter: 45 out of 100
Updating learning rate to 0.0025
Epoch: 57 cost time: 0.7306468486785889
Epoch: 57, Steps: 32 | Train Loss: 0.1521985 Vali Loss: 0.2786946 Test Loss: 1.3558443
EarlyStopping counter: 46 out of 100
Updating learning rate to 0.0025
Epoch: 58 cost time: 0.8042042255401611
Epoch: 58, Steps: 32 | Train Loss: 0.1461638 Vali Loss: 0.2951456 Test Loss: 1.2893146
EarlyStopping counter: 47 out of 100
Updating learning rate to 0.0025
Epoch: 59 cost time: 0.7612478733062744
Epoch: 59, Steps: 32 | Train Loss: 0.1449005 Vali Loss: 0.3261415 Test Loss: 1.4414778
EarlyStopping counter: 48 out of 100
Updating learning rate to 0.0025
Epoch: 60 cost time: 0.7396855354309082
Epoch: 60, Steps: 32 | Train Loss: 0.1424344 Vali Loss: 0.2996210 Test Loss: 1.3676146
EarlyStopping counter: 49 out of 100
Updating learning rate to 0.0025
Epoch: 61 cost time: 0.7281906604766846
Epoch: 61, Steps: 32 | Train Loss: 0.1491383 Vali Loss: 0.2878100 Test Loss: 1.4093271
EarlyStopping counter: 50 out of 100
Updating learning rate to 0.0025
Epoch: 62 cost time: 0.8974478244781494
Epoch: 62, Steps: 32 | Train Loss: 0.1462753 Vali Loss: 0.3176644 Test Loss: 1.2505783
EarlyStopping counter: 51 out of 100
Updating learning rate to 0.0025
Epoch: 63 cost time: 0.8412845134735107
Epoch: 63, Steps: 32 | Train Loss: 0.1459926 Vali Loss: 0.3046759 Test Loss: 1.5509850
EarlyStopping counter: 52 out of 100
Updating learning rate to 0.0025
Epoch: 64 cost time: 0.7675168514251709
Epoch: 64, Steps: 32 | Train Loss: 0.1420771 Vali Loss: 0.3170024 Test Loss: 1.3301890
EarlyStopping counter: 53 out of 100
Updating learning rate to 0.0025
Epoch: 65 cost time: 0.8475480079650879
Epoch: 65, Steps: 32 | Train Loss: 0.1432076 Vali Loss: 0.3036976 Test Loss: 1.3455265
EarlyStopping counter: 54 out of 100
Updating learning rate to 0.0025
Epoch: 66 cost time: 0.813410758972168
Epoch: 66, Steps: 32 | Train Loss: 0.1372213 Vali Loss: 0.2802588 Test Loss: 1.4132943
EarlyStopping counter: 55 out of 100
Updating learning rate to 0.0025
Epoch: 67 cost time: 0.8295717239379883
Epoch: 67, Steps: 32 | Train Loss: 0.1478573 Vali Loss: 0.2997999 Test Loss: 1.4267790
EarlyStopping counter: 56 out of 100
Updating learning rate to 0.0025
Epoch: 68 cost time: 0.7264115810394287
Epoch: 68, Steps: 32 | Train Loss: 0.1363009 Vali Loss: 0.2833369 Test Loss: 1.4342191
EarlyStopping counter: 57 out of 100
Updating learning rate to 0.0025
Epoch: 69 cost time: 0.8274552822113037
Epoch: 69, Steps: 32 | Train Loss: 0.1401791 Vali Loss: 0.2872831 Test Loss: 1.3994465
EarlyStopping counter: 58 out of 100
Updating learning rate to 0.0025
Epoch: 70 cost time: 0.8233206272125244
Epoch: 70, Steps: 32 | Train Loss: 0.1445808 Vali Loss: 0.2824855 Test Loss: 1.4543438
EarlyStopping counter: 59 out of 100
Updating learning rate to 0.0025
Epoch: 71 cost time: 0.7433969974517822
Epoch: 71, Steps: 32 | Train Loss: 0.1407087 Vali Loss: 0.2921619 Test Loss: 1.4070086
EarlyStopping counter: 60 out of 100
Updating learning rate to 0.0025
Epoch: 72 cost time: 0.7947297096252441
Epoch: 72, Steps: 32 | Train Loss: 0.1332143 Vali Loss: 0.3021216 Test Loss: 1.2882795
EarlyStopping counter: 61 out of 100
Updating learning rate to 0.0025
Epoch: 73 cost time: 0.7968325614929199
Epoch: 73, Steps: 32 | Train Loss: 0.1318665 Vali Loss: 0.2740078 Test Loss: 1.4438868
EarlyStopping counter: 62 out of 100
Updating learning rate to 0.0025
Epoch: 74 cost time: 0.7279043197631836
Epoch: 74, Steps: 32 | Train Loss: 0.1308965 Vali Loss: 0.2938388 Test Loss: 1.4258983
EarlyStopping counter: 63 out of 100
Updating learning rate to 0.0025
Epoch: 75 cost time: 0.7217342853546143
Epoch: 75, Steps: 32 | Train Loss: 0.1295470 Vali Loss: 0.2650647 Test Loss: 1.4930005
EarlyStopping counter: 64 out of 100
Updating learning rate to 0.0025
Epoch: 76 cost time: 0.7105014324188232
Epoch: 76, Steps: 32 | Train Loss: 0.1310118 Vali Loss: 0.2810652 Test Loss: 1.3679788
EarlyStopping counter: 65 out of 100
Updating learning rate to 0.0025
Epoch: 77 cost time: 0.7945740222930908
Epoch: 77, Steps: 32 | Train Loss: 0.1300517 Vali Loss: 0.3081843 Test Loss: 1.4071565
EarlyStopping counter: 66 out of 100
Updating learning rate to 0.0025
Epoch: 78 cost time: 0.8372132778167725
Epoch: 78, Steps: 32 | Train Loss: 0.1324564 Vali Loss: 0.2801333 Test Loss: 1.5462688
EarlyStopping counter: 67 out of 100
Updating learning rate to 0.0025
Epoch: 79 cost time: 0.8469159603118896
Epoch: 79, Steps: 32 | Train Loss: 0.1374085 Vali Loss: 0.3164593 Test Loss: 1.3497553
EarlyStopping counter: 68 out of 100
Updating learning rate to 0.0025
Epoch: 80 cost time: 0.710735559463501
Epoch: 80, Steps: 32 | Train Loss: 0.1288615 Vali Loss: 0.2701095 Test Loss: 1.3749828
EarlyStopping counter: 69 out of 100
Updating learning rate to 0.0025
Epoch: 81 cost time: 0.7940948009490967
Epoch: 81, Steps: 32 | Train Loss: 0.1294559 Vali Loss: 0.2975123 Test Loss: 1.3347731
EarlyStopping counter: 70 out of 100
Updating learning rate to 0.0025
Epoch: 82 cost time: 0.7169902324676514
Epoch: 82, Steps: 32 | Train Loss: 0.1276100 Vali Loss: 0.2691643 Test Loss: 1.4701166
EarlyStopping counter: 71 out of 100
Updating learning rate to 0.0025
Epoch: 83 cost time: 0.8192446231842041
Epoch: 83, Steps: 32 | Train Loss: 0.1250155 Vali Loss: 0.2896842 Test Loss: 1.3778536
EarlyStopping counter: 72 out of 100
Updating learning rate to 0.0025
Epoch: 84 cost time: 0.7907838821411133
Epoch: 84, Steps: 32 | Train Loss: 0.1258094 Vali Loss: 0.2555513 Test Loss: 1.3864906
EarlyStopping counter: 73 out of 100
Updating learning rate to 0.0025
Epoch: 85 cost time: 0.8536350727081299
Epoch: 85, Steps: 32 | Train Loss: 0.1254732 Vali Loss: 0.2787449 Test Loss: 1.5172000
EarlyStopping counter: 74 out of 100
Updating learning rate to 0.0025
Epoch: 86 cost time: 0.7956643104553223
Epoch: 86, Steps: 32 | Train Loss: 0.1210286 Vali Loss: 0.2822879 Test Loss: 1.4333262
EarlyStopping counter: 75 out of 100
Updating learning rate to 0.0025
Epoch: 87 cost time: 0.8020658493041992
Epoch: 87, Steps: 32 | Train Loss: 0.1239293 Vali Loss: 0.2768854 Test Loss: 1.4561853
EarlyStopping counter: 76 out of 100
Updating learning rate to 0.0025
Epoch: 88 cost time: 0.7498781681060791
Epoch: 88, Steps: 32 | Train Loss: 0.1368065 Vali Loss: 0.2942415 Test Loss: 1.5499587
EarlyStopping counter: 77 out of 100
Updating learning rate to 0.0025
Epoch: 89 cost time: 0.7921819686889648
Epoch: 89, Steps: 32 | Train Loss: 0.1351591 Vali Loss: 0.3101323 Test Loss: 1.4672823
EarlyStopping counter: 78 out of 100
Updating learning rate to 0.0025
Epoch: 90 cost time: 0.7780106067657471
Epoch: 90, Steps: 32 | Train Loss: 0.1270610 Vali Loss: 0.2914313 Test Loss: 1.3670249
EarlyStopping counter: 79 out of 100
Updating learning rate to 0.0025
Epoch: 91 cost time: 0.7659657001495361
Epoch: 91, Steps: 32 | Train Loss: 0.1304882 Vali Loss: 0.2962688 Test Loss: 1.5016685
EarlyStopping counter: 80 out of 100
Updating learning rate to 0.0025
Epoch: 92 cost time: 0.7945313453674316
Epoch: 92, Steps: 32 | Train Loss: 0.1255075 Vali Loss: 0.3068419 Test Loss: 1.4282573
EarlyStopping counter: 81 out of 100
Updating learning rate to 0.0025
Epoch: 93 cost time: 0.7212250232696533
Epoch: 93, Steps: 32 | Train Loss: 0.1217111 Vali Loss: 0.2894443 Test Loss: 1.4750345
EarlyStopping counter: 82 out of 100
Updating learning rate to 0.0025
Epoch: 94 cost time: 0.8004412651062012
Epoch: 94, Steps: 32 | Train Loss: 0.1209552 Vali Loss: 0.3106245 Test Loss: 1.3052177
EarlyStopping counter: 83 out of 100
Updating learning rate to 0.0025
Epoch: 95 cost time: 0.7384774684906006
Epoch: 95, Steps: 32 | Train Loss: 0.1290123 Vali Loss: 0.2987798 Test Loss: 1.4479733
EarlyStopping counter: 84 out of 100
Updating learning rate to 0.0025
Epoch: 96 cost time: 0.7562859058380127
Epoch: 96, Steps: 32 | Train Loss: 0.1217287 Vali Loss: 0.2997723 Test Loss: 1.4157600
EarlyStopping counter: 85 out of 100
Updating learning rate to 0.0025
Epoch: 97 cost time: 0.8115706443786621
Epoch: 97, Steps: 32 | Train Loss: 0.1285030 Vali Loss: 0.2703605 Test Loss: 1.5470712
EarlyStopping counter: 86 out of 100
Updating learning rate to 0.0025
Epoch: 98 cost time: 0.737525463104248
Epoch: 98, Steps: 32 | Train Loss: 0.1249997 Vali Loss: 0.3090290 Test Loss: 1.4665284
EarlyStopping counter: 87 out of 100
Updating learning rate to 0.0025
Epoch: 99 cost time: 0.7655823230743408
Epoch: 99, Steps: 32 | Train Loss: 0.1243942 Vali Loss: 0.2749557 Test Loss: 1.5643469
EarlyStopping counter: 88 out of 100
Updating learning rate to 0.0025
Epoch: 100 cost time: 0.8096485137939453
Epoch: 100, Steps: 32 | Train Loss: 0.1234057 Vali Loss: 0.3189980 Test Loss: 1.3544803
EarlyStopping counter: 89 out of 100
Updating learning rate to 0.0025
>>>>>>>testing : 104_60_PatchTST_custom_ftM_sl104_ll48_pl60_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:1.5405501127243042, mae:0.8666031360626221, rse:0.5930930972099304
