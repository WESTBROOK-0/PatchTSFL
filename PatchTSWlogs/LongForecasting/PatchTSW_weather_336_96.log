Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTSW', model_id='weather_336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : weather_336_96_PatchTSW_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6129484
	speed: 1.3801s/iter; left time: 39059.5497s
	iters: 200, epoch: 1 | loss: 0.5871539
	speed: 1.3700s/iter; left time: 38635.4314s
Epoch: 1 cost time: 390.5814731121063
Epoch: 1, Steps: 284 | Train Loss: 0.6222822 Vali Loss: 0.5229384 Test Loss: 0.2058574
Validation loss decreased (inf --> 0.522938).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4545175
	speed: 3.0565s/iter; left time: 85634.0321s
	iters: 200, epoch: 2 | loss: 0.3309811
	speed: 1.3701s/iter; left time: 38248.0570s
Epoch: 2 cost time: 390.74846053123474
Epoch: 2, Steps: 284 | Train Loss: 0.4733046 Vali Loss: 0.4092945 Test Loss: 0.1654223
Validation loss decreased (0.522938 --> 0.409295).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3172179
	speed: 3.0557s/iter; left time: 84744.5420s
	iters: 200, epoch: 3 | loss: 0.6100616
	speed: 1.3693s/iter; left time: 37836.8983s
Epoch: 3 cost time: 390.6415717601776
Epoch: 3, Steps: 284 | Train Loss: 0.4434396 Vali Loss: 0.4050194 Test Loss: 0.1618064
Validation loss decreased (0.409295 --> 0.405019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3510319
	speed: 3.0512s/iter; left time: 83753.3757s
	iters: 200, epoch: 4 | loss: 0.3436720
	speed: 1.3701s/iter; left time: 37470.1428s
Epoch: 4 cost time: 390.72097969055176
Epoch: 4, Steps: 284 | Train Loss: 0.4337791 Vali Loss: 0.3907478 Test Loss: 0.1585869
Validation loss decreased (0.405019 --> 0.390748).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3102592
	speed: 3.0526s/iter; left time: 82923.1811s
	iters: 200, epoch: 5 | loss: 0.3309570
	speed: 1.3701s/iter; left time: 37083.0986s
Epoch: 5 cost time: 390.5076947212219
Epoch: 5, Steps: 284 | Train Loss: 0.4246727 Vali Loss: 0.3953921 Test Loss: 0.1586702
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3297142
	speed: 3.0478s/iter; left time: 81929.0839s
	iters: 200, epoch: 6 | loss: 0.2788481
	speed: 1.3702s/iter; left time: 36696.1914s
Epoch: 6 cost time: 390.79571318626404
Epoch: 6, Steps: 284 | Train Loss: 0.4208519 Vali Loss: 0.3938118 Test Loss: 0.1586538
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7478572
	speed: 3.0452s/iter; left time: 80993.4700s
	iters: 200, epoch: 7 | loss: 0.3736830
	speed: 1.3698s/iter; left time: 36296.0930s
Epoch: 7 cost time: 390.56794023513794
Epoch: 7, Steps: 284 | Train Loss: 0.4169237 Vali Loss: 0.3867575 Test Loss: 0.1570043
Validation loss decreased (0.390748 --> 0.386757).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3982784
	speed: 3.0546s/iter; left time: 80374.7211s
	iters: 200, epoch: 8 | loss: 0.3449307
	speed: 1.3699s/iter; left time: 35909.9052s
Epoch: 8 cost time: 390.60508584976196
Epoch: 8, Steps: 284 | Train Loss: 0.4129989 Vali Loss: 0.3909462 Test Loss: 0.1552332
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6315314
	speed: 3.0454s/iter; left time: 79268.6997s
	iters: 200, epoch: 9 | loss: 0.2741989
	speed: 1.3703s/iter; left time: 35530.6792s
Epoch: 9 cost time: 390.6738464832306
Epoch: 9, Steps: 284 | Train Loss: 0.4083073 Vali Loss: 0.3949414 Test Loss: 0.1551730
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5290579
	speed: 3.0479s/iter; left time: 78468.9257s
	iters: 200, epoch: 10 | loss: 0.3121431
	speed: 1.3704s/iter; left time: 35143.4656s
Epoch: 10 cost time: 390.7905042171478
Epoch: 10, Steps: 284 | Train Loss: 0.4047468 Vali Loss: 0.3887290 Test Loss: 0.1551050
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5191965
	speed: 3.0463s/iter; left time: 77562.1925s
	iters: 200, epoch: 11 | loss: 0.3709532
	speed: 1.3706s/iter; left time: 34759.2370s
Epoch: 11 cost time: 390.83864307403564
Epoch: 11, Steps: 284 | Train Loss: 0.4018619 Vali Loss: 0.3916053 Test Loss: 0.1544408
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.4289964
	speed: 3.0509s/iter; left time: 76813.6210s
	iters: 200, epoch: 12 | loss: 0.5601371
	speed: 1.3707s/iter; left time: 34371.8163s
Epoch: 12 cost time: 390.9448890686035
Epoch: 12, Steps: 284 | Train Loss: 0.3988822 Vali Loss: 0.3865019 Test Loss: 0.1532605
Validation loss decreased (0.386757 --> 0.386502).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6071916
	speed: 3.0572s/iter; left time: 76103.4977s
	iters: 200, epoch: 13 | loss: 0.2926562
	speed: 1.3705s/iter; left time: 33978.4471s
Epoch: 13 cost time: 390.78348302841187
Epoch: 13, Steps: 284 | Train Loss: 0.3965997 Vali Loss: 0.3917064 Test Loss: 0.1536416
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3519354
	speed: 3.0503s/iter; left time: 75064.0815s
	iters: 200, epoch: 14 | loss: 0.2622193
	speed: 1.3703s/iter; left time: 33585.0190s
Epoch: 14 cost time: 390.8044192790985
Epoch: 14, Steps: 284 | Train Loss: 0.3943393 Vali Loss: 0.3980231 Test Loss: 0.1551597
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.3737715
	speed: 3.0455s/iter; left time: 74081.9891s
	iters: 200, epoch: 15 | loss: 0.3417461
	speed: 1.3705s/iter; left time: 33200.9376s
Epoch: 15 cost time: 390.82080006599426
Epoch: 15, Steps: 284 | Train Loss: 0.3929254 Vali Loss: 0.3925358 Test Loss: 0.1554051
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5844471
	speed: 3.0497s/iter; left time: 73319.0101s
	iters: 200, epoch: 16 | loss: 0.7859401
	speed: 1.3699s/iter; left time: 32797.0044s
Epoch: 16 cost time: 390.7364618778229
Epoch: 16, Steps: 284 | Train Loss: 0.3902470 Vali Loss: 0.3937199 Test Loss: 0.1541898
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.4735517
	speed: 3.0501s/iter; left time: 72461.9262s
	iters: 200, epoch: 17 | loss: 0.2909903
	speed: 1.3705s/iter; left time: 32421.6394s
Epoch: 17 cost time: 390.959082365036
Epoch: 17, Steps: 284 | Train Loss: 0.3888491 Vali Loss: 0.3943833 Test Loss: 0.1554199
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2786867
	speed: 3.0441s/iter; left time: 71454.9029s
	iters: 200, epoch: 18 | loss: 0.5304045
	speed: 1.3702s/iter; left time: 32026.0956s
Epoch: 18 cost time: 390.601176738739
Epoch: 18, Steps: 284 | Train Loss: 0.3862943 Vali Loss: 0.3935243 Test Loss: 0.1555456
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6245903
	speed: 3.0489s/iter; left time: 70700.3533s
	iters: 200, epoch: 19 | loss: 0.3106061
	speed: 1.3701s/iter; left time: 31634.8693s
Epoch: 19 cost time: 390.7169625759125
Epoch: 19, Steps: 284 | Train Loss: 0.3850135 Vali Loss: 0.3967997 Test Loss: 0.1549997
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3116315
	speed: 3.0452s/iter; left time: 69750.2825s
	iters: 200, epoch: 20 | loss: 0.5877495
	speed: 1.3704s/iter; left time: 31251.9482s
Epoch: 20 cost time: 390.63991045951843
Epoch: 20, Steps: 284 | Train Loss: 0.3842628 Vali Loss: 0.3990501 Test Loss: 0.1561855
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.3370551
	speed: 3.0457s/iter; left time: 68896.5520s
	iters: 200, epoch: 21 | loss: 0.7834809
	speed: 1.3702s/iter; left time: 30858.1497s
Epoch: 21 cost time: 390.80049777030945
Epoch: 21, Steps: 284 | Train Loss: 0.3825854 Vali Loss: 0.3966067 Test Loss: 0.1547298
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.3182006
	speed: 3.0510s/iter; left time: 68150.3990s
	iters: 200, epoch: 22 | loss: 0.3849841
	speed: 1.3701s/iter; left time: 30466.4000s
Epoch: 22 cost time: 390.9449985027313
Epoch: 22, Steps: 284 | Train Loss: 0.3819958 Vali Loss: 0.3988235 Test Loss: 0.1553437
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.2808238
	speed: 3.0497s/iter; left time: 67253.9347s
	iters: 200, epoch: 23 | loss: 0.2362332
	speed: 1.3704s/iter; left time: 30084.4730s
Epoch: 23 cost time: 390.73384284973145
Epoch: 23, Steps: 284 | Train Loss: 0.3813333 Vali Loss: 0.3979736 Test Loss: 0.1552516
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.3904257
	speed: 3.0525s/iter; left time: 66450.6663s
	iters: 200, epoch: 24 | loss: 0.2500364
	speed: 1.3700s/iter; left time: 29687.1703s
Epoch: 24 cost time: 390.7879068851471
Epoch: 24, Steps: 284 | Train Loss: 0.3804992 Vali Loss: 0.3960820 Test Loss: 0.1553039
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.4229225
	speed: 3.0440s/iter; left time: 65401.2512s
	iters: 200, epoch: 25 | loss: 0.3448814
	speed: 1.3703s/iter; left time: 29303.6901s
Epoch: 25 cost time: 390.7336232662201
Epoch: 25, Steps: 284 | Train Loss: 0.3777886 Vali Loss: 0.4013821 Test Loss: 0.1556714
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.2672226
	speed: 3.0486s/iter; left time: 64634.0756s
	iters: 200, epoch: 26 | loss: 0.4940908
	speed: 1.3703s/iter; left time: 28914.9112s
Epoch: 26 cost time: 390.74956130981445
Epoch: 26, Steps: 284 | Train Loss: 0.3786579 Vali Loss: 0.3989792 Test Loss: 0.1556010
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.3085394
	speed: 3.0471s/iter; left time: 63736.4488s
	iters: 200, epoch: 27 | loss: 0.2864507
	speed: 1.3702s/iter; left time: 28522.8867s
Epoch: 27 cost time: 390.7228252887726
Epoch: 27, Steps: 284 | Train Loss: 0.3780315 Vali Loss: 0.3961644 Test Loss: 0.1552019
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.4332891
	speed: 3.0505s/iter; left time: 62939.9552s
	iters: 200, epoch: 28 | loss: 0.4718239
	speed: 1.3701s/iter; left time: 28133.2409s
Epoch: 28 cost time: 390.9154758453369
Epoch: 28, Steps: 284 | Train Loss: 0.3767060 Vali Loss: 0.3978012 Test Loss: 0.1552939
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.5481229
	speed: 3.0453s/iter; left time: 61969.8051s
	iters: 200, epoch: 29 | loss: 0.2502696
	speed: 1.3701s/iter; left time: 27742.7535s
Epoch: 29 cost time: 390.59131932258606
Epoch: 29, Steps: 284 | Train Loss: 0.3771907 Vali Loss: 0.4011655 Test Loss: 0.1562590
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.2753352
	speed: 3.0471s/iter; left time: 61140.2618s
	iters: 200, epoch: 30 | loss: 0.3896460
	speed: 1.3702s/iter; left time: 27356.9671s
Epoch: 30 cost time: 390.8667984008789
Epoch: 30, Steps: 284 | Train Loss: 0.3767591 Vali Loss: 0.4003400 Test Loss: 0.1557621
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.2607989
	speed: 3.0462s/iter; left time: 60256.1388s
	iters: 200, epoch: 31 | loss: 0.4674869
	speed: 1.3703s/iter; left time: 26969.2533s
Epoch: 31 cost time: 390.7568619251251
Epoch: 31, Steps: 284 | Train Loss: 0.3753341 Vali Loss: 0.4007409 Test Loss: 0.1556187
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.3662615
	speed: 3.0482s/iter; left time: 59429.9262s
	iters: 200, epoch: 32 | loss: 0.3079279
	speed: 1.3703s/iter; left time: 26579.6425s
Epoch: 32 cost time: 390.84658336639404
Epoch: 32, Steps: 284 | Train Loss: 0.3759111 Vali Loss: 0.4005894 Test Loss: 0.1560151
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : weather_336_96_PatchTSW_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1532605141401291, mae:0.2026001363992691, rse:0.5157333016395569
