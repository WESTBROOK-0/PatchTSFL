Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3675136
	speed: 0.0509s/iter; left time: 1338.3155s
	iters: 200, epoch: 1 | loss: 0.7393699
	speed: 0.0453s/iter; left time: 1187.8285s
Epoch: 1 cost time: 12.63948655128479
Epoch: 1, Steps: 264 | Train Loss: 0.4879574 Vali Loss: 0.2250672 Test Loss: 0.3038928
Validation loss decreased (inf --> 0.225067).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.3860705
	speed: 0.1286s/iter; left time: 3348.6967s
	iters: 200, epoch: 2 | loss: 0.4814833
	speed: 0.0453s/iter; left time: 1175.6403s
Epoch: 2 cost time: 12.58810806274414
Epoch: 2, Steps: 264 | Train Loss: 0.4357000 Vali Loss: 0.2131896 Test Loss: 0.2907100
Validation loss decreased (0.225067 --> 0.213190).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.4807566
	speed: 0.1284s/iter; left time: 3308.7062s
	iters: 200, epoch: 3 | loss: 0.5010685
	speed: 0.0453s/iter; left time: 1163.8296s
Epoch: 3 cost time: 12.548618793487549
Epoch: 3, Steps: 264 | Train Loss: 0.4210957 Vali Loss: 0.2085907 Test Loss: 0.2836312
Validation loss decreased (0.213190 --> 0.208591).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.3757508
	speed: 0.1315s/iter; left time: 3355.1446s
	iters: 200, epoch: 4 | loss: 0.3906310
	speed: 0.0453s/iter; left time: 1149.9915s
Epoch: 4 cost time: 12.670732498168945
Epoch: 4, Steps: 264 | Train Loss: 0.4114720 Vali Loss: 0.2058649 Test Loss: 0.2803280
Validation loss decreased (0.208591 --> 0.205865).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3472645
	speed: 0.1272s/iter; left time: 3211.4807s
	iters: 200, epoch: 5 | loss: 0.4550141
	speed: 0.0453s/iter; left time: 1139.4604s
Epoch: 5 cost time: 12.560851573944092
Epoch: 5, Steps: 264 | Train Loss: 0.4059360 Vali Loss: 0.2034747 Test Loss: 0.2786009
Validation loss decreased (0.205865 --> 0.203475).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.2611705
	speed: 0.1284s/iter; left time: 3207.8394s
	iters: 200, epoch: 6 | loss: 0.5400327
	speed: 0.0453s/iter; left time: 1126.1552s
Epoch: 6 cost time: 12.651212215423584
Epoch: 6, Steps: 264 | Train Loss: 0.4009742 Vali Loss: 0.2033404 Test Loss: 0.2778844
Validation loss decreased (0.203475 --> 0.203340).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.3704583
	speed: 0.1279s/iter; left time: 3160.3513s
	iters: 200, epoch: 7 | loss: 0.3226481
	speed: 0.0454s/iter; left time: 1116.4182s
Epoch: 7 cost time: 12.645407438278198
Epoch: 7, Steps: 264 | Train Loss: 0.3976601 Vali Loss: 0.2014153 Test Loss: 0.2777142
Validation loss decreased (0.203340 --> 0.201415).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3902133
	speed: 0.1280s/iter; left time: 3129.4061s
	iters: 200, epoch: 8 | loss: 0.6442590
	speed: 0.0455s/iter; left time: 1106.8608s
Epoch: 8 cost time: 12.62581491470337
Epoch: 8, Steps: 264 | Train Loss: 0.3941614 Vali Loss: 0.2021182 Test Loss: 0.2753668
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.5777643
	speed: 0.1284s/iter; left time: 3105.0139s
	iters: 200, epoch: 9 | loss: 0.3902735
	speed: 0.0454s/iter; left time: 1093.6420s
Epoch: 9 cost time: 12.606417894363403
Epoch: 9, Steps: 264 | Train Loss: 0.3897901 Vali Loss: 0.2033440 Test Loss: 0.2756298
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.4248345
	speed: 0.1265s/iter; left time: 3025.9337s
	iters: 200, epoch: 10 | loss: 0.3689362
	speed: 0.0453s/iter; left time: 1078.5600s
Epoch: 10 cost time: 12.56227993965149
Epoch: 10, Steps: 264 | Train Loss: 0.3835844 Vali Loss: 0.2062063 Test Loss: 0.2740324
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3030663
	speed: 0.1277s/iter; left time: 3021.6551s
	iters: 200, epoch: 11 | loss: 0.3842235
	speed: 0.0453s/iter; left time: 1067.0337s
Epoch: 11 cost time: 12.5650794506073
Epoch: 11, Steps: 264 | Train Loss: 0.3752881 Vali Loss: 0.2066465 Test Loss: 0.2785345
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.5591587
	speed: 0.1277s/iter; left time: 2987.2096s
	iters: 200, epoch: 12 | loss: 0.4077314
	speed: 0.0453s/iter; left time: 1055.0428s
Epoch: 12 cost time: 12.563899278640747
Epoch: 12, Steps: 264 | Train Loss: 0.3647057 Vali Loss: 0.2141461 Test Loss: 0.2784942
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3820473
	speed: 0.1267s/iter; left time: 2931.2768s
	iters: 200, epoch: 13 | loss: 0.3794824
	speed: 0.0453s/iter; left time: 1043.9218s
Epoch: 13 cost time: 12.568175554275513
Epoch: 13, Steps: 264 | Train Loss: 0.3517101 Vali Loss: 0.2140523 Test Loss: 0.2873279
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3604068
	speed: 0.1267s/iter; left time: 2898.3643s
	iters: 200, epoch: 14 | loss: 0.3612600
	speed: 0.0453s/iter; left time: 1031.5443s
Epoch: 14 cost time: 12.582902193069458
Epoch: 14, Steps: 264 | Train Loss: 0.3387346 Vali Loss: 0.2144942 Test Loss: 0.2860706
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.2584434
	speed: 0.1258s/iter; left time: 2843.8157s
	iters: 200, epoch: 15 | loss: 0.3673834
	speed: 0.0455s/iter; left time: 1023.2264s
Epoch: 15 cost time: 12.597402572631836
Epoch: 15, Steps: 264 | Train Loss: 0.3284314 Vali Loss: 0.2187669 Test Loss: 0.2895360
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.3507352
	speed: 0.1303s/iter; left time: 2910.3266s
	iters: 200, epoch: 16 | loss: 0.2893483
	speed: 0.0455s/iter; left time: 1012.6123s
Epoch: 16 cost time: 12.664093255996704
Epoch: 16, Steps: 264 | Train Loss: 0.3213498 Vali Loss: 0.2233534 Test Loss: 0.2908411
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.3863802
	speed: 0.1286s/iter; left time: 2838.2156s
	iters: 200, epoch: 17 | loss: 0.2727879
	speed: 0.0454s/iter; left time: 997.6932s
Epoch: 17 cost time: 12.557850122451782
Epoch: 17, Steps: 264 | Train Loss: 0.3142803 Vali Loss: 0.2203955 Test Loss: 0.2967618
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.3297920
	speed: 0.1267s/iter; left time: 2764.1757s
	iters: 200, epoch: 18 | loss: 0.4005871
	speed: 0.0454s/iter; left time: 985.1049s
Epoch: 18 cost time: 12.590700387954712
Epoch: 18, Steps: 264 | Train Loss: 0.3086515 Vali Loss: 0.2255528 Test Loss: 0.2977825
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.2371018
	speed: 0.1306s/iter; left time: 2814.1884s
	iters: 200, epoch: 19 | loss: 0.3066040
	speed: 0.0453s/iter; left time: 971.9489s
Epoch: 19 cost time: 12.642375707626343
Epoch: 19, Steps: 264 | Train Loss: 0.3040729 Vali Loss: 0.2283821 Test Loss: 0.2956205
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3345319
	speed: 0.1267s/iter; left time: 2696.0914s
	iters: 200, epoch: 20 | loss: 0.2363614
	speed: 0.0453s/iter; left time: 960.2854s
Epoch: 20 cost time: 12.528713464736938
Epoch: 20, Steps: 264 | Train Loss: 0.2991459 Vali Loss: 0.2241776 Test Loss: 0.2994867
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.3182773
	speed: 0.1266s/iter; left time: 2660.2815s
	iters: 200, epoch: 21 | loss: 0.3026348
	speed: 0.0455s/iter; left time: 950.8724s
Epoch: 21 cost time: 12.605710983276367
Epoch: 21, Steps: 264 | Train Loss: 0.2953489 Vali Loss: 0.2258737 Test Loss: 0.3034400
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.3980359
	speed: 0.1276s/iter; left time: 2649.1765s
	iters: 200, epoch: 22 | loss: 0.2783976
	speed: 0.0454s/iter; left time: 937.2807s
Epoch: 22 cost time: 12.645535707473755
Epoch: 22, Steps: 264 | Train Loss: 0.2906170 Vali Loss: 0.2242805 Test Loss: 0.3089822
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.2841472
	speed: 0.1279s/iter; left time: 2621.4385s
	iters: 200, epoch: 23 | loss: 0.2452578
	speed: 0.0453s/iter; left time: 924.2053s
Epoch: 23 cost time: 12.609101057052612
Epoch: 23, Steps: 264 | Train Loss: 0.2867430 Vali Loss: 0.2266791 Test Loss: 0.3036967
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2510405
	speed: 0.1284s/iter; left time: 2596.9060s
	iters: 200, epoch: 24 | loss: 0.2450727
	speed: 0.0453s/iter; left time: 912.4289s
Epoch: 24 cost time: 12.617845058441162
Epoch: 24, Steps: 264 | Train Loss: 0.2835955 Vali Loss: 0.2290768 Test Loss: 0.3078125
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.2600704
	speed: 0.1286s/iter; left time: 2567.1330s
	iters: 200, epoch: 25 | loss: 0.2497765
	speed: 0.0453s/iter; left time: 900.5894s
Epoch: 25 cost time: 12.617690324783325
Epoch: 25, Steps: 264 | Train Loss: 0.2800437 Vali Loss: 0.2237941 Test Loss: 0.3040627
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2832748
	speed: 0.1270s/iter; left time: 2501.7201s
	iters: 200, epoch: 26 | loss: 0.3438624
	speed: 0.0453s/iter; left time: 887.5285s
Epoch: 26 cost time: 12.59563422203064
Epoch: 26, Steps: 264 | Train Loss: 0.2772164 Vali Loss: 0.2240608 Test Loss: 0.3081551
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2715236
	speed: 0.1302s/iter; left time: 2531.1954s
	iters: 200, epoch: 27 | loss: 0.2965508
	speed: 0.0462s/iter; left time: 893.3501s
Epoch: 27 cost time: 12.787946939468384
Epoch: 27, Steps: 264 | Train Loss: 0.2739201 Vali Loss: 0.2271624 Test Loss: 0.3101223
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.27771416306495667, mae:0.3293546140193939, rse:0.4251704514026642
