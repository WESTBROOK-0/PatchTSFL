Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='custom', data_path='national_illness.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0025, loss='mse', lradj='constant', model='PatchTSFL', model_id='104_60', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=24, patience=100, pct_start=0.3, pred_len=60, random_seed=2021, revin=1, root_path='./dataset/', seq_len=104, stride=2, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 104_60_PatchTSFL_custom_ftM_sl104_ll48_pl60_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 513
val 38
test 134
Epoch: 1 cost time: 1.6413369178771973
Epoch: 1, Steps: 32 | Train Loss: 0.8970994 Vali Loss: 0.6677788 Test Loss: 4.3260584
Validation loss decreased (inf --> 0.667779).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 1.7000586986541748
Epoch: 2, Steps: 32 | Train Loss: 0.8945675 Vali Loss: 0.6725945 Test Loss: 4.2765160
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 3 cost time: 1.7472801208496094
Epoch: 3, Steps: 32 | Train Loss: 0.8918812 Vali Loss: 0.6568594 Test Loss: 4.2350726
Validation loss decreased (0.667779 --> 0.656859).  Saving model ...
Updating learning rate to 0.0025
Epoch: 4 cost time: 1.6871604919433594
Epoch: 4, Steps: 32 | Train Loss: 0.8890130 Vali Loss: 0.6329518 Test Loss: 4.2093420
Validation loss decreased (0.656859 --> 0.632952).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 1.7411375045776367
Epoch: 5, Steps: 32 | Train Loss: 0.8882336 Vali Loss: 0.6536195 Test Loss: 4.1952610
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 6 cost time: 1.6849517822265625
Epoch: 6, Steps: 32 | Train Loss: 0.8888834 Vali Loss: 0.6566468 Test Loss: 4.1760931
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 7 cost time: 1.5230834484100342
Epoch: 7, Steps: 32 | Train Loss: 0.8878871 Vali Loss: 0.6564007 Test Loss: 4.1734796
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 8 cost time: 1.843231439590454
Epoch: 8, Steps: 32 | Train Loss: 0.8868386 Vali Loss: 0.6607909 Test Loss: 4.1691093
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 9 cost time: 1.6515929698944092
Epoch: 9, Steps: 32 | Train Loss: 0.8876964 Vali Loss: 0.6635739 Test Loss: 4.1691661
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 10 cost time: 1.7411682605743408
Epoch: 10, Steps: 32 | Train Loss: 0.8833150 Vali Loss: 0.6502801 Test Loss: 4.1650543
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 11 cost time: 1.8328485488891602
Epoch: 11, Steps: 32 | Train Loss: 0.8884244 Vali Loss: 0.6406022 Test Loss: 4.1634130
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 12 cost time: 1.867135763168335
Epoch: 12, Steps: 32 | Train Loss: 0.8883926 Vali Loss: 0.6346282 Test Loss: 4.1596160
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 13 cost time: 1.7815065383911133
Epoch: 13, Steps: 32 | Train Loss: 0.8837340 Vali Loss: 0.6678125 Test Loss: 4.1638846
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
Epoch: 14 cost time: 1.545546054840088
Epoch: 14, Steps: 32 | Train Loss: 0.8883779 Vali Loss: 0.6444993 Test Loss: 4.1558175
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.0025
Epoch: 15 cost time: 1.636009693145752
Epoch: 15, Steps: 32 | Train Loss: 0.8879192 Vali Loss: 0.6721224 Test Loss: 4.1602726
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.0025
Epoch: 16 cost time: 1.6518824100494385
Epoch: 16, Steps: 32 | Train Loss: 0.8882314 Vali Loss: 0.6496270 Test Loss: 4.1603503
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.0025
Epoch: 17 cost time: 1.6267893314361572
Epoch: 17, Steps: 32 | Train Loss: 0.8876176 Vali Loss: 0.6301295 Test Loss: 4.1655588
Validation loss decreased (0.632952 --> 0.630129).  Saving model ...
Updating learning rate to 0.0025
Epoch: 18 cost time: 1.7299201488494873
Epoch: 18, Steps: 32 | Train Loss: 0.8884921 Vali Loss: 0.6511139 Test Loss: 4.1659727
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 19 cost time: 1.7640864849090576
