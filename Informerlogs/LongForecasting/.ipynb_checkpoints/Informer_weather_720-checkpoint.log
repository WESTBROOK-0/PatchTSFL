Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_Informer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8252253
	speed: 0.0562s/iter; left time: 1001.7269s
	iters: 200, epoch: 1 | loss: 0.9499935
	speed: 0.0362s/iter; left time: 641.5224s
	iters: 300, epoch: 1 | loss: 0.5979691
	speed: 0.0365s/iter; left time: 642.6508s
	iters: 400, epoch: 1 | loss: 1.5452176
	speed: 0.0364s/iter; left time: 637.3104s
	iters: 500, epoch: 1 | loss: 0.5673402
	speed: 0.0365s/iter; left time: 636.1743s
	iters: 600, epoch: 1 | loss: 0.8126358
	speed: 0.0360s/iter; left time: 624.0360s
	iters: 700, epoch: 1 | loss: 0.8376273
	speed: 0.0354s/iter; left time: 609.2930s
	iters: 800, epoch: 1 | loss: 0.5671002
	speed: 0.0329s/iter; left time: 562.4039s
	iters: 900, epoch: 1 | loss: 0.8208585
	speed: 0.0337s/iter; left time: 574.1655s
	iters: 1000, epoch: 1 | loss: 0.7009711
	speed: 0.0347s/iter; left time: 587.7482s
	iters: 1100, epoch: 1 | loss: 0.6587366
	speed: 0.0354s/iter; left time: 594.5827s
	iters: 1200, epoch: 1 | loss: 0.8437190
	speed: 0.0365s/iter; left time: 610.9392s
	iters: 1300, epoch: 1 | loss: 0.5003971
	speed: 0.0341s/iter; left time: 566.2110s
	iters: 1400, epoch: 1 | loss: 1.6040574
	speed: 0.0338s/iter; left time: 557.9195s
	iters: 1500, epoch: 1 | loss: 0.5893213
	speed: 0.0345s/iter; left time: 566.2317s
	iters: 1600, epoch: 1 | loss: 0.5307298
	speed: 0.0350s/iter; left time: 571.8161s
	iters: 1700, epoch: 1 | loss: 0.5121611
	speed: 0.0355s/iter; left time: 575.1164s
	iters: 1800, epoch: 1 | loss: 0.6915070
	speed: 0.0340s/iter; left time: 547.9258s
	iters: 1900, epoch: 1 | loss: 0.9067170
	speed: 0.0354s/iter; left time: 566.5042s
	iters: 2000, epoch: 1 | loss: 0.5616711
	speed: 0.0364s/iter; left time: 579.3641s
	iters: 2100, epoch: 1 | loss: 0.6453006
	speed: 0.0364s/iter; left time: 575.0112s
	iters: 2200, epoch: 1 | loss: 0.4682833
	speed: 0.0355s/iter; left time: 558.3652s
	iters: 2300, epoch: 1 | loss: 0.7069553
	speed: 0.0360s/iter; left time: 562.6609s
	iters: 2400, epoch: 1 | loss: 0.5216215
	speed: 0.0364s/iter; left time: 565.0857s
	iters: 2500, epoch: 1 | loss: 0.6889864
	speed: 0.0372s/iter; left time: 574.1836s
	iters: 2600, epoch: 1 | loss: 0.4034082
	speed: 0.0349s/iter; left time: 535.1758s
	iters: 2700, epoch: 1 | loss: 0.5690811
	speed: 0.0340s/iter; left time: 517.4975s
	iters: 2800, epoch: 1 | loss: 0.8185558
	speed: 0.0340s/iter; left time: 513.9280s
	iters: 2900, epoch: 1 | loss: 0.4608676
	speed: 0.0338s/iter; left time: 508.2962s
	iters: 3000, epoch: 1 | loss: 0.5203248
	speed: 0.0348s/iter; left time: 519.8112s
	iters: 3100, epoch: 1 | loss: 0.4495389
	speed: 0.0352s/iter; left time: 521.3496s
	iters: 3200, epoch: 1 | loss: 0.5190798
	speed: 0.0349s/iter; left time: 513.7839s
	iters: 3300, epoch: 1 | loss: 0.5467793
	speed: 0.0344s/iter; left time: 503.4716s
	iters: 3400, epoch: 1 | loss: 0.6598570
	speed: 0.0344s/iter; left time: 499.6753s
	iters: 3500, epoch: 1 | loss: 0.7737341
	speed: 0.0346s/iter; left time: 499.4267s
	iters: 3600, epoch: 1 | loss: 0.4873962
	speed: 0.0344s/iter; left time: 492.4352s
	iters: 3700, epoch: 1 | loss: 0.8549072
	speed: 0.0341s/iter; left time: 484.5620s
	iters: 3800, epoch: 1 | loss: 0.5502123
	speed: 0.0347s/iter; left time: 489.8658s
	iters: 3900, epoch: 1 | loss: 0.5178168
	speed: 0.0344s/iter; left time: 482.5767s
	iters: 4000, epoch: 1 | loss: 0.5537039
	speed: 0.0360s/iter; left time: 501.0199s
	iters: 4100, epoch: 1 | loss: 0.5606999
	speed: 0.0353s/iter; left time: 487.8377s
	iters: 4200, epoch: 1 | loss: 0.4611253
	speed: 0.0345s/iter; left time: 473.0675s
	iters: 4300, epoch: 1 | loss: 1.4752383
	speed: 0.0345s/iter; left time: 470.2989s
	iters: 4400, epoch: 1 | loss: 0.5109676
	speed: 0.0347s/iter; left time: 468.4018s
	iters: 4500, epoch: 1 | loss: 0.3763992
	speed: 0.0345s/iter; left time: 462.9500s
	iters: 4600, epoch: 1 | loss: 0.5778243
	speed: 0.0344s/iter; left time: 458.3342s
	iters: 4700, epoch: 1 | loss: 0.5816194
	speed: 0.0343s/iter; left time: 453.9640s
	iters: 4800, epoch: 1 | loss: 0.4246436
	speed: 0.0346s/iter; left time: 453.8109s
	iters: 4900, epoch: 1 | loss: 0.4691775
	speed: 0.0344s/iter; left time: 448.2442s
	iters: 5000, epoch: 1 | loss: 0.6902300
	speed: 0.0338s/iter; left time: 436.6383s
	iters: 5100, epoch: 1 | loss: 0.5523856
	speed: 0.0345s/iter; left time: 441.5517s
	iters: 5200, epoch: 1 | loss: 0.9056796
	speed: 0.0340s/iter; left time: 432.5010s
	iters: 5300, epoch: 1 | loss: 0.7065793
	speed: 0.0346s/iter; left time: 436.4651s
	iters: 5400, epoch: 1 | loss: 0.4747408
	speed: 0.0337s/iter; left time: 421.3832s
	iters: 5500, epoch: 1 | loss: 0.5502732
	speed: 0.0343s/iter; left time: 425.5354s
	iters: 5600, epoch: 1 | loss: 0.5535442
	speed: 0.0368s/iter; left time: 453.0066s
	iters: 5700, epoch: 1 | loss: 0.7203335
	speed: 0.0369s/iter; left time: 451.2183s
	iters: 5800, epoch: 1 | loss: 1.5132488
	speed: 0.0364s/iter; left time: 441.4088s
	iters: 5900, epoch: 1 | loss: 0.4544028
	speed: 0.0350s/iter; left time: 420.1674s
	iters: 6000, epoch: 1 | loss: 0.4626814
	speed: 0.0338s/iter; left time: 403.3871s
	iters: 6100, epoch: 1 | loss: 0.4944357
	speed: 0.0335s/iter; left time: 395.4189s
	iters: 6200, epoch: 1 | loss: 0.4219492
	speed: 0.0337s/iter; left time: 394.7924s
	iters: 6300, epoch: 1 | loss: 0.4437376
	speed: 0.0329s/iter; left time: 381.8218s
	iters: 6400, epoch: 1 | loss: 0.3209300
	speed: 0.0336s/iter; left time: 387.3637s
	iters: 6500, epoch: 1 | loss: 0.7923045
	speed: 0.0333s/iter; left time: 379.7776s
	iters: 6600, epoch: 1 | loss: 0.4604576
	speed: 0.0341s/iter; left time: 386.0389s
	iters: 6700, epoch: 1 | loss: 0.5186602
	speed: 0.0339s/iter; left time: 380.0963s
	iters: 6800, epoch: 1 | loss: 0.4165062
	speed: 0.0336s/iter; left time: 373.5475s
	iters: 6900, epoch: 1 | loss: 0.4133976
	speed: 0.0325s/iter; left time: 358.5759s
	iters: 7000, epoch: 1 | loss: 0.5217447
	speed: 0.0330s/iter; left time: 360.1517s
	iters: 7100, epoch: 1 | loss: 0.5023304
	speed: 0.0330s/iter; left time: 357.4468s
	iters: 7200, epoch: 1 | loss: 0.4675135
	speed: 0.0335s/iter; left time: 359.2640s
	iters: 7300, epoch: 1 | loss: 0.3931335
	speed: 0.0361s/iter; left time: 382.8187s
	iters: 7400, epoch: 1 | loss: 0.4549586
	speed: 0.0339s/iter; left time: 356.1152s
	iters: 7500, epoch: 1 | loss: 0.8984830
	speed: 0.0339s/iter; left time: 353.5225s
	iters: 7600, epoch: 1 | loss: 0.5980912
	speed: 0.0345s/iter; left time: 356.0941s
	iters: 7700, epoch: 1 | loss: 0.8769942
	speed: 0.0339s/iter; left time: 346.3619s
	iters: 7800, epoch: 1 | loss: 0.4288548
	speed: 0.0346s/iter; left time: 350.2135s
	iters: 7900, epoch: 1 | loss: 1.2844272
	speed: 0.0353s/iter; left time: 353.2969s
	iters: 8000, epoch: 1 | loss: 0.3948631
	speed: 0.0350s/iter; left time: 347.4266s
	iters: 8100, epoch: 1 | loss: 0.3821703
	speed: 0.0340s/iter; left time: 334.2282s
	iters: 8200, epoch: 1 | loss: 0.4837150
	speed: 0.0341s/iter; left time: 330.9392s
	iters: 8300, epoch: 1 | loss: 0.5746093
	speed: 0.0340s/iter; left time: 326.6801s
	iters: 8400, epoch: 1 | loss: 0.4342843
	speed: 0.0339s/iter; left time: 322.1752s
	iters: 8500, epoch: 1 | loss: 0.5540773
	speed: 0.0344s/iter; left time: 323.9947s
	iters: 8600, epoch: 1 | loss: 0.4873771
	speed: 0.0339s/iter; left time: 315.8224s
	iters: 8700, epoch: 1 | loss: 1.3932000
	speed: 0.0336s/iter; left time: 309.9371s
	iters: 8800, epoch: 1 | loss: 0.4472190
	speed: 0.0343s/iter; left time: 313.0343s
	iters: 8900, epoch: 1 | loss: 0.4642017
	speed: 0.0338s/iter; left time: 304.3335s
Epoch: 1 cost time: 312.6163024902344
Epoch: 1, Steps: 8958 | Train Loss: 0.6597394 Vali Loss: 0.9576725 Test Loss: 1.3608005
Validation loss decreased (inf --> 0.957673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4334143
	speed: 0.5261s/iter; left time: 4660.4756s
	iters: 200, epoch: 2 | loss: 0.3834379
	speed: 0.0335s/iter; left time: 293.6219s
	iters: 300, epoch: 2 | loss: 0.5511262
	speed: 0.0337s/iter; left time: 292.1167s
	iters: 400, epoch: 2 | loss: 0.5068287
	speed: 0.0336s/iter; left time: 287.9203s
	iters: 500, epoch: 2 | loss: 0.4299815
	speed: 0.0338s/iter; left time: 285.7925s
	iters: 600, epoch: 2 | loss: 0.6303744
	speed: 0.0357s/iter; left time: 298.6105s
	iters: 700, epoch: 2 | loss: 0.7163394
	speed: 0.0359s/iter; left time: 296.8421s
	iters: 800, epoch: 2 | loss: 0.4230001
	speed: 0.0359s/iter; left time: 293.2230s
	iters: 900, epoch: 2 | loss: 0.3982644
	speed: 0.0352s/iter; left time: 283.8086s
	iters: 1000, epoch: 2 | loss: 0.4479886
	speed: 0.0335s/iter; left time: 266.9033s
	iters: 1100, epoch: 2 | loss: 0.5380335
	speed: 0.0335s/iter; left time: 262.9759s
	iters: 1200, epoch: 2 | loss: 0.3662854
	speed: 0.0334s/iter; left time: 259.4059s
	iters: 1300, epoch: 2 | loss: 0.3860525
	speed: 0.0338s/iter; left time: 259.0211s
	iters: 1400, epoch: 2 | loss: 0.2853506
	speed: 0.0332s/iter; left time: 251.2158s
	iters: 1500, epoch: 2 | loss: 0.3712401
	speed: 0.0331s/iter; left time: 246.5677s
	iters: 1600, epoch: 2 | loss: 0.4625224
	speed: 0.0334s/iter; left time: 246.0699s
	iters: 1700, epoch: 2 | loss: 0.5602153
	speed: 0.0337s/iter; left time: 244.9319s
	iters: 1800, epoch: 2 | loss: 0.3359648
	speed: 0.0340s/iter; left time: 243.3727s
	iters: 1900, epoch: 2 | loss: 1.6404284
	speed: 0.0340s/iter; left time: 239.7688s
	iters: 2000, epoch: 2 | loss: 0.4258391
	speed: 0.0337s/iter; left time: 234.1920s
	iters: 2100, epoch: 2 | loss: 0.5220885
	speed: 0.0335s/iter; left time: 230.0215s
	iters: 2200, epoch: 2 | loss: 0.4374892
	speed: 0.0335s/iter; left time: 226.1495s
	iters: 2300, epoch: 2 | loss: 0.3372297
	speed: 0.0334s/iter; left time: 222.5033s
	iters: 2400, epoch: 2 | loss: 0.5775294
	speed: 0.0335s/iter; left time: 219.4774s
	iters: 2500, epoch: 2 | loss: 0.4558060
	speed: 0.0337s/iter; left time: 217.5818s
	iters: 2600, epoch: 2 | loss: 0.2589168
	speed: 0.0333s/iter; left time: 211.8264s
	iters: 2700, epoch: 2 | loss: 1.3309240
	speed: 0.0336s/iter; left time: 210.1350s
	iters: 2800, epoch: 2 | loss: 0.3454375
	speed: 0.0338s/iter; left time: 208.1260s
	iters: 2900, epoch: 2 | loss: 1.3862548
	speed: 0.0334s/iter; left time: 202.0798s
	iters: 3000, epoch: 2 | loss: 0.3197934
	speed: 0.0338s/iter; left time: 201.4594s
	iters: 3100, epoch: 2 | loss: 0.4344383
	speed: 0.0333s/iter; left time: 195.1192s
	iters: 3200, epoch: 2 | loss: 1.2390754
	speed: 0.0339s/iter; left time: 195.1539s
	iters: 3300, epoch: 2 | loss: 0.3726860
	speed: 0.0363s/iter; left time: 205.5434s
	iters: 3400, epoch: 2 | loss: 0.4409914
	speed: 0.0350s/iter; left time: 194.3686s
	iters: 3500, epoch: 2 | loss: 0.3139393
	speed: 0.0337s/iter; left time: 184.0109s
	iters: 3600, epoch: 2 | loss: 0.3109628
	speed: 0.0335s/iter; left time: 179.7649s
	iters: 3700, epoch: 2 | loss: 0.3414326
	speed: 0.0350s/iter; left time: 184.1632s
	iters: 3800, epoch: 2 | loss: 0.7516724
	speed: 0.0333s/iter; left time: 171.5693s
	iters: 3900, epoch: 2 | loss: 0.5520838
	speed: 0.0339s/iter; left time: 171.7344s
	iters: 4000, epoch: 2 | loss: 0.2354589
	speed: 0.0339s/iter; left time: 168.3158s
	iters: 4100, epoch: 2 | loss: 0.5038764
	speed: 0.0330s/iter; left time: 160.2849s
	iters: 4200, epoch: 2 | loss: 0.3409626
	speed: 0.0334s/iter; left time: 158.7385s
	iters: 4300, epoch: 2 | loss: 0.2841927
	speed: 0.0334s/iter; left time: 155.4961s
	iters: 4400, epoch: 2 | loss: 0.3890174
	speed: 0.0335s/iter; left time: 152.6841s
	iters: 4500, epoch: 2 | loss: 0.4146755
	speed: 0.0329s/iter; left time: 146.8850s
	iters: 4600, epoch: 2 | loss: 0.4271298
	speed: 0.0335s/iter; left time: 145.8261s
	iters: 4700, epoch: 2 | loss: 0.2208904
	speed: 0.0331s/iter; left time: 141.0428s
	iters: 4800, epoch: 2 | loss: 0.3137422
	speed: 0.0333s/iter; left time: 138.4400s
	iters: 4900, epoch: 2 | loss: 0.6652780
	speed: 0.0345s/iter; left time: 139.9175s
	iters: 5000, epoch: 2 | loss: 0.2014985
	speed: 0.0346s/iter; left time: 136.8079s
	iters: 5100, epoch: 2 | loss: 0.3782244
	speed: 0.0333s/iter; left time: 128.3939s
	iters: 5200, epoch: 2 | loss: 0.3398938
	speed: 0.0337s/iter; left time: 126.6182s
	iters: 5300, epoch: 2 | loss: 1.2120920
	speed: 0.0333s/iter; left time: 121.9256s
	iters: 5400, epoch: 2 | loss: 0.5514321
	speed: 0.0337s/iter; left time: 120.0845s
	iters: 5500, epoch: 2 | loss: 0.3242365
	speed: 0.0338s/iter; left time: 116.9193s
	iters: 5600, epoch: 2 | loss: 0.2854663
	speed: 0.0345s/iter; left time: 115.7770s
	iters: 5700, epoch: 2 | loss: 0.4528094
	speed: 0.0344s/iter; left time: 112.2196s
	iters: 5800, epoch: 2 | loss: 0.2332243
	speed: 0.0340s/iter; left time: 107.5326s
	iters: 5900, epoch: 2 | loss: 0.3593124
	speed: 0.0341s/iter; left time: 104.3791s
	iters: 6000, epoch: 2 | loss: 0.3157028
	speed: 0.0358s/iter; left time: 105.8516s
	iters: 6100, epoch: 2 | loss: 0.3142085
	speed: 0.0354s/iter; left time: 101.3501s
	iters: 6200, epoch: 2 | loss: 0.1690377
	speed: 0.0364s/iter; left time: 100.3355s
	iters: 6300, epoch: 2 | loss: 0.2530447
	speed: 0.0343s/iter; left time: 91.2132s
	iters: 6400, epoch: 2 | loss: 0.3869726
	speed: 0.0337s/iter; left time: 86.2141s
	iters: 6500, epoch: 2 | loss: 0.2584210
	speed: 0.0339s/iter; left time: 83.3407s
	iters: 6600, epoch: 2 | loss: 0.2643590
	speed: 0.0360s/iter; left time: 84.9042s
	iters: 6700, epoch: 2 | loss: 0.2597565
	speed: 0.0356s/iter; left time: 80.4653s
	iters: 6800, epoch: 2 | loss: 0.2534841
	speed: 0.0335s/iter; left time: 72.3145s
	iters: 6900, epoch: 2 | loss: 0.2385326
	speed: 0.0336s/iter; left time: 69.1029s
	iters: 7000, epoch: 2 | loss: 0.3040179
	speed: 0.0336s/iter; left time: 65.8188s
	iters: 7100, epoch: 2 | loss: 0.2577797
	speed: 0.0339s/iter; left time: 62.9301s
	iters: 7200, epoch: 2 | loss: 0.2889958
	speed: 0.0337s/iter; left time: 59.3131s
	iters: 7300, epoch: 2 | loss: 0.2332087
	speed: 0.0337s/iter; left time: 55.8292s
	iters: 7400, epoch: 2 | loss: 0.2362261
	speed: 0.0339s/iter; left time: 52.8744s
	iters: 7500, epoch: 2 | loss: 0.3411859
	speed: 0.0339s/iter; left time: 49.4231s
	iters: 7600, epoch: 2 | loss: 0.2345290
	speed: 0.0338s/iter; left time: 45.9265s
	iters: 7700, epoch: 2 | loss: 0.2469831
	speed: 0.0333s/iter; left time: 41.8934s
	iters: 7800, epoch: 2 | loss: 0.2903270
	speed: 0.0332s/iter; left time: 38.4460s
	iters: 7900, epoch: 2 | loss: 0.2205484
	speed: 0.0332s/iter; left time: 35.1251s
	iters: 8000, epoch: 2 | loss: 0.4836237
	speed: 0.0338s/iter; left time: 32.4132s
	iters: 8100, epoch: 2 | loss: 1.2862612
	speed: 0.0333s/iter; left time: 28.5919s
	iters: 8200, epoch: 2 | loss: 0.2085185
	speed: 0.0341s/iter; left time: 25.8572s
	iters: 8300, epoch: 2 | loss: 0.2570792
	speed: 0.0360s/iter; left time: 23.7457s
	iters: 8400, epoch: 2 | loss: 0.2410688
	speed: 0.0368s/iter; left time: 20.5433s
	iters: 8500, epoch: 2 | loss: 0.2997326
	speed: 0.0336s/iter; left time: 15.4418s
	iters: 8600, epoch: 2 | loss: 0.2100548
	speed: 0.0333s/iter; left time: 11.9557s
	iters: 8700, epoch: 2 | loss: 1.0515718
	speed: 0.0334s/iter; left time: 8.6503s
	iters: 8800, epoch: 2 | loss: 0.2080417
	speed: 0.0335s/iter; left time: 5.3330s
	iters: 8900, epoch: 2 | loss: 1.1688827
	speed: 0.0335s/iter; left time: 1.9744s
Epoch: 2 cost time: 306.2595286369324
Epoch: 2, Steps: 8958 | Train Loss: 0.4228239 Vali Loss: 0.8077977 Test Loss: 0.8703654
Validation loss decreased (0.957673 --> 0.807798).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_720_Informer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.8703266978263855, mae:0.671755313873291, rse:1.2276462316513062
