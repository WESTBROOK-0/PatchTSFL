Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm2_336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_192_PatchTST_ETTm2_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2106545
	speed: 0.0401s/iter; left time: 1058.1662s
	iters: 200, epoch: 1 | loss: 0.1790881
	speed: 0.0178s/iter; left time: 468.3846s
Epoch: 1 cost time: 7.111065626144409
Epoch: 1, Steps: 265 | Train Loss: 0.2096437 Vali Loss: 0.1597343 Test Loss: 0.1056475
Validation loss decreased (inf --> 0.159734).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.1291098
	speed: 0.1142s/iter; left time: 2983.8674s
	iters: 200, epoch: 2 | loss: 0.1485709
	speed: 0.0180s/iter; left time: 468.6176s
Epoch: 2 cost time: 7.44359016418457
Epoch: 2, Steps: 265 | Train Loss: 0.1629208 Vali Loss: 0.1464693 Test Loss: 0.0978443
Validation loss decreased (0.159734 --> 0.146469).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.1695891
	speed: 0.1106s/iter; left time: 2860.2825s
	iters: 200, epoch: 3 | loss: 0.1556879
	speed: 0.0183s/iter; left time: 471.6471s
Epoch: 3 cost time: 7.112817287445068
Epoch: 3, Steps: 265 | Train Loss: 0.1518560 Vali Loss: 0.1414088 Test Loss: 0.0955554
Validation loss decreased (0.146469 --> 0.141409).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.1533974
	speed: 0.1101s/iter; left time: 2819.1409s
	iters: 200, epoch: 4 | loss: 0.1618419
	speed: 0.0182s/iter; left time: 465.4050s
Epoch: 4 cost time: 7.3100292682647705
Epoch: 4, Steps: 265 | Train Loss: 0.1458608 Vali Loss: 0.1387897 Test Loss: 0.0943887
Validation loss decreased (0.141409 --> 0.138790).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.1268567
	speed: 0.1151s/iter; left time: 2917.2893s
	iters: 200, epoch: 5 | loss: 0.1602796
	speed: 0.0181s/iter; left time: 457.6902s
Epoch: 5 cost time: 7.277609348297119
Epoch: 5, Steps: 265 | Train Loss: 0.1420346 Vali Loss: 0.1383422 Test Loss: 0.0939126
Validation loss decreased (0.138790 --> 0.138342).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.1589055
	speed: 0.1087s/iter; left time: 2725.6199s
	iters: 200, epoch: 6 | loss: 0.1109385
	speed: 0.0179s/iter; left time: 448.1963s
Epoch: 6 cost time: 6.957378387451172
Epoch: 6, Steps: 265 | Train Loss: 0.1394759 Vali Loss: 0.1373749 Test Loss: 0.0937514
Validation loss decreased (0.138342 --> 0.137375).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.1511904
	speed: 0.1109s/iter; left time: 2751.8019s
	iters: 200, epoch: 7 | loss: 0.1461048
	speed: 0.0202s/iter; left time: 498.3988s
Epoch: 7 cost time: 7.316804647445679
Epoch: 7, Steps: 265 | Train Loss: 0.1372851 Vali Loss: 0.1379207 Test Loss: 0.0937228
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.1405883
	speed: 0.1104s/iter; left time: 2710.5893s
	iters: 200, epoch: 8 | loss: 0.1173750
	speed: 0.0181s/iter; left time: 443.0245s
Epoch: 8 cost time: 7.167938947677612
Epoch: 8, Steps: 265 | Train Loss: 0.1352732 Vali Loss: 0.1387735 Test Loss: 0.0938200
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.1296571
	speed: 0.1068s/iter; left time: 2594.2465s
	iters: 200, epoch: 9 | loss: 0.1348371
	speed: 0.0183s/iter; left time: 442.1985s
Epoch: 9 cost time: 6.968316078186035
Epoch: 9, Steps: 265 | Train Loss: 0.1338522 Vali Loss: 0.1395970 Test Loss: 0.0944179
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.1334619
	speed: 0.1095s/iter; left time: 2630.3707s
	iters: 200, epoch: 10 | loss: 0.1298511
	speed: 0.0185s/iter; left time: 441.8708s
Epoch: 10 cost time: 7.234194040298462
Epoch: 10, Steps: 265 | Train Loss: 0.1323873 Vali Loss: 0.1396653 Test Loss: 0.0941943
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.1271895
	speed: 0.1091s/iter; left time: 2592.2571s
	iters: 200, epoch: 11 | loss: 0.1349247
	speed: 0.0181s/iter; left time: 427.5826s
Epoch: 11 cost time: 7.035957098007202
Epoch: 11, Steps: 265 | Train Loss: 0.1311579 Vali Loss: 0.1420447 Test Loss: 0.0950629
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.1408779
	speed: 0.1120s/iter; left time: 2630.8286s
	iters: 200, epoch: 12 | loss: 0.1334297
	speed: 0.0184s/iter; left time: 429.4950s
Epoch: 12 cost time: 7.507490634918213
Epoch: 12, Steps: 265 | Train Loss: 0.1300048 Vali Loss: 0.1416277 Test Loss: 0.0947095
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.1579488
	speed: 0.1079s/iter; left time: 2504.9079s
	iters: 200, epoch: 13 | loss: 0.1179986
	speed: 0.0182s/iter; left time: 420.9772s
Epoch: 13 cost time: 7.104624271392822
Epoch: 13, Steps: 265 | Train Loss: 0.1289667 Vali Loss: 0.1438093 Test Loss: 0.0938871
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.1678501
	speed: 0.1072s/iter; left time: 2461.3940s
	iters: 200, epoch: 14 | loss: 0.1006871
	speed: 0.0228s/iter; left time: 521.5177s
Epoch: 14 cost time: 7.696144342422485
Epoch: 14, Steps: 265 | Train Loss: 0.1278967 Vali Loss: 0.1446091 Test Loss: 0.0956175
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.1175322
	speed: 0.1123s/iter; left time: 2548.4983s
	iters: 200, epoch: 15 | loss: 0.1102688
	speed: 0.0184s/iter; left time: 415.9110s
Epoch: 15 cost time: 7.23149561882019
Epoch: 15, Steps: 265 | Train Loss: 0.1270812 Vali Loss: 0.1448003 Test Loss: 0.0947288
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.1506697
	speed: 0.1089s/iter; left time: 2441.6486s
	iters: 200, epoch: 16 | loss: 0.1140326
	speed: 0.0185s/iter; left time: 412.2431s
Epoch: 16 cost time: 7.091152667999268
Epoch: 16, Steps: 265 | Train Loss: 0.1257626 Vali Loss: 0.1459618 Test Loss: 0.0943443
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.1111111
	speed: 0.1088s/iter; left time: 2410.9160s
	iters: 200, epoch: 17 | loss: 0.1284544
	speed: 0.0179s/iter; left time: 394.4889s
Epoch: 17 cost time: 6.92096471786499
Epoch: 17, Steps: 265 | Train Loss: 0.1248632 Vali Loss: 0.1462129 Test Loss: 0.0943172
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.1327365
	speed: 0.1075s/iter; left time: 2354.9058s
	iters: 200, epoch: 18 | loss: 0.1218087
	speed: 0.0177s/iter; left time: 386.4334s
Epoch: 18 cost time: 6.982664108276367
Epoch: 18, Steps: 265 | Train Loss: 0.1234929 Vali Loss: 0.1456879 Test Loss: 0.0965371
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.1228819
	speed: 0.1075s/iter; left time: 2324.7916s
	iters: 200, epoch: 19 | loss: 0.1339416
	speed: 0.0208s/iter; left time: 448.6390s
Epoch: 19 cost time: 7.437022686004639
Epoch: 19, Steps: 265 | Train Loss: 0.1212919 Vali Loss: 0.1430176 Test Loss: 0.0971510
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.1094540
	speed: 0.1146s/iter; left time: 2447.9271s
	iters: 200, epoch: 20 | loss: 0.1199792
	speed: 0.0176s/iter; left time: 373.2545s
Epoch: 20 cost time: 6.960216760635376
Epoch: 20, Steps: 265 | Train Loss: 0.1191589 Vali Loss: 0.1443600 Test Loss: 0.1001052
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.1066203
	speed: 0.1091s/iter; left time: 2301.1877s
	iters: 200, epoch: 21 | loss: 0.1241090
	speed: 0.0182s/iter; left time: 383.1706s
Epoch: 21 cost time: 7.004203796386719
Epoch: 21, Steps: 265 | Train Loss: 0.1160476 Vali Loss: 0.1460292 Test Loss: 0.1005277
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.1192778
	speed: 0.1090s/iter; left time: 2271.9817s
	iters: 200, epoch: 22 | loss: 0.1139986
	speed: 0.0180s/iter; left time: 373.8384s
Epoch: 22 cost time: 7.2026472091674805
Epoch: 22, Steps: 265 | Train Loss: 0.1140855 Vali Loss: 0.1450896 Test Loss: 0.1000780
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.1021990
	speed: 0.1099s/iter; left time: 2261.7742s
	iters: 200, epoch: 23 | loss: 0.1206711
	speed: 0.0187s/iter; left time: 383.6078s
Epoch: 23 cost time: 7.1548683643341064
Epoch: 23, Steps: 265 | Train Loss: 0.1116637 Vali Loss: 0.1497711 Test Loss: 0.1029204
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.1264912
	speed: 0.1077s/iter; left time: 2187.0452s
	iters: 200, epoch: 24 | loss: 0.1021186
	speed: 0.0172s/iter; left time: 347.6677s
Epoch: 24 cost time: 6.938218593597412
Epoch: 24, Steps: 265 | Train Loss: 0.1097672 Vali Loss: 0.1567391 Test Loss: 0.1013830
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.0981996
	speed: 0.1085s/iter; left time: 2173.8721s
	iters: 200, epoch: 25 | loss: 0.0947839
	speed: 0.0177s/iter; left time: 352.7773s
Epoch: 25 cost time: 7.151628017425537
Epoch: 25, Steps: 265 | Train Loss: 0.1076931 Vali Loss: 0.1532036 Test Loss: 0.1036420
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.1013103
	speed: 0.1138s/iter; left time: 2249.5553s
	iters: 200, epoch: 26 | loss: 0.1026573
	speed: 0.0184s/iter; left time: 362.5014s
Epoch: 26 cost time: 7.4039647579193115
Epoch: 26, Steps: 265 | Train Loss: 0.1054318 Vali Loss: 0.1607796 Test Loss: 0.1024298
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_192_PatchTST_ETTm2_ftS_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.09375140070915222, mae:0.23083242774009705, rse:0.4977533519268036
