Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_96_PatchTSW_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3778839
	speed: 0.3649s/iter; left time: 9669.7358s
	iters: 200, epoch: 1 | loss: 0.3517080
	speed: 0.3465s/iter; left time: 9147.9372s
Epoch: 1 cost time: 94.13089799880981
Epoch: 1, Steps: 266 | Train Loss: 0.3942242 Vali Loss: 0.4275565 Test Loss: 0.3457291
Validation loss decreased (inf --> 0.427556).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.3050604
	speed: 0.8230s/iter; left time: 21592.3269s
	iters: 200, epoch: 2 | loss: 0.3176875
	speed: 0.3466s/iter; left time: 9058.2555s
Epoch: 2 cost time: 94.15650987625122
Epoch: 2, Steps: 266 | Train Loss: 0.3137873 Vali Loss: 0.3927984 Test Loss: 0.3163724
Validation loss decreased (0.427556 --> 0.392798).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2972570
	speed: 0.8269s/iter; left time: 21472.9804s
	iters: 200, epoch: 3 | loss: 0.2855800
	speed: 0.3466s/iter; left time: 8967.4343s
Epoch: 3 cost time: 94.24679827690125
Epoch: 3, Steps: 266 | Train Loss: 0.2962614 Vali Loss: 0.3849797 Test Loss: 0.3096485
Validation loss decreased (0.392798 --> 0.384980).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3009906
	speed: 0.8195s/iter; left time: 21063.0879s
	iters: 200, epoch: 4 | loss: 0.2687975
	speed: 0.3469s/iter; left time: 8882.9185s
Epoch: 4 cost time: 94.2125072479248
Epoch: 4, Steps: 266 | Train Loss: 0.2869532 Vali Loss: 0.3798527 Test Loss: 0.3064657
Validation loss decreased (0.384980 --> 0.379853).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2884689
	speed: 0.8220s/iter; left time: 20908.5461s
	iters: 200, epoch: 5 | loss: 0.2835977
	speed: 0.3468s/iter; left time: 8786.4692s
Epoch: 5 cost time: 94.18341255187988
Epoch: 5, Steps: 266 | Train Loss: 0.2797711 Vali Loss: 0.3780791 Test Loss: 0.3003009
Validation loss decreased (0.379853 --> 0.378079).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2870279
	speed: 0.8240s/iter; left time: 20739.7521s
	iters: 200, epoch: 6 | loss: 0.2651834
	speed: 0.3466s/iter; left time: 8689.4337s
Epoch: 6 cost time: 94.18727660179138
Epoch: 6, Steps: 266 | Train Loss: 0.2729933 Vali Loss: 0.3750321 Test Loss: 0.3001578
Validation loss decreased (0.378079 --> 0.375032).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.3154712
	speed: 0.8228s/iter; left time: 20491.2250s
	iters: 200, epoch: 7 | loss: 0.2792843
	speed: 0.3469s/iter; left time: 8604.7901s
Epoch: 7 cost time: 94.23800444602966
Epoch: 7, Steps: 266 | Train Loss: 0.2666714 Vali Loss: 0.3739377 Test Loss: 0.2971106
Validation loss decreased (0.375032 --> 0.373938).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2651922
	speed: 0.8220s/iter; left time: 20252.8015s
	iters: 200, epoch: 8 | loss: 0.2631031
	speed: 0.3470s/iter; left time: 8514.2109s
Epoch: 8 cost time: 94.17813539505005
Epoch: 8, Steps: 266 | Train Loss: 0.2604228 Vali Loss: 0.3695310 Test Loss: 0.2953900
Validation loss decreased (0.373938 --> 0.369531).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2570781
	speed: 0.8250s/iter; left time: 20108.9122s
	iters: 200, epoch: 9 | loss: 0.2665071
	speed: 0.3468s/iter; left time: 8417.7798s
Epoch: 9 cost time: 94.26361107826233
Epoch: 9, Steps: 266 | Train Loss: 0.2552476 Vali Loss: 0.3710186 Test Loss: 0.2946530
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.2380976
	speed: 0.8111s/iter; left time: 19552.3654s
	iters: 200, epoch: 10 | loss: 0.2421115
	speed: 0.3465s/iter; left time: 8319.4997s
Epoch: 10 cost time: 94.24384903907776
Epoch: 10, Steps: 266 | Train Loss: 0.2501514 Vali Loss: 0.3721392 Test Loss: 0.2976824
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2606677
	speed: 0.8129s/iter; left time: 19379.2300s
	iters: 200, epoch: 11 | loss: 0.2454055
	speed: 0.3466s/iter; left time: 8228.8321s
Epoch: 11 cost time: 94.18688583374023
Epoch: 11, Steps: 266 | Train Loss: 0.2455790 Vali Loss: 0.3695410 Test Loss: 0.2946449
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.2219731
	speed: 0.8132s/iter; left time: 19172.1307s
	iters: 200, epoch: 12 | loss: 0.2471282
	speed: 0.3468s/iter; left time: 8141.9464s
Epoch: 12 cost time: 94.40712547302246
Epoch: 12, Steps: 266 | Train Loss: 0.2415884 Vali Loss: 0.3688768 Test Loss: 0.2923314
Validation loss decreased (0.369531 --> 0.368877).  Saving model ...
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.2384816
	speed: 0.8219s/iter; left time: 19158.7856s
	iters: 200, epoch: 13 | loss: 0.2377005
	speed: 0.3467s/iter; left time: 8047.0234s
Epoch: 13 cost time: 94.27467608451843
Epoch: 13, Steps: 266 | Train Loss: 0.2379404 Vali Loss: 0.3676190 Test Loss: 0.2945950
Validation loss decreased (0.368877 --> 0.367619).  Saving model ...
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2366023
	speed: 0.8231s/iter; left time: 18966.3962s
	iters: 200, epoch: 14 | loss: 0.2420335
	speed: 0.3467s/iter; left time: 7953.2261s
Epoch: 14 cost time: 94.24078893661499
Epoch: 14, Steps: 266 | Train Loss: 0.2343537 Vali Loss: 0.3701970 Test Loss: 0.2944320
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.2608623
	speed: 0.8158s/iter; left time: 18580.5001s
	iters: 200, epoch: 15 | loss: 0.2251437
	speed: 0.3467s/iter; left time: 7861.3534s
Epoch: 15 cost time: 94.50678730010986
Epoch: 15, Steps: 266 | Train Loss: 0.2310258 Vali Loss: 0.3712428 Test Loss: 0.2938474
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2222571
	speed: 0.8113s/iter; left time: 18263.2814s
	iters: 200, epoch: 16 | loss: 0.2224583
	speed: 0.3469s/iter; left time: 7773.7124s
Epoch: 16 cost time: 94.3050229549408
Epoch: 16, Steps: 266 | Train Loss: 0.2273732 Vali Loss: 0.3717537 Test Loss: 0.2955773
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2387521
	speed: 0.8081s/iter; left time: 17976.8186s
	iters: 200, epoch: 17 | loss: 0.2249970
	speed: 0.3467s/iter; left time: 7678.6705s
Epoch: 17 cost time: 94.16926765441895
Epoch: 17, Steps: 266 | Train Loss: 0.2237364 Vali Loss: 0.3732033 Test Loss: 0.2992887
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2019534
	speed: 0.8105s/iter; left time: 17814.0929s
	iters: 200, epoch: 18 | loss: 0.2199472
	speed: 0.3468s/iter; left time: 7586.7197s
Epoch: 18 cost time: 94.24196672439575
Epoch: 18, Steps: 266 | Train Loss: 0.2204861 Vali Loss: 0.3800257 Test Loss: 0.2979389
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.2108593
	speed: 0.8124s/iter; left time: 17640.1864s
	iters: 200, epoch: 19 | loss: 0.2197309
	speed: 0.3468s/iter; left time: 7494.3846s
Epoch: 19 cost time: 94.24622297286987
Epoch: 19, Steps: 266 | Train Loss: 0.2171927 Vali Loss: 0.3817957 Test Loss: 0.3018552
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2151557
	speed: 0.8120s/iter; left time: 17415.0204s
	iters: 200, epoch: 20 | loss: 0.2090521
	speed: 0.3466s/iter; left time: 7399.3825s
Epoch: 20 cost time: 94.29620575904846
Epoch: 20, Steps: 266 | Train Loss: 0.2135996 Vali Loss: 0.3851018 Test Loss: 0.3036985
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.2152385
	speed: 0.8125s/iter; left time: 17210.5296s
	iters: 200, epoch: 21 | loss: 0.2216053
	speed: 0.3467s/iter; left time: 7308.7316s
Epoch: 21 cost time: 94.17100238800049
Epoch: 21, Steps: 266 | Train Loss: 0.2106626 Vali Loss: 0.3878187 Test Loss: 0.3066210
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.1964272
	speed: 0.8100s/iter; left time: 16940.7739s
	iters: 200, epoch: 22 | loss: 0.2091528
	speed: 0.3467s/iter; left time: 7215.9912s
Epoch: 22 cost time: 94.13592267036438
Epoch: 22, Steps: 266 | Train Loss: 0.2073397 Vali Loss: 0.3882193 Test Loss: 0.3201613
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.2067816
	speed: 0.8145s/iter; left time: 16818.1506s
	iters: 200, epoch: 23 | loss: 0.1954000
	speed: 0.3467s/iter; left time: 7125.3033s
Epoch: 23 cost time: 94.23717522621155
Epoch: 23, Steps: 266 | Train Loss: 0.2036275 Vali Loss: 0.3884688 Test Loss: 0.3174830
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.1847308
	speed: 0.8112s/iter; left time: 16535.6534s
	iters: 200, epoch: 24 | loss: 0.2084565
	speed: 0.3468s/iter; left time: 7033.2187s
Epoch: 24 cost time: 94.19076156616211
Epoch: 24, Steps: 266 | Train Loss: 0.2006088 Vali Loss: 0.3976211 Test Loss: 0.3067398
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.1893340
	speed: 0.8174s/iter; left time: 16442.7047s
	iters: 200, epoch: 25 | loss: 0.1897427
	speed: 0.3468s/iter; left time: 6941.1478s
Epoch: 25 cost time: 94.40103268623352
Epoch: 25, Steps: 266 | Train Loss: 0.1970573 Vali Loss: 0.3921271 Test Loss: 0.3149945
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.2036143
	speed: 0.8109s/iter; left time: 16096.6950s
	iters: 200, epoch: 26 | loss: 0.1736567
	speed: 0.3469s/iter; left time: 6850.9390s
Epoch: 26 cost time: 94.2617871761322
Epoch: 26, Steps: 266 | Train Loss: 0.1933793 Vali Loss: 0.3953344 Test Loss: 0.3201106
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.1828184
	speed: 0.8140s/iter; left time: 15942.5416s
	iters: 200, epoch: 27 | loss: 0.1857226
	speed: 0.3467s/iter; left time: 6756.1582s
Epoch: 27 cost time: 94.36803650856018
Epoch: 27, Steps: 266 | Train Loss: 0.1900751 Vali Loss: 0.4021202 Test Loss: 0.3196124
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.1986870
	speed: 0.8106s/iter; left time: 15660.8101s
	iters: 200, epoch: 28 | loss: 0.1829878
	speed: 0.3468s/iter; left time: 6666.0667s
Epoch: 28 cost time: 94.17861747741699
Epoch: 28, Steps: 266 | Train Loss: 0.1864536 Vali Loss: 0.4048405 Test Loss: 0.3198522
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.1707453
	speed: 0.8118s/iter; left time: 15466.6558s
	iters: 200, epoch: 29 | loss: 0.1840746
	speed: 0.3466s/iter; left time: 6568.3039s
Epoch: 29 cost time: 94.22189927101135
Epoch: 29, Steps: 266 | Train Loss: 0.1829593 Vali Loss: 0.4134009 Test Loss: 0.3260477
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.1970696
	speed: 0.8131s/iter; left time: 15275.1821s
	iters: 200, epoch: 30 | loss: 0.1880084
	speed: 0.3469s/iter; left time: 6481.7634s
Epoch: 30 cost time: 94.4147081375122
Epoch: 30, Steps: 266 | Train Loss: 0.1793431 Vali Loss: 0.4151608 Test Loss: 0.3236718
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.59486415263404e-05
	iters: 100, epoch: 31 | loss: 0.1770866
	speed: 0.8165s/iter; left time: 15121.7857s
	iters: 200, epoch: 31 | loss: 0.1692142
	speed: 0.3466s/iter; left time: 6385.5619s
Epoch: 31 cost time: 94.51053166389465
Epoch: 31, Steps: 266 | Train Loss: 0.1760260 Vali Loss: 0.4228454 Test Loss: 0.3244082
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.850661944740828e-05
	iters: 100, epoch: 32 | loss: 0.1707286
	speed: 0.8131s/iter; left time: 14842.6577s
	iters: 200, epoch: 32 | loss: 0.1751071
	speed: 0.3467s/iter; left time: 6294.4865s
Epoch: 32 cost time: 94.53837585449219
Epoch: 32, Steps: 266 | Train Loss: 0.1730872 Vali Loss: 0.4186889 Test Loss: 0.3293554
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.083947962827694e-05
	iters: 100, epoch: 33 | loss: 0.1610594
	speed: 0.8123s/iter; left time: 14611.8300s
	iters: 200, epoch: 33 | loss: 0.1766305
	speed: 0.3468s/iter; left time: 6203.9433s
Epoch: 33 cost time: 94.23919916152954
Epoch: 33, Steps: 266 | Train Loss: 0.1700568 Vali Loss: 0.4249294 Test Loss: 0.3318807
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTSW_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.294594943523407, mae:0.3481866121292114, rse:0.5162976384162903
