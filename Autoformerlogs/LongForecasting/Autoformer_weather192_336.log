Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_192_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_336_Autoformer_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 2.9698536
	speed: 0.0626s/iter; left time: 1131.5148s
	iters: 200, epoch: 1 | loss: 1.1570374
	speed: 0.0433s/iter; left time: 778.4556s
	iters: 300, epoch: 1 | loss: 0.5392058
	speed: 0.0474s/iter; left time: 847.4030s
	iters: 400, epoch: 1 | loss: 0.7507477
	speed: 0.0484s/iter; left time: 861.2768s
	iters: 500, epoch: 1 | loss: 0.6725658
	speed: 0.0455s/iter; left time: 805.2312s
	iters: 600, epoch: 1 | loss: 0.8464963
	speed: 0.0465s/iter; left time: 818.3470s
	iters: 700, epoch: 1 | loss: 0.6673042
	speed: 0.0435s/iter; left time: 760.9345s
	iters: 800, epoch: 1 | loss: 0.8060049
	speed: 0.0430s/iter; left time: 747.2328s
	iters: 900, epoch: 1 | loss: 0.6626169
	speed: 0.0393s/iter; left time: 679.9991s
	iters: 1000, epoch: 1 | loss: 0.4981508
	speed: 0.0387s/iter; left time: 665.0868s
	iters: 1100, epoch: 1 | loss: 0.7864114
	speed: 0.0387s/iter; left time: 660.2898s
	iters: 1200, epoch: 1 | loss: 0.6247360
	speed: 0.0433s/iter; left time: 734.7305s
	iters: 1300, epoch: 1 | loss: 0.4494700
	speed: 0.0449s/iter; left time: 758.2505s
	iters: 1400, epoch: 1 | loss: 0.7429242
	speed: 0.0438s/iter; left time: 735.5350s
	iters: 1500, epoch: 1 | loss: 2.5633633
	speed: 0.0435s/iter; left time: 726.3137s
	iters: 1600, epoch: 1 | loss: 0.5044849
	speed: 0.0422s/iter; left time: 700.4741s
	iters: 1700, epoch: 1 | loss: 2.6784678
	speed: 0.0440s/iter; left time: 725.9534s
	iters: 1800, epoch: 1 | loss: 0.5004790
	speed: 0.0426s/iter; left time: 697.1151s
	iters: 1900, epoch: 1 | loss: 0.6779672
	speed: 0.0442s/iter; left time: 719.9156s
	iters: 2000, epoch: 1 | loss: 0.5555605
	speed: 0.0475s/iter; left time: 767.9662s
	iters: 2100, epoch: 1 | loss: 0.6085345
	speed: 0.0473s/iter; left time: 760.8557s
	iters: 2200, epoch: 1 | loss: 0.4286057
	speed: 0.0455s/iter; left time: 727.5058s
	iters: 2300, epoch: 1 | loss: 0.3909431
	speed: 0.0448s/iter; left time: 710.9948s
	iters: 2400, epoch: 1 | loss: 0.5576761
	speed: 0.0432s/iter; left time: 682.1741s
	iters: 2500, epoch: 1 | loss: 1.0648017
	speed: 0.0432s/iter; left time: 676.7606s
	iters: 2600, epoch: 1 | loss: 0.5272982
	speed: 0.0430s/iter; left time: 670.4995s
	iters: 2700, epoch: 1 | loss: 0.4205160
	speed: 0.0432s/iter; left time: 668.4015s
	iters: 2800, epoch: 1 | loss: 0.5449234
	speed: 0.0429s/iter; left time: 659.9371s
	iters: 2900, epoch: 1 | loss: 0.3670089
	speed: 0.0434s/iter; left time: 663.5286s
	iters: 3000, epoch: 1 | loss: 0.6686955
	speed: 0.0429s/iter; left time: 651.5203s
	iters: 3100, epoch: 1 | loss: 0.5891529
	speed: 0.0420s/iter; left time: 632.7209s
	iters: 3200, epoch: 1 | loss: 0.4955880
	speed: 0.0378s/iter; left time: 566.6845s
	iters: 3300, epoch: 1 | loss: 0.4767126
	speed: 0.0393s/iter; left time: 584.7086s
	iters: 3400, epoch: 1 | loss: 2.8319206
	speed: 0.0423s/iter; left time: 625.5206s
	iters: 3500, epoch: 1 | loss: 0.5300484
	speed: 0.0435s/iter; left time: 638.4358s
	iters: 3600, epoch: 1 | loss: 0.6443664
	speed: 0.0429s/iter; left time: 625.2481s
	iters: 3700, epoch: 1 | loss: 0.4002414
	speed: 0.0405s/iter; left time: 586.3758s
	iters: 3800, epoch: 1 | loss: 0.3499140
	speed: 0.0415s/iter; left time: 596.7777s
	iters: 3900, epoch: 1 | loss: 0.8332165
	speed: 0.0430s/iter; left time: 613.6823s
	iters: 4000, epoch: 1 | loss: 0.5800156
	speed: 0.0430s/iter; left time: 609.7784s
	iters: 4100, epoch: 1 | loss: 0.5876554
	speed: 0.0433s/iter; left time: 609.4247s
	iters: 4200, epoch: 1 | loss: 0.4118591
	speed: 0.0458s/iter; left time: 640.1440s
	iters: 4300, epoch: 1 | loss: 0.4264695
	speed: 0.0438s/iter; left time: 608.3606s
	iters: 4400, epoch: 1 | loss: 1.3328846
	speed: 0.0429s/iter; left time: 590.5847s
	iters: 4500, epoch: 1 | loss: 0.4024477
	speed: 0.0383s/iter; left time: 523.9758s
	iters: 4600, epoch: 1 | loss: 0.6830054
	speed: 0.0378s/iter; left time: 513.8240s
	iters: 4700, epoch: 1 | loss: 0.6086130
	speed: 0.0382s/iter; left time: 515.3325s
	iters: 4800, epoch: 1 | loss: 0.3599028
	speed: 0.0385s/iter; left time: 514.9081s
	iters: 4900, epoch: 1 | loss: 0.3415700
	speed: 0.0380s/iter; left time: 504.8415s
	iters: 5000, epoch: 1 | loss: 0.6530131
	speed: 0.0387s/iter; left time: 509.9862s
	iters: 5100, epoch: 1 | loss: 0.5405666
	speed: 0.0386s/iter; left time: 504.3198s
	iters: 5200, epoch: 1 | loss: 0.5135308
	speed: 0.0389s/iter; left time: 505.2488s
	iters: 5300, epoch: 1 | loss: 0.6709440
	speed: 0.0386s/iter; left time: 497.5815s
	iters: 5400, epoch: 1 | loss: 0.6485597
	speed: 0.0384s/iter; left time: 491.3919s
	iters: 5500, epoch: 1 | loss: 0.3330497
	speed: 0.0384s/iter; left time: 487.2844s
	iters: 5600, epoch: 1 | loss: 0.3582945
	speed: 0.0384s/iter; left time: 482.8010s
	iters: 5700, epoch: 1 | loss: 0.4459652
	speed: 0.0385s/iter; left time: 480.4211s
	iters: 5800, epoch: 1 | loss: 0.4190441
	speed: 0.0391s/iter; left time: 484.2663s
	iters: 5900, epoch: 1 | loss: 0.8346046
	speed: 0.0398s/iter; left time: 489.3421s
	iters: 6000, epoch: 1 | loss: 0.6072817
	speed: 0.0405s/iter; left time: 492.9822s
	iters: 6100, epoch: 1 | loss: 0.6214017
	speed: 0.0432s/iter; left time: 522.2785s
	iters: 6200, epoch: 1 | loss: 0.2458644
	speed: 0.0422s/iter; left time: 506.0500s
	iters: 6300, epoch: 1 | loss: 0.5094241
	speed: 0.0429s/iter; left time: 510.0068s
	iters: 6400, epoch: 1 | loss: 0.8070199
	speed: 0.0449s/iter; left time: 528.5326s
	iters: 6500, epoch: 1 | loss: 0.6130192
	speed: 0.0441s/iter; left time: 515.7053s
	iters: 6600, epoch: 1 | loss: 0.6572295
	speed: 0.0446s/iter; left time: 515.9805s
	iters: 6700, epoch: 1 | loss: 0.4177273
	speed: 0.0455s/iter; left time: 522.2872s
	iters: 6800, epoch: 1 | loss: 0.8464835
	speed: 0.0457s/iter; left time: 519.6055s
	iters: 6900, epoch: 1 | loss: 0.4233348
	speed: 0.0450s/iter; left time: 507.6065s
	iters: 7000, epoch: 1 | loss: 0.4758302
	speed: 0.0437s/iter; left time: 488.6806s
	iters: 7100, epoch: 1 | loss: 0.4101300
	speed: 0.0439s/iter; left time: 486.4186s
	iters: 7200, epoch: 1 | loss: 0.6089602
	speed: 0.0433s/iter; left time: 475.3321s
	iters: 7300, epoch: 1 | loss: 0.4642113
	speed: 0.0402s/iter; left time: 437.7562s
	iters: 7400, epoch: 1 | loss: 0.4743373
	speed: 0.0383s/iter; left time: 413.0009s
	iters: 7500, epoch: 1 | loss: 0.5417501
	speed: 0.0384s/iter; left time: 409.9452s
	iters: 7600, epoch: 1 | loss: 0.4035145
	speed: 0.0385s/iter; left time: 407.1691s
	iters: 7700, epoch: 1 | loss: 0.4749341
	speed: 0.0410s/iter; left time: 430.2277s
	iters: 7800, epoch: 1 | loss: 0.4006170
	speed: 0.0435s/iter; left time: 451.5481s
	iters: 7900, epoch: 1 | loss: 2.9862585
	speed: 0.0435s/iter; left time: 446.8685s
	iters: 8000, epoch: 1 | loss: 0.6596428
	speed: 0.0425s/iter; left time: 432.2079s
	iters: 8100, epoch: 1 | loss: 0.5324714
	speed: 0.0426s/iter; left time: 429.2226s
	iters: 8200, epoch: 1 | loss: 0.6296384
	speed: 0.0439s/iter; left time: 438.1547s
	iters: 8300, epoch: 1 | loss: 0.5290492
	speed: 0.0432s/iter; left time: 426.6955s
	iters: 8400, epoch: 1 | loss: 0.3880685
	speed: 0.0436s/iter; left time: 426.5235s
	iters: 8500, epoch: 1 | loss: 0.3178715
	speed: 0.0433s/iter; left time: 419.2560s
	iters: 8600, epoch: 1 | loss: 0.4230114
	speed: 0.0433s/iter; left time: 414.8079s
	iters: 8700, epoch: 1 | loss: 0.7429696
	speed: 0.0437s/iter; left time: 414.4489s
	iters: 8800, epoch: 1 | loss: 0.3585036
	speed: 0.0436s/iter; left time: 409.3188s
	iters: 8900, epoch: 1 | loss: 0.5315144
	speed: 0.0437s/iter; left time: 405.2114s
	iters: 9000, epoch: 1 | loss: 0.7319335
	speed: 0.0437s/iter; left time: 401.5366s
Epoch: 1 cost time: 387.2931373119354
Epoch: 1, Steps: 9090 | Train Loss: 0.6848320 Vali Loss: 0.6643330 Test Loss: 0.3396804
Validation loss decreased (inf --> 0.664333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4289516
	speed: 0.7215s/iter; left time: 6487.0669s
	iters: 200, epoch: 2 | loss: 0.5294583
	speed: 0.0454s/iter; left time: 403.4666s
	iters: 300, epoch: 2 | loss: 0.3607289
	speed: 0.0454s/iter; left time: 399.2604s
	iters: 400, epoch: 2 | loss: 0.6090922
	speed: 0.0447s/iter; left time: 388.0869s
	iters: 500, epoch: 2 | loss: 0.6905713
	speed: 0.0421s/iter; left time: 361.4082s
	iters: 600, epoch: 2 | loss: 0.5375797
	speed: 0.0395s/iter; left time: 335.3573s
	iters: 700, epoch: 2 | loss: 0.4814661
	speed: 0.0412s/iter; left time: 345.6649s
	iters: 800, epoch: 2 | loss: 0.4507239
	speed: 0.0439s/iter; left time: 364.0562s
	iters: 900, epoch: 2 | loss: 0.4295391
	speed: 0.0422s/iter; left time: 345.3366s
	iters: 1000, epoch: 2 | loss: 0.7792950
	speed: 0.0396s/iter; left time: 320.5426s
	iters: 1100, epoch: 2 | loss: 0.6987904
	speed: 0.0388s/iter; left time: 310.0275s
	iters: 1200, epoch: 2 | loss: 2.4272964
	speed: 0.0390s/iter; left time: 307.4661s
	iters: 1300, epoch: 2 | loss: 0.5034990
	speed: 0.0386s/iter; left time: 300.6166s
	iters: 1400, epoch: 2 | loss: 0.8678614
	speed: 0.0389s/iter; left time: 299.2137s
	iters: 1500, epoch: 2 | loss: 0.8450232
	speed: 0.0430s/iter; left time: 326.3794s
	iters: 1600, epoch: 2 | loss: 0.3330459
	speed: 0.0456s/iter; left time: 341.6713s
	iters: 1700, epoch: 2 | loss: 0.3873610
	speed: 0.0472s/iter; left time: 349.0055s
	iters: 1800, epoch: 2 | loss: 0.5135450
	speed: 0.0470s/iter; left time: 342.6581s
	iters: 1900, epoch: 2 | loss: 0.5069827
	speed: 0.0486s/iter; left time: 349.6575s
	iters: 2000, epoch: 2 | loss: 0.4691523
	speed: 0.0457s/iter; left time: 323.9034s
	iters: 2100, epoch: 2 | loss: 0.4920393
	speed: 0.0447s/iter; left time: 312.6636s
	iters: 2200, epoch: 2 | loss: 0.3484556
	speed: 0.0437s/iter; left time: 301.0742s
	iters: 2300, epoch: 2 | loss: 0.7348341
	speed: 0.0441s/iter; left time: 299.2309s
	iters: 2400, epoch: 2 | loss: 0.7902414
	speed: 0.0443s/iter; left time: 296.1686s
	iters: 2500, epoch: 2 | loss: 0.6390221
	speed: 0.0445s/iter; left time: 293.2967s
	iters: 2600, epoch: 2 | loss: 0.4814477
	speed: 0.0447s/iter; left time: 289.9435s
	iters: 2700, epoch: 2 | loss: 0.4588025
	speed: 0.0428s/iter; left time: 273.7083s
	iters: 2800, epoch: 2 | loss: 1.2256838
	speed: 0.0424s/iter; left time: 267.0522s
	iters: 2900, epoch: 2 | loss: 0.6980850
	speed: 0.0439s/iter; left time: 271.5823s
	iters: 3000, epoch: 2 | loss: 0.4292712
	speed: 0.0459s/iter; left time: 279.5563s
	iters: 3100, epoch: 2 | loss: 0.4643730
	speed: 0.0451s/iter; left time: 270.0772s
	iters: 3200, epoch: 2 | loss: 2.6444538
	speed: 0.0435s/iter; left time: 256.1418s
	iters: 3300, epoch: 2 | loss: 0.4851149
	speed: 0.0424s/iter; left time: 245.7340s
	iters: 3400, epoch: 2 | loss: 0.4701016
	speed: 0.0379s/iter; left time: 215.7936s
	iters: 3500, epoch: 2 | loss: 0.4689828
	speed: 0.0384s/iter; left time: 214.8706s
	iters: 3600, epoch: 2 | loss: 0.5287772
	speed: 0.0380s/iter; left time: 208.6175s
	iters: 3700, epoch: 2 | loss: 0.7724721
	speed: 0.0378s/iter; left time: 203.7733s
	iters: 3800, epoch: 2 | loss: 0.3574938
	speed: 0.0381s/iter; left time: 201.3901s
	iters: 3900, epoch: 2 | loss: 0.5155621
	speed: 0.0398s/iter; left time: 206.7100s
	iters: 4000, epoch: 2 | loss: 0.6732935
	speed: 0.0383s/iter; left time: 195.1480s
	iters: 4100, epoch: 2 | loss: 0.4140898
	speed: 0.0384s/iter; left time: 191.8086s
	iters: 4200, epoch: 2 | loss: 0.6398319
	speed: 0.0424s/iter; left time: 207.2789s
	iters: 4300, epoch: 2 | loss: 2.5691919
	speed: 0.0443s/iter; left time: 212.2825s
	iters: 4400, epoch: 2 | loss: 0.5432428
	speed: 0.0460s/iter; left time: 215.8624s
	iters: 4500, epoch: 2 | loss: 0.3071679
	speed: 0.0444s/iter; left time: 204.0374s
	iters: 4600, epoch: 2 | loss: 0.4810651
	speed: 0.0439s/iter; left time: 197.1157s
	iters: 4700, epoch: 2 | loss: 0.5008684
	speed: 0.0432s/iter; left time: 189.7707s
	iters: 4800, epoch: 2 | loss: 0.6473216
	speed: 0.0434s/iter; left time: 186.3128s
	iters: 4900, epoch: 2 | loss: 0.6241876
	speed: 0.0435s/iter; left time: 182.4355s
	iters: 5000, epoch: 2 | loss: 0.4356989
	speed: 0.0437s/iter; left time: 178.7859s
	iters: 5100, epoch: 2 | loss: 0.5950914
	speed: 0.0428s/iter; left time: 170.8281s
	iters: 5200, epoch: 2 | loss: 0.2975600
	speed: 0.0429s/iter; left time: 166.8511s
	iters: 5300, epoch: 2 | loss: 0.4577867
	speed: 0.0436s/iter; left time: 165.4384s
	iters: 5400, epoch: 2 | loss: 0.3770771
	speed: 0.0460s/iter; left time: 169.6634s
	iters: 5500, epoch: 2 | loss: 0.2358198
	speed: 0.0475s/iter; left time: 170.6240s
	iters: 5600, epoch: 2 | loss: 0.5928219
	speed: 0.0456s/iter; left time: 159.3616s
	iters: 5700, epoch: 2 | loss: 0.4312017
	speed: 0.0442s/iter; left time: 149.8966s
	iters: 5800, epoch: 2 | loss: 0.5155040
	speed: 0.0426s/iter; left time: 140.2409s
	iters: 5900, epoch: 2 | loss: 0.5377529
	speed: 0.0428s/iter; left time: 136.5345s
	iters: 6000, epoch: 2 | loss: 0.4689468
	speed: 0.0388s/iter; left time: 119.8512s
	iters: 6100, epoch: 2 | loss: 0.3883857
	speed: 0.0385s/iter; left time: 115.0725s
	iters: 6200, epoch: 2 | loss: 0.3630493
	speed: 0.0398s/iter; left time: 115.1528s
	iters: 6300, epoch: 2 | loss: 0.8154077
	speed: 0.0426s/iter; left time: 118.8136s
	iters: 6400, epoch: 2 | loss: 0.8026385
	speed: 0.0398s/iter; left time: 107.2231s
	iters: 6500, epoch: 2 | loss: 0.4833290
	speed: 0.0385s/iter; left time: 99.6979s
	iters: 6600, epoch: 2 | loss: 0.4618388
	speed: 0.0390s/iter; left time: 97.0807s
	iters: 6700, epoch: 2 | loss: 0.4609826
	speed: 0.0381s/iter; left time: 91.1445s
	iters: 6800, epoch: 2 | loss: 0.4443330
	speed: 0.0409s/iter; left time: 93.7352s
	iters: 6900, epoch: 2 | loss: 0.3673516
	speed: 0.0443s/iter; left time: 97.0644s
	iters: 7000, epoch: 2 | loss: 0.4445184
	speed: 0.0445s/iter; left time: 93.1445s
	iters: 7100, epoch: 2 | loss: 0.3928738
	speed: 0.0440s/iter; left time: 87.6366s
	iters: 7200, epoch: 2 | loss: 0.3117701
	speed: 0.0439s/iter; left time: 82.9232s
	iters: 7300, epoch: 2 | loss: 0.4709398
	speed: 0.0436s/iter; left time: 78.0168s
	iters: 7400, epoch: 2 | loss: 0.7294506
	speed: 0.0433s/iter; left time: 73.2475s
	iters: 7500, epoch: 2 | loss: 0.4095438
	speed: 0.0431s/iter; left time: 68.6228s
	iters: 7600, epoch: 2 | loss: 0.7481363
	speed: 0.0433s/iter; left time: 64.6212s
	iters: 7700, epoch: 2 | loss: 0.5201313
	speed: 0.0427s/iter; left time: 59.4102s
	iters: 7800, epoch: 2 | loss: 0.3156113
	speed: 0.0439s/iter; left time: 56.6991s
	iters: 7900, epoch: 2 | loss: 0.3241242
	speed: 0.0473s/iter; left time: 56.3071s
	iters: 8000, epoch: 2 | loss: 0.5308084
	speed: 0.0463s/iter; left time: 50.5000s
	iters: 8100, epoch: 2 | loss: 0.5371897
	speed: 0.0435s/iter; left time: 43.0907s
	iters: 8200, epoch: 2 | loss: 0.5554430
	speed: 0.0430s/iter; left time: 38.3318s
	iters: 8300, epoch: 2 | loss: 0.3752372
	speed: 0.0406s/iter; left time: 32.1365s
	iters: 8400, epoch: 2 | loss: 0.4308175
	speed: 0.0394s/iter; left time: 27.1911s
	iters: 8500, epoch: 2 | loss: 0.3889720
	speed: 0.0429s/iter; left time: 25.3350s
	iters: 8600, epoch: 2 | loss: 0.4613201
	speed: 0.0467s/iter; left time: 22.9510s
	iters: 8700, epoch: 2 | loss: 0.3900656
	speed: 0.0466s/iter; left time: 18.2378s
	iters: 8800, epoch: 2 | loss: 0.6174363
	speed: 0.0485s/iter; left time: 14.1191s
	iters: 8900, epoch: 2 | loss: 0.5278422
	speed: 0.0481s/iter; left time: 9.1790s
	iters: 9000, epoch: 2 | loss: 0.6772572
	speed: 0.0526s/iter; left time: 4.7901s
Epoch: 2 cost time: 393.19827127456665
Epoch: 2, Steps: 9090 | Train Loss: 0.5794640 Vali Loss: 0.6598182 Test Loss: 0.3436836
Validation loss decreased (0.664333 --> 0.659818).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_336_Autoformer_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.34368395805358887, mae:0.389959454536438, rse:0.7699546813964844
