Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_96_PatchTSW_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5071302
	speed: 0.3625s/iter; left time: 9606.9838s
	iters: 200, epoch: 1 | loss: 0.4543751
	speed: 0.3449s/iter; left time: 9105.1888s
Epoch: 1 cost time: 93.64425587654114
Epoch: 1, Steps: 266 | Train Loss: 0.3349468 Vali Loss: 0.1383092 Test Loss: 0.1980923
Validation loss decreased (inf --> 0.138309).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.2342957
	speed: 0.8135s/iter; left time: 21342.4467s
	iters: 200, epoch: 2 | loss: 0.1595850
	speed: 0.3463s/iter; left time: 9051.3396s
Epoch: 2 cost time: 94.10364103317261
Epoch: 2, Steps: 266 | Train Loss: 0.2521934 Vali Loss: 0.1293028 Test Loss: 0.1842085
Validation loss decreased (0.138309 --> 0.129303).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2872414
	speed: 0.8212s/iter; left time: 21325.5687s
	iters: 200, epoch: 3 | loss: 0.2757760
	speed: 0.3466s/iter; left time: 8965.1036s
Epoch: 3 cost time: 94.3305037021637
Epoch: 3, Steps: 266 | Train Loss: 0.2378650 Vali Loss: 0.1253463 Test Loss: 0.1784927
Validation loss decreased (0.129303 --> 0.125346).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.2694461
	speed: 0.8206s/iter; left time: 21092.1496s
	iters: 200, epoch: 4 | loss: 0.1956041
	speed: 0.3466s/iter; left time: 8874.2806s
Epoch: 4 cost time: 94.25068259239197
Epoch: 4, Steps: 266 | Train Loss: 0.2296677 Vali Loss: 0.1232277 Test Loss: 0.1751123
Validation loss decreased (0.125346 --> 0.123228).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.1515080
	speed: 0.8156s/iter; left time: 20746.7942s
	iters: 200, epoch: 5 | loss: 0.2253488
	speed: 0.3468s/iter; left time: 8787.3219s
Epoch: 5 cost time: 94.17148208618164
Epoch: 5, Steps: 266 | Train Loss: 0.2235854 Vali Loss: 0.1224271 Test Loss: 0.1727962
Validation loss decreased (0.123228 --> 0.122427).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2584099
	speed: 0.8133s/iter; left time: 20471.1049s
	iters: 200, epoch: 6 | loss: 0.1781610
	speed: 0.3468s/iter; left time: 8695.2330s
Epoch: 6 cost time: 93.92009544372559
Epoch: 6, Steps: 266 | Train Loss: 0.2176279 Vali Loss: 0.1218007 Test Loss: 0.1720505
Validation loss decreased (0.122427 --> 0.121801).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2781905
	speed: 0.8212s/iter; left time: 20452.3424s
	iters: 200, epoch: 7 | loss: 0.2582898
	speed: 0.3468s/iter; left time: 8602.8994s
Epoch: 7 cost time: 94.3854467868805
Epoch: 7, Steps: 266 | Train Loss: 0.2125129 Vali Loss: 0.1215707 Test Loss: 0.1692821
Validation loss decreased (0.121801 --> 0.121571).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.1862553
	speed: 0.8273s/iter; left time: 20382.6628s
	iters: 200, epoch: 8 | loss: 0.1829638
	speed: 0.3467s/iter; left time: 8508.0263s
Epoch: 8 cost time: 94.3413188457489
Epoch: 8, Steps: 266 | Train Loss: 0.2069907 Vali Loss: 0.1208913 Test Loss: 0.1701204
Validation loss decreased (0.121571 --> 0.120891).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2176525
	speed: 0.8203s/iter; left time: 19992.2240s
	iters: 200, epoch: 9 | loss: 0.2143543
	speed: 0.3466s/iter; left time: 8412.1037s
Epoch: 9 cost time: 94.26778197288513
Epoch: 9, Steps: 266 | Train Loss: 0.2024216 Vali Loss: 0.1220198 Test Loss: 0.1705927
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.1669700
	speed: 0.8133s/iter; left time: 19607.0077s
	iters: 200, epoch: 10 | loss: 0.1856379
	speed: 0.3464s/iter; left time: 8317.1074s
Epoch: 10 cost time: 94.4148371219635
Epoch: 10, Steps: 266 | Train Loss: 0.1969072 Vali Loss: 0.1229073 Test Loss: 0.1714587
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.1588599
	speed: 0.8047s/iter; left time: 19183.9520s
	iters: 200, epoch: 11 | loss: 0.1958986
	speed: 0.3467s/iter; left time: 8231.2165s
Epoch: 11 cost time: 94.11523771286011
Epoch: 11, Steps: 266 | Train Loss: 0.1920858 Vali Loss: 0.1242995 Test Loss: 0.1713681
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.1822624
	speed: 0.8110s/iter; left time: 19120.3583s
	iters: 200, epoch: 12 | loss: 0.1985125
	speed: 0.3464s/iter; left time: 8132.8897s
Epoch: 12 cost time: 94.05612111091614
Epoch: 12, Steps: 266 | Train Loss: 0.1873285 Vali Loss: 0.1226782 Test Loss: 0.1714727
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.1932680
	speed: 0.8092s/iter; left time: 18860.9893s
	iters: 200, epoch: 13 | loss: 0.1798172
	speed: 0.3467s/iter; left time: 8047.6679s
Epoch: 13 cost time: 94.25288152694702
Epoch: 13, Steps: 266 | Train Loss: 0.1829130 Vali Loss: 0.1228790 Test Loss: 0.1708088
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.1926038
	speed: 0.8082s/iter; left time: 18623.3487s
	iters: 200, epoch: 14 | loss: 0.1730102
	speed: 0.3472s/iter; left time: 7965.5628s
Epoch: 14 cost time: 94.23074102401733
Epoch: 14, Steps: 266 | Train Loss: 0.1790900 Vali Loss: 0.1229352 Test Loss: 0.1733394
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.1814965
	speed: 0.8098s/iter; left time: 18444.8184s
	iters: 200, epoch: 15 | loss: 0.1911405
	speed: 0.3472s/iter; left time: 7872.8715s
Epoch: 15 cost time: 94.29001903533936
Epoch: 15, Steps: 266 | Train Loss: 0.1750906 Vali Loss: 0.1237046 Test Loss: 0.1738232
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.1560729
	speed: 0.8094s/iter; left time: 18220.3952s
	iters: 200, epoch: 16 | loss: 0.1424036
	speed: 0.3480s/iter; left time: 7798.0720s
Epoch: 16 cost time: 94.64755439758301
Epoch: 16, Steps: 266 | Train Loss: 0.1712203 Vali Loss: 0.1253540 Test Loss: 0.1773014
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.1284680
	speed: 0.8201s/iter; left time: 18242.7597s
