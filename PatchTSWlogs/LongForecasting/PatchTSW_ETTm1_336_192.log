Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_192_PatchTSW_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4523677
	speed: 0.3613s/iter; left time: 9537.3942s
	iters: 200, epoch: 1 | loss: 0.3826899
	speed: 0.3462s/iter; left time: 9105.1620s
Epoch: 1 cost time: 93.41290497779846
Epoch: 1, Steps: 265 | Train Loss: 0.4340306 Vali Loss: 0.5519696 Test Loss: 0.3812062
Validation loss decreased (inf --> 0.551970).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3471043
	speed: 0.8018s/iter; left time: 20954.6084s
	iters: 200, epoch: 2 | loss: 0.3438518
	speed: 0.3465s/iter; left time: 9020.5469s
Epoch: 2 cost time: 93.6937186717987
Epoch: 2, Steps: 265 | Train Loss: 0.3528172 Vali Loss: 0.5131379 Test Loss: 0.3561656
Validation loss decreased (0.551970 --> 0.513138).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.3675556
	speed: 0.8170s/iter; left time: 21137.2426s
	iters: 200, epoch: 3 | loss: 0.3238269
	speed: 0.3468s/iter; left time: 8937.0131s
Epoch: 3 cost time: 93.949054479599
Epoch: 3, Steps: 265 | Train Loss: 0.3355982 Vali Loss: 0.5040587 Test Loss: 0.3473089
Validation loss decreased (0.513138 --> 0.504059).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3398508
	speed: 0.8154s/iter; left time: 20877.8862s
	iters: 200, epoch: 4 | loss: 0.3232845
	speed: 0.3469s/iter; left time: 8848.3851s
Epoch: 4 cost time: 93.68120837211609
Epoch: 4, Steps: 265 | Train Loss: 0.3273905 Vali Loss: 0.4992047 Test Loss: 0.3432400
Validation loss decreased (0.504059 --> 0.499205).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3225444
	speed: 0.8204s/iter; left time: 20789.6832s
	iters: 200, epoch: 5 | loss: 0.2879960
	speed: 0.3469s/iter; left time: 8756.2720s
Epoch: 5 cost time: 93.92575693130493
Epoch: 5, Steps: 265 | Train Loss: 0.3216974 Vali Loss: 0.4970040 Test Loss: 0.3391287
Validation loss decreased (0.499205 --> 0.497004).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3417120
	speed: 0.8184s/iter; left time: 20522.9893s
	iters: 200, epoch: 6 | loss: 0.3103593
	speed: 0.3470s/iter; left time: 8667.2017s
Epoch: 6 cost time: 94.00974917411804
Epoch: 6, Steps: 265 | Train Loss: 0.3163311 Vali Loss: 0.4956689 Test Loss: 0.3368101
Validation loss decreased (0.497004 --> 0.495669).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.3104994
	speed: 0.8151s/iter; left time: 20223.2925s
	iters: 200, epoch: 7 | loss: 0.3059884
	speed: 0.3471s/iter; left time: 8576.1627s
Epoch: 7 cost time: 93.91235613822937
Epoch: 7, Steps: 265 | Train Loss: 0.3113664 Vali Loss: 0.4922050 Test Loss: 0.3370240
Validation loss decreased (0.495669 --> 0.492205).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.2975894
	speed: 0.8152s/iter; left time: 20010.8293s
	iters: 200, epoch: 8 | loss: 0.2915303
	speed: 0.3472s/iter; left time: 8487.7141s
Epoch: 8 cost time: 94.02227020263672
Epoch: 8, Steps: 265 | Train Loss: 0.3063813 Vali Loss: 0.4924781 Test Loss: 0.3349961
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.3243296
	speed: 0.8036s/iter; left time: 19511.8478s
	iters: 200, epoch: 9 | loss: 0.2925674
	speed: 0.3469s/iter; left time: 8389.0067s
Epoch: 9 cost time: 93.91544675827026
Epoch: 9, Steps: 265 | Train Loss: 0.3018996 Vali Loss: 0.4944792 Test Loss: 0.3304440
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.3084159
	speed: 0.8090s/iter; left time: 19428.8806s
	iters: 200, epoch: 10 | loss: 0.3103350
	speed: 0.3470s/iter; left time: 8298.5139s
Epoch: 10 cost time: 94.13711810112
Epoch: 10, Steps: 265 | Train Loss: 0.2976032 Vali Loss: 0.4925088 Test Loss: 0.3313687
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.2835355
	speed: 0.8079s/iter; left time: 19189.5704s
	iters: 200, epoch: 11 | loss: 0.2799426
	speed: 0.3471s/iter; left time: 8209.9250s
Epoch: 11 cost time: 94.05364179611206
Epoch: 11, Steps: 265 | Train Loss: 0.2934126 Vali Loss: 0.4959124 Test Loss: 0.3322311
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.2684976
	speed: 0.8089s/iter; left time: 18998.2438s
	iters: 200, epoch: 12 | loss: 0.2676861
	speed: 0.3468s/iter; left time: 8110.3789s
Epoch: 12 cost time: 93.90725827217102
Epoch: 12, Steps: 265 | Train Loss: 0.2894007 Vali Loss: 0.4926872 Test Loss: 0.3313127
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2896852
	speed: 0.8101s/iter; left time: 18812.2384s
	iters: 200, epoch: 13 | loss: 0.3005884
	speed: 0.3469s/iter; left time: 8020.8799s
Epoch: 13 cost time: 93.9453797340393
Epoch: 13, Steps: 265 | Train Loss: 0.2859386 Vali Loss: 0.4966843 Test Loss: 0.3336687
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.2746473
	speed: 0.8083s/iter; left time: 18555.3190s
	iters: 200, epoch: 14 | loss: 0.2869180
	speed: 0.3472s/iter; left time: 7935.1746s
Epoch: 14 cost time: 93.88730692863464
Epoch: 14, Steps: 265 | Train Loss: 0.2823444 Vali Loss: 0.4927245 Test Loss: 0.3293271
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2868893
	speed: 0.8059s/iter; left time: 18287.4186s
	iters: 200, epoch: 15 | loss: 0.3249320
	speed: 0.3470s/iter; left time: 7839.5983s
Epoch: 15 cost time: 93.99525427818298
Epoch: 15, Steps: 265 | Train Loss: 0.2787651 Vali Loss: 0.4974793 Test Loss: 0.3314833
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2966374
	speed: 0.8080s/iter; left time: 18120.3744s
	iters: 200, epoch: 16 | loss: 0.2773043
	speed: 0.3470s/iter; left time: 7747.5877s
Epoch: 16 cost time: 93.92403388023376
Epoch: 16, Steps: 265 | Train Loss: 0.2752086 Vali Loss: 0.4950157 Test Loss: 0.3315049
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2675974
	speed: 0.8091s/iter; left time: 17929.5821s
	iters: 200, epoch: 17 | loss: 0.2807588
	speed: 0.3472s/iter; left time: 7659.7352s
Epoch: 17 cost time: 94.08740997314453
Epoch: 17, Steps: 265 | Train Loss: 0.2708672 Vali Loss: 0.4968535 Test Loss: 0.3329532
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2637731
	speed: 0.8097s/iter; left time: 17729.2876s
	iters: 200, epoch: 18 | loss: 0.2906946
	speed: 0.3470s/iter; left time: 7563.3552s
Epoch: 18 cost time: 94.00327491760254
Epoch: 18, Steps: 265 | Train Loss: 0.2671795 Vali Loss: 0.4993178 Test Loss: 0.3330238
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2785160
	speed: 0.8091s/iter; left time: 17500.6971s
	iters: 200, epoch: 19 | loss: 0.2719793
	speed: 0.3472s/iter; left time: 7476.4790s
Epoch: 19 cost time: 93.90006279945374
Epoch: 19, Steps: 265 | Train Loss: 0.2628626 Vali Loss: 0.5018772 Test Loss: 0.3437637
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2714998
	speed: 0.8067s/iter; left time: 17234.9023s
	iters: 200, epoch: 20 | loss: 0.2271387
	speed: 0.3468s/iter; left time: 7374.7411s
Epoch: 20 cost time: 93.85856199264526
Epoch: 20, Steps: 265 | Train Loss: 0.2585983 Vali Loss: 0.5034285 Test Loss: 0.3362945
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2475359
	speed: 0.8061s/iter; left time: 17009.4302s
	iters: 200, epoch: 21 | loss: 0.2665239
	speed: 0.3469s/iter; left time: 7285.6346s
Epoch: 21 cost time: 93.9429624080658
Epoch: 21, Steps: 265 | Train Loss: 0.2542781 Vali Loss: 0.5138260 Test Loss: 0.3495130
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2473725
	speed: 0.8113s/iter; left time: 16905.1360s
	iters: 200, epoch: 22 | loss: 0.2468345
	speed: 0.3470s/iter; left time: 7194.8922s
Epoch: 22 cost time: 94.1498191356659
Epoch: 22, Steps: 265 | Train Loss: 0.2506883 Vali Loss: 0.5158524 Test Loss: 0.3393381
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2292223
	speed: 0.8069s/iter; left time: 16599.0234s
	iters: 200, epoch: 23 | loss: 0.2286481
	speed: 0.3471s/iter; left time: 7104.5016s
Epoch: 23 cost time: 93.9054045677185
Epoch: 23, Steps: 265 | Train Loss: 0.2464445 Vali Loss: 0.5116284 Test Loss: 0.3515242
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2511383
	speed: 0.8086s/iter; left time: 16418.8211s
	iters: 200, epoch: 24 | loss: 0.2293575
	speed: 0.3471s/iter; left time: 7014.5074s
Epoch: 24 cost time: 93.99025011062622
Epoch: 24, Steps: 265 | Train Loss: 0.2420172 Vali Loss: 0.5145051 Test Loss: 0.3595361
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2429915
	speed: 0.8043s/iter; left time: 16119.8721s
	iters: 200, epoch: 25 | loss: 0.2252700
	speed: 0.3471s/iter; left time: 6922.1690s
Epoch: 25 cost time: 94.05631518363953
Epoch: 25, Steps: 265 | Train Loss: 0.2382601 Vali Loss: 0.5184696 Test Loss: 0.3495357
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2300022
	speed: 0.8061s/iter; left time: 15942.1911s
	iters: 200, epoch: 26 | loss: 0.2336178
	speed: 0.3472s/iter; left time: 6831.0315s
Epoch: 26 cost time: 94.01999378204346
Epoch: 26, Steps: 265 | Train Loss: 0.2340233 Vali Loss: 0.5258726 Test Loss: 0.3600593
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2468835
	speed: 0.8062s/iter; left time: 15729.7536s
	iters: 200, epoch: 27 | loss: 0.2362196
	speed: 0.3470s/iter; left time: 6735.7776s
Epoch: 27 cost time: 94.00623178482056
Epoch: 27, Steps: 265 | Train Loss: 0.2301317 Vali Loss: 0.5264863 Test Loss: 0.3607975
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTSW_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3370242118835449, mae:0.3708091974258423, rse:0.5521727800369263
