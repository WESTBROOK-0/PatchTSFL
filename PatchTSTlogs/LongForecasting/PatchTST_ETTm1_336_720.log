Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5268667
	speed: 0.0521s/iter; left time: 1355.5330s
	iters: 200, epoch: 1 | loss: 0.5146532
	speed: 0.0465s/iter; left time: 1203.1230s
Epoch: 1 cost time: 12.848932981491089
Epoch: 1, Steps: 261 | Train Loss: 0.5553891 Vali Loss: 1.0185183 Test Loss: 0.4813811
Validation loss decreased (inf --> 1.018518).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.4816158
	speed: 0.1338s/iter; left time: 3443.4437s
	iters: 200, epoch: 2 | loss: 0.4867128
	speed: 0.0465s/iter; left time: 1193.4130s
Epoch: 2 cost time: 12.888692378997803
Epoch: 2, Steps: 261 | Train Loss: 0.4716990 Vali Loss: 0.9809836 Test Loss: 0.4518062
Validation loss decreased (1.018518 --> 0.980984).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4320019
	speed: 0.1345s/iter; left time: 3427.6127s
	iters: 200, epoch: 3 | loss: 0.4508645
	speed: 0.0468s/iter; left time: 1186.8879s
Epoch: 3 cost time: 12.971266031265259
Epoch: 3, Steps: 261 | Train Loss: 0.4493775 Vali Loss: 0.9663900 Test Loss: 0.4416227
Validation loss decreased (0.980984 --> 0.966390).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4491374
	speed: 0.1361s/iter; left time: 3431.7196s
	iters: 200, epoch: 4 | loss: 0.4421536
	speed: 0.0466s/iter; left time: 1170.3030s
Epoch: 4 cost time: 12.986056566238403
Epoch: 4, Steps: 261 | Train Loss: 0.4386550 Vali Loss: 0.9643591 Test Loss: 0.4370510
Validation loss decreased (0.966390 --> 0.964359).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.4166359
	speed: 0.1354s/iter; left time: 3378.7009s
	iters: 200, epoch: 5 | loss: 0.4636121
	speed: 0.0466s/iter; left time: 1157.7665s
Epoch: 5 cost time: 13.096679925918579
Epoch: 5, Steps: 261 | Train Loss: 0.4328476 Vali Loss: 0.9646826 Test Loss: 0.4338947
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.4558915
	speed: 0.1366s/iter; left time: 3373.4899s
	iters: 200, epoch: 6 | loss: 0.4285181
	speed: 0.0465s/iter; left time: 1144.5694s
Epoch: 6 cost time: 13.07374095916748
Epoch: 6, Steps: 261 | Train Loss: 0.4293144 Vali Loss: 0.9605571 Test Loss: 0.4317810
Validation loss decreased (0.964359 --> 0.960557).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.4304454
	speed: 0.1370s/iter; left time: 3347.4777s
	iters: 200, epoch: 7 | loss: 0.4284375
	speed: 0.0467s/iter; left time: 1136.8174s
Epoch: 7 cost time: 13.036202907562256
Epoch: 7, Steps: 261 | Train Loss: 0.4265887 Vali Loss: 0.9609868 Test Loss: 0.4303763
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.4169259
	speed: 0.1386s/iter; left time: 3349.3934s
	iters: 200, epoch: 8 | loss: 0.3776423
	speed: 0.0465s/iter; left time: 1120.6283s
Epoch: 8 cost time: 13.034574031829834
Epoch: 8, Steps: 261 | Train Loss: 0.4241412 Vali Loss: 0.9569377 Test Loss: 0.4281554
Validation loss decreased (0.960557 --> 0.956938).  Saving model ...
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.4320177
	speed: 0.1398s/iter; left time: 3343.3596s
	iters: 200, epoch: 9 | loss: 0.3870955
	speed: 0.0467s/iter; left time: 1111.4013s
Epoch: 9 cost time: 13.020840644836426
Epoch: 9, Steps: 261 | Train Loss: 0.4214134 Vali Loss: 0.9505633 Test Loss: 0.4256436
Validation loss decreased (0.956938 --> 0.950563).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.4242924
	speed: 0.1329s/iter; left time: 3142.8677s
	iters: 200, epoch: 10 | loss: 0.4340114
	speed: 0.0467s/iter; left time: 1100.9085s
Epoch: 10 cost time: 12.902193069458008
Epoch: 10, Steps: 261 | Train Loss: 0.4175333 Vali Loss: 0.9559678 Test Loss: 0.4203452
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.3962268
	speed: 0.1344s/iter; left time: 3144.2406s
	iters: 200, epoch: 11 | loss: 0.4408952
	speed: 0.0466s/iter; left time: 1085.7712s
Epoch: 11 cost time: 12.930917501449585
Epoch: 11, Steps: 261 | Train Loss: 0.4134933 Vali Loss: 0.9501995 Test Loss: 0.4159597
Validation loss decreased (0.950563 --> 0.950199).  Saving model ...
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.3938559
	speed: 0.1381s/iter; left time: 3194.6623s
	iters: 200, epoch: 12 | loss: 0.4226029
	speed: 0.0465s/iter; left time: 1070.3226s
Epoch: 12 cost time: 13.010255098342896
Epoch: 12, Steps: 261 | Train Loss: 0.4101428 Vali Loss: 0.9500785 Test Loss: 0.4142676
Validation loss decreased (0.950199 --> 0.950078).  Saving model ...
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.4152576
	speed: 0.1327s/iter; left time: 3034.6159s
	iters: 200, epoch: 13 | loss: 0.3982128
	speed: 0.0466s/iter; left time: 1060.6497s
Epoch: 13 cost time: 12.846625328063965
Epoch: 13, Steps: 261 | Train Loss: 0.4068686 Vali Loss: 0.9457819 Test Loss: 0.4132362
Validation loss decreased (0.950078 --> 0.945782).  Saving model ...
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.4133545
	speed: 0.1315s/iter; left time: 2972.1975s
	iters: 200, epoch: 14 | loss: 0.4113889
	speed: 0.0465s/iter; left time: 1047.6043s
Epoch: 14 cost time: 12.788164854049683
Epoch: 14, Steps: 261 | Train Loss: 0.4035964 Vali Loss: 0.9578323 Test Loss: 0.4153295
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.3591883
	speed: 0.1384s/iter; left time: 3092.9215s
	iters: 200, epoch: 15 | loss: 0.3826664
	speed: 0.0466s/iter; left time: 1035.9965s
Epoch: 15 cost time: 13.106289863586426
Epoch: 15, Steps: 261 | Train Loss: 0.4005166 Vali Loss: 0.9474847 Test Loss: 0.4150920
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.3827124
	speed: 0.1375s/iter; left time: 3036.4962s
	iters: 200, epoch: 16 | loss: 0.4404892
	speed: 0.0465s/iter; left time: 1021.8925s
Epoch: 16 cost time: 13.146714687347412
Epoch: 16, Steps: 261 | Train Loss: 0.3976115 Vali Loss: 0.9422761 Test Loss: 0.4185518
Validation loss decreased (0.945782 --> 0.942276).  Saving model ...
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.4152092
	speed: 0.1396s/iter; left time: 3046.5082s
	iters: 200, epoch: 17 | loss: 0.3724646
	speed: 0.0466s/iter; left time: 1012.1930s
Epoch: 17 cost time: 13.184837341308594
Epoch: 17, Steps: 261 | Train Loss: 0.3947587 Vali Loss: 0.9424576 Test Loss: 0.4195707
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.3572394
	speed: 0.1342s/iter; left time: 2893.5024s
	iters: 200, epoch: 18 | loss: 0.3913054
	speed: 0.0467s/iter; left time: 1003.2210s
Epoch: 18 cost time: 13.004845142364502
Epoch: 18, Steps: 261 | Train Loss: 0.3919960 Vali Loss: 0.9484851 Test Loss: 0.4210446
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.3883962
	speed: 0.1362s/iter; left time: 2900.4796s
	iters: 200, epoch: 19 | loss: 0.3759284
	speed: 0.0466s/iter; left time: 988.4966s
Epoch: 19 cost time: 12.850736618041992
Epoch: 19, Steps: 261 | Train Loss: 0.3887922 Vali Loss: 0.9540870 Test Loss: 0.4227271
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.3782331
	speed: 0.1336s/iter; left time: 2810.8529s
	iters: 200, epoch: 20 | loss: 0.3809253
	speed: 0.0467s/iter; left time: 977.0762s
Epoch: 20 cost time: 13.092000484466553
Epoch: 20, Steps: 261 | Train Loss: 0.3855486 Vali Loss: 0.9539722 Test Loss: 0.4233539
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.4131150
	speed: 0.1361s/iter; left time: 2828.0933s
	iters: 200, epoch: 21 | loss: 0.4306356
	speed: 0.0467s/iter; left time: 965.2304s
Epoch: 21 cost time: 12.887701034545898
Epoch: 21, Steps: 261 | Train Loss: 0.3818221 Vali Loss: 0.9561875 Test Loss: 0.4214068
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3710332
	speed: 0.1326s/iter; left time: 2720.0298s
	iters: 200, epoch: 22 | loss: 0.3783243
	speed: 0.0466s/iter; left time: 950.8123s
Epoch: 22 cost time: 12.936349630355835
Epoch: 22, Steps: 261 | Train Loss: 0.3783559 Vali Loss: 0.9486209 Test Loss: 0.4266963
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.3606458
	speed: 0.1314s/iter; left time: 2662.4313s
	iters: 200, epoch: 23 | loss: 0.3341677
	speed: 0.0466s/iter; left time: 938.4769s
Epoch: 23 cost time: 12.819093942642212
Epoch: 23, Steps: 261 | Train Loss: 0.3749608 Vali Loss: 0.9639613 Test Loss: 0.4313563
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3807487
	speed: 0.1316s/iter; left time: 2631.0194s
	iters: 200, epoch: 24 | loss: 0.3674129
	speed: 0.0467s/iter; left time: 929.5876s
Epoch: 24 cost time: 12.85767936706543
Epoch: 24, Steps: 261 | Train Loss: 0.3711645 Vali Loss: 0.9757558 Test Loss: 0.4284669
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3856414
	speed: 0.1320s/iter; left time: 2605.9764s
	iters: 200, epoch: 25 | loss: 0.3727616
	speed: 0.0466s/iter; left time: 916.0326s
Epoch: 25 cost time: 12.827128648757935
Epoch: 25, Steps: 261 | Train Loss: 0.3675821 Vali Loss: 0.9813992 Test Loss: 0.4311081
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.3585105
	speed: 0.1347s/iter; left time: 2622.7618s
	iters: 200, epoch: 26 | loss: 0.3569590
	speed: 0.0468s/iter; left time: 906.7222s
Epoch: 26 cost time: 12.911225080490112
Epoch: 26, Steps: 261 | Train Loss: 0.3634381 Vali Loss: 0.9800120 Test Loss: 0.4324603
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.3312498
	speed: 0.1332s/iter; left time: 2558.5063s
	iters: 200, epoch: 27 | loss: 0.3595601
	speed: 0.0467s/iter; left time: 891.7889s
Epoch: 27 cost time: 13.028713464736938
Epoch: 27, Steps: 261 | Train Loss: 0.3595270 Vali Loss: 0.9967036 Test Loss: 0.4333109
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.3705048
	speed: 0.1363s/iter; left time: 2583.0512s
	iters: 200, epoch: 28 | loss: 0.3561662
	speed: 0.0466s/iter; left time: 877.8774s
Epoch: 28 cost time: 13.060172319412231
Epoch: 28, Steps: 261 | Train Loss: 0.3556362 Vali Loss: 0.9844919 Test Loss: 0.4371165
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.3343641
	speed: 0.1365s/iter; left time: 2552.2699s
	iters: 200, epoch: 29 | loss: 0.3573404
	speed: 0.0468s/iter; left time: 869.4694s
Epoch: 29 cost time: 12.989439010620117
Epoch: 29, Steps: 261 | Train Loss: 0.3515708 Vali Loss: 0.9946353 Test Loss: 0.4403816
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.318146929322795e-05
	iters: 100, epoch: 30 | loss: 0.3450203
	speed: 0.1355s/iter; left time: 2498.0182s
	iters: 200, epoch: 30 | loss: 0.3747361
	speed: 0.0466s/iter; left time: 853.6508s
Epoch: 30 cost time: 13.117478847503662
Epoch: 30, Steps: 261 | Train Loss: 0.3478933 Vali Loss: 1.0193797 Test Loss: 0.4423857
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.59487855091154e-05
	iters: 100, epoch: 31 | loss: 0.3662067
	speed: 0.1380s/iter; left time: 2507.2291s
	iters: 200, epoch: 31 | loss: 0.3313585
	speed: 0.0467s/iter; left time: 844.4342s
Epoch: 31 cost time: 13.030061721801758
Epoch: 31, Steps: 261 | Train Loss: 0.3434035 Vali Loss: 0.9976933 Test Loss: 0.4455145
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.850675609123214e-05
	iters: 100, epoch: 32 | loss: 0.3488182
	speed: 0.1401s/iter; left time: 2508.7546s
	iters: 200, epoch: 32 | loss: 0.3233288
	speed: 0.0466s/iter; left time: 829.3364s
Epoch: 32 cost time: 13.088836669921875
Epoch: 32, Steps: 261 | Train Loss: 0.3397180 Vali Loss: 1.0038228 Test Loss: 0.4472368
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.083960728023302e-05
	iters: 100, epoch: 33 | loss: 0.2977809
	speed: 0.1317s/iter; left time: 2324.0682s
	iters: 200, epoch: 33 | loss: 0.3400685
	speed: 0.0466s/iter; left time: 817.5645s
Epoch: 33 cost time: 12.831313371658325
Epoch: 33, Steps: 261 | Train Loss: 0.3357986 Vali Loss: 1.0062267 Test Loss: 0.4482564
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.293295351848083e-05
	iters: 100, epoch: 34 | loss: 0.3279880
	speed: 0.1356s/iter; left time: 2358.0131s
	iters: 200, epoch: 34 | loss: 0.3104264
	speed: 0.0467s/iter; left time: 806.8250s
Epoch: 34 cost time: 12.976427555084229
Epoch: 34, Steps: 261 | Train Loss: 0.3323014 Vali Loss: 1.0010113 Test Loss: 0.4489041
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.47738861587773e-05
	iters: 100, epoch: 35 | loss: 0.3339114
	speed: 0.1323s/iter; left time: 2265.2308s
	iters: 200, epoch: 35 | loss: 0.3217306
	speed: 0.0466s/iter; left time: 793.6389s
Epoch: 35 cost time: 12.873340845108032
Epoch: 35, Steps: 261 | Train Loss: 0.3286656 Vali Loss: 1.0257590 Test Loss: 0.4501404
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.635105306570629e-05
	iters: 100, epoch: 36 | loss: 0.3282644
	speed: 0.1343s/iter; left time: 2264.6194s
	iters: 200, epoch: 36 | loss: 0.3391494
	speed: 0.0468s/iter; left time: 784.5054s
Epoch: 36 cost time: 12.837915182113647
Epoch: 36, Steps: 261 | Train Loss: 0.3248171 Vali Loss: 1.0137651 Test Loss: 0.4449546
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4185519516468048, mae:0.423845499753952, rse:0.6154061555862427
