Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='ETTm2_336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : ETTm2_336_720_PatchTSFL_ETTm2_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3364257
	speed: 0.0683s/iter; left time: 1774.6051s
	iters: 200, epoch: 1 | loss: 0.2620911
	speed: 0.0451s/iter; left time: 1167.3264s
Epoch: 1 cost time: 14.356303215026855
Epoch: 1, Steps: 261 | Train Loss: 0.3091598 Vali Loss: 0.2522346 Test Loss: 0.2015955
Validation loss decreased (inf --> 0.252235).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.2763977
	speed: 0.1868s/iter; left time: 4807.5187s
	iters: 200, epoch: 2 | loss: 0.2358123
	speed: 0.0551s/iter; left time: 1413.2772s
Epoch: 2 cost time: 17.05520248413086
Epoch: 2, Steps: 261 | Train Loss: 0.2856523 Vali Loss: 0.2479311 Test Loss: 0.1968952
Validation loss decreased (0.252235 --> 0.247931).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.2768979
	speed: 0.1852s/iter; left time: 4718.4725s
	iters: 200, epoch: 3 | loss: 0.2374067
	speed: 0.0531s/iter; left time: 1347.6374s
Epoch: 3 cost time: 15.96840763092041
Epoch: 3, Steps: 261 | Train Loss: 0.2793290 Vali Loss: 0.2433917 Test Loss: 0.1926901
Validation loss decreased (0.247931 --> 0.243392).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.2823707
	speed: 0.1814s/iter; left time: 4575.0072s
	iters: 200, epoch: 4 | loss: 0.2838539
	speed: 0.0504s/iter; left time: 1265.9687s
Epoch: 4 cost time: 15.46245265007019
Epoch: 4, Steps: 261 | Train Loss: 0.2714250 Vali Loss: 0.2356920 Test Loss: 0.1865153
Validation loss decreased (0.243392 --> 0.235692).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.2361371
	speed: 0.1861s/iter; left time: 4643.2682s
	iters: 200, epoch: 5 | loss: 0.2940981
	speed: 0.0503s/iter; left time: 1249.0671s
Epoch: 5 cost time: 15.654223918914795
Epoch: 5, Steps: 261 | Train Loss: 0.2570736 Vali Loss: 0.2299266 Test Loss: 0.1818517
Validation loss decreased (0.235692 --> 0.229927).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.2283210
	speed: 0.1806s/iter; left time: 4459.2441s
	iters: 200, epoch: 6 | loss: 0.2386295
	speed: 0.0485s/iter; left time: 1192.4062s
Epoch: 6 cost time: 15.011529684066772
Epoch: 6, Steps: 261 | Train Loss: 0.2441326 Vali Loss: 0.2286385 Test Loss: 0.1825247
Validation loss decreased (0.229927 --> 0.228638).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.1991662
	speed: 0.1769s/iter; left time: 4322.6584s
	iters: 200, epoch: 7 | loss: 0.2393759
	speed: 0.0504s/iter; left time: 1226.9727s
Epoch: 7 cost time: 15.4665687084198
Epoch: 7, Steps: 261 | Train Loss: 0.2370055 Vali Loss: 0.2274897 Test Loss: 0.1828478
Validation loss decreased (0.228638 --> 0.227490).  Saving model ...
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.2128909
	speed: 0.1822s/iter; left time: 4403.5225s
	iters: 200, epoch: 8 | loss: 0.1925115
	speed: 0.0493s/iter; left time: 1187.9755s
Epoch: 8 cost time: 15.318344116210938
Epoch: 8, Steps: 261 | Train Loss: 0.2306461 Vali Loss: 0.2281906 Test Loss: 0.1831594
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.1945124
	speed: 0.1821s/iter; left time: 4355.2290s
	iters: 200, epoch: 9 | loss: 0.1939353
	speed: 0.0495s/iter; left time: 1177.8279s
Epoch: 9 cost time: 15.477328538894653
Epoch: 9, Steps: 261 | Train Loss: 0.2253717 Vali Loss: 0.2267429 Test Loss: 0.1832468
Validation loss decreased (0.227490 --> 0.226743).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.2268040
	speed: 0.1788s/iter; left time: 4228.5360s
	iters: 200, epoch: 10 | loss: 0.1990128
	speed: 0.0459s/iter; left time: 1081.6547s
Epoch: 10 cost time: 14.996787548065186
Epoch: 10, Steps: 261 | Train Loss: 0.2209932 Vali Loss: 0.2293025 Test Loss: 0.1840755
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.1993632
	speed: 0.1785s/iter; left time: 4176.4602s
	iters: 200, epoch: 11 | loss: 0.1991233
	speed: 0.0512s/iter; left time: 1193.6335s
Epoch: 11 cost time: 15.435256242752075
Epoch: 11, Steps: 261 | Train Loss: 0.2179287 Vali Loss: 0.2266118 Test Loss: 0.1865829
Validation loss decreased (0.226743 --> 0.226612).  Saving model ...
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.2196002
	speed: 0.1823s/iter; left time: 4217.3058s
	iters: 200, epoch: 12 | loss: 0.2020654
	speed: 0.0498s/iter; left time: 1146.7636s
Epoch: 12 cost time: 15.529603242874146
Epoch: 12, Steps: 261 | Train Loss: 0.2149541 Vali Loss: 0.2257187 Test Loss: 0.1869863
Validation loss decreased (0.226612 --> 0.225719).  Saving model ...
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.2196541
	speed: 0.1819s/iter; left time: 4160.3819s
	iters: 200, epoch: 13 | loss: 0.1742966
	speed: 0.0500s/iter; left time: 1137.8406s
Epoch: 13 cost time: 15.178990602493286
Epoch: 13, Steps: 261 | Train Loss: 0.2121607 Vali Loss: 0.2234688 Test Loss: 0.1872459
Validation loss decreased (0.225719 --> 0.223469).  Saving model ...
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.1853342
	speed: 0.1825s/iter; left time: 4126.7964s
	iters: 200, epoch: 14 | loss: 0.2144246
	speed: 0.0456s/iter; left time: 1027.2218s
Epoch: 14 cost time: 14.807874202728271
Epoch: 14, Steps: 261 | Train Loss: 0.2105717 Vali Loss: 0.2266624 Test Loss: 0.1867118
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.2075581
	speed: 0.1691s/iter; left time: 3778.5619s
	iters: 200, epoch: 15 | loss: 0.2293214
	speed: 0.0452s/iter; left time: 1005.4676s
Epoch: 15 cost time: 14.296329021453857
Epoch: 15, Steps: 261 | Train Loss: 0.2082035 Vali Loss: 0.2270949 Test Loss: 0.1883280
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.2516558
	speed: 0.1791s/iter; left time: 3954.8317s
	iters: 200, epoch: 16 | loss: 0.1861562
	speed: 0.0450s/iter; left time: 989.5718s
Epoch: 16 cost time: 14.638636350631714
Epoch: 16, Steps: 261 | Train Loss: 0.2061243 Vali Loss: 0.2277749 Test Loss: 0.1896106
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.2078430
	speed: 0.1816s/iter; left time: 3962.9769s
	iters: 200, epoch: 17 | loss: 0.2014334
	speed: 0.0495s/iter; left time: 1074.4494s
Epoch: 17 cost time: 15.340260744094849
Epoch: 17, Steps: 261 | Train Loss: 0.2042346 Vali Loss: 0.2254811 Test Loss: 0.1902628
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.1944287
	speed: 0.1822s/iter; left time: 3929.6445s
	iters: 200, epoch: 18 | loss: 0.2031170
	speed: 0.0470s/iter; left time: 1008.3958s
Epoch: 18 cost time: 15.030719995498657
Epoch: 18, Steps: 261 | Train Loss: 0.2024869 Vali Loss: 0.2318325 Test Loss: 0.1909411
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.2048010
	speed: 0.1819s/iter; left time: 3875.4038s
	iters: 200, epoch: 19 | loss: 0.1927053
	speed: 0.0507s/iter; left time: 1074.7703s
Epoch: 19 cost time: 15.544541120529175
Epoch: 19, Steps: 261 | Train Loss: 0.1998699 Vali Loss: 0.2316269 Test Loss: 0.1916348
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.2050571
	speed: 0.1770s/iter; left time: 3724.2665s
	iters: 200, epoch: 20 | loss: 0.1601181
	speed: 0.0479s/iter; left time: 1002.1725s
Epoch: 20 cost time: 14.972497940063477
Epoch: 20, Steps: 261 | Train Loss: 0.1976027 Vali Loss: 0.2304442 Test Loss: 0.1920945
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.1966788
	speed: 0.1834s/iter; left time: 3810.3278s
	iters: 200, epoch: 21 | loss: 0.1829095
	speed: 0.0479s/iter; left time: 991.2322s
Epoch: 21 cost time: 15.28973937034607
Epoch: 21, Steps: 261 | Train Loss: 0.1948997 Vali Loss: 0.2338973 Test Loss: 0.1942532
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.1734970
	speed: 0.1773s/iter; left time: 3638.6232s
	iters: 200, epoch: 22 | loss: 0.1830328
	speed: 0.0485s/iter; left time: 990.3294s
Epoch: 22 cost time: 15.07422947883606
Epoch: 22, Steps: 261 | Train Loss: 0.1918814 Vali Loss: 0.2343184 Test Loss: 0.1957358
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.1882217
	speed: 0.1706s/iter; left time: 3457.0464s
	iters: 200, epoch: 23 | loss: 0.1696198
	speed: 0.0479s/iter; left time: 965.6269s
Epoch: 23 cost time: 15.082245349884033
Epoch: 23, Steps: 261 | Train Loss: 0.1893255 Vali Loss: 0.2402452 Test Loss: 0.1969347
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.1742147
	speed: 0.1694s/iter; left time: 3388.5341s
	iters: 200, epoch: 24 | loss: 0.2003812
	speed: 0.0494s/iter; left time: 983.4430s
Epoch: 24 cost time: 15.220657110214233
Epoch: 24, Steps: 261 | Train Loss: 0.1864483 Vali Loss: 0.2389292 Test Loss: 0.1973089
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.1746779
	speed: 0.1694s/iter; left time: 3343.6904s
	iters: 200, epoch: 25 | loss: 0.1616959
	speed: 0.0483s/iter; left time: 948.8416s
Epoch: 25 cost time: 15.030457019805908
Epoch: 25, Steps: 261 | Train Loss: 0.1837564 Vali Loss: 0.2401001 Test Loss: 0.1970403
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.1733693
	speed: 0.1691s/iter; left time: 3293.1675s
	iters: 200, epoch: 26 | loss: 0.1854350
	speed: 0.0482s/iter; left time: 934.1165s
Epoch: 26 cost time: 14.558432340621948
Epoch: 26, Steps: 261 | Train Loss: 0.1802439 Vali Loss: 0.2422172 Test Loss: 0.2042834
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.1588178
	speed: 0.1673s/iter; left time: 3214.6552s
	iters: 200, epoch: 27 | loss: 0.1918857
	speed: 0.0440s/iter; left time: 841.8089s
Epoch: 27 cost time: 14.2689528465271
Epoch: 27, Steps: 261 | Train Loss: 0.1770800 Vali Loss: 0.2430941 Test Loss: 0.2053524
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.1618605
	speed: 0.1620s/iter; left time: 3070.0425s
	iters: 200, epoch: 28 | loss: 0.1819385
	speed: 0.0471s/iter; left time: 888.3177s
Epoch: 28 cost time: 14.53865671157837
Epoch: 28, Steps: 261 | Train Loss: 0.1741854 Vali Loss: 0.2472654 Test Loss: 0.2100815
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.1551721
	speed: 0.1660s/iter; left time: 3102.9394s
	iters: 200, epoch: 29 | loss: 0.1884442
	speed: 0.0479s/iter; left time: 891.4020s
Epoch: 29 cost time: 14.646586894989014
Epoch: 29, Steps: 261 | Train Loss: 0.1712056 Vali Loss: 0.2498595 Test Loss: 0.2141549
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.318146929322795e-05
	iters: 100, epoch: 30 | loss: 0.1849120
	speed: 0.1666s/iter; left time: 3071.4442s
	iters: 200, epoch: 30 | loss: 0.1687199
	speed: 0.0466s/iter; left time: 854.1674s
Epoch: 30 cost time: 14.545652151107788
Epoch: 30, Steps: 261 | Train Loss: 0.1685173 Vali Loss: 0.2583211 Test Loss: 0.2100756
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.59487855091154e-05
	iters: 100, epoch: 31 | loss: 0.1798071
	speed: 0.1672s/iter; left time: 3037.4536s
	iters: 200, epoch: 31 | loss: 0.1636243
	speed: 0.0465s/iter; left time: 840.1174s
Epoch: 31 cost time: 14.350049257278442
Epoch: 31, Steps: 261 | Train Loss: 0.1656580 Vali Loss: 0.2543951 Test Loss: 0.2147349
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.850675609123214e-05
	iters: 100, epoch: 32 | loss: 0.1636013
	speed: 0.1671s/iter; left time: 2993.4689s
	iters: 200, epoch: 32 | loss: 0.1704369
	speed: 0.0483s/iter; left time: 860.0683s
Epoch: 32 cost time: 14.920689821243286
Epoch: 32, Steps: 261 | Train Loss: 0.1628023 Vali Loss: 0.2606578 Test Loss: 0.2245033
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.083960728023302e-05
	iters: 100, epoch: 33 | loss: 0.1510675
	speed: 0.1667s/iter; left time: 2942.1228s
	iters: 200, epoch: 33 | loss: 0.1496727
	speed: 0.0440s/iter; left time: 771.7223s
Epoch: 33 cost time: 13.919617891311646
Epoch: 33, Steps: 261 | Train Loss: 0.1605286 Vali Loss: 0.2666940 Test Loss: 0.2223141
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_336_720_PatchTSFL_ETTm2_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.18724583089351654, mae:0.3373695909976959, rse:0.7136190533638
