Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='weather_336_1440', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_1440_PatchTST_custom_ftM_sl336_ll48_pl1440_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35112
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 0.8507562
	speed: 0.1340s/iter; left time: 3657.2394s
	iters: 200, epoch: 1 | loss: 1.0358434
	speed: 0.1147s/iter; left time: 3118.8128s
Epoch: 1 cost time: 33.47417211532593
Epoch: 1, Steps: 274 | Train Loss: 0.9362597 Vali Loss: 0.8329908 Test Loss: 0.4129786
Validation loss decreased (inf --> 0.832991).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7076169
	speed: 0.3254s/iter; left time: 8795.8024s
	iters: 200, epoch: 2 | loss: 0.6557733
	speed: 0.1145s/iter; left time: 3082.8237s
Epoch: 2 cost time: 33.85891389846802
Epoch: 2, Steps: 274 | Train Loss: 0.7156533 Vali Loss: 0.7477811 Test Loss: 0.3844420
Validation loss decreased (0.832991 --> 0.747781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5851445
	speed: 0.3229s/iter; left time: 8637.7639s
	iters: 200, epoch: 3 | loss: 0.7204040
	speed: 0.1149s/iter; left time: 3062.0175s
Epoch: 3 cost time: 33.85050106048584
Epoch: 3, Steps: 274 | Train Loss: 0.6886190 Vali Loss: 0.7403882 Test Loss: 0.3820184
Validation loss decreased (0.747781 --> 0.740388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7387742
	speed: 0.3243s/iter; left time: 8587.2421s
	iters: 200, epoch: 4 | loss: 0.6509674
	speed: 0.1149s/iter; left time: 3031.6889s
Epoch: 4 cost time: 33.82141304016113
Epoch: 4, Steps: 274 | Train Loss: 0.6822503 Vali Loss: 0.7312369 Test Loss: 0.3802162
Validation loss decreased (0.740388 --> 0.731237).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6494632
	speed: 0.3273s/iter; left time: 8576.5689s
	iters: 200, epoch: 5 | loss: 0.6223407
	speed: 0.1148s/iter; left time: 2997.1381s
Epoch: 5 cost time: 33.67365050315857
Epoch: 5, Steps: 274 | Train Loss: 0.6760192 Vali Loss: 0.7356442 Test Loss: 0.3785737
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6361474
	speed: 0.3243s/iter; left time: 8409.5533s
	iters: 200, epoch: 6 | loss: 0.6344590
	speed: 0.1148s/iter; left time: 2964.9442s
Epoch: 6 cost time: 33.6562557220459
Epoch: 6, Steps: 274 | Train Loss: 0.6726550 Vali Loss: 0.7381103 Test Loss: 0.3784093
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6378055
	speed: 0.3281s/iter; left time: 8417.6383s
	iters: 200, epoch: 7 | loss: 0.7271401
	speed: 0.1150s/iter; left time: 2939.3241s
Epoch: 7 cost time: 33.83033895492554
Epoch: 7, Steps: 274 | Train Loss: 0.6704685 Vali Loss: 0.7320958 Test Loss: 0.3776879
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6492530
	speed: 0.3245s/iter; left time: 8236.5200s
	iters: 200, epoch: 8 | loss: 0.6914022
	speed: 0.1150s/iter; left time: 2908.4338s
Epoch: 8 cost time: 33.71846055984497
Epoch: 8, Steps: 274 | Train Loss: 0.6688169 Vali Loss: 0.7315304 Test Loss: 0.3767723
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6467679
	speed: 0.3245s/iter; left time: 8146.7629s
	iters: 200, epoch: 9 | loss: 0.6989156
	speed: 0.1149s/iter; left time: 2873.9222s
Epoch: 9 cost time: 33.86429142951965
Epoch: 9, Steps: 274 | Train Loss: 0.6668953 Vali Loss: 0.7300587 Test Loss: 0.3755402
Validation loss decreased (0.731237 --> 0.730059).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5954139
	speed: 0.3259s/iter; left time: 8094.7268s
	iters: 200, epoch: 10 | loss: 0.6894439
	speed: 0.1149s/iter; left time: 2841.5511s
Epoch: 10 cost time: 33.74596619606018
Epoch: 10, Steps: 274 | Train Loss: 0.6655080 Vali Loss: 0.7326125 Test Loss: 0.3764352
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6053503
	speed: 0.3267s/iter; left time: 8023.7679s
	iters: 200, epoch: 11 | loss: 0.6551693
	speed: 0.1150s/iter; left time: 2812.7590s
Epoch: 11 cost time: 33.9735221862793
Epoch: 11, Steps: 274 | Train Loss: 0.6639111 Vali Loss: 0.7303888 Test Loss: 0.3760954
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6732419
	speed: 0.3229s/iter; left time: 7843.1980s
	iters: 200, epoch: 12 | loss: 0.7364581
	speed: 0.1149s/iter; left time: 2778.8387s
Epoch: 12 cost time: 33.65979766845703
Epoch: 12, Steps: 274 | Train Loss: 0.6627193 Vali Loss: 0.7319852 Test Loss: 0.3763476
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5807161
	speed: 0.3228s/iter; left time: 7750.4212s
	iters: 200, epoch: 13 | loss: 0.6490741
	speed: 0.1149s/iter; left time: 2747.1615s
Epoch: 13 cost time: 33.6684033870697
Epoch: 13, Steps: 274 | Train Loss: 0.6613162 Vali Loss: 0.7291494 Test Loss: 0.3758462
Validation loss decreased (0.730059 --> 0.729149).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6724973
	speed: 0.3264s/iter; left time: 7749.0164s
	iters: 200, epoch: 14 | loss: 0.5999051
	speed: 0.1150s/iter; left time: 2718.2040s
Epoch: 14 cost time: 33.7942419052124
Epoch: 14, Steps: 274 | Train Loss: 0.6603157 Vali Loss: 0.7288989 Test Loss: 0.3770505
Validation loss decreased (0.729149 --> 0.728899).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6698024
	speed: 0.3259s/iter; left time: 7646.7866s
	iters: 200, epoch: 15 | loss: 0.6337075
	speed: 0.1149s/iter; left time: 2684.4204s
Epoch: 15 cost time: 33.78907012939453
