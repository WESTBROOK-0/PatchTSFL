Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6918609
	speed: 0.1380s/iter; left time: 3906.4858s
	iters: 200, epoch: 1 | loss: 0.7055328
	speed: 0.1255s/iter; left time: 3538.5434s
Epoch: 1 cost time: 37.050347328186035
Epoch: 1, Steps: 284 | Train Loss: 0.7448597 Vali Loss: 0.5405214 Test Loss: 0.2209346
Validation loss decreased (inf --> 0.540521).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3490998
	speed: 0.3346s/iter; left time: 9373.5963s
	iters: 200, epoch: 2 | loss: 0.4066018
	speed: 0.1266s/iter; left time: 3533.1597s
Epoch: 2 cost time: 37.424161195755005
Epoch: 2, Steps: 284 | Train Loss: 0.4887820 Vali Loss: 0.4168344 Test Loss: 0.1691396
Validation loss decreased (0.540521 --> 0.416834).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4488151
	speed: 0.3491s/iter; left time: 9681.0153s
	iters: 200, epoch: 3 | loss: 0.4204177
	speed: 0.1271s/iter; left time: 3512.0019s
Epoch: 3 cost time: 38.03453731536865
Epoch: 3, Steps: 284 | Train Loss: 0.4474323 Vali Loss: 0.4050395 Test Loss: 0.1621971
Validation loss decreased (0.416834 --> 0.405040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3624397
	speed: 0.3461s/iter; left time: 9500.0994s
	iters: 200, epoch: 4 | loss: 0.6338027
	speed: 0.1272s/iter; left time: 3478.1014s
Epoch: 4 cost time: 37.90529465675354
Epoch: 4, Steps: 284 | Train Loss: 0.4403404 Vali Loss: 0.3949177 Test Loss: 0.1591706
Validation loss decreased (0.405040 --> 0.394918).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3679921
	speed: 0.3519s/iter; left time: 9560.5792s
	iters: 200, epoch: 5 | loss: 0.8098240
	speed: 0.1269s/iter; left time: 3433.7256s
Epoch: 5 cost time: 38.1285080909729
Epoch: 5, Steps: 284 | Train Loss: 0.4353439 Vali Loss: 0.3966824 Test Loss: 0.1581619
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3595654
	speed: 0.3526s/iter; left time: 9477.0293s
	iters: 200, epoch: 6 | loss: 0.4234348
	speed: 0.1267s/iter; left time: 3393.9702s
Epoch: 6 cost time: 37.91035532951355
Epoch: 6, Steps: 284 | Train Loss: 0.4321266 Vali Loss: 0.3939536 Test Loss: 0.1557138
Validation loss decreased (0.394918 --> 0.393954).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5594563
	speed: 0.3466s/iter; left time: 9217.2541s
	iters: 200, epoch: 7 | loss: 0.3125072
	speed: 0.1267s/iter; left time: 3357.1050s
Epoch: 7 cost time: 37.92115783691406
Epoch: 7, Steps: 284 | Train Loss: 0.4292396 Vali Loss: 0.3931718 Test Loss: 0.1556703
Validation loss decreased (0.393954 --> 0.393172).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3646784
	speed: 0.3482s/iter; left time: 9163.1825s
	iters: 200, epoch: 8 | loss: 0.5478253
	speed: 0.1267s/iter; left time: 3321.8842s
Epoch: 8 cost time: 37.842146158218384
Epoch: 8, Steps: 284 | Train Loss: 0.4268212 Vali Loss: 0.3953379 Test Loss: 0.1538979
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6076418
	speed: 0.3453s/iter; left time: 8988.5201s
	iters: 200, epoch: 9 | loss: 0.3075468
	speed: 0.1267s/iter; left time: 3284.2402s
Epoch: 9 cost time: 37.90095567703247
Epoch: 9, Steps: 284 | Train Loss: 0.4247582 Vali Loss: 0.3981636 Test Loss: 0.1552712
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3997220
	speed: 0.3483s/iter; left time: 8967.0063s
	iters: 200, epoch: 10 | loss: 0.3117632
	speed: 0.1268s/iter; left time: 3252.1620s
Epoch: 10 cost time: 37.85743284225464
Epoch: 10, Steps: 284 | Train Loss: 0.4235764 Vali Loss: 0.3965216 Test Loss: 0.1533468
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3045481
	speed: 0.3480s/iter; left time: 8860.9515s
	iters: 200, epoch: 11 | loss: 0.5219319
	speed: 0.1269s/iter; left time: 3217.9439s
Epoch: 11 cost time: 37.842501163482666
Epoch: 11, Steps: 284 | Train Loss: 0.4218917 Vali Loss: 0.3955293 Test Loss: 0.1537023
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7236733
	speed: 0.3481s/iter; left time: 8763.3689s
	iters: 200, epoch: 12 | loss: 0.4113908
	speed: 0.1267s/iter; left time: 3177.6404s
Epoch: 12 cost time: 37.719815254211426
Epoch: 12, Steps: 284 | Train Loss: 0.4209478 Vali Loss: 0.3980744 Test Loss: 0.1522071
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6140998
	speed: 0.3515s/iter; left time: 8751.0407s
	iters: 200, epoch: 13 | loss: 0.3221866
	speed: 0.1270s/iter; left time: 3148.6035s
Epoch: 13 cost time: 38.06269955635071
Epoch: 13, Steps: 284 | Train Loss: 0.4189045 Vali Loss: 0.3957025 Test Loss: 0.1525479
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2983325
	speed: 0.3501s/iter; left time: 8616.2949s
	iters: 200, epoch: 14 | loss: 0.3087248
	speed: 0.1270s/iter; left time: 3112.8916s
Epoch: 14 cost time: 38.08296847343445
Epoch: 14, Steps: 284 | Train Loss: 0.4173852 Vali Loss: 0.3977544 Test Loss: 0.1529894
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4901558
	speed: 0.3520s/iter; left time: 8562.4673s
	iters: 200, epoch: 15 | loss: 0.4135692
	speed: 0.1269s/iter; left time: 3073.6187s
Epoch: 15 cost time: 38.04341387748718
Epoch: 15, Steps: 284 | Train Loss: 0.4173156 Vali Loss: 0.3972756 Test Loss: 0.1513517
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3198128
	speed: 0.3492s/iter; left time: 8395.6803s
	iters: 200, epoch: 16 | loss: 0.6277199
	speed: 0.1271s/iter; left time: 3042.0288s
Epoch: 16 cost time: 38.04579210281372
Epoch: 16, Steps: 284 | Train Loss: 0.4157743 Vali Loss: 0.3979424 Test Loss: 0.1522038
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2867792
	speed: 0.3506s/iter; left time: 8328.0670s
	iters: 200, epoch: 17 | loss: 0.5833289
	speed: 0.1268s/iter; left time: 2998.9693s
Epoch: 17 cost time: 37.9031925201416
Epoch: 17, Steps: 284 | Train Loss: 0.4155316 Vali Loss: 0.3978374 Test Loss: 0.1515323
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3150008
	speed: 0.3522s/iter; left time: 8267.6386s
	iters: 200, epoch: 18 | loss: 0.6300306
	speed: 0.1267s/iter; left time: 2962.1819s
Epoch: 18 cost time: 38.02495813369751
Epoch: 18, Steps: 284 | Train Loss: 0.4137134 Vali Loss: 0.3933438 Test Loss: 0.1516889
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4828119
	speed: 0.3499s/iter; left time: 8114.2893s
	iters: 200, epoch: 19 | loss: 0.5163468
	speed: 0.1271s/iter; left time: 2934.8306s
Epoch: 19 cost time: 37.872209548950195
Epoch: 19, Steps: 284 | Train Loss: 0.4134003 Vali Loss: 0.3965195 Test Loss: 0.1511528
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3108933
	speed: 0.3544s/iter; left time: 8117.1238s
	iters: 200, epoch: 20 | loss: 0.3066148
	speed: 0.1268s/iter; left time: 2892.7484s
Epoch: 20 cost time: 38.15416765213013
Epoch: 20, Steps: 284 | Train Loss: 0.4123620 Vali Loss: 0.3949808 Test Loss: 0.1504745
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.8338960
	speed: 0.3502s/iter; left time: 7922.2685s
	iters: 200, epoch: 21 | loss: 0.2976668
	speed: 0.1268s/iter; left time: 2856.7815s
Epoch: 21 cost time: 37.96625113487244
Epoch: 21, Steps: 284 | Train Loss: 0.4126209 Vali Loss: 0.3982293 Test Loss: 0.1507986
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.3232448
	speed: 0.3502s/iter; left time: 7821.7898s
	iters: 200, epoch: 22 | loss: 0.3011703
	speed: 0.1271s/iter; left time: 2825.4285s
Epoch: 22 cost time: 37.87676024436951
Epoch: 22, Steps: 284 | Train Loss: 0.4114207 Vali Loss: 0.3955862 Test Loss: 0.1509432
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.3709686
	speed: 0.3508s/iter; left time: 7736.2507s
	iters: 200, epoch: 23 | loss: 0.3323726
	speed: 0.1268s/iter; left time: 2784.7334s
Epoch: 23 cost time: 37.783732175827026
Epoch: 23, Steps: 284 | Train Loss: 0.4117186 Vali Loss: 0.3971962 Test Loss: 0.1510064
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5883529
	speed: 0.3521s/iter; left time: 7665.7337s
	iters: 200, epoch: 24 | loss: 0.5561069
	speed: 0.1268s/iter; left time: 2748.4055s
Epoch: 24 cost time: 37.94103717803955
Epoch: 24, Steps: 284 | Train Loss: 0.4109892 Vali Loss: 0.3937407 Test Loss: 0.1507995
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.3813097
	speed: 0.3491s/iter; left time: 7500.7481s
	iters: 200, epoch: 25 | loss: 0.5046142
	speed: 0.1270s/iter; left time: 2715.0633s
Epoch: 25 cost time: 37.96870398521423
Epoch: 25, Steps: 284 | Train Loss: 0.4109126 Vali Loss: 0.3952213 Test Loss: 0.1513068
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.2706562
	speed: 0.3534s/iter; left time: 7493.3330s
	iters: 200, epoch: 26 | loss: 0.4917949
	speed: 0.1270s/iter; left time: 2679.1992s
Epoch: 26 cost time: 38.17012619972229
Epoch: 26, Steps: 284 | Train Loss: 0.4096411 Vali Loss: 0.3954517 Test Loss: 0.1505764
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.3330168
	speed: 0.3520s/iter; left time: 7363.2480s
	iters: 200, epoch: 27 | loss: 0.5437619
	speed: 0.1271s/iter; left time: 2646.4032s
Epoch: 27 cost time: 38.057955741882324
Epoch: 27, Steps: 284 | Train Loss: 0.4105766 Vali Loss: 0.3938097 Test Loss: 0.1506961
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.15567035973072052, mae:0.20489397644996643, rse:0.5197721719741821
