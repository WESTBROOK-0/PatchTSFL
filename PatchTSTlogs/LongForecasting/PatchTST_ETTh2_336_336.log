Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=4, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Epoch: 1 cost time: 1.9308912754058838
Epoch: 1, Steps: 62 | Train Loss: 0.8134517 Vali Loss: 0.5027722 Test Loss: 0.3920398
Validation loss decreased (inf --> 0.502772).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.8202250003814697
Epoch: 2, Steps: 62 | Train Loss: 0.7464948 Vali Loss: 0.4145272 Test Loss: 0.3574173
Validation loss decreased (0.502772 --> 0.414527).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.8103582859039307
Epoch: 3, Steps: 62 | Train Loss: 0.6839136 Vali Loss: 0.3932317 Test Loss: 0.3448719
Validation loss decreased (0.414527 --> 0.393232).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.7478458881378174
Epoch: 4, Steps: 62 | Train Loss: 0.6560115 Vali Loss: 0.3814797 Test Loss: 0.3378746
Validation loss decreased (0.393232 --> 0.381480).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.8059139251708984
Epoch: 5, Steps: 62 | Train Loss: 0.6429088 Vali Loss: 0.3761605 Test Loss: 0.3347048
Validation loss decreased (0.381480 --> 0.376160).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.788012981414795
Epoch: 6, Steps: 62 | Train Loss: 0.6317744 Vali Loss: 0.3696228 Test Loss: 0.3329602
Validation loss decreased (0.376160 --> 0.369623).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 1.768052577972412
Epoch: 7, Steps: 62 | Train Loss: 0.6270099 Vali Loss: 0.3694112 Test Loss: 0.3314489
Validation loss decreased (0.369623 --> 0.369411).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.801185131072998
Epoch: 8, Steps: 62 | Train Loss: 0.6222441 Vali Loss: 0.3665555 Test Loss: 0.3290017
Validation loss decreased (0.369411 --> 0.366555).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.115983247756958
Epoch: 9, Steps: 62 | Train Loss: 0.6168595 Vali Loss: 0.3678012 Test Loss: 0.3288451
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.9580788612365723
Epoch: 10, Steps: 62 | Train Loss: 0.6127482 Vali Loss: 0.3667316 Test Loss: 0.3277582
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.7596802711486816
Epoch: 11, Steps: 62 | Train Loss: 0.6100177 Vali Loss: 0.3681211 Test Loss: 0.3271537
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.8013596534729004
Epoch: 12, Steps: 62 | Train Loss: 0.6070986 Vali Loss: 0.3684007 Test Loss: 0.3265600
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 1.7796833515167236
Epoch: 13, Steps: 62 | Train Loss: 0.6047651 Vali Loss: 0.3663611 Test Loss: 0.3267008
Validation loss decreased (0.366555 --> 0.366361).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 1.7575082778930664
Epoch: 14, Steps: 62 | Train Loss: 0.6018415 Vali Loss: 0.3662096 Test Loss: 0.3267911
Validation loss decreased (0.366361 --> 0.366210).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 1.7975413799285889
Epoch: 15, Steps: 62 | Train Loss: 0.5994291 Vali Loss: 0.3684808 Test Loss: 0.3271595
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 1.8938868045806885
Epoch: 16, Steps: 62 | Train Loss: 0.5974774 Vali Loss: 0.3684447 Test Loss: 0.3273996
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.891240119934082
Epoch: 17, Steps: 62 | Train Loss: 0.5984578 Vali Loss: 0.3706285 Test Loss: 0.3270974
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 1.870546579360962
Epoch: 18, Steps: 62 | Train Loss: 0.5949884 Vali Loss: 0.3675801 Test Loss: 0.3281244
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 1.830094337463379
Epoch: 19, Steps: 62 | Train Loss: 0.5947924 Vali Loss: 0.3678979 Test Loss: 0.3282028
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 1.899146556854248
Epoch: 20, Steps: 62 | Train Loss: 0.5949586 Vali Loss: 0.3661225 Test Loss: 0.3283335
Validation loss decreased (0.366210 --> 0.366122).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 1.8249852657318115
Epoch: 21, Steps: 62 | Train Loss: 0.5916682 Vali Loss: 0.3678670 Test Loss: 0.3287152
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.0084402561187744
Epoch: 22, Steps: 62 | Train Loss: 0.5916368 Vali Loss: 0.3642505 Test Loss: 0.3287826
Validation loss decreased (0.366122 --> 0.364251).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 1.9506580829620361
Epoch: 23, Steps: 62 | Train Loss: 0.5918465 Vali Loss: 0.3636910 Test Loss: 0.3291762
Validation loss decreased (0.364251 --> 0.363691).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.028188705444336
Epoch: 24, Steps: 62 | Train Loss: 0.5915701 Vali Loss: 0.3660984 Test Loss: 0.3293272
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 1.804107904434204
Epoch: 25, Steps: 62 | Train Loss: 0.5898466 Vali Loss: 0.3661869 Test Loss: 0.3292898
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 1.8626337051391602
Epoch: 26, Steps: 62 | Train Loss: 0.5903613 Vali Loss: 0.3653782 Test Loss: 0.3295671
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.9213955402374268
Epoch: 27, Steps: 62 | Train Loss: 0.5906679 Vali Loss: 0.3656026 Test Loss: 0.3295130
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 2.112109661102295
Epoch: 28, Steps: 62 | Train Loss: 0.5909308 Vali Loss: 0.3658402 Test Loss: 0.3297202
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 1.9782702922821045
Epoch: 29, Steps: 62 | Train Loss: 0.5893984 Vali Loss: 0.3658076 Test Loss: 0.3297926
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 1.9547069072723389
Epoch: 30, Steps: 62 | Train Loss: 0.5899346 Vali Loss: 0.3648721 Test Loss: 0.3299805
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 1.9318926334381104
Epoch: 31, Steps: 62 | Train Loss: 0.5892573 Vali Loss: 0.3638383 Test Loss: 0.3301059
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.8159873485565186
Epoch: 32, Steps: 62 | Train Loss: 0.5888970 Vali Loss: 0.3642776 Test Loss: 0.3299060
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 2.1045889854431152
Epoch: 33, Steps: 62 | Train Loss: 0.5888009 Vali Loss: 0.3647837 Test Loss: 0.3302561
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 1.819706916809082
Epoch: 34, Steps: 62 | Train Loss: 0.5890007 Vali Loss: 0.3627796 Test Loss: 0.3301237
Validation loss decreased (0.363691 --> 0.362780).  Saving model ...
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 2.026742458343506
Epoch: 35, Steps: 62 | Train Loss: 0.5889179 Vali Loss: 0.3658580 Test Loss: 0.3302328
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 1.8443310260772705
Epoch: 36, Steps: 62 | Train Loss: 0.5880019 Vali Loss: 0.3652029 Test Loss: 0.3303175
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 1.802253007888794
Epoch: 37, Steps: 62 | Train Loss: 0.5889281 Vali Loss: 0.3647958 Test Loss: 0.3304487
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 1.874037265777588
Epoch: 38, Steps: 62 | Train Loss: 0.5881326 Vali Loss: 0.3652792 Test Loss: 0.3303429
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 1.9613745212554932
Epoch: 39, Steps: 62 | Train Loss: 0.5892337 Vali Loss: 0.3662452 Test Loss: 0.3302700
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 1.7794620990753174
Epoch: 40, Steps: 62 | Train Loss: 0.5885598 Vali Loss: 0.3662840 Test Loss: 0.3305148
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 1.9329841136932373
Epoch: 41, Steps: 62 | Train Loss: 0.5873779 Vali Loss: 0.3668537 Test Loss: 0.3305345
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 1.8384385108947754
Epoch: 42, Steps: 62 | Train Loss: 0.5871742 Vali Loss: 0.3663145 Test Loss: 0.3305952
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 1.9942550659179688
Epoch: 43, Steps: 62 | Train Loss: 0.5880340 Vali Loss: 0.3648627 Test Loss: 0.3306019
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 1.838433027267456
Epoch: 44, Steps: 62 | Train Loss: 0.5880758 Vali Loss: 0.3652087 Test Loss: 0.3306184
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 1.942178726196289
Epoch: 45, Steps: 62 | Train Loss: 0.5896386 Vali Loss: 0.3659230 Test Loss: 0.3307702
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.9437899589538574
Epoch: 46, Steps: 62 | Train Loss: 0.5888899 Vali Loss: 0.3631474 Test Loss: 0.3306336
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 1.8892393112182617
Epoch: 47, Steps: 62 | Train Loss: 0.5887813 Vali Loss: 0.3622333 Test Loss: 0.3307316
Validation loss decreased (0.362780 --> 0.362233).  Saving model ...
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 1.8363361358642578
Epoch: 48, Steps: 62 | Train Loss: 0.5878416 Vali Loss: 0.3647417 Test Loss: 0.3303370
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 1.8085427284240723
Epoch: 49, Steps: 62 | Train Loss: 0.5878655 Vali Loss: 0.3671122 Test Loss: 0.3305970
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 1.886335849761963
Epoch: 50, Steps: 62 | Train Loss: 0.5882191 Vali Loss: 0.3632711 Test Loss: 0.3305101
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 1.9485349655151367
Epoch: 51, Steps: 62 | Train Loss: 0.5867823 Vali Loss: 0.3653266 Test Loss: 0.3308498
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 1.8541128635406494
Epoch: 52, Steps: 62 | Train Loss: 0.5882788 Vali Loss: 0.3646698 Test Loss: 0.3307267
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 1.985539436340332
Epoch: 53, Steps: 62 | Train Loss: 0.5875686 Vali Loss: 0.3638482 Test Loss: 0.3308828
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.048391580581665
Epoch: 54, Steps: 62 | Train Loss: 0.5872482 Vali Loss: 0.3648110 Test Loss: 0.3306512
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 1.804441213607788
Epoch: 55, Steps: 62 | Train Loss: 0.5866231 Vali Loss: 0.3661662 Test Loss: 0.3307419
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 2.127735137939453
Epoch: 56, Steps: 62 | Train Loss: 0.5870761 Vali Loss: 0.3648348 Test Loss: 0.3308423
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 2.0369083881378174
Epoch: 57, Steps: 62 | Train Loss: 0.5874342 Vali Loss: 0.3614206 Test Loss: 0.3308314
Validation loss decreased (0.362233 --> 0.361421).  Saving model ...
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 1.788576364517212
Epoch: 58, Steps: 62 | Train Loss: 0.5866142 Vali Loss: 0.3632056 Test Loss: 0.3308724
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 2.0712525844573975
Epoch: 59, Steps: 62 | Train Loss: 0.5882951 Vali Loss: 0.3651437 Test Loss: 0.3309173
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 1.8116984367370605
Epoch: 60, Steps: 62 | Train Loss: 0.5882852 Vali Loss: 0.3628125 Test Loss: 0.3307155
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 1.8705615997314453
Epoch: 61, Steps: 62 | Train Loss: 0.5879755 Vali Loss: 0.3659670 Test Loss: 0.3306408
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 1.7583527565002441
Epoch: 62, Steps: 62 | Train Loss: 0.5874745 Vali Loss: 0.3652006 Test Loss: 0.3310437
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 1.89021897315979
Epoch: 63, Steps: 62 | Train Loss: 0.5872717 Vali Loss: 0.3626330 Test Loss: 0.3307700
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 1.7820355892181396
Epoch: 64, Steps: 62 | Train Loss: 0.5868858 Vali Loss: 0.3635601 Test Loss: 0.3305387
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 1.808504343032837
Epoch: 65, Steps: 62 | Train Loss: 0.5879383 Vali Loss: 0.3648058 Test Loss: 0.3307382
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 1.9254112243652344
Epoch: 66, Steps: 62 | Train Loss: 0.5880282 Vali Loss: 0.3654495 Test Loss: 0.3305480
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 1.8425884246826172
Epoch: 67, Steps: 62 | Train Loss: 0.5875276 Vali Loss: 0.3650769 Test Loss: 0.3308917
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 2.044792652130127
Epoch: 68, Steps: 62 | Train Loss: 0.5875488 Vali Loss: 0.3646339 Test Loss: 0.3308621
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 1.8899474143981934
Epoch: 69, Steps: 62 | Train Loss: 0.5884675 Vali Loss: 0.3671652 Test Loss: 0.3305651
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 1.7985148429870605
Epoch: 70, Steps: 62 | Train Loss: 0.5880807 Vali Loss: 0.3650796 Test Loss: 0.3307912
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 1.9072535037994385
Epoch: 71, Steps: 62 | Train Loss: 0.5878729 Vali Loss: 0.3638951 Test Loss: 0.3309137
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 1.896050214767456
Epoch: 72, Steps: 62 | Train Loss: 0.5873877 Vali Loss: 0.3645690 Test Loss: 0.3307935
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 1.7833893299102783
Epoch: 73, Steps: 62 | Train Loss: 0.5881980 Vali Loss: 0.3657920 Test Loss: 0.3307996
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 1.8855955600738525
Epoch: 74, Steps: 62 | Train Loss: 0.5881652 Vali Loss: 0.3633217 Test Loss: 0.3309297
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 1.9703257083892822
Epoch: 75, Steps: 62 | Train Loss: 0.5871426 Vali Loss: 0.3648466 Test Loss: 0.3306938
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 1.8275582790374756
Epoch: 76, Steps: 62 | Train Loss: 0.5881808 Vali Loss: 0.3641430 Test Loss: 0.3309398
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 2.051668882369995
Epoch: 77, Steps: 62 | Train Loss: 0.5866061 Vali Loss: 0.3634302 Test Loss: 0.3307526
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 1.8152785301208496
Epoch: 78, Steps: 62 | Train Loss: 0.5878297 Vali Loss: 0.3657327 Test Loss: 0.3307981
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 1.8727695941925049
Epoch: 79, Steps: 62 | Train Loss: 0.5880051 Vali Loss: 0.3641873 Test Loss: 0.3307204
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 1.9311797618865967
Epoch: 80, Steps: 62 | Train Loss: 0.5876400 Vali Loss: 0.3637836 Test Loss: 0.3307982
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 1.9029488563537598
Epoch: 81, Steps: 62 | Train Loss: 0.5868039 Vali Loss: 0.3648448 Test Loss: 0.3308529
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 1.8492920398712158
Epoch: 82, Steps: 62 | Train Loss: 0.5873465 Vali Loss: 0.3647997 Test Loss: 0.3308661
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 1.797760009765625
Epoch: 83, Steps: 62 | Train Loss: 0.5873871 Vali Loss: 0.3653184 Test Loss: 0.3308430
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 1.8282275199890137
Epoch: 84, Steps: 62 | Train Loss: 0.5875064 Vali Loss: 0.3640226 Test Loss: 0.3308014
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 1.7667872905731201
Epoch: 85, Steps: 62 | Train Loss: 0.5870005 Vali Loss: 0.3643465 Test Loss: 0.3308781
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 1.8629918098449707
Epoch: 86, Steps: 62 | Train Loss: 0.5885112 Vali Loss: 0.3636050 Test Loss: 0.3309254
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 1.7590446472167969
Epoch: 87, Steps: 62 | Train Loss: 0.5868725 Vali Loss: 0.3650199 Test Loss: 0.3308814
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 1.8620686531066895
Epoch: 88, Steps: 62 | Train Loss: 0.5886913 Vali Loss: 0.3655664 Test Loss: 0.3309708
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 1.9044711589813232
Epoch: 89, Steps: 62 | Train Loss: 0.5884455 Vali Loss: 0.3611568 Test Loss: 0.3309236
Validation loss decreased (0.361421 --> 0.361157).  Saving model ...
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 1.8340058326721191
Epoch: 90, Steps: 62 | Train Loss: 0.5876687 Vali Loss: 0.3629412 Test Loss: 0.3309866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 1.9621860980987549
Epoch: 91, Steps: 62 | Train Loss: 0.5884473 Vali Loss: 0.3657545 Test Loss: 0.3308004
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 1.857248306274414
Epoch: 92, Steps: 62 | Train Loss: 0.5888081 Vali Loss: 0.3641844 Test Loss: 0.3308624
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 1.9472520351409912
Epoch: 93, Steps: 62 | Train Loss: 0.5882816 Vali Loss: 0.3636986 Test Loss: 0.3308538
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 1.852062702178955
Epoch: 94, Steps: 62 | Train Loss: 0.5864270 Vali Loss: 0.3651361 Test Loss: 0.3307987
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 1.7591395378112793
Epoch: 95, Steps: 62 | Train Loss: 0.5856967 Vali Loss: 0.3647622 Test Loss: 0.3305901
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 1.9004275798797607
Epoch: 96, Steps: 62 | Train Loss: 0.5864831 Vali Loss: 0.3654459 Test Loss: 0.3308543
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 2.0984549522399902
Epoch: 97, Steps: 62 | Train Loss: 0.5883467 Vali Loss: 0.3662249 Test Loss: 0.3305407
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 1.830808162689209
Epoch: 98, Steps: 62 | Train Loss: 0.5876488 Vali Loss: 0.3623194 Test Loss: 0.3309504
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 1.785276174545288
Epoch: 99, Steps: 62 | Train Loss: 0.5889312 Vali Loss: 0.3664879 Test Loss: 0.3308105
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 1.870915412902832
Epoch: 100, Steps: 62 | Train Loss: 0.5880904 Vali Loss: 0.3655591 Test Loss: 0.3309353
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.33092355728149414, mae:0.3805953562259674, rse:0.4595695436000824
