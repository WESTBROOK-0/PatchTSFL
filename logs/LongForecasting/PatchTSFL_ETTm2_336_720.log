Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
>>>>>>>start training : 336_720_PatchTSFL_ETTm2_ftM_sl336_ll48_pl720_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5290195
	speed: 0.0936s/iter; left time: 2433.9327s
	iters: 200, epoch: 1 | loss: 0.6172791
	speed: 0.0721s/iter; left time: 1866.5261s
Epoch: 1 cost time: 21.2721529006958
Epoch: 1, Steps: 261 | Train Loss: 0.6403423 Vali Loss: 0.3175004 Test Loss: 0.4263015
Validation loss decreased (inf --> 0.317500).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.8129486
	speed: 0.2375s/iter; left time: 6114.3891s
	iters: 200, epoch: 2 | loss: 0.6732293
	speed: 0.0748s/iter; left time: 1917.5833s
Epoch: 2 cost time: 22.207566261291504
Epoch: 2, Steps: 261 | Train Loss: 0.6166804 Vali Loss: 0.3106125 Test Loss: 0.4172784
Validation loss decreased (0.317500 --> 0.310612).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4867225
	speed: 0.2240s/iter; left time: 5707.0963s
	iters: 200, epoch: 3 | loss: 0.4742039
	speed: 0.0735s/iter; left time: 1865.2027s
Epoch: 3 cost time: 21.369867086410522
Epoch: 3, Steps: 261 | Train Loss: 0.6060180 Vali Loss: 0.3030888 Test Loss: 0.4073552
Validation loss decreased (0.310612 --> 0.303089).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.5929006
	speed: 0.2300s/iter; left time: 5800.2970s
	iters: 200, epoch: 4 | loss: 0.7267447
	speed: 0.0719s/iter; left time: 1805.0552s
Epoch: 4 cost time: 21.352707386016846
Epoch: 4, Steps: 261 | Train Loss: 0.5854609 Vali Loss: 0.2862362 Test Loss: 0.3912760
Validation loss decreased (0.303089 --> 0.286236).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.5697435
	speed: 0.2135s/iter; left time: 5328.2392s
	iters: 200, epoch: 5 | loss: 0.5706702
	speed: 0.0751s/iter; left time: 1866.0407s
Epoch: 5 cost time: 21.900450706481934
Epoch: 5, Steps: 261 | Train Loss: 0.5610135 Vali Loss: 0.2789294 Test Loss: 0.3873321
Validation loss decreased (0.286236 --> 0.278929).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.4380826
	speed: 0.2410s/iter; left time: 5951.9622s
	iters: 200, epoch: 6 | loss: 0.4267988
	speed: 0.0746s/iter; left time: 1834.4050s
Epoch: 6 cost time: 22.14841914176941
Epoch: 6, Steps: 261 | Train Loss: 0.5523561 Vali Loss: 0.2754417 Test Loss: 0.3840724
Validation loss decreased (0.278929 --> 0.275442).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.5093607
	speed: 0.2390s/iter; left time: 5839.6603s
	iters: 200, epoch: 7 | loss: 0.4708274
	speed: 0.0756s/iter; left time: 1838.9721s
Epoch: 7 cost time: 21.889140129089355
Epoch: 7, Steps: 261 | Train Loss: 0.5445621 Vali Loss: 0.2747307 Test Loss: 0.3811995
Validation loss decreased (0.275442 --> 0.274731).  Saving model ...
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.6009701
	speed: 0.2173s/iter; left time: 5251.8684s
	iters: 200, epoch: 8 | loss: 0.6138611
	speed: 0.0721s/iter; left time: 1734.7199s
Epoch: 8 cost time: 21.547986268997192
Epoch: 8, Steps: 261 | Train Loss: 0.5387486 Vali Loss: 0.2722183 Test Loss: 0.3781071
Validation loss decreased (0.274731 --> 0.272218).  Saving model ...
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.3890525
	speed: 0.2146s/iter; left time: 5131.5242s
	iters: 200, epoch: 9 | loss: 0.5585421
	speed: 0.0718s/iter; left time: 1710.5848s
Epoch: 9 cost time: 21.08886981010437
Epoch: 9, Steps: 261 | Train Loss: 0.5322333 Vali Loss: 0.2715230 Test Loss: 0.3762828
Validation loss decreased (0.272218 --> 0.271523).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.5885516
	speed: 0.2248s/iter; left time: 5317.2319s
	iters: 200, epoch: 10 | loss: 0.5749875
	speed: 0.0731s/iter; left time: 1720.6580s
Epoch: 10 cost time: 21.914947986602783
Epoch: 10, Steps: 261 | Train Loss: 0.5280892 Vali Loss: 0.2718511 Test Loss: 0.3741511
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.3393927
	speed: 0.2246s/iter; left time: 5253.2089s
	iters: 200, epoch: 11 | loss: 0.5853036
	speed: 0.0721s/iter; left time: 1679.9044s
Epoch: 11 cost time: 21.717374324798584
Epoch: 11, Steps: 261 | Train Loss: 0.5225793 Vali Loss: 0.2722704 Test Loss: 0.3737667
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.5708202
	speed: 0.2269s/iter; left time: 5247.6629s
	iters: 200, epoch: 12 | loss: 0.4514659
	speed: 0.0722s/iter; left time: 1661.9536s
Epoch: 12 cost time: 21.58829617500305
Epoch: 12, Steps: 261 | Train Loss: 0.5161648 Vali Loss: 0.2724121 Test Loss: 0.3730711
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.5161799
	speed: 0.2235s/iter; left time: 5110.8714s
	iters: 200, epoch: 13 | loss: 0.4489318
	speed: 0.0732s/iter; left time: 1665.8357s
Epoch: 13 cost time: 21.502464771270752
Epoch: 13, Steps: 261 | Train Loss: 0.5110378 Vali Loss: 0.2732173 Test Loss: 0.3727618
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.3951742
	speed: 0.2245s/iter; left time: 5074.6007s
	iters: 200, epoch: 14 | loss: 0.4822732
	speed: 0.0722s/iter; left time: 1623.9832s
Epoch: 14 cost time: 21.568838834762573
Epoch: 14, Steps: 261 | Train Loss: 0.5048459 Vali Loss: 0.2752236 Test Loss: 0.3725303
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.5315742
	speed: 0.2147s/iter; left time: 4797.5569s
	iters: 200, epoch: 15 | loss: 0.4919217
	speed: 0.0716s/iter; left time: 1592.6935s
Epoch: 15 cost time: 21.15609359741211
Epoch: 15, Steps: 261 | Train Loss: 0.4983829 Vali Loss: 0.2764128 Test Loss: 0.3761835
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.4966495
	speed: 0.2176s/iter; left time: 4804.9036s
	iters: 200, epoch: 16 | loss: 0.5053194
	speed: 0.0725s/iter; left time: 1594.0003s
Epoch: 16 cost time: 21.504592895507812
Epoch: 16, Steps: 261 | Train Loss: 0.4921369 Vali Loss: 0.2775088 Test Loss: 0.3744672
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.4365404
	speed: 0.2178s/iter; left time: 4754.4906s
	iters: 200, epoch: 17 | loss: 0.4181927
	speed: 0.0725s/iter; left time: 1574.2087s
Epoch: 17 cost time: 21.524775981903076
Epoch: 17, Steps: 261 | Train Loss: 0.4854038 Vali Loss: 0.2787405 Test Loss: 0.3755254
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.5300624
	speed: 0.2194s/iter; left time: 4732.0486s
	iters: 200, epoch: 18 | loss: 0.3869448
	speed: 0.0719s/iter; left time: 1543.9602s
Epoch: 18 cost time: 21.037747383117676
Epoch: 18, Steps: 261 | Train Loss: 0.4781178 Vali Loss: 0.2801032 Test Loss: 0.3810140
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.5238541
	speed: 0.2196s/iter; left time: 4677.1309s
	iters: 200, epoch: 19 | loss: 0.5666785
	speed: 0.0726s/iter; left time: 1539.1402s
Epoch: 19 cost time: 21.506803512573242
Epoch: 19, Steps: 261 | Train Loss: 0.4724161 Vali Loss: 0.2818061 Test Loss: 0.3765346
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.4939925
	speed: 0.2415s/iter; left time: 5080.8414s
	iters: 200, epoch: 20 | loss: 0.4928607
	speed: 0.0732s/iter; left time: 1533.5129s
Epoch: 20 cost time: 21.58762812614441
Epoch: 20, Steps: 261 | Train Loss: 0.4664106 Vali Loss: 0.2834300 Test Loss: 0.3785473
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.5356364
	speed: 0.2275s/iter; left time: 4727.3602s
	iters: 200, epoch: 21 | loss: 0.4668932
	speed: 0.0720s/iter; left time: 1489.0301s
Epoch: 21 cost time: 21.982146978378296
Epoch: 21, Steps: 261 | Train Loss: 0.4603618 Vali Loss: 0.2844325 Test Loss: 0.3803292
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.4971114
	speed: 0.2165s/iter; left time: 4443.0326s
	iters: 200, epoch: 22 | loss: 0.3812815
	speed: 0.0718s/iter; left time: 1466.0156s
Epoch: 22 cost time: 21.345683813095093
Epoch: 22, Steps: 261 | Train Loss: 0.4571631 Vali Loss: 0.2874317 Test Loss: 0.3778592
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.5421745
	speed: 0.2242s/iter; left time: 4542.8345s
	iters: 200, epoch: 23 | loss: 0.4885233
	speed: 0.0709s/iter; left time: 1428.4529s
Epoch: 23 cost time: 21.60841965675354
Epoch: 23, Steps: 261 | Train Loss: 0.4512123 Vali Loss: 0.2874223 Test Loss: 0.3803224
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3823102
	speed: 0.2330s/iter; left time: 4660.5321s
	iters: 200, epoch: 24 | loss: 0.5505474
	speed: 0.0726s/iter; left time: 1444.3132s
Epoch: 24 cost time: 21.78219962120056
Epoch: 24, Steps: 261 | Train Loss: 0.4470100 Vali Loss: 0.2892017 Test Loss: 0.3788170
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.4193680
	speed: 0.2308s/iter; left time: 4555.0637s
	iters: 200, epoch: 25 | loss: 0.4757913
	speed: 0.0730s/iter; left time: 1432.5702s
Epoch: 25 cost time: 21.73366904258728
Epoch: 25, Steps: 261 | Train Loss: 0.4425871 Vali Loss: 0.2905634 Test Loss: 0.3778718
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.2899436
	speed: 0.2102s/iter; left time: 4094.2559s
	iters: 200, epoch: 26 | loss: 0.4187431
	speed: 0.0721s/iter; left time: 1397.5097s
Epoch: 26 cost time: 20.87962818145752
Epoch: 26, Steps: 261 | Train Loss: 0.4387431 Vali Loss: 0.2925393 Test Loss: 0.3822660
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.4794335
	speed: 0.2139s/iter; left time: 4109.4734s
	iters: 200, epoch: 27 | loss: 0.4063561
	speed: 0.0726s/iter; left time: 1387.6994s
Epoch: 27 cost time: 21.14315128326416
Epoch: 27, Steps: 261 | Train Loss: 0.4339057 Vali Loss: 0.2911242 Test Loss: 0.3799779
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.4675511
	speed: 0.2197s/iter; left time: 4163.3372s
	iters: 200, epoch: 28 | loss: 0.4580868
	speed: 0.0720s/iter; left time: 1358.2449s
Epoch: 28 cost time: 21.32503318786621
Epoch: 28, Steps: 261 | Train Loss: 0.4298366 Vali Loss: 0.2931830 Test Loss: 0.3824477
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.3767800
	speed: 0.2201s/iter; left time: 4113.9244s
	iters: 200, epoch: 29 | loss: 0.4373433
	speed: 0.0728s/iter; left time: 1352.9908s
Epoch: 29 cost time: 21.777331113815308
Epoch: 29, Steps: 261 | Train Loss: 0.4251183 Vali Loss: 0.2947102 Test Loss: 0.3836662
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTSFL_ETTm2_ftM_sl336_ll48_pl720_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.3762834370136261, mae:0.3900437355041504, rse:0.49250149726867676
