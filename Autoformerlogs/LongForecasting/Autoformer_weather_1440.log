Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Autoformer', model_id='weather_336_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_1440_Autoformer_custom_ftM_sl336_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35112
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 1.0021218
	speed: 0.1275s/iter; left time: 2225.0309s
	iters: 200, epoch: 1 | loss: 0.7900262
	speed: 0.1067s/iter; left time: 1852.6616s
	iters: 300, epoch: 1 | loss: 0.9373151
	speed: 0.1069s/iter; left time: 1845.5840s
	iters: 400, epoch: 1 | loss: 0.7640178
	speed: 0.1070s/iter; left time: 1835.3431s
	iters: 500, epoch: 1 | loss: 1.1047748
	speed: 0.1067s/iter; left time: 1819.6895s
	iters: 600, epoch: 1 | loss: 1.0257576
	speed: 0.1071s/iter; left time: 1815.7232s
	iters: 700, epoch: 1 | loss: 0.7008379
	speed: 0.1071s/iter; left time: 1804.6807s
	iters: 800, epoch: 1 | loss: 1.2148600
	speed: 0.1066s/iter; left time: 1785.9257s
	iters: 900, epoch: 1 | loss: 0.8840137
	speed: 0.1068s/iter; left time: 1779.3887s
	iters: 1000, epoch: 1 | loss: 1.1088790
	speed: 0.1069s/iter; left time: 1769.1323s
	iters: 1100, epoch: 1 | loss: 0.7305582
	speed: 0.1066s/iter; left time: 1753.8125s
	iters: 1200, epoch: 1 | loss: 1.2375677
	speed: 0.1065s/iter; left time: 1742.6765s
	iters: 1300, epoch: 1 | loss: 0.8247060
	speed: 0.1070s/iter; left time: 1738.9645s
	iters: 1400, epoch: 1 | loss: 1.2039034
	speed: 0.1069s/iter; left time: 1726.9196s
	iters: 1500, epoch: 1 | loss: 1.2588913
	speed: 0.1061s/iter; left time: 1703.1426s
	iters: 1600, epoch: 1 | loss: 1.2451662
	speed: 0.1069s/iter; left time: 1705.2805s
	iters: 1700, epoch: 1 | loss: 0.5715550
	speed: 0.1066s/iter; left time: 1691.0561s
	iters: 1800, epoch: 1 | loss: 0.7018101
	speed: 0.1066s/iter; left time: 1678.9522s
	iters: 1900, epoch: 1 | loss: 0.8641199
	speed: 0.1067s/iter; left time: 1670.1014s
	iters: 2000, epoch: 1 | loss: 0.7123326
	speed: 0.1067s/iter; left time: 1660.1363s
	iters: 2100, epoch: 1 | loss: 0.6669319
	speed: 0.1069s/iter; left time: 1652.3969s
	iters: 2200, epoch: 1 | loss: 0.6504346
	speed: 0.1068s/iter; left time: 1639.4545s
	iters: 2300, epoch: 1 | loss: 0.7680224
	speed: 0.1067s/iter; left time: 1627.3986s
	iters: 2400, epoch: 1 | loss: 0.7457168
	speed: 0.1066s/iter; left time: 1615.8487s
	iters: 2500, epoch: 1 | loss: 0.9185532
	speed: 0.1068s/iter; left time: 1607.7017s
	iters: 2600, epoch: 1 | loss: 0.7188566
	speed: 0.1067s/iter; left time: 1596.0564s
	iters: 2700, epoch: 1 | loss: 0.6296535
	speed: 0.1068s/iter; left time: 1585.9885s
	iters: 2800, epoch: 1 | loss: 0.6668763
	speed: 0.1068s/iter; left time: 1575.5539s
	iters: 2900, epoch: 1 | loss: 0.8082110
	speed: 0.1068s/iter; left time: 1565.9559s
	iters: 3000, epoch: 1 | loss: 0.5433702
	speed: 0.1068s/iter; left time: 1554.6625s
	iters: 3100, epoch: 1 | loss: 0.6881396
	speed: 0.1067s/iter; left time: 1542.1742s
	iters: 3200, epoch: 1 | loss: 0.6868699
	speed: 0.1068s/iter; left time: 1532.6335s
	iters: 3300, epoch: 1 | loss: 0.5858573
	speed: 0.1065s/iter; left time: 1518.5282s
	iters: 3400, epoch: 1 | loss: 0.6154498
	speed: 0.1068s/iter; left time: 1511.6171s
	iters: 3500, epoch: 1 | loss: 0.6344706
	speed: 0.1066s/iter; left time: 1498.5744s
	iters: 3600, epoch: 1 | loss: 0.7882016
	speed: 0.1067s/iter; left time: 1488.9716s
	iters: 3700, epoch: 1 | loss: 0.6929464
	speed: 0.1067s/iter; left time: 1478.0067s
	iters: 3800, epoch: 1 | loss: 1.1108553
	speed: 0.1067s/iter; left time: 1468.0014s
	iters: 3900, epoch: 1 | loss: 0.8410607
	speed: 0.1066s/iter; left time: 1456.4474s
	iters: 4000, epoch: 1 | loss: 1.0021338
	speed: 0.1067s/iter; left time: 1446.0681s
	iters: 4100, epoch: 1 | loss: 0.8012828
	speed: 0.1067s/iter; left time: 1436.2770s
	iters: 4200, epoch: 1 | loss: 0.6800883
	speed: 0.1033s/iter; left time: 1380.0142s
	iters: 4300, epoch: 1 | loss: 0.4997048
	speed: 0.1128s/iter; left time: 1495.8060s
	iters: 4400, epoch: 1 | loss: 1.1487210
	speed: 0.1095s/iter; left time: 1440.4351s
	iters: 4500, epoch: 1 | loss: 0.6869192
	speed: 0.1118s/iter; left time: 1459.1476s
	iters: 4600, epoch: 1 | loss: 1.0850680
	speed: 0.1099s/iter; left time: 1424.0748s
	iters: 4700, epoch: 1 | loss: 0.6261942
	speed: 0.1110s/iter; left time: 1427.1453s
	iters: 4800, epoch: 1 | loss: 1.0645185
	speed: 0.1101s/iter; left time: 1404.4497s
	iters: 4900, epoch: 1 | loss: 0.6635932
	speed: 0.1126s/iter; left time: 1425.1177s
	iters: 5000, epoch: 1 | loss: 0.8885834
	speed: 0.1130s/iter; left time: 1418.7557s
	iters: 5100, epoch: 1 | loss: 0.6205615
	speed: 0.1127s/iter; left time: 1403.5689s
	iters: 5200, epoch: 1 | loss: 0.5847031
	speed: 0.1121s/iter; left time: 1385.0023s
	iters: 5300, epoch: 1 | loss: 0.5968094
	speed: 0.1122s/iter; left time: 1375.5673s
	iters: 5400, epoch: 1 | loss: 0.7762099
	speed: 0.1126s/iter; left time: 1369.4603s
	iters: 5500, epoch: 1 | loss: 0.8607138
	speed: 0.1127s/iter; left time: 1358.4029s
	iters: 5600, epoch: 1 | loss: 0.5432422
	speed: 0.1045s/iter; left time: 1249.1311s
	iters: 5700, epoch: 1 | loss: 0.5531456
	speed: 0.1069s/iter; left time: 1267.0968s
	iters: 5800, epoch: 1 | loss: 0.6635537
	speed: 0.1066s/iter; left time: 1252.9411s
	iters: 5900, epoch: 1 | loss: 0.7311845
	speed: 0.1066s/iter; left time: 1243.0550s
	iters: 6000, epoch: 1 | loss: 0.6073064
	speed: 0.1065s/iter; left time: 1230.5079s
	iters: 6100, epoch: 1 | loss: 0.6861607
	speed: 0.1066s/iter; left time: 1221.8348s
	iters: 6200, epoch: 1 | loss: 0.8006588
	speed: 0.1066s/iter; left time: 1210.6849s
	iters: 6300, epoch: 1 | loss: 0.5954895
	speed: 0.1065s/iter; left time: 1199.0715s
	iters: 6400, epoch: 1 | loss: 0.6697037
	speed: 0.1072s/iter; left time: 1195.5642s
	iters: 6500, epoch: 1 | loss: 0.6929979
	speed: 0.1073s/iter; left time: 1186.8557s
	iters: 6600, epoch: 1 | loss: 0.6493351
	speed: 0.1066s/iter; left time: 1168.0281s
	iters: 6700, epoch: 1 | loss: 0.5504718
	speed: 0.1068s/iter; left time: 1159.4756s
	iters: 6800, epoch: 1 | loss: 0.5168089
	speed: 0.1067s/iter; left time: 1147.7464s
	iters: 6900, epoch: 1 | loss: 0.5677932
	speed: 0.1066s/iter; left time: 1136.1365s
	iters: 7000, epoch: 1 | loss: 0.7361792
	speed: 0.1067s/iter; left time: 1126.2198s
	iters: 7100, epoch: 1 | loss: 0.4139335
	speed: 0.1065s/iter; left time: 1113.3004s
	iters: 7200, epoch: 1 | loss: 0.4121051
	speed: 0.1066s/iter; left time: 1104.0473s
	iters: 7300, epoch: 1 | loss: 0.5259136
	speed: 0.1066s/iter; left time: 1093.1612s
	iters: 7400, epoch: 1 | loss: 0.4906321
	speed: 0.1066s/iter; left time: 1082.9082s
	iters: 7500, epoch: 1 | loss: 0.6419156
	speed: 0.1066s/iter; left time: 1072.4951s
	iters: 7600, epoch: 1 | loss: 0.5778728
	speed: 0.1064s/iter; left time: 1059.6635s
	iters: 7700, epoch: 1 | loss: 0.4960735
	speed: 0.1066s/iter; left time: 1050.9089s
	iters: 7800, epoch: 1 | loss: 1.0487545
	speed: 0.1066s/iter; left time: 1039.6991s
	iters: 7900, epoch: 1 | loss: 0.8189847
	speed: 0.1064s/iter; left time: 1027.7791s
	iters: 8000, epoch: 1 | loss: 0.7599585
	speed: 0.1067s/iter; left time: 1019.4262s
	iters: 8100, epoch: 1 | loss: 0.6973454
	speed: 0.1066s/iter; left time: 1007.9798s
	iters: 8200, epoch: 1 | loss: 0.5685750
	speed: 0.1068s/iter; left time: 999.3691s
	iters: 8300, epoch: 1 | loss: 1.1393031
	speed: 0.1067s/iter; left time: 987.5255s
	iters: 8400, epoch: 1 | loss: 1.1506801
	speed: 0.1068s/iter; left time: 978.3713s
	iters: 8500, epoch: 1 | loss: 0.6003765
	speed: 0.1066s/iter; left time: 965.5576s
	iters: 8600, epoch: 1 | loss: 0.9499078
	speed: 0.1066s/iter; left time: 954.4727s
	iters: 8700, epoch: 1 | loss: 0.5535044
	speed: 0.1067s/iter; left time: 945.0612s
Epoch: 1 cost time: 944.8514778614044
Epoch: 1, Steps: 8778 | Train Loss: 0.7780215 Vali Loss: 0.8150682 Test Loss: 0.4623187
Validation loss decreased (inf --> 0.815068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4270326
	speed: 1.7509s/iter; left time: 15195.9347s
	iters: 200, epoch: 2 | loss: 0.6599114
	speed: 0.1065s/iter; left time: 913.5052s
	iters: 300, epoch: 2 | loss: 0.6380641
	speed: 0.1066s/iter; left time: 903.9933s
	iters: 400, epoch: 2 | loss: 0.7259333
	speed: 0.1066s/iter; left time: 893.0211s
	iters: 500, epoch: 2 | loss: 0.6121166
	speed: 0.1066s/iter; left time: 882.8482s
	iters: 600, epoch: 2 | loss: 0.6103946
	speed: 0.1067s/iter; left time: 872.6503s
	iters: 700, epoch: 2 | loss: 0.6604187
	speed: 0.1067s/iter; left time: 862.0859s
	iters: 800, epoch: 2 | loss: 0.4973349
	speed: 0.1067s/iter; left time: 851.2042s
	iters: 900, epoch: 2 | loss: 1.2253108
	speed: 0.1064s/iter; left time: 838.2930s
	iters: 1000, epoch: 2 | loss: 0.4785950
	speed: 0.1065s/iter; left time: 828.6000s
	iters: 1100, epoch: 2 | loss: 0.5115215
	speed: 0.1066s/iter; left time: 818.9031s
	iters: 1200, epoch: 2 | loss: 0.8235046
	speed: 0.1066s/iter; left time: 807.9320s
	iters: 1300, epoch: 2 | loss: 0.5927843
	speed: 0.1068s/iter; left time: 798.7381s
	iters: 1400, epoch: 2 | loss: 1.2777101
	speed: 0.1067s/iter; left time: 787.0740s
	iters: 1500, epoch: 2 | loss: 0.5587006
	speed: 0.1066s/iter; left time: 775.5916s
	iters: 1600, epoch: 2 | loss: 0.5464186
	speed: 0.1066s/iter; left time: 765.0106s
	iters: 1700, epoch: 2 | loss: 0.6392592
	speed: 0.1067s/iter; left time: 755.0145s
	iters: 1800, epoch: 2 | loss: 0.4922201
	speed: 0.1066s/iter; left time: 743.9236s
	iters: 1900, epoch: 2 | loss: 0.4550478
	speed: 0.1069s/iter; left time: 735.3428s
	iters: 2000, epoch: 2 | loss: 0.5854493
	speed: 0.1069s/iter; left time: 724.4498s
	iters: 2100, epoch: 2 | loss: 0.6186638
	speed: 0.1067s/iter; left time: 712.9036s
	iters: 2200, epoch: 2 | loss: 0.6180161
	speed: 0.1067s/iter; left time: 701.8274s
	iters: 2300, epoch: 2 | loss: 0.9501863
	speed: 0.1067s/iter; left time: 691.1450s
	iters: 2400, epoch: 2 | loss: 0.5231633
	speed: 0.1075s/iter; left time: 686.0138s
	iters: 2500, epoch: 2 | loss: 0.6433184
	speed: 0.1068s/iter; left time: 670.6750s
	iters: 2600, epoch: 2 | loss: 0.5173101
	speed: 0.1067s/iter; left time: 659.2638s
	iters: 2700, epoch: 2 | loss: 0.4769865
	speed: 0.1066s/iter; left time: 647.7253s
	iters: 2800, epoch: 2 | loss: 0.6340725
	speed: 0.1065s/iter; left time: 637.0386s
	iters: 2900, epoch: 2 | loss: 0.7135114
	speed: 0.1060s/iter; left time: 623.3956s
	iters: 3000, epoch: 2 | loss: 0.5400454
	speed: 0.1066s/iter; left time: 616.2138s
	iters: 3100, epoch: 2 | loss: 0.8569162
	speed: 0.1066s/iter; left time: 605.2878s
	iters: 3200, epoch: 2 | loss: 1.0632579
	speed: 0.1068s/iter; left time: 595.9934s
	iters: 3300, epoch: 2 | loss: 0.5959910
	speed: 0.1067s/iter; left time: 584.7174s
	iters: 3400, epoch: 2 | loss: 0.4691271
	speed: 0.1069s/iter; left time: 575.2528s
	iters: 3500, epoch: 2 | loss: 0.7270752
	speed: 0.1068s/iter; left time: 563.5720s
	iters: 3600, epoch: 2 | loss: 0.4962394
	speed: 0.1066s/iter; left time: 552.1545s
	iters: 3700, epoch: 2 | loss: 0.7563119
	speed: 0.1066s/iter; left time: 541.6557s
	iters: 3800, epoch: 2 | loss: 0.6137769
	speed: 0.1067s/iter; left time: 531.4571s
	iters: 3900, epoch: 2 | loss: 0.5764502
	speed: 0.1067s/iter; left time: 520.7492s
	iters: 4000, epoch: 2 | loss: 0.5303316
	speed: 0.1061s/iter; left time: 507.2037s
	iters: 4100, epoch: 2 | loss: 1.0985099
	speed: 0.1067s/iter; left time: 499.4354s
	iters: 4200, epoch: 2 | loss: 0.4916318
	speed: 0.0985s/iter; left time: 450.8961s
	iters: 4300, epoch: 2 | loss: 0.6065374
	speed: 0.0993s/iter; left time: 444.7110s
	iters: 4400, epoch: 2 | loss: 0.6015882
	speed: 0.0966s/iter; left time: 423.0877s
	iters: 4500, epoch: 2 | loss: 0.5165684
	speed: 0.1010s/iter; left time: 432.2014s
	iters: 4600, epoch: 2 | loss: 0.4867164
	speed: 0.0997s/iter; left time: 416.6111s
	iters: 4700, epoch: 2 | loss: 0.5175105
	speed: 0.0901s/iter; left time: 367.5571s
	iters: 4800, epoch: 2 | loss: 0.7269229
	speed: 0.1001s/iter; left time: 398.4292s
	iters: 4900, epoch: 2 | loss: 0.7506009
	speed: 0.1027s/iter; left time: 398.4795s
	iters: 5000, epoch: 2 | loss: 1.1404861
	speed: 0.1023s/iter; left time: 386.7203s
	iters: 5100, epoch: 2 | loss: 0.9668979
	speed: 0.1071s/iter; left time: 393.9559s
	iters: 5200, epoch: 2 | loss: 0.7421533
	speed: 0.1036s/iter; left time: 370.6127s
	iters: 5300, epoch: 2 | loss: 0.5999312
	speed: 0.1043s/iter; left time: 362.8146s
	iters: 5400, epoch: 2 | loss: 0.4387474
	speed: 0.1021s/iter; left time: 344.9409s
	iters: 5500, epoch: 2 | loss: 0.6539430
	speed: 0.1016s/iter; left time: 333.1191s
	iters: 5600, epoch: 2 | loss: 0.5069051
	speed: 0.1020s/iter; left time: 324.3196s
	iters: 5700, epoch: 2 | loss: 0.6053083
	speed: 0.1015s/iter; left time: 312.3814s
	iters: 5800, epoch: 2 | loss: 0.4940457
	speed: 0.1018s/iter; left time: 303.2289s
	iters: 5900, epoch: 2 | loss: 0.4478129
	speed: 0.0882s/iter; left time: 253.8815s
	iters: 6000, epoch: 2 | loss: 0.4342286
	speed: 0.0916s/iter; left time: 254.5278s
	iters: 6100, epoch: 2 | loss: 0.3593658
	speed: 0.0908s/iter; left time: 243.2406s
	iters: 6200, epoch: 2 | loss: 0.5023189
	speed: 0.0905s/iter; left time: 233.2749s
	iters: 6300, epoch: 2 | loss: 0.4545996
	speed: 0.0895s/iter; left time: 221.8659s
	iters: 6400, epoch: 2 | loss: 0.9202767
	speed: 0.0949s/iter; left time: 225.7990s
	iters: 6500, epoch: 2 | loss: 0.7261953
	speed: 0.0938s/iter; left time: 213.6835s
	iters: 6600, epoch: 2 | loss: 0.7315948
	speed: 0.0972s/iter; left time: 211.7499s
	iters: 6700, epoch: 2 | loss: 0.6995897
	speed: 0.0908s/iter; left time: 188.7060s
	iters: 6800, epoch: 2 | loss: 0.6944746
	speed: 0.0949s/iter; left time: 187.7159s
	iters: 6900, epoch: 2 | loss: 1.4735582
	speed: 0.0976s/iter; left time: 183.3812s
	iters: 7000, epoch: 2 | loss: 0.6496125
	speed: 0.0979s/iter; left time: 174.1457s
	iters: 7100, epoch: 2 | loss: 0.6792770
	speed: 0.0959s/iter; left time: 160.9515s
	iters: 7200, epoch: 2 | loss: 0.5515647
	speed: 0.0922s/iter; left time: 145.5236s
	iters: 7300, epoch: 2 | loss: 1.0742651
	speed: 0.0594s/iter; left time: 87.8743s
	iters: 7400, epoch: 2 | loss: 0.4528129
	speed: 0.0533s/iter; left time: 73.5316s
	iters: 7500, epoch: 2 | loss: 0.6618978
	speed: 0.0541s/iter; left time: 69.2116s
	iters: 7600, epoch: 2 | loss: 0.4402166
	speed: 0.0541s/iter; left time: 63.8393s
	iters: 7700, epoch: 2 | loss: 0.7040488
	speed: 0.0532s/iter; left time: 57.4387s
	iters: 7800, epoch: 2 | loss: 0.5213342
	speed: 0.0536s/iter; left time: 52.4628s
	iters: 7900, epoch: 2 | loss: 0.5779969
	speed: 0.0534s/iter; left time: 46.9776s
	iters: 8000, epoch: 2 | loss: 0.6351047
	speed: 0.0533s/iter; left time: 41.5336s
	iters: 8100, epoch: 2 | loss: 0.6058634
	speed: 0.0530s/iter; left time: 36.0089s
	iters: 8200, epoch: 2 | loss: 0.4039554
	speed: 0.0537s/iter; left time: 31.1156s
	iters: 8300, epoch: 2 | loss: 0.5867330
	speed: 0.0529s/iter; left time: 25.3537s
	iters: 8400, epoch: 2 | loss: 0.5715101
	speed: 0.0530s/iter; left time: 20.1006s
	iters: 8500, epoch: 2 | loss: 0.5154675
	speed: 0.0535s/iter; left time: 14.9253s
	iters: 8600, epoch: 2 | loss: 0.5346365
	speed: 0.0540s/iter; left time: 9.6731s
	iters: 8700, epoch: 2 | loss: 0.6803450
	speed: 0.0549s/iter; left time: 4.3402s
Epoch: 2 cost time: 826.7767016887665
998
Epoch: 2, Steps: 8778 | Train Loss: 0.6676999 Vali Loss: 0.8141782 Test Loss: 0.4879896
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
>>>>>>>testing : weather_336_1440_Autoformer_custom_ftM_sl336_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:0.4623185694217682, mae:0.4523785412311554, rse:0.8983727693557739
