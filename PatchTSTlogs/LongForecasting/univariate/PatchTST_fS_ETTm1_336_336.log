Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm1_336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_336_PatchTST_ETTm1_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.1829627
	speed: 0.0385s/iter; left time: 1013.3882s
	iters: 200, epoch: 1 | loss: 0.1553913
	speed: 0.0181s/iter; left time: 475.0279s
Epoch: 1 cost time: 6.955233097076416
Epoch: 1, Steps: 264 | Train Loss: 0.1979257 Vali Loss: 0.1041154 Test Loss: 0.0554756
Validation loss decreased (inf --> 0.104115).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.1647032
	speed: 0.1130s/iter; left time: 2942.7363s
	iters: 200, epoch: 2 | loss: 0.1472063
	speed: 0.0218s/iter; left time: 565.1117s
Epoch: 2 cost time: 7.962665319442749
Epoch: 2, Steps: 264 | Train Loss: 0.1758581 Vali Loss: 0.1004147 Test Loss: 0.0537525
Validation loss decreased (0.104115 --> 0.100415).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.1412801
	speed: 0.1083s/iter; left time: 2792.2316s
	iters: 200, epoch: 3 | loss: 0.1899158
	speed: 0.0181s/iter; left time: 463.7905s
Epoch: 3 cost time: 6.8552751541137695
Epoch: 3, Steps: 264 | Train Loss: 0.1693726 Vali Loss: 0.0987561 Test Loss: 0.0529650
Validation loss decreased (0.100415 --> 0.098756).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.1855736
	speed: 0.1101s/iter; left time: 2808.1576s
	iters: 200, epoch: 4 | loss: 0.1444518
	speed: 0.0179s/iter; left time: 454.9282s
Epoch: 4 cost time: 6.8276543617248535
Epoch: 4, Steps: 264 | Train Loss: 0.1656011 Vali Loss: 0.0980253 Test Loss: 0.0527113
Validation loss decreased (0.098756 --> 0.098025).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.2023724
	speed: 0.1117s/iter; left time: 2819.3615s
	iters: 200, epoch: 5 | loss: 0.1781352
	speed: 0.0219s/iter; left time: 550.1176s
Epoch: 5 cost time: 7.695584774017334
Epoch: 5, Steps: 264 | Train Loss: 0.1630638 Vali Loss: 0.0977746 Test Loss: 0.0525635
Validation loss decreased (0.098025 --> 0.097775).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.1623530
	speed: 0.1130s/iter; left time: 2823.0262s
	iters: 200, epoch: 6 | loss: 0.1521324
	speed: 0.0180s/iter; left time: 447.9461s
Epoch: 6 cost time: 7.1170055866241455
Epoch: 6, Steps: 264 | Train Loss: 0.1610929 Vali Loss: 0.0978958 Test Loss: 0.0524375
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.1501770
	speed: 0.1118s/iter; left time: 2762.1900s
	iters: 200, epoch: 7 | loss: 0.1617242
	speed: 0.0186s/iter; left time: 457.5740s
Epoch: 7 cost time: 7.146797180175781
Epoch: 7, Steps: 264 | Train Loss: 0.1593619 Vali Loss: 0.0978900 Test Loss: 0.0526208
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.1867308
	speed: 0.1113s/iter; left time: 2720.6854s
	iters: 200, epoch: 8 | loss: 0.1372682
	speed: 0.0190s/iter; left time: 463.7413s
Epoch: 8 cost time: 7.412635326385498
Epoch: 8, Steps: 264 | Train Loss: 0.1577928 Vali Loss: 0.0976282 Test Loss: 0.0527164
Validation loss decreased (0.097775 --> 0.097628).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.1661615
	speed: 0.1101s/iter; left time: 2664.2254s
	iters: 200, epoch: 9 | loss: 0.1633470
	speed: 0.0183s/iter; left time: 441.9131s
Epoch: 9 cost time: 7.13607931137085
Epoch: 9, Steps: 264 | Train Loss: 0.1555931 Vali Loss: 0.0983171 Test Loss: 0.0527760
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.1389499
	speed: 0.1085s/iter; left time: 2596.8296s
	iters: 200, epoch: 10 | loss: 0.1188145
	speed: 0.0185s/iter; left time: 439.9125s
Epoch: 10 cost time: 7.102524042129517
Epoch: 10, Steps: 264 | Train Loss: 0.1535847 Vali Loss: 0.1003490 Test Loss: 0.0528615
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.1317853
	speed: 0.1099s/iter; left time: 2599.4391s
	iters: 200, epoch: 11 | loss: 0.1430377
	speed: 0.0185s/iter; left time: 435.3311s
Epoch: 11 cost time: 7.165455102920532
Epoch: 11, Steps: 264 | Train Loss: 0.1515840 Vali Loss: 0.1047335 Test Loss: 0.0530166
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.1338613
	speed: 0.1093s/iter; left time: 2557.9369s
	iters: 200, epoch: 12 | loss: 0.1681420
	speed: 0.0186s/iter; left time: 433.3548s
Epoch: 12 cost time: 7.198742389678955
Epoch: 12, Steps: 264 | Train Loss: 0.1497287 Vali Loss: 0.1064207 Test Loss: 0.0539394
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.1342890
	speed: 0.1126s/iter; left time: 2604.8500s
	iters: 200, epoch: 13 | loss: 0.1772848
	speed: 0.0185s/iter; left time: 425.9464s
Epoch: 13 cost time: 7.247345209121704
Epoch: 13, Steps: 264 | Train Loss: 0.1470850 Vali Loss: 0.1100861 Test Loss: 0.0543611
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.1313554
	speed: 0.1106s/iter; left time: 2530.0273s
	iters: 200, epoch: 14 | loss: 0.1586471
	speed: 0.0183s/iter; left time: 416.2423s
Epoch: 14 cost time: 7.043591260910034
Epoch: 14, Steps: 264 | Train Loss: 0.1437802 Vali Loss: 0.1126437 Test Loss: 0.0545938
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.1485001
	speed: 0.1082s/iter; left time: 2445.6009s
	iters: 200, epoch: 15 | loss: 0.1446665
	speed: 0.0183s/iter; left time: 412.4416s
Epoch: 15 cost time: 7.041788578033447
Epoch: 15, Steps: 264 | Train Loss: 0.1406481 Vali Loss: 0.1128698 Test Loss: 0.0555093
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.1314828
	speed: 0.1107s/iter; left time: 2472.0945s
	iters: 200, epoch: 16 | loss: 0.1358736
	speed: 0.0188s/iter; left time: 419.1846s
Epoch: 16 cost time: 7.120903253555298
Epoch: 16, Steps: 264 | Train Loss: 0.1371034 Vali Loss: 0.1146088 Test Loss: 0.0564619
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.1199641
	speed: 0.1079s/iter; left time: 2381.9011s
	iters: 200, epoch: 17 | loss: 0.1351022
	speed: 0.0183s/iter; left time: 402.8328s
Epoch: 17 cost time: 7.142699480056763
Epoch: 17, Steps: 264 | Train Loss: 0.1336985 Vali Loss: 0.1166844 Test Loss: 0.0565191
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.1268013
	speed: 0.1106s/iter; left time: 2412.1911s
	iters: 200, epoch: 18 | loss: 0.1479479
	speed: 0.0186s/iter; left time: 402.8318s
Epoch: 18 cost time: 7.245111703872681
Epoch: 18, Steps: 264 | Train Loss: 0.1303911 Vali Loss: 0.1188562 Test Loss: 0.0556161
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.1201109
	speed: 0.1096s/iter; left time: 2361.8670s
	iters: 200, epoch: 19 | loss: 0.1408205
	speed: 0.0210s/iter; left time: 451.2549s
Epoch: 19 cost time: 7.3763861656188965
Epoch: 19, Steps: 264 | Train Loss: 0.1266214 Vali Loss: 0.1172752 Test Loss: 0.0564257
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.1428773
	speed: 0.1161s/iter; left time: 2471.7935s
	iters: 200, epoch: 20 | loss: 0.1300831
	speed: 0.0215s/iter; left time: 455.3967s
Epoch: 20 cost time: 7.960555791854858
Epoch: 20, Steps: 264 | Train Loss: 0.1225238 Vali Loss: 0.1203642 Test Loss: 0.0574959
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.1091387
	speed: 0.1142s/iter; left time: 2399.7612s
	iters: 200, epoch: 21 | loss: 0.1295635
	speed: 0.0180s/iter; left time: 375.7004s
Epoch: 21 cost time: 7.1559789180755615
Epoch: 21, Steps: 264 | Train Loss: 0.1187766 Vali Loss: 0.1206818 Test Loss: 0.0557100
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.1196192
	speed: 0.1061s/iter; left time: 2202.2308s
	iters: 200, epoch: 22 | loss: 0.1322359
	speed: 0.0186s/iter; left time: 384.7768s
Epoch: 22 cost time: 7.034003496170044
Epoch: 22, Steps: 264 | Train Loss: 0.1148481 Vali Loss: 0.1186271 Test Loss: 0.0567024
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.1033987
	speed: 0.1074s/iter; left time: 2200.8110s
	iters: 200, epoch: 23 | loss: 0.1235877
	speed: 0.0185s/iter; left time: 377.7534s
Epoch: 23 cost time: 7.097659349441528
Epoch: 23, Steps: 264 | Train Loss: 0.1116301 Vali Loss: 0.1235835 Test Loss: 0.0577364
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.1080405
	speed: 0.1151s/iter; left time: 2327.6764s
	iters: 200, epoch: 24 | loss: 0.1054076
	speed: 0.0180s/iter; left time: 362.7716s
Epoch: 24 cost time: 7.527649164199829
Epoch: 24, Steps: 264 | Train Loss: 0.1072681 Vali Loss: 0.1207487 Test Loss: 0.0580635
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.1104876
	speed: 0.1105s/iter; left time: 2205.4698s
	iters: 200, epoch: 25 | loss: 0.0936179
	speed: 0.0186s/iter; left time: 369.6133s
Epoch: 25 cost time: 7.2922139167785645
Epoch: 25, Steps: 264 | Train Loss: 0.1044533 Vali Loss: 0.1213742 Test Loss: 0.0585718
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.0996075
	speed: 0.1091s/iter; left time: 2149.9774s
	iters: 200, epoch: 26 | loss: 0.1041291
	speed: 0.0182s/iter; left time: 356.6250s
Epoch: 26 cost time: 6.942217111587524
Epoch: 26, Steps: 264 | Train Loss: 0.1008371 Vali Loss: 0.1228387 Test Loss: 0.0629838
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.0995111
	speed: 0.1075s/iter; left time: 2089.8499s
	iters: 200, epoch: 27 | loss: 0.1002476
	speed: 0.0198s/iter; left time: 382.9630s
Epoch: 27 cost time: 7.195324897766113
Epoch: 27, Steps: 264 | Train Loss: 0.0979274 Vali Loss: 0.1300280 Test Loss: 0.0595156
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.0800964
	speed: 0.1096s/iter; left time: 2101.2455s
	iters: 200, epoch: 28 | loss: 0.1029986
	speed: 0.0183s/iter; left time: 348.4465s
Epoch: 28 cost time: 7.206122398376465
Epoch: 28, Steps: 264 | Train Loss: 0.0948808 Vali Loss: 0.1255374 Test Loss: 0.0610349
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_336_PatchTST_ETTm1_ftS_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.05271638557314873, mae:0.17279930412769318, rse:0.6773761510848999
