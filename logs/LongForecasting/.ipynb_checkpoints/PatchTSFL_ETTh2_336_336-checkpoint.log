Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTSFL', model_id='336_336', moving_avg=25, n_heads=4, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_336_PatchTSFL_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Epoch: 1 cost time: 1.2942392826080322
Epoch: 1, Steps: 62 | Train Loss: 0.7153299 Vali Loss: 0.4769137 Test Loss: 0.3587906
Validation loss decreased (inf --> 0.476914).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.2794206142425537
Epoch: 2, Steps: 62 | Train Loss: 0.7143400 Vali Loss: 0.4733533 Test Loss: 0.3588013
Validation loss decreased (0.476914 --> 0.473353).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.3123624324798584
Epoch: 3, Steps: 62 | Train Loss: 0.7143799 Vali Loss: 0.4757358 Test Loss: 0.3588205
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.4001150131225586
Epoch: 4, Steps: 62 | Train Loss: 0.7130168 Vali Loss: 0.4737645 Test Loss: 0.3588458
EarlyStopping counter: 2 out of 100
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.287564992904663
Epoch: 5, Steps: 62 | Train Loss: 0.7148861 Vali Loss: 0.4735977 Test Loss: 0.3588725
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.3507254123687744
Epoch: 6, Steps: 62 | Train Loss: 0.7141608 Vali Loss: 0.4739449 Test Loss: 0.3589021
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 1.4262330532073975
Epoch: 7, Steps: 62 | Train Loss: 0.7124892 Vali Loss: 0.4700753 Test Loss: 0.3589323
Validation loss decreased (0.473353 --> 0.470075).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.3778321743011475
Epoch: 8, Steps: 62 | Train Loss: 0.7135393 Vali Loss: 0.4738123 Test Loss: 0.3589603
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 1.3670475482940674
Epoch: 9, Steps: 62 | Train Loss: 0.7121175 Vali Loss: 0.4710449 Test Loss: 0.3589871
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.4559550285339355
Epoch: 10, Steps: 62 | Train Loss: 0.7126840 Vali Loss: 0.4707987 Test Loss: 0.3590119
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.422421932220459
Epoch: 11, Steps: 62 | Train Loss: 0.7117820 Vali Loss: 0.4693078 Test Loss: 0.3590379
Validation loss decreased (0.470075 --> 0.469308).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.42376708984375
Epoch: 12, Steps: 62 | Train Loss: 0.7122474 Vali Loss: 0.4672916 Test Loss: 0.3590625
Validation loss decreased (0.469308 --> 0.467292).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 1.2671544551849365
Epoch: 13, Steps: 62 | Train Loss: 0.7132178 Vali Loss: 0.4692343 Test Loss: 0.3590835
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 1.2990939617156982
Epoch: 14, Steps: 62 | Train Loss: 0.7130963 Vali Loss: 0.4699216 Test Loss: 0.3591039
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 1.395977258682251
Epoch: 15, Steps: 62 | Train Loss: 0.7108279 Vali Loss: 0.4709310 Test Loss: 0.3591213
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 1.298445463180542
Epoch: 16, Steps: 62 | Train Loss: 0.7104864 Vali Loss: 0.4717475 Test Loss: 0.3591388
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.382312297821045
Epoch: 17, Steps: 62 | Train Loss: 0.7126605 Vali Loss: 0.4725528 Test Loss: 0.3591553
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 1.3101105690002441
Epoch: 18, Steps: 62 | Train Loss: 0.7128178 Vali Loss: 0.4710371 Test Loss: 0.3591686
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 1.2936601638793945
Epoch: 19, Steps: 62 | Train Loss: 0.7116293 Vali Loss: 0.4693634 Test Loss: 0.3591824
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 1.329113245010376
Epoch: 20, Steps: 62 | Train Loss: 0.7120491 Vali Loss: 0.4709599 Test Loss: 0.3591930
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 1.3402392864227295
Epoch: 21, Steps: 62 | Train Loss: 0.7119344 Vali Loss: 0.4688803 Test Loss: 0.3592038
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 1.391472578048706
Epoch: 22, Steps: 62 | Train Loss: 0.7103569 Vali Loss: 0.4697123 Test Loss: 0.3592135
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 1.5152323246002197
Epoch: 23, Steps: 62 | Train Loss: 0.7122021 Vali Loss: 0.4694009 Test Loss: 0.3592225
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 1.4165802001953125
Epoch: 24, Steps: 62 | Train Loss: 0.7078499 Vali Loss: 0.4690090 Test Loss: 0.3592300
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 1.405979871749878
Epoch: 25, Steps: 62 | Train Loss: 0.7126500 Vali Loss: 0.4677006 Test Loss: 0.3592379
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 1.420118808746338
Epoch: 26, Steps: 62 | Train Loss: 0.7125619 Vali Loss: 0.4669819 Test Loss: 0.3592447
Validation loss decreased (0.467292 --> 0.466982).  Saving model ...
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.3183245658874512
Epoch: 27, Steps: 62 | Train Loss: 0.7118302 Vali Loss: 0.4693606 Test Loss: 0.3592499
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 1.3747406005859375
Epoch: 28, Steps: 62 | Train Loss: 0.7101259 Vali Loss: 0.4675249 Test Loss: 0.3592556
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 1.4123096466064453
Epoch: 29, Steps: 62 | Train Loss: 0.7114793 Vali Loss: 0.4708499 Test Loss: 0.3592602
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 1.2793171405792236
Epoch: 30, Steps: 62 | Train Loss: 0.7107358 Vali Loss: 0.4676652 Test Loss: 0.3592648
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 1.3417491912841797
Epoch: 31, Steps: 62 | Train Loss: 0.7099167 Vali Loss: 0.4692859 Test Loss: 0.3592688
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.4068052768707275
Epoch: 32, Steps: 62 | Train Loss: 0.7120772 Vali Loss: 0.4689979 Test Loss: 0.3592721
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 1.3374652862548828
Epoch: 33, Steps: 62 | Train Loss: 0.7117538 Vali Loss: 0.4715078 Test Loss: 0.3592758
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 1.279092788696289
Epoch: 34, Steps: 62 | Train Loss: 0.7125073 Vali Loss: 0.4683606 Test Loss: 0.3592788
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 1.3711397647857666
Epoch: 35, Steps: 62 | Train Loss: 0.7119916 Vali Loss: 0.4692309 Test Loss: 0.3592812
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 1.304361343383789
Epoch: 36, Steps: 62 | Train Loss: 0.7115593 Vali Loss: 0.4686867 Test Loss: 0.3592837
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 1.3918230533599854
Epoch: 37, Steps: 62 | Train Loss: 0.7115666 Vali Loss: 0.4708613 Test Loss: 0.3592860
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 1.3008067607879639
Epoch: 38, Steps: 62 | Train Loss: 0.7109313 Vali Loss: 0.4678605 Test Loss: 0.3592879
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 1.3302545547485352
Epoch: 39, Steps: 62 | Train Loss: 0.7104484 Vali Loss: 0.4674776 Test Loss: 0.3592897
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 1.4184353351593018
Epoch: 40, Steps: 62 | Train Loss: 0.7114024 Vali Loss: 0.4675924 Test Loss: 0.3592913
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 1.3349583148956299
Epoch: 41, Steps: 62 | Train Loss: 0.7127012 Vali Loss: 0.4698536 Test Loss: 0.3592929
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 1.3300962448120117
Epoch: 42, Steps: 62 | Train Loss: 0.7116513 Vali Loss: 0.4695623 Test Loss: 0.3592942
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 1.3541977405548096
Epoch: 43, Steps: 62 | Train Loss: 0.7105180 Vali Loss: 0.4678001 Test Loss: 0.3592953
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 1.3325645923614502
Epoch: 44, Steps: 62 | Train Loss: 0.7102725 Vali Loss: 0.4698405 Test Loss: 0.3592964
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 1.2690389156341553
Epoch: 45, Steps: 62 | Train Loss: 0.7107426 Vali Loss: 0.4668415 Test Loss: 0.3592973
Validation loss decreased (0.466982 --> 0.466842).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.3768048286437988
Epoch: 46, Steps: 62 | Train Loss: 0.7124244 Vali Loss: 0.4707755 Test Loss: 0.3592981
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 1.3607285022735596
Epoch: 47, Steps: 62 | Train Loss: 0.7117042 Vali Loss: 0.4661406 Test Loss: 0.3592990
Validation loss decreased (0.466842 --> 0.466141).  Saving model ...
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 1.38862943649292
Epoch: 48, Steps: 62 | Train Loss: 0.7109430 Vali Loss: 0.4681609 Test Loss: 0.3592997
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 1.4593908786773682
Epoch: 49, Steps: 62 | Train Loss: 0.7118749 Vali Loss: 0.4703732 Test Loss: 0.3593003
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 1.4267711639404297
Epoch: 50, Steps: 62 | Train Loss: 0.7115369 Vali Loss: 0.4685857 Test Loss: 0.3593008
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 1.4569106101989746
Epoch: 51, Steps: 62 | Train Loss: 0.7121475 Vali Loss: 0.4703521 Test Loss: 0.3593013
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 1.3092281818389893
Epoch: 52, Steps: 62 | Train Loss: 0.7115809 Vali Loss: 0.4682982 Test Loss: 0.3593018
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 1.3970232009887695
Epoch: 53, Steps: 62 | Train Loss: 0.7101172 Vali Loss: 0.4706194 Test Loss: 0.3593022
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 1.3415677547454834
Epoch: 54, Steps: 62 | Train Loss: 0.7114146 Vali Loss: 0.4664726 Test Loss: 0.3593026
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 1.3764822483062744
Epoch: 55, Steps: 62 | Train Loss: 0.7121898 Vali Loss: 0.4654501 Test Loss: 0.3593029
Validation loss decreased (0.466141 --> 0.465450).  Saving model ...
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 1.3779337406158447
Epoch: 56, Steps: 62 | Train Loss: 0.7112758 Vali Loss: 0.4696195 Test Loss: 0.3593032
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 1.3072750568389893
Epoch: 57, Steps: 62 | Train Loss: 0.7098618 Vali Loss: 0.4699751 Test Loss: 0.3593035
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 1.3060705661773682
Epoch: 58, Steps: 62 | Train Loss: 0.7120365 Vali Loss: 0.4663674 Test Loss: 0.3593037
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 1.2811996936798096
Epoch: 59, Steps: 62 | Train Loss: 0.7122482 Vali Loss: 0.4670181 Test Loss: 0.3593040
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 1.374159812927246
Epoch: 60, Steps: 62 | Train Loss: 0.7110571 Vali Loss: 0.4674650 Test Loss: 0.3593042
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 1.3068947792053223
Epoch: 61, Steps: 62 | Train Loss: 0.7118731 Vali Loss: 0.4696618 Test Loss: 0.3593043
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 1.2886335849761963
Epoch: 62, Steps: 62 | Train Loss: 0.7115071 Vali Loss: 0.4699530 Test Loss: 0.3593046
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 1.3914721012115479
Epoch: 63, Steps: 62 | Train Loss: 0.7115237 Vali Loss: 0.4700246 Test Loss: 0.3593047
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 1.3763256072998047
Epoch: 64, Steps: 62 | Train Loss: 0.7106530 Vali Loss: 0.4693359 Test Loss: 0.3593048
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 1.3492348194122314
Epoch: 65, Steps: 62 | Train Loss: 0.7113771 Vali Loss: 0.4682272 Test Loss: 0.3593049
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 1.2567462921142578
Epoch: 66, Steps: 62 | Train Loss: 0.7120603 Vali Loss: 0.4672261 Test Loss: 0.3593051
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 1.4021215438842773
Epoch: 67, Steps: 62 | Train Loss: 0.7110021 Vali Loss: 0.4717243 Test Loss: 0.3593051
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 1.3590619564056396
Epoch: 68, Steps: 62 | Train Loss: 0.7125961 Vali Loss: 0.4682645 Test Loss: 0.3593052
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 1.3506333827972412
Epoch: 69, Steps: 62 | Train Loss: 0.7115483 Vali Loss: 0.4679115 Test Loss: 0.3593053
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 1.4083774089813232
Epoch: 70, Steps: 62 | Train Loss: 0.7110325 Vali Loss: 0.4694907 Test Loss: 0.3593053
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 1.4429819583892822
Epoch: 71, Steps: 62 | Train Loss: 0.7118418 Vali Loss: 0.4699495 Test Loss: 0.3593054
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 1.3439371585845947
Epoch: 72, Steps: 62 | Train Loss: 0.7111820 Vali Loss: 0.4686072 Test Loss: 0.3593055
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 1.332937479019165
Epoch: 73, Steps: 62 | Train Loss: 0.7117829 Vali Loss: 0.4685697 Test Loss: 0.3593055
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 1.4844655990600586
Epoch: 74, Steps: 62 | Train Loss: 0.7119840 Vali Loss: 0.4651188 Test Loss: 0.3593056
Validation loss decreased (0.465450 --> 0.465119).  Saving model ...
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 1.4413683414459229
Epoch: 75, Steps: 62 | Train Loss: 0.7118781 Vali Loss: 0.4692679 Test Loss: 0.3593056
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 1.4711744785308838
Epoch: 76, Steps: 62 | Train Loss: 0.7124218 Vali Loss: 0.4694226 Test Loss: 0.3593056
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 1.3857109546661377
Epoch: 77, Steps: 62 | Train Loss: 0.7110477 Vali Loss: 0.4669410 Test Loss: 0.3593056
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 1.3715081214904785
Epoch: 78, Steps: 62 | Train Loss: 0.7111424 Vali Loss: 0.4719606 Test Loss: 0.3593057
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 1.269521713256836
Epoch: 79, Steps: 62 | Train Loss: 0.7124632 Vali Loss: 0.4679239 Test Loss: 0.3593058
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 1.4416348934173584
Epoch: 80, Steps: 62 | Train Loss: 0.7121720 Vali Loss: 0.4710710 Test Loss: 0.3593058
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 1.2624499797821045
Epoch: 81, Steps: 62 | Train Loss: 0.7118113 Vali Loss: 0.4698356 Test Loss: 0.3593058
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 1.298748254776001
Epoch: 82, Steps: 62 | Train Loss: 0.7111094 Vali Loss: 0.4694583 Test Loss: 0.3593058
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 1.347529411315918
Epoch: 83, Steps: 62 | Train Loss: 0.7121052 Vali Loss: 0.4638660 Test Loss: 0.3593058
Validation loss decreased (0.465119 --> 0.463866).  Saving model ...
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 1.4414145946502686
Epoch: 84, Steps: 62 | Train Loss: 0.7108973 Vali Loss: 0.4675757 Test Loss: 0.3593059
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 1.3878777027130127
Epoch: 85, Steps: 62 | Train Loss: 0.7107544 Vali Loss: 0.4707667 Test Loss: 0.3593059
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 1.2735979557037354
Epoch: 86, Steps: 62 | Train Loss: 0.7106422 Vali Loss: 0.4681683 Test Loss: 0.3593059
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 1.3027541637420654
Epoch: 87, Steps: 62 | Train Loss: 0.7112387 Vali Loss: 0.4697286 Test Loss: 0.3593058
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 1.3501319885253906
Epoch: 88, Steps: 62 | Train Loss: 0.7116369 Vali Loss: 0.4706566 Test Loss: 0.3593059
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 1.3391578197479248
Epoch: 89, Steps: 62 | Train Loss: 0.7116494 Vali Loss: 0.4666800 Test Loss: 0.3593059
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 1.263777494430542
Epoch: 90, Steps: 62 | Train Loss: 0.7121163 Vali Loss: 0.4670912 Test Loss: 0.3593059
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 1.2736742496490479
Epoch: 91, Steps: 62 | Train Loss: 0.7118745 Vali Loss: 0.4676184 Test Loss: 0.3593059
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 1.3779270648956299
Epoch: 92, Steps: 62 | Train Loss: 0.7101882 Vali Loss: 0.4668449 Test Loss: 0.3593059
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 1.3853840827941895
Epoch: 93, Steps: 62 | Train Loss: 0.7119468 Vali Loss: 0.4685351 Test Loss: 0.3593059
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 1.3603715896606445
Epoch: 94, Steps: 62 | Train Loss: 0.7119292 Vali Loss: 0.4677252 Test Loss: 0.3593059
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 1.2677171230316162
Epoch: 95, Steps: 62 | Train Loss: 0.7091538 Vali Loss: 0.4669439 Test Loss: 0.3593059
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 1.4062607288360596
Epoch: 96, Steps: 62 | Train Loss: 0.7113421 Vali Loss: 0.4691874 Test Loss: 0.3593059
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 1.3782916069030762
Epoch: 97, Steps: 62 | Train Loss: 0.7124725 Vali Loss: 0.4687383 Test Loss: 0.3593059
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 1.3287830352783203
Epoch: 98, Steps: 62 | Train Loss: 0.7112693 Vali Loss: 0.4709994 Test Loss: 0.3593059
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 1.533043384552002
Epoch: 99, Steps: 62 | Train Loss: 0.7114954 Vali Loss: 0.4673125 Test Loss: 0.3593059
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 1.3528876304626465
Epoch: 100, Steps: 62 | Train Loss: 0.7114918 Vali Loss: 0.4662472 Test Loss: 0.3593059
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_336_PatchTSFL_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.35930562019348145, mae:0.41259220242500305, rse:0.4788719713687897
