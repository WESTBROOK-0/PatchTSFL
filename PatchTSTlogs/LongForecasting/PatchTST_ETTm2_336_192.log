Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_192', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3326294
	speed: 0.0500s/iter; left time: 1319.6285s
	iters: 200, epoch: 1 | loss: 0.4382668
	speed: 0.0450s/iter; left time: 1184.7372s
Epoch: 1 cost time: 12.5681631565094
Epoch: 1, Steps: 265 | Train Loss: 0.4113821 Vali Loss: 0.1839766 Test Loss: 0.2538088
Validation loss decreased (inf --> 0.183977).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.2371667
	speed: 0.1305s/iter; left time: 3409.4896s
	iters: 200, epoch: 2 | loss: 0.2512401
	speed: 0.0450s/iter; left time: 1170.4997s
Epoch: 2 cost time: 12.624957799911499
Epoch: 2, Steps: 265 | Train Loss: 0.3486815 Vali Loss: 0.1711735 Test Loss: 0.2380175
Validation loss decreased (0.183977 --> 0.171174).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.4661140
	speed: 0.1290s/iter; left time: 3336.6528s
	iters: 200, epoch: 3 | loss: 0.4209371
	speed: 0.0452s/iter; left time: 1165.9252s
Epoch: 3 cost time: 12.676519870758057
Epoch: 3, Steps: 265 | Train Loss: 0.3308704 Vali Loss: 0.1651815 Test Loss: 0.2305916
Validation loss decreased (0.171174 --> 0.165182).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3338267
	speed: 0.1328s/iter; left time: 3401.6179s
	iters: 200, epoch: 4 | loss: 0.4613864
	speed: 0.0451s/iter; left time: 1150.9265s
Epoch: 4 cost time: 12.866649627685547
Epoch: 4, Steps: 265 | Train Loss: 0.3208745 Vali Loss: 0.1625696 Test Loss: 0.2266638
Validation loss decreased (0.165182 --> 0.162570).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3768051
	speed: 0.1288s/iter; left time: 3263.7174s
	iters: 200, epoch: 5 | loss: 0.3645163
	speed: 0.0449s/iter; left time: 1132.2903s
Epoch: 5 cost time: 12.564799070358276
Epoch: 5, Steps: 265 | Train Loss: 0.3144609 Vali Loss: 0.1615958 Test Loss: 0.2250090
Validation loss decreased (0.162570 --> 0.161596).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3034133
	speed: 0.1320s/iter; left time: 3311.1409s
	iters: 200, epoch: 6 | loss: 0.2355599
	speed: 0.0452s/iter; left time: 1129.7014s
Epoch: 6 cost time: 12.817584991455078
Epoch: 6, Steps: 265 | Train Loss: 0.3100027 Vali Loss: 0.1596280 Test Loss: 0.2232096
Validation loss decreased (0.161596 --> 0.159628).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.2476260
	speed: 0.1321s/iter; left time: 3278.6204s
	iters: 200, epoch: 7 | loss: 0.3748030
	speed: 0.0448s/iter; left time: 1107.3000s
Epoch: 7 cost time: 12.709262132644653
Epoch: 7, Steps: 265 | Train Loss: 0.3067963 Vali Loss: 0.1586763 Test Loss: 0.2214559
Validation loss decreased (0.159628 --> 0.158676).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.2424492
	speed: 0.1332s/iter; left time: 3270.0546s
	iters: 200, epoch: 8 | loss: 0.4083413
	speed: 0.0453s/iter; left time: 1107.8743s
Epoch: 8 cost time: 12.72946286201477
Epoch: 8, Steps: 265 | Train Loss: 0.3044893 Vali Loss: 0.1594227 Test Loss: 0.2199616
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.2919538
	speed: 0.1317s/iter; left time: 3196.7846s
	iters: 200, epoch: 9 | loss: 0.2056664
	speed: 0.0451s/iter; left time: 1091.1939s
Epoch: 9 cost time: 12.716893672943115
Epoch: 9, Steps: 265 | Train Loss: 0.3008325 Vali Loss: 0.1586019 Test Loss: 0.2206101
Validation loss decreased (0.158676 --> 0.158602).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.2376903
	speed: 0.1308s/iter; left time: 3141.4359s
	iters: 200, epoch: 10 | loss: 0.3107706
	speed: 0.0453s/iter; left time: 1082.2690s
Epoch: 10 cost time: 12.71782374382019
Epoch: 10, Steps: 265 | Train Loss: 0.2974007 Vali Loss: 0.1596252 Test Loss: 0.2224643
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.2027861
	speed: 0.1309s/iter; left time: 3108.3685s
	iters: 200, epoch: 11 | loss: 0.2775896
	speed: 0.0452s/iter; left time: 1068.5969s
Epoch: 11 cost time: 12.699053287506104
Epoch: 11, Steps: 265 | Train Loss: 0.2928065 Vali Loss: 0.1606147 Test Loss: 0.2228899
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3644513
	speed: 0.1305s/iter; left time: 3065.5470s
	iters: 200, epoch: 12 | loss: 0.2379105
	speed: 0.0452s/iter; left time: 1056.7435s
Epoch: 12 cost time: 12.67061161994934
Epoch: 12, Steps: 265 | Train Loss: 0.2870386 Vali Loss: 0.1636972 Test Loss: 0.2234602
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2816738
	speed: 0.1300s/iter; left time: 3018.7267s
	iters: 200, epoch: 13 | loss: 0.2391604
	speed: 0.0452s/iter; left time: 1044.2097s
Epoch: 13 cost time: 12.700652599334717
Epoch: 13, Steps: 265 | Train Loss: 0.2813256 Vali Loss: 0.1641837 Test Loss: 0.2270585
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.3765008
	speed: 0.1317s/iter; left time: 3023.5262s
	iters: 200, epoch: 14 | loss: 0.2511747
	speed: 0.0452s/iter; left time: 1032.4223s
Epoch: 14 cost time: 12.731271266937256
Epoch: 14, Steps: 265 | Train Loss: 0.2745924 Vali Loss: 0.1645062 Test Loss: 0.2287409
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2900027
	speed: 0.1310s/iter; left time: 2972.3337s
	iters: 200, epoch: 15 | loss: 0.2320906
	speed: 0.0451s/iter; left time: 1019.1722s
Epoch: 15 cost time: 12.688120603561401
Epoch: 15, Steps: 265 | Train Loss: 0.2675623 Vali Loss: 0.1686321 Test Loss: 0.2318285
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.3031047
	speed: 0.1308s/iter; left time: 2932.3855s
	iters: 200, epoch: 16 | loss: 0.2197310
	speed: 0.0451s/iter; left time: 1007.5400s
Epoch: 16 cost time: 12.634233474731445
Epoch: 16, Steps: 265 | Train Loss: 0.2607612 Vali Loss: 0.1702986 Test Loss: 0.2317650
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.3001636
	speed: 0.1308s/iter; left time: 2899.0471s
	iters: 200, epoch: 17 | loss: 0.3455173
	speed: 0.0451s/iter; left time: 995.1776s
Epoch: 17 cost time: 12.650436401367188
Epoch: 17, Steps: 265 | Train Loss: 0.2553198 Vali Loss: 0.1696247 Test Loss: 0.2345610
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2929472
	speed: 0.1290s/iter; left time: 2824.7208s
	iters: 200, epoch: 18 | loss: 0.2494010
	speed: 0.0451s/iter; left time: 983.7464s
Epoch: 18 cost time: 12.678173542022705
Epoch: 18, Steps: 265 | Train Loss: 0.2513925 Vali Loss: 0.1678892 Test Loss: 0.2395011
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2625575
	speed: 0.1299s/iter; left time: 2809.7472s
	iters: 200, epoch: 19 | loss: 0.3271404
	speed: 0.0453s/iter; left time: 974.4614s
Epoch: 19 cost time: 12.666948318481445
Epoch: 19, Steps: 265 | Train Loss: 0.2465309 Vali Loss: 0.1688532 Test Loss: 0.2342892
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2829596
	speed: 0.1298s/iter; left time: 2772.6441s
	iters: 200, epoch: 20 | loss: 0.2217647
	speed: 0.0452s/iter; left time: 960.3355s
Epoch: 20 cost time: 12.614580392837524
Epoch: 20, Steps: 265 | Train Loss: 0.2437565 Vali Loss: 0.1705354 Test Loss: 0.2419159
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2197303
	speed: 0.1296s/iter; left time: 2734.7261s
	iters: 200, epoch: 21 | loss: 0.2891976
	speed: 0.0451s/iter; left time: 947.3323s
Epoch: 21 cost time: 12.721222400665283
Epoch: 21, Steps: 265 | Train Loss: 0.2401434 Vali Loss: 0.1731861 Test Loss: 0.2434505
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.1784502
	speed: 0.1300s/iter; left time: 2708.3832s
	iters: 200, epoch: 22 | loss: 0.2439572
	speed: 0.0451s/iter; left time: 935.5809s
Epoch: 22 cost time: 12.634243488311768
Epoch: 22, Steps: 265 | Train Loss: 0.2367010 Vali Loss: 0.1728147 Test Loss: 0.2395225
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2519150
	speed: 0.1299s/iter; left time: 2671.4791s
	iters: 200, epoch: 23 | loss: 0.1985811
	speed: 0.0451s/iter; left time: 923.4239s
Epoch: 23 cost time: 12.656190156936646
Epoch: 23, Steps: 265 | Train Loss: 0.2337003 Vali Loss: 0.1709539 Test Loss: 0.2348154
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2343873
	speed: 0.1273s/iter; left time: 2585.0645s
	iters: 200, epoch: 24 | loss: 0.2746772
	speed: 0.0449s/iter; left time: 908.1488s
Epoch: 24 cost time: 12.540647506713867
Epoch: 24, Steps: 265 | Train Loss: 0.2316730 Vali Loss: 0.1731868 Test Loss: 0.2393398
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2452821
	speed: 0.1289s/iter; left time: 2582.6644s
	iters: 200, epoch: 25 | loss: 0.2472201
	speed: 0.0451s/iter; left time: 899.1151s
Epoch: 25 cost time: 12.576335191726685
Epoch: 25, Steps: 265 | Train Loss: 0.2285673 Vali Loss: 0.1736877 Test Loss: 0.2416422
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.1882032
	speed: 0.1278s/iter; left time: 2527.4502s
	iters: 200, epoch: 26 | loss: 0.2280221
	speed: 0.0451s/iter; left time: 888.1662s
Epoch: 26 cost time: 12.565186023712158
Epoch: 26, Steps: 265 | Train Loss: 0.2264923 Vali Loss: 0.1735048 Test Loss: 0.2430296
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2490592
	speed: 0.1297s/iter; left time: 2530.7751s
	iters: 200, epoch: 27 | loss: 0.1801764
	speed: 0.0452s/iter; left time: 877.0878s
Epoch: 27 cost time: 12.628357648849487
Epoch: 27, Steps: 265 | Train Loss: 0.2229811 Vali Loss: 0.1724617 Test Loss: 0.2383637
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2270880
	speed: 0.1288s/iter; left time: 2479.3315s
	iters: 200, epoch: 28 | loss: 0.2415089
	speed: 0.0451s/iter; left time: 862.6277s
Epoch: 28 cost time: 12.791399002075195
Epoch: 28, Steps: 265 | Train Loss: 0.2205107 Vali Loss: 0.1706337 Test Loss: 0.2425907
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.1770023
	speed: 0.1307s/iter; left time: 2481.6004s
	iters: 200, epoch: 29 | loss: 0.1840702
	speed: 0.0451s/iter; left time: 851.3098s
Epoch: 29 cost time: 12.667472839355469
Epoch: 29, Steps: 265 | Train Loss: 0.2173371 Vali Loss: 0.1740920 Test Loss: 0.2406638
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTST_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.22061005234718323, mae:0.2920730710029602, rse:0.3795955777168274
