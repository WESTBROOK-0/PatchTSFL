Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=24, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='traffic.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=862, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_96_PatchTSFL_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.9950516
	speed: 0.0647s/iter; left time: 3181.4081s
	iters: 200, epoch: 1 | loss: 0.9807437
	speed: 0.0462s/iter; left time: 2269.3963s
	iters: 300, epoch: 1 | loss: 1.0552284
	speed: 0.0469s/iter; left time: 2298.0322s
	iters: 400, epoch: 1 | loss: 0.9249466
	speed: 0.0470s/iter; left time: 2299.7505s
Epoch: 1 cost time: 24.934709787368774
Epoch: 1, Steps: 493 | Train Loss: 0.9831671 Vali Loss: 1.1945963 Test Loss: 1.3785555
Validation loss decreased (inf --> 1.194596).  Saving model ...
Updating learning rate to 4.591079293121559e-06
	iters: 100, epoch: 2 | loss: 1.0825051
	speed: 0.2514s/iter; left time: 12245.1601s
	iters: 200, epoch: 2 | loss: 0.9551452
	speed: 0.0490s/iter; left time: 2383.8153s
	iters: 300, epoch: 2 | loss: 1.0316839
	speed: 0.0490s/iter; left time: 2376.1656s
	iters: 400, epoch: 2 | loss: 1.0147136
	speed: 0.0487s/iter; left time: 2359.2178s
Epoch: 2 cost time: 26.118759870529175
Epoch: 2, Steps: 493 | Train Loss: 0.9831686 Vali Loss: 1.1951149 Test Loss: 1.3785517
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.34975989203805e-06
	iters: 100, epoch: 3 | loss: 0.8830702
	speed: 0.2605s/iter; left time: 12559.6688s
	iters: 200, epoch: 3 | loss: 0.9834903
	speed: 0.0471s/iter; left time: 2265.1958s
	iters: 300, epoch: 3 | loss: 0.9748445
	speed: 0.0471s/iter; left time: 2263.4886s
	iters: 400, epoch: 3 | loss: 1.0002897
	speed: 0.0480s/iter; left time: 2302.0143s
Epoch: 3 cost time: 25.30595850944519
Epoch: 3, Steps: 493 | Train Loss: 0.9831493 Vali Loss: 1.1952486 Test Loss: 1.3785467
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.232728476531372e-06
	iters: 100, epoch: 4 | loss: 1.0413576
	speed: 0.2593s/iter; left time: 12375.4460s
	iters: 200, epoch: 4 | loss: 1.0033988
	speed: 0.0483s/iter; left time: 2299.1175s
	iters: 300, epoch: 4 | loss: 0.9319810
	speed: 0.0483s/iter; left time: 2296.1823s
	iters: 400, epoch: 4 | loss: 1.0173898
	speed: 0.0483s/iter; left time: 2288.5834s
Epoch: 4 cost time: 26.105411291122437
Epoch: 4, Steps: 493 | Train Loss: 0.9830487 Vali Loss: 1.1949365 Test Loss: 1.3785394
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3168982420225906e-05
	iters: 100, epoch: 5 | loss: 0.9419791
	speed: 0.2630s/iter; left time: 12423.5821s
	iters: 200, epoch: 5 | loss: 0.9539974
	speed: 0.0441s/iter; left time: 2079.4334s
