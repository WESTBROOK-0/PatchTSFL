Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='Informer', model_id='weather_192_1440', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=1440, random_seed=2021, revin=1, root_path='./dataset/', seq_len=192, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_1440_Informer_custom_ftM_sl192_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35256
val 3831
test 9100
	iters: 100, epoch: 1 | loss: 0.6899087
	speed: 0.0566s/iter; left time: 992.1578s
	iters: 200, epoch: 1 | loss: 0.6037053
	speed: 0.0396s/iter; left time: 690.2081s
	iters: 300, epoch: 1 | loss: 1.2263429
	speed: 0.0380s/iter; left time: 658.3940s
	iters: 400, epoch: 1 | loss: 0.8160819
	speed: 0.0370s/iter; left time: 636.9575s
	iters: 500, epoch: 1 | loss: 0.7776895
	speed: 0.0360s/iter; left time: 617.1065s
	iters: 600, epoch: 1 | loss: 0.7110265
	speed: 0.0366s/iter; left time: 623.2205s
	iters: 700, epoch: 1 | loss: 0.6121143
	speed: 0.0366s/iter; left time: 620.0447s
	iters: 800, epoch: 1 | loss: 0.7453007
	speed: 0.0372s/iter; left time: 625.4199s
	iters: 900, epoch: 1 | loss: 0.5217371
	speed: 0.0395s/iter; left time: 660.7987s
	iters: 1000, epoch: 1 | loss: 0.6116432
	speed: 0.0360s/iter; left time: 599.4506s
	iters: 1100, epoch: 1 | loss: 0.6776103
	speed: 0.0362s/iter; left time: 599.0345s
	iters: 1200, epoch: 1 | loss: 0.6522655
	speed: 0.0368s/iter; left time: 604.9423s
	iters: 1300, epoch: 1 | loss: 0.7561405
	speed: 0.0396s/iter; left time: 647.2424s
	iters: 1400, epoch: 1 | loss: 0.8957706
	speed: 0.0419s/iter; left time: 680.1255s
	iters: 1500, epoch: 1 | loss: 0.7265797
	speed: 0.0434s/iter; left time: 699.6601s
	iters: 1600, epoch: 1 | loss: 0.7463740
	speed: 0.0395s/iter; left time: 632.6815s
	iters: 1700, epoch: 1 | loss: 0.9048169
	speed: 0.0391s/iter; left time: 622.9237s
	iters: 1800, epoch: 1 | loss: 0.8240198
	speed: 0.0394s/iter; left time: 624.3767s
	iters: 1900, epoch: 1 | loss: 0.7258340
	speed: 0.0397s/iter; left time: 624.1057s
	iters: 2000, epoch: 1 | loss: 0.5753852
	speed: 0.0407s/iter; left time: 635.7929s
	iters: 2100, epoch: 1 | loss: 0.6956667
	speed: 0.0401s/iter; left time: 623.2119s
	iters: 2200, epoch: 1 | loss: 0.5743850
	speed: 0.0403s/iter; left time: 622.1965s
	iters: 2300, epoch: 1 | loss: 0.6479238
	speed: 0.0395s/iter; left time: 605.3517s
	iters: 2400, epoch: 1 | loss: 0.7434345
	speed: 0.0402s/iter; left time: 611.8433s
	iters: 2500, epoch: 1 | loss: 0.5759460
	speed: 0.0397s/iter; left time: 600.9213s
	iters: 2600, epoch: 1 | loss: 0.6731701
	speed: 0.0398s/iter; left time: 597.7539s
	iters: 2700, epoch: 1 | loss: 0.8853504
	speed: 0.0408s/iter; left time: 608.4060s
	iters: 2800, epoch: 1 | loss: 0.6529958
	speed: 0.0404s/iter; left time: 599.7427s
	iters: 2900, epoch: 1 | loss: 0.7032586
	speed: 0.0406s/iter; left time: 597.8602s
	iters: 3000, epoch: 1 | loss: 1.0865538
	speed: 0.0411s/iter; left time: 600.7859s
	iters: 3100, epoch: 1 | loss: 1.0737568
	speed: 0.0406s/iter; left time: 590.5810s
	iters: 3200, epoch: 1 | loss: 0.6145870
	speed: 0.0402s/iter; left time: 579.3459s
	iters: 3300, epoch: 1 | loss: 0.5366659
	speed: 0.0400s/iter; left time: 573.7043s
	iters: 3400, epoch: 1 | loss: 0.5024484
	speed: 0.0404s/iter; left time: 574.4912s
	iters: 3500, epoch: 1 | loss: 0.5272993
	speed: 0.0401s/iter; left time: 566.9891s
	iters: 3600, epoch: 1 | loss: 0.5897595
	speed: 0.0398s/iter; left time: 557.6589s
	iters: 3700, epoch: 1 | loss: 0.5752271
	speed: 0.0399s/iter; left time: 555.3197s
	iters: 3800, epoch: 1 | loss: 0.9514126
	speed: 0.0408s/iter; left time: 564.1220s
	iters: 3900, epoch: 1 | loss: 0.5431913
	speed: 0.0408s/iter; left time: 560.7761s
	iters: 4000, epoch: 1 | loss: 0.8210266
	speed: 0.0408s/iter; left time: 556.3874s
	iters: 4100, epoch: 1 | loss: 0.6679518
	speed: 0.0411s/iter; left time: 555.4815s
	iters: 4200, epoch: 1 | loss: 0.6542405
	speed: 0.0407s/iter; left time: 547.0186s
	iters: 4300, epoch: 1 | loss: 0.6264082
	speed: 0.0401s/iter; left time: 534.4675s
	iters: 4400, epoch: 1 | loss: 0.6588536
	speed: 0.0403s/iter; left time: 533.2680s
	iters: 4500, epoch: 1 | loss: 0.7165603
	speed: 0.0401s/iter; left time: 526.0349s
	iters: 4600, epoch: 1 | loss: 0.5875524
	speed: 0.0394s/iter; left time: 513.5190s
	iters: 4700, epoch: 1 | loss: 0.5378086
	speed: 0.0397s/iter; left time: 513.7139s
	iters: 4800, epoch: 1 | loss: 0.6612118
	speed: 0.0399s/iter; left time: 511.7403s
	iters: 4900, epoch: 1 | loss: 1.5450995
	speed: 0.0400s/iter; left time: 509.6991s
	iters: 5000, epoch: 1 | loss: 0.5293704
	speed: 0.0379s/iter; left time: 478.9506s
	iters: 5100, epoch: 1 | loss: 0.4485500
	speed: 0.0383s/iter; left time: 479.6887s
	iters: 5200, epoch: 1 | loss: 0.3852891
	speed: 0.0398s/iter; left time: 494.2813s
	iters: 5300, epoch: 1 | loss: 0.5800426
	speed: 0.0404s/iter; left time: 498.5152s
	iters: 5400, epoch: 1 | loss: 1.0464487
	speed: 0.0403s/iter; left time: 493.0398s
	iters: 5500, epoch: 1 | loss: 0.9896297
	speed: 0.0394s/iter; left time: 478.0570s
	iters: 5600, epoch: 1 | loss: 0.5470915
	speed: 0.0400s/iter; left time: 480.7836s
	iters: 5700, epoch: 1 | loss: 0.7528839
	speed: 0.0400s/iter; left time: 476.5833s
	iters: 5800, epoch: 1 | loss: 0.6764342
	speed: 0.0401s/iter; left time: 474.3230s
	iters: 5900, epoch: 1 | loss: 0.5478137
	speed: 0.0390s/iter; left time: 457.8048s
	iters: 6000, epoch: 1 | loss: 0.6198366
	speed: 0.0402s/iter; left time: 467.6879s
	iters: 6100, epoch: 1 | loss: 0.5322666
	speed: 0.0405s/iter; left time: 466.9424s
	iters: 6200, epoch: 1 | loss: 0.4963042
	speed: 0.0401s/iter; left time: 458.6606s
	iters: 6300, epoch: 1 | loss: 0.6034448
	speed: 0.0403s/iter; left time: 457.0018s
	iters: 6400, epoch: 1 | loss: 0.5658067
	speed: 0.0403s/iter; left time: 452.3977s
	iters: 6500, epoch: 1 | loss: 0.5397874
	speed: 0.0395s/iter; left time: 439.5282s
	iters: 6600, epoch: 1 | loss: 0.6204666
	speed: 0.0404s/iter; left time: 445.1778s
	iters: 6700, epoch: 1 | loss: 0.7980752
	speed: 0.0407s/iter; left time: 444.6427s
	iters: 6800, epoch: 1 | loss: 0.5422074
	speed: 0.0407s/iter; left time: 440.7548s
	iters: 6900, epoch: 1 | loss: 0.5452394
	speed: 0.0400s/iter; left time: 429.1031s
	iters: 7000, epoch: 1 | loss: 0.6501735
	speed: 0.0407s/iter; left time: 432.2388s
	iters: 7100, epoch: 1 | loss: 0.5843449
	speed: 0.0409s/iter; left time: 430.3310s
	iters: 7200, epoch: 1 | loss: 0.6643518
	speed: 0.0422s/iter; left time: 439.8097s
	iters: 7300, epoch: 1 | loss: 0.6196229
	speed: 0.0419s/iter; left time: 432.8668s
	iters: 7400, epoch: 1 | loss: 0.5379313
	speed: 0.0409s/iter; left time: 418.3689s
	iters: 7500, epoch: 1 | loss: 0.5007765
	speed: 0.0402s/iter; left time: 407.5416s
	iters: 7600, epoch: 1 | loss: 0.6914881
	speed: 0.0419s/iter; left time: 419.7935s
	iters: 7700, epoch: 1 | loss: 0.4610266
	speed: 0.0406s/iter; left time: 402.7681s
	iters: 7800, epoch: 1 | loss: 0.5481679
	speed: 0.0409s/iter; left time: 402.3745s
	iters: 7900, epoch: 1 | loss: 0.5956590
	speed: 0.0389s/iter; left time: 378.4748s
	iters: 8000, epoch: 1 | loss: 0.7392522
	speed: 0.0365s/iter; left time: 351.1412s
	iters: 8100, epoch: 1 | loss: 0.5587127
	speed: 0.0364s/iter; left time: 347.2481s
	iters: 8200, epoch: 1 | loss: 0.5423459
	speed: 0.0370s/iter; left time: 348.9745s
	iters: 8300, epoch: 1 | loss: 0.8124622
	speed: 0.0369s/iter; left time: 344.3699s
	iters: 8400, epoch: 1 | loss: 0.4978661
	speed: 0.0371s/iter; left time: 342.0044s
	iters: 8500, epoch: 1 | loss: 0.7866930
	speed: 0.0371s/iter; left time: 338.3400s
	iters: 8600, epoch: 1 | loss: 0.5871630
	speed: 0.0367s/iter; left time: 331.5065s
	iters: 8700, epoch: 1 | loss: 0.5359722
	speed: 0.0366s/iter; left time: 326.7816s
	iters: 8800, epoch: 1 | loss: 0.5711342
	speed: 0.0369s/iter; left time: 325.3768s
Epoch: 1 cost time: 350.18570041656494
Epoch: 1, Steps: 8814 | Train Loss: 0.7116515 Vali Loss: 1.2593173 Test Loss: 2.2914102
Validation loss decreased (inf --> 1.259317).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7329551
	speed: 0.5527s/iter; left time: 4816.6637s
	iters: 200, epoch: 2 | loss: 0.9687420
	speed: 0.0365s/iter; left time: 314.1750s
	iters: 300, epoch: 2 | loss: 0.4730467
	speed: 0.0371s/iter; left time: 316.3050s
	iters: 400, epoch: 2 | loss: 0.5257515
	speed: 0.0372s/iter; left time: 313.2897s
	iters: 500, epoch: 2 | loss: 0.7860448
	speed: 0.0367s/iter; left time: 304.8020s
	iters: 600, epoch: 2 | loss: 0.4677472
	speed: 0.0365s/iter; left time: 300.2224s
	iters: 700, epoch: 2 | loss: 0.6616581
	speed: 0.0371s/iter; left time: 300.7271s
	iters: 800, epoch: 2 | loss: 0.4390133
	speed: 0.0365s/iter; left time: 292.3897s
	iters: 900, epoch: 2 | loss: 0.5368305
	speed: 0.0371s/iter; left time: 293.8258s
	iters: 1000, epoch: 2 | loss: 0.6013273
	speed: 0.0367s/iter; left time: 286.4544s
	iters: 1100, epoch: 2 | loss: 0.9908191
	speed: 0.0366s/iter; left time: 282.4876s
	iters: 1200, epoch: 2 | loss: 0.3965944
	speed: 0.0369s/iter; left time: 281.3138s
	iters: 1300, epoch: 2 | loss: 0.4381459
	speed: 0.0389s/iter; left time: 292.0339s
	iters: 1400, epoch: 2 | loss: 0.4867792
	speed: 0.0419s/iter; left time: 310.8913s
	iters: 1500, epoch: 2 | loss: 0.8205568
	speed: 0.0413s/iter; left time: 302.0888s
	iters: 1600, epoch: 2 | loss: 0.4510006
	speed: 0.0413s/iter; left time: 297.9784s
	iters: 1700, epoch: 2 | loss: 1.0878592
	speed: 0.0442s/iter; left time: 314.1381s
	iters: 1800, epoch: 2 | loss: 0.5097679
	speed: 0.0403s/iter; left time: 282.8605s
	iters: 1900, epoch: 2 | loss: 0.3867547
	speed: 0.0384s/iter; left time: 265.6809s
	iters: 2000, epoch: 2 | loss: 0.3846156
	speed: 0.0363s/iter; left time: 247.5794s
	iters: 2100, epoch: 2 | loss: 0.4269615
	speed: 0.0362s/iter; left time: 242.7796s
	iters: 2200, epoch: 2 | loss: 0.5627530
	speed: 0.0360s/iter; left time: 238.1028s
	iters: 2300, epoch: 2 | loss: 0.4051578
	speed: 0.0360s/iter; left time: 234.5914s
	iters: 2400, epoch: 2 | loss: 0.4884179
	speed: 0.0361s/iter; left time: 231.6177s
	iters: 2500, epoch: 2 | loss: 0.3844220
	speed: 0.0364s/iter; left time: 229.7091s
	iters: 2600, epoch: 2 | loss: 0.3371355
	speed: 0.0364s/iter; left time: 225.9300s
	iters: 2700, epoch: 2 | loss: 0.4431124
	speed: 0.0365s/iter; left time: 223.2056s
	iters: 2800, epoch: 2 | loss: 0.5317711
	speed: 0.0368s/iter; left time: 221.5236s
	iters: 2900, epoch: 2 | loss: 0.3706575
	speed: 0.0365s/iter; left time: 215.7021s
	iters: 3000, epoch: 2 | loss: 0.3766477
	speed: 0.0363s/iter; left time: 211.1350s
	iters: 3100, epoch: 2 | loss: 0.3036168
	speed: 0.0367s/iter; left time: 209.8189s
	iters: 3200, epoch: 2 | loss: 0.8653242
	speed: 0.0363s/iter; left time: 204.0823s
	iters: 3300, epoch: 2 | loss: 0.4980130
	speed: 0.0362s/iter; left time: 199.6853s
	iters: 3400, epoch: 2 | loss: 0.8398052
	speed: 0.0367s/iter; left time: 198.6676s
	iters: 3500, epoch: 2 | loss: 0.3454420
	speed: 0.0365s/iter; left time: 194.2556s
	iters: 3600, epoch: 2 | loss: 0.3503698
	speed: 0.0383s/iter; left time: 199.8796s
	iters: 3700, epoch: 2 | loss: 1.3702159
	speed: 0.0377s/iter; left time: 193.0213s
	iters: 3800, epoch: 2 | loss: 0.9112206
	speed: 0.0379s/iter; left time: 189.8656s
	iters: 3900, epoch: 2 | loss: 0.3239370
	speed: 0.0382s/iter; left time: 187.7430s
	iters: 4000, epoch: 2 | loss: 0.2486071
	speed: 0.0378s/iter; left time: 182.1051s
	iters: 4100, epoch: 2 | loss: 0.4333809
	speed: 0.0369s/iter; left time: 173.7717s
	iters: 4200, epoch: 2 | loss: 0.9130818
	speed: 0.0366s/iter; left time: 168.7129s
	iters: 4300, epoch: 2 | loss: 0.9105747
	speed: 0.0366s/iter; left time: 165.3208s
	iters: 4400, epoch: 2 | loss: 0.4500912
	speed: 0.0397s/iter; left time: 175.2361s
	iters: 4500, epoch: 2 | loss: 0.2925986
	speed: 0.0369s/iter; left time: 159.2365s
	iters: 4600, epoch: 2 | loss: 0.3815743
	speed: 0.0365s/iter; left time: 153.9991s
	iters: 4700, epoch: 2 | loss: 0.4623983
	speed: 0.0366s/iter; left time: 150.4243s
	iters: 4800, epoch: 2 | loss: 0.4596972
	speed: 0.0369s/iter; left time: 148.1154s
	iters: 4900, epoch: 2 | loss: 0.4939050
	speed: 0.0368s/iter; left time: 144.1314s
	iters: 5000, epoch: 2 | loss: 0.4650611
	speed: 0.0365s/iter; left time: 139.4048s
	iters: 5100, epoch: 2 | loss: 0.2488799
	speed: 0.0375s/iter; left time: 139.4588s
	iters: 5200, epoch: 2 | loss: 0.3328454
	speed: 0.0372s/iter; left time: 134.3062s
	iters: 5300, epoch: 2 | loss: 0.3397693
	speed: 0.0411s/iter; left time: 144.5871s
	iters: 5400, epoch: 2 | loss: 0.3682741
	speed: 0.0383s/iter; left time: 130.9208s
	iters: 5500, epoch: 2 | loss: 0.4613002
	speed: 0.0370s/iter; left time: 122.4910s
	iters: 5600, epoch: 2 | loss: 0.4179556
	speed: 0.0368s/iter; left time: 118.3361s
	iters: 5700, epoch: 2 | loss: 0.2235758
	speed: 0.0380s/iter; left time: 118.4852s
	iters: 5800, epoch: 2 | loss: 0.4688677
	speed: 0.0371s/iter; left time: 111.8613s
	iters: 5900, epoch: 2 | loss: 0.3304613
	speed: 0.0367s/iter; left time: 106.9312s
	iters: 6000, epoch: 2 | loss: 0.4299847
	speed: 0.0367s/iter; left time: 103.2353s
	iters: 6100, epoch: 2 | loss: 0.3019855
	speed: 0.0364s/iter; left time: 98.7094s
	iters: 6200, epoch: 2 | loss: 0.1986704
	speed: 0.0368s/iter; left time: 96.3552s
	iters: 6300, epoch: 2 | loss: 0.3435387
	speed: 0.0365s/iter; left time: 91.8459s
	iters: 6400, epoch: 2 | loss: 0.3817657
	speed: 0.0377s/iter; left time: 91.0739s
	iters: 6500, epoch: 2 | loss: 0.2798155
	speed: 0.0384s/iter; left time: 89.0007s
	iters: 6600, epoch: 2 | loss: 0.2124808
	speed: 0.0397s/iter; left time: 88.0247s
	iters: 6700, epoch: 2 | loss: 0.3101049
	speed: 0.0392s/iter; left time: 82.9916s
	iters: 6800, epoch: 2 | loss: 0.3055696
	speed: 0.0386s/iter; left time: 77.7894s
	iters: 6900, epoch: 2 | loss: 0.2343050
	speed: 0.0368s/iter; left time: 70.5431s
	iters: 7000, epoch: 2 | loss: 0.2902546
	speed: 0.0368s/iter; left time: 66.8644s
	iters: 7100, epoch: 2 | loss: 0.3991388
	speed: 0.0365s/iter; left time: 62.6340s
	iters: 7200, epoch: 2 | loss: 0.2909048
	speed: 0.0368s/iter; left time: 59.3932s
	iters: 7300, epoch: 2 | loss: 0.3820309
	speed: 0.0364s/iter; left time: 55.1001s
	iters: 7400, epoch: 2 | loss: 0.3708862
	speed: 0.0365s/iter; left time: 51.6785s
	iters: 7500, epoch: 2 | loss: 0.3777887
	speed: 0.0369s/iter; left time: 48.5349s
	iters: 7600, epoch: 2 | loss: 0.2654768
	speed: 0.0368s/iter; left time: 44.6592s
	iters: 7700, epoch: 2 | loss: 0.2103638
	speed: 0.0370s/iter; left time: 41.2400s
	iters: 7800, epoch: 2 | loss: 0.2999576
	speed: 0.0367s/iter; left time: 37.2830s
	iters: 7900, epoch: 2 | loss: 0.7415099
	speed: 0.0368s/iter; left time: 33.6934s
	iters: 8000, epoch: 2 | loss: 0.2263108
	speed: 0.0367s/iter; left time: 29.8824s
	iters: 8100, epoch: 2 | loss: 0.2962050
	speed: 0.0369s/iter; left time: 26.4073s
	iters: 8200, epoch: 2 | loss: 0.4068260
	speed: 0.0367s/iter; left time: 22.5422s
	iters: 8300, epoch: 2 | loss: 0.2606934
	speed: 0.0369s/iter; left time: 18.9995s
	iters: 8400, epoch: 2 | loss: 0.6904487
	speed: 0.0365s/iter; left time: 15.1496s
	iters: 8500, epoch: 2 | loss: 0.2606750
	speed: 0.0363s/iter; left time: 11.4322s
	iters: 8600, epoch: 2 | loss: 0.3019213
	speed: 0.0366s/iter; left time: 7.8751s
	iters: 8700, epoch: 2 | loss: 0.4253762
	speed: 0.0367s/iter; left time: 4.2223s
	iters: 8800, epoch: 2 | loss: 0.3297228
	speed: 0.0365s/iter; left time: 0.5473s
Epoch: 2 cost time: 331.01729011535645
Epoch: 2, Steps: 8814 | Train Loss: 0.4607175 Vali Loss: 0.9693904 Test Loss: 1.2696543
Validation loss decreased (1.259317 --> 0.969390).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_192_1440_Informer_custom_ftM_sl192_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9100
mse:1.2695585489273071, mae:0.8422136902809143, rse:1.4887175559997559
