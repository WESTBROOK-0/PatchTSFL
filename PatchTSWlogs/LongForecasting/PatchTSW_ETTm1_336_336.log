Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : 336_336_PatchTSW_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4493798
	speed: 0.3623s/iter; left time: 9527.6357s
	iters: 200, epoch: 1 | loss: 0.4235821
	speed: 0.3471s/iter; left time: 9094.5913s
Epoch: 1 cost time: 93.34042286872864
Epoch: 1, Steps: 264 | Train Loss: 0.4771381 Vali Loss: 0.7092324 Test Loss: 0.4137889
Validation loss decreased (inf --> 0.709232).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.4342349
	speed: 0.8111s/iter; left time: 21119.8566s
	iters: 200, epoch: 2 | loss: 0.3625620
	speed: 0.3470s/iter; left time: 8999.8350s
Epoch: 2 cost time: 93.40475416183472
Epoch: 2, Steps: 264 | Train Loss: 0.3957875 Vali Loss: 0.6599872 Test Loss: 0.3885339
Validation loss decreased (0.709232 --> 0.659987).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.3644798
	speed: 0.8055s/iter; left time: 20761.1165s
	iters: 200, epoch: 3 | loss: 0.4291691
	speed: 0.3473s/iter; left time: 8917.2877s
Epoch: 3 cost time: 93.53675150871277
Epoch: 3, Steps: 264 | Train Loss: 0.3785535 Vali Loss: 0.6498225 Test Loss: 0.3796993
Validation loss decreased (0.659987 --> 0.649822).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.3524121
	speed: 0.8046s/iter; left time: 20524.0329s
	iters: 200, epoch: 4 | loss: 0.3966769
	speed: 0.3469s/iter; left time: 8815.4128s
Epoch: 4 cost time: 93.36892414093018
Epoch: 4, Steps: 264 | Train Loss: 0.3705277 Vali Loss: 0.6470028 Test Loss: 0.3757383
Validation loss decreased (0.649822 --> 0.647003).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3989455
	speed: 0.8070s/iter; left time: 20372.5648s
	iters: 200, epoch: 5 | loss: 0.3718692
	speed: 0.3471s/iter; left time: 8728.9371s
Epoch: 5 cost time: 93.50758171081543
Epoch: 5, Steps: 264 | Train Loss: 0.3649174 Vali Loss: 0.6427172 Test Loss: 0.3728367
Validation loss decreased (0.647003 --> 0.642717).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.3387264
	speed: 0.8158s/iter; left time: 20380.3682s
	iters: 200, epoch: 6 | loss: 0.3330330
	speed: 0.3476s/iter; left time: 8647.8832s
Epoch: 6 cost time: 93.91271543502808
Epoch: 6, Steps: 264 | Train Loss: 0.3602290 Vali Loss: 0.6408296 Test Loss: 0.3711137
Validation loss decreased (0.642717 --> 0.640830).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.3343130
	speed: 0.8090s/iter; left time: 19996.7328s
	iters: 200, epoch: 7 | loss: 0.3398923
	speed: 0.3474s/iter; left time: 8552.2440s
Epoch: 7 cost time: 93.47323274612427
Epoch: 7, Steps: 264 | Train Loss: 0.3556939 Vali Loss: 0.6373439 Test Loss: 0.3715477
Validation loss decreased (0.640830 --> 0.637344).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3336619
	speed: 0.8187s/iter; left time: 20018.6358s
	iters: 200, epoch: 8 | loss: 0.3363810
	speed: 0.3475s/iter; left time: 8461.9972s
Epoch: 8 cost time: 93.83896017074585
Epoch: 8, Steps: 264 | Train Loss: 0.3512241 Vali Loss: 0.6405942 Test Loss: 0.3684650
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.3293294
	speed: 0.8003s/iter; left time: 19359.1463s
	iters: 200, epoch: 9 | loss: 0.3245365
	speed: 0.3477s/iter; left time: 8374.6742s
Epoch: 9 cost time: 93.62904858589172
Epoch: 9, Steps: 264 | Train Loss: 0.3466695 Vali Loss: 0.6353194 Test Loss: 0.3699803
Validation loss decreased (0.637344 --> 0.635319).  Saving model ...
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.3579179
	speed: 0.8155s/iter; left time: 19510.8180s
	iters: 200, epoch: 10 | loss: 0.3253223
	speed: 0.3475s/iter; left time: 8279.9105s
Epoch: 10 cost time: 93.91058254241943
Epoch: 10, Steps: 264 | Train Loss: 0.3426043 Vali Loss: 0.6385106 Test Loss: 0.3671644
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3093019
	speed: 0.8014s/iter; left time: 18961.4148s
	iters: 200, epoch: 11 | loss: 0.2964067
	speed: 0.3474s/iter; left time: 8185.4811s
Epoch: 11 cost time: 93.5278992652893
Epoch: 11, Steps: 264 | Train Loss: 0.3384924 Vali Loss: 0.6368154 Test Loss: 0.3682728
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3324708
	speed: 0.8087s/iter; left time: 18921.2191s
	iters: 200, epoch: 12 | loss: 0.3268317
	speed: 0.3476s/iter; left time: 8097.3681s
Epoch: 12 cost time: 93.8019506931305
Epoch: 12, Steps: 264 | Train Loss: 0.3344523 Vali Loss: 0.6360298 Test Loss: 0.3648923
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3180150
	speed: 0.8070s/iter; left time: 18668.0750s
	iters: 200, epoch: 13 | loss: 0.3181894
	speed: 0.3476s/iter; left time: 8007.2187s
Epoch: 13 cost time: 93.74966740608215
Epoch: 13, Steps: 264 | Train Loss: 0.3305357 Vali Loss: 0.6397428 Test Loss: 0.3657118
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3337652
	speed: 0.8017s/iter; left time: 18333.8473s
	iters: 200, epoch: 14 | loss: 0.3239569
	speed: 0.3476s/iter; left time: 7914.2376s
Epoch: 14 cost time: 93.82587695121765
Epoch: 14, Steps: 264 | Train Loss: 0.3264512 Vali Loss: 0.6455076 Test Loss: 0.3680120
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.3166145
	speed: 0.8065s/iter; left time: 18229.9985s
	iters: 200, epoch: 15 | loss: 0.3002993
	speed: 0.3476s/iter; left time: 7822.7445s
Epoch: 15 cost time: 93.79370403289795
Epoch: 15, Steps: 264 | Train Loss: 0.3221231 Vali Loss: 0.6422728 Test Loss: 0.3653931
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.3312677
	speed: 0.8082s/iter; left time: 18055.7634s
	iters: 200, epoch: 16 | loss: 0.2984415
	speed: 0.3475s/iter; left time: 7727.7726s
Epoch: 16 cost time: 93.8135998249054
Epoch: 16, Steps: 264 | Train Loss: 0.3176304 Vali Loss: 0.6510560 Test Loss: 0.3753055
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.2958622
	speed: 0.8081s/iter; left time: 17839.3199s
	iters: 200, epoch: 17 | loss: 0.3248483
	speed: 0.3478s/iter; left time: 7643.4750s
Epoch: 17 cost time: 93.91637063026428
Epoch: 17, Steps: 264 | Train Loss: 0.3129370 Vali Loss: 0.6454628 Test Loss: 0.3698374
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.2886733
	speed: 0.8068s/iter; left time: 17599.2904s
	iters: 200, epoch: 18 | loss: 0.2848485
	speed: 0.3474s/iter; left time: 7543.7436s
Epoch: 18 cost time: 93.8459985256195
Epoch: 18, Steps: 264 | Train Loss: 0.3081587 Vali Loss: 0.6418828 Test Loss: 0.3723490
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3284297
	speed: 0.8016s/iter; left time: 17274.6360s
	iters: 200, epoch: 19 | loss: 0.3148292
	speed: 0.3476s/iter; left time: 7454.7149s
Epoch: 19 cost time: 93.69297456741333
Epoch: 19, Steps: 264 | Train Loss: 0.3029852 Vali Loss: 0.6584472 Test Loss: 0.3764035
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3033193
	speed: 0.8046s/iter; left time: 17126.2006s
	iters: 200, epoch: 20 | loss: 0.3075467
	speed: 0.3475s/iter; left time: 7361.7145s
Epoch: 20 cost time: 93.70220398902893
Epoch: 20, Steps: 264 | Train Loss: 0.2985619 Vali Loss: 0.6639606 Test Loss: 0.3815155
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.2910643
	speed: 0.8033s/iter; left time: 16886.6928s
	iters: 200, epoch: 21 | loss: 0.2750638
	speed: 0.3476s/iter; left time: 7271.1872s
Epoch: 21 cost time: 93.75402092933655
Epoch: 21, Steps: 264 | Train Loss: 0.2937226 Vali Loss: 0.6675001 Test Loss: 0.3791804
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.2964480
	speed: 0.8093s/iter; left time: 16798.8511s
	iters: 200, epoch: 22 | loss: 0.2684515
	speed: 0.3476s/iter; left time: 7180.8681s
Epoch: 22 cost time: 93.66564273834229
Epoch: 22, Steps: 264 | Train Loss: 0.2891706 Vali Loss: 0.6541217 Test Loss: 0.3871011
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.3368633
	speed: 0.8054s/iter; left time: 16504.6984s
	iters: 200, epoch: 23 | loss: 0.2876290
	speed: 0.3476s/iter; left time: 7088.1318s
Epoch: 23 cost time: 93.9395055770874
Epoch: 23, Steps: 264 | Train Loss: 0.2844082 Vali Loss: 0.6646259 Test Loss: 0.3934801
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2747323
	speed: 0.8018s/iter; left time: 16219.3657s
	iters: 200, epoch: 24 | loss: 0.2779882
	speed: 0.3475s/iter; left time: 6995.3928s
Epoch: 24 cost time: 93.8466305732727
Epoch: 24, Steps: 264 | Train Loss: 0.2797471 Vali Loss: 0.6756663 Test Loss: 0.3924679
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.2833102
	speed: 0.8030s/iter; left time: 16031.5112s
	iters: 200, epoch: 25 | loss: 0.2959276
	speed: 0.3475s/iter; left time: 6902.5230s
Epoch: 25 cost time: 93.77086853981018
Epoch: 25, Steps: 264 | Train Loss: 0.2753038 Vali Loss: 0.6778467 Test Loss: 0.4004044
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2564934
	speed: 0.8128s/iter; left time: 16013.5888s
	iters: 200, epoch: 26 | loss: 0.2611572
	speed: 0.3473s/iter; left time: 6807.5383s
Epoch: 26 cost time: 94.28297090530396
Epoch: 26, Steps: 264 | Train Loss: 0.2703881 Vali Loss: 0.6680488 Test Loss: 0.4027052
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2833862
	speed: 0.8025s/iter; left time: 15598.4450s
	iters: 200, epoch: 27 | loss: 0.2638294
	speed: 0.3474s/iter; left time: 6718.6251s
Epoch: 27 cost time: 93.61278629302979
Epoch: 27, Steps: 264 | Train Loss: 0.2663998 Vali Loss: 0.6792316 Test Loss: 0.4103571
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.2607778
	speed: 0.8058s/iter; left time: 15448.9786s
	iters: 200, epoch: 28 | loss: 0.2739938
	speed: 0.3475s/iter; left time: 6628.0123s
Epoch: 28 cost time: 93.84457588195801
Epoch: 28, Steps: 264 | Train Loss: 0.2619573 Vali Loss: 0.6914539 Test Loss: 0.4094481
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.2572317
	speed: 0.8074s/iter; left time: 15266.4257s
	iters: 200, epoch: 29 | loss: 0.2645836
	speed: 0.3476s/iter; left time: 6537.1721s
Epoch: 29 cost time: 93.83906579017639
Epoch: 29, Steps: 264 | Train Loss: 0.2579591 Vali Loss: 0.6813796 Test Loss: 0.4063151
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTSW_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3699805736541748, mae:0.3916824162006378, rse:0.5787431001663208
