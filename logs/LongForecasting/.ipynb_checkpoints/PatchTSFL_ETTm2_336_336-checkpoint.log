Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSFL', model_id='336_336', moving_avg=25, n_heads=16, num_workers=4, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
fourier enhanced block used!
modes=0, index=[]
>>>>>>>start training : 336_336_PatchTSFL_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3166872
	speed: 0.0144s/iter; left time: 378.5918s
	iters: 200, epoch: 1 | loss: 0.4602388
	speed: 0.0074s/iter; left time: 192.9505s
Epoch: 1 cost time: 2.787708282470703
Epoch: 1, Steps: 264 | Train Loss: 0.4997503 Vali Loss: 0.2610151 Test Loss: 0.3415906
Validation loss decreased (inf --> 0.261015).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.5224717
	speed: 0.0540s/iter; left time: 1405.4026s
	iters: 200, epoch: 2 | loss: 0.3552403
	speed: 0.0074s/iter; left time: 192.4933s
Epoch: 2 cost time: 2.7417283058166504
Epoch: 2, Steps: 264 | Train Loss: 0.5004588 Vali Loss: 0.2608422 Test Loss: 0.3415847
Validation loss decreased (0.261015 --> 0.260842).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.4155002
	speed: 0.0527s/iter; left time: 1359.4229s
	iters: 200, epoch: 3 | loss: 0.5176768
	speed: 0.0074s/iter; left time: 189.4077s
Epoch: 3 cost time: 2.812382698059082
Epoch: 3, Steps: 264 | Train Loss: 0.5006310 Vali Loss: 0.2608021 Test Loss: 0.3415780
Validation loss decreased (0.260842 --> 0.260802).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.4849187
	speed: 0.0527s/iter; left time: 1344.9016s
	iters: 200, epoch: 4 | loss: 0.3757244
	speed: 0.0074s/iter; left time: 187.1306s
Epoch: 4 cost time: 2.837573766708374
Epoch: 4, Steps: 264 | Train Loss: 0.5001401 Vali Loss: 0.2608326 Test Loss: 0.3415707
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.4907913
	speed: 0.0529s/iter; left time: 1335.7982s
	iters: 200, epoch: 5 | loss: 0.5469413
	speed: 0.0068s/iter; left time: 171.7829s
Epoch: 5 cost time: 2.7281365394592285
Epoch: 5, Steps: 264 | Train Loss: 0.5000949 Vali Loss: 0.2608487 Test Loss: 0.3415616
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.3423552
	speed: 0.0524s/iter; left time: 1309.0642s
	iters: 200, epoch: 6 | loss: 0.3759007
	speed: 0.0069s/iter; left time: 172.6511s
Epoch: 6 cost time: 2.732041358947754
Epoch: 6, Steps: 264 | Train Loss: 0.5000334 Vali Loss: 0.2608169 Test Loss: 0.3415519
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.5686258
	speed: 0.0515s/iter; left time: 1271.7879s
	iters: 200, epoch: 7 | loss: 0.6316863
	speed: 0.0066s/iter; left time: 161.8451s
Epoch: 7 cost time: 2.5646843910217285
Epoch: 7, Steps: 264 | Train Loss: 0.5006986 Vali Loss: 0.2608548 Test Loss: 0.3415402
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.5493650
	speed: 0.0488s/iter; left time: 1193.2798s
	iters: 200, epoch: 8 | loss: 0.4221766
	speed: 0.0067s/iter; left time: 163.5450s
Epoch: 8 cost time: 2.616093397140503
Epoch: 8, Steps: 264 | Train Loss: 0.4999079 Vali Loss: 0.2608970 Test Loss: 0.3415262
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.5435506
	speed: 0.0451s/iter; left time: 1090.3048s
	iters: 200, epoch: 9 | loss: 0.4654765
	speed: 0.0066s/iter; left time: 158.5764s
Epoch: 9 cost time: 2.518047332763672
Epoch: 9, Steps: 264 | Train Loss: 0.5006053 Vali Loss: 0.2610225 Test Loss: 0.3415099
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.6436692
	speed: 0.0504s/iter; left time: 1206.3793s
	iters: 200, epoch: 10 | loss: 0.3951752
	speed: 0.0067s/iter; left time: 159.0451s
Epoch: 10 cost time: 2.6046087741851807
Epoch: 10, Steps: 264 | Train Loss: 0.5008400 Vali Loss: 0.2610264 Test Loss: 0.3414916
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.5641665
	speed: 0.0501s/iter; left time: 1185.2010s
	iters: 200, epoch: 11 | loss: 0.3811131
	speed: 0.0067s/iter; left time: 158.2775s
Epoch: 11 cost time: 2.652161121368408
Epoch: 11, Steps: 264 | Train Loss: 0.5002111 Vali Loss: 0.2610767 Test Loss: 0.3414710
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3658062
	speed: 0.0494s/iter; left time: 1154.8487s
	iters: 200, epoch: 12 | loss: 0.4508992
	speed: 0.0066s/iter; left time: 154.0047s
Epoch: 12 cost time: 2.5010826587677
Epoch: 12, Steps: 264 | Train Loss: 0.5003220 Vali Loss: 0.2610228 Test Loss: 0.3414473
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3833528
	speed: 0.0496s/iter; left time: 1146.8004s
	iters: 200, epoch: 13 | loss: 0.3474556
	speed: 0.0068s/iter; left time: 157.7757s
Epoch: 13 cost time: 2.6958768367767334
Epoch: 13, Steps: 264 | Train Loss: 0.5003397 Vali Loss: 0.2609772 Test Loss: 0.3414230
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.5200016
	speed: 0.0500s/iter; left time: 1143.7833s
	iters: 200, epoch: 14 | loss: 0.4637744
	speed: 0.0068s/iter; left time: 154.4620s
Epoch: 14 cost time: 2.7107768058776855
Epoch: 14, Steps: 264 | Train Loss: 0.5000338 Vali Loss: 0.2611960 Test Loss: 0.3413962
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.5410309
	speed: 0.0498s/iter; left time: 1126.7091s
	iters: 200, epoch: 15 | loss: 0.4165835
	speed: 0.0070s/iter; left time: 158.5278s
Epoch: 15 cost time: 2.716613292694092
Epoch: 15, Steps: 264 | Train Loss: 0.5007394 Vali Loss: 0.2611266 Test Loss: 0.3413664
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.4912170
	speed: 0.0498s/iter; left time: 1111.8981s
	iters: 200, epoch: 16 | loss: 0.6020656
	speed: 0.0071s/iter; left time: 158.0026s
Epoch: 16 cost time: 2.6680614948272705
Epoch: 16, Steps: 264 | Train Loss: 0.4997958 Vali Loss: 0.2612540 Test Loss: 0.3413417
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.5074215
	speed: 0.0506s/iter; left time: 1117.7009s
	iters: 200, epoch: 17 | loss: 0.5129022
	speed: 0.0067s/iter; left time: 148.1197s
Epoch: 17 cost time: 2.5975162982940674
Epoch: 17, Steps: 264 | Train Loss: 0.5000588 Vali Loss: 0.2613807 Test Loss: 0.3413121
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.3790382
	speed: 0.0508s/iter; left time: 1107.9267s
	iters: 200, epoch: 18 | loss: 0.4506992
	speed: 0.0067s/iter; left time: 145.1329s
Epoch: 18 cost time: 2.627913236618042
Epoch: 18, Steps: 264 | Train Loss: 0.4994497 Vali Loss: 0.2613548 Test Loss: 0.3412814
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3918327
	speed: 0.0486s/iter; left time: 1046.7602s
	iters: 200, epoch: 19 | loss: 0.4065748
	speed: 0.0067s/iter; left time: 143.5290s
Epoch: 19 cost time: 2.5470519065856934
Epoch: 19, Steps: 264 | Train Loss: 0.5004462 Vali Loss: 0.2613288 Test Loss: 0.3412507
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3757894
	speed: 0.0484s/iter; left time: 1031.0394s
	iters: 200, epoch: 20 | loss: 0.3282126
	speed: 0.0068s/iter; left time: 143.4721s
Epoch: 20 cost time: 2.6031455993652344
Epoch: 20, Steps: 264 | Train Loss: 0.4999011 Vali Loss: 0.2615909 Test Loss: 0.3412201
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.6450052
	speed: 0.0492s/iter; left time: 1035.0192s
	iters: 200, epoch: 21 | loss: 0.3945830
	speed: 0.0066s/iter; left time: 138.6877s
Epoch: 21 cost time: 2.603938579559326
Epoch: 21, Steps: 264 | Train Loss: 0.5003201 Vali Loss: 0.2614321 Test Loss: 0.3411891
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.4449582
	speed: 0.0505s/iter; left time: 1048.4244s
	iters: 200, epoch: 22 | loss: 0.4488192
	speed: 0.0067s/iter; left time: 139.0602s
Epoch: 22 cost time: 2.645918369293213
Epoch: 22, Steps: 264 | Train Loss: 0.5000434 Vali Loss: 0.2618191 Test Loss: 0.3411633
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.6683473
	speed: 0.0488s/iter; left time: 1000.1984s
	iters: 200, epoch: 23 | loss: 0.3919831
	speed: 0.0070s/iter; left time: 142.9250s
Epoch: 23 cost time: 2.6393351554870605
Epoch: 23, Steps: 264 | Train Loss: 0.5000794 Vali Loss: 0.2615227 Test Loss: 0.3411379
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTSFL_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3415779173374176, mae:0.380262553691864, rse:0.4715295732021332
