Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.2, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='ETTm1_336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_720_PatchTST_ETTm1_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2178495
	speed: 0.0411s/iter; left time: 1067.8289s
	iters: 200, epoch: 1 | loss: 0.2108257
	speed: 0.0191s/iter; left time: 494.0645s
Epoch: 1 cost time: 7.275076866149902
Epoch: 1, Steps: 261 | Train Loss: 0.2274620 Vali Loss: 0.1240778 Test Loss: 0.0762080
Validation loss decreased (inf --> 0.124078).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.2053718
	speed: 0.1138s/iter; left time: 2929.1239s
	iters: 200, epoch: 2 | loss: 0.1917580
	speed: 0.0197s/iter; left time: 505.6961s
Epoch: 2 cost time: 7.458355188369751
Epoch: 2, Steps: 261 | Train Loss: 0.2098191 Vali Loss: 0.1213021 Test Loss: 0.0747240
Validation loss decreased (0.124078 --> 0.121302).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.2470454
	speed: 0.1110s/iter; left time: 2829.0126s
	iters: 200, epoch: 3 | loss: 0.1815825
	speed: 0.0196s/iter; left time: 498.4621s
Epoch: 3 cost time: 7.129023313522339
Epoch: 3, Steps: 261 | Train Loss: 0.2044479 Vali Loss: 0.1202187 Test Loss: 0.0739347
Validation loss decreased (0.121302 --> 0.120219).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.1854435
	speed: 0.1149s/iter; left time: 2898.0591s
	iters: 200, epoch: 4 | loss: 0.2169006
	speed: 0.0201s/iter; left time: 504.8578s
Epoch: 4 cost time: 7.402570962905884
Epoch: 4, Steps: 261 | Train Loss: 0.2012237 Vali Loss: 0.1194659 Test Loss: 0.0740117
Validation loss decreased (0.120219 --> 0.119466).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.2453694
	speed: 0.1106s/iter; left time: 2759.1722s
	iters: 200, epoch: 5 | loss: 0.2126579
	speed: 0.0192s/iter; left time: 477.9438s
Epoch: 5 cost time: 7.175169229507446
Epoch: 5, Steps: 261 | Train Loss: 0.1990858 Vali Loss: 0.1189673 Test Loss: 0.0743914
Validation loss decreased (0.119466 --> 0.118967).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.1940177
	speed: 0.1132s/iter; left time: 2796.4485s
	iters: 200, epoch: 6 | loss: 0.1902866
	speed: 0.0196s/iter; left time: 481.1785s
Epoch: 6 cost time: 7.452771902084351
Epoch: 6, Steps: 261 | Train Loss: 0.1972968 Vali Loss: 0.1187040 Test Loss: 0.0743148
Validation loss decreased (0.118967 --> 0.118704).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.1729467
	speed: 0.1158s/iter; left time: 2830.3878s
	iters: 200, epoch: 7 | loss: 0.1937943
	speed: 0.0189s/iter; left time: 460.5548s
Epoch: 7 cost time: 7.561544418334961
Epoch: 7, Steps: 261 | Train Loss: 0.1945949 Vali Loss: 0.1181971 Test Loss: 0.0744657
Validation loss decreased (0.118704 --> 0.118197).  Saving model ...
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.2027867
	speed: 0.1109s/iter; left time: 2681.6737s
	iters: 200, epoch: 8 | loss: 0.1578493
	speed: 0.0193s/iter; left time: 464.0963s
Epoch: 8 cost time: 7.25657844543457
Epoch: 8, Steps: 261 | Train Loss: 0.1903533 Vali Loss: 0.1218353 Test Loss: 0.0740581
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.1993744
	speed: 0.1163s/iter; left time: 2781.5057s
	iters: 200, epoch: 9 | loss: 0.1667165
	speed: 0.0204s/iter; left time: 484.8123s
Epoch: 9 cost time: 7.50336217880249
Epoch: 9, Steps: 261 | Train Loss: 0.1868005 Vali Loss: 0.1243331 Test Loss: 0.0731971
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.2233374
	speed: 0.1159s/iter; left time: 2741.5585s
	iters: 200, epoch: 10 | loss: 0.1773667
	speed: 0.0190s/iter; left time: 447.7267s
Epoch: 10 cost time: 7.208918571472168
Epoch: 10, Steps: 261 | Train Loss: 0.1829680 Vali Loss: 0.1274309 Test Loss: 0.0738670
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.1753600
	speed: 0.1102s/iter; left time: 2577.3360s
	iters: 200, epoch: 11 | loss: 0.1879363
	speed: 0.0186s/iter; left time: 432.5343s
Epoch: 11 cost time: 7.058305501937866
Epoch: 11, Steps: 261 | Train Loss: 0.1787755 Vali Loss: 0.1273052 Test Loss: 0.0745556
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.1739357
	speed: 0.1129s/iter; left time: 2611.7387s
	iters: 200, epoch: 12 | loss: 0.1771797
	speed: 0.0189s/iter; left time: 436.2224s
Epoch: 12 cost time: 7.228323221206665
Epoch: 12, Steps: 261 | Train Loss: 0.1744218 Vali Loss: 0.1297715 Test Loss: 0.0753545
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.1691291
	speed: 0.1147s/iter; left time: 2622.3273s
	iters: 200, epoch: 13 | loss: 0.1434488
	speed: 0.0205s/iter; left time: 467.6909s
Epoch: 13 cost time: 7.563727855682373
Epoch: 13, Steps: 261 | Train Loss: 0.1703392 Vali Loss: 0.1312079 Test Loss: 0.0755915
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.1622686
	speed: 0.1144s/iter; left time: 2586.2175s
	iters: 200, epoch: 14 | loss: 0.1502574
	speed: 0.0186s/iter; left time: 419.5853s
Epoch: 14 cost time: 7.159088134765625
Epoch: 14, Steps: 261 | Train Loss: 0.1665323 Vali Loss: 0.1304217 Test Loss: 0.0765446
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.1554895
	speed: 0.1079s/iter; left time: 2410.9617s
	iters: 200, epoch: 15 | loss: 0.1826369
	speed: 0.0184s/iter; left time: 410.1348s
Epoch: 15 cost time: 6.734264612197876
Epoch: 15, Steps: 261 | Train Loss: 0.1639070 Vali Loss: 0.1342456 Test Loss: 0.0799982
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.1393426
	speed: 0.1138s/iter; left time: 2514.0115s
	iters: 200, epoch: 16 | loss: 0.1661564
	speed: 0.0200s/iter; left time: 438.9104s
Epoch: 16 cost time: 7.622387170791626
Epoch: 16, Steps: 261 | Train Loss: 0.1608232 Vali Loss: 0.1333346 Test Loss: 0.0791043
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.1584416
	speed: 0.1175s/iter; left time: 2564.4505s
	iters: 200, epoch: 17 | loss: 0.1616042
	speed: 0.0184s/iter; left time: 400.5459s
Epoch: 17 cost time: 7.03331732749939
Epoch: 17, Steps: 261 | Train Loss: 0.1579582 Vali Loss: 0.1376926 Test Loss: 0.0801732
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.1525104
	speed: 0.1193s/iter; left time: 2571.9756s
	iters: 200, epoch: 18 | loss: 0.1602098
	speed: 0.0199s/iter; left time: 426.6524s
Epoch: 18 cost time: 7.7003772258758545
Epoch: 18, Steps: 261 | Train Loss: 0.1549781 Vali Loss: 0.1335191 Test Loss: 0.0804554
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.1547558
	speed: 0.1106s/iter; left time: 2355.2513s
	iters: 200, epoch: 19 | loss: 0.1658322
	speed: 0.0204s/iter; left time: 433.0044s
Epoch: 19 cost time: 7.223340034484863
Epoch: 19, Steps: 261 | Train Loss: 0.1512913 Vali Loss: 0.1333695 Test Loss: 0.0832751
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.1636495
	speed: 0.1192s/iter; left time: 2507.7479s
	iters: 200, epoch: 20 | loss: 0.1437958
	speed: 0.0190s/iter; left time: 397.0000s
Epoch: 20 cost time: 7.545135259628296
Epoch: 20, Steps: 261 | Train Loss: 0.1479948 Vali Loss: 0.1369547 Test Loss: 0.0802582
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.1524775
	speed: 0.1129s/iter; left time: 2346.7476s
	iters: 200, epoch: 21 | loss: 0.1573275
	speed: 0.0183s/iter; left time: 379.3183s
Epoch: 21 cost time: 6.993907928466797
Epoch: 21, Steps: 261 | Train Loss: 0.1445922 Vali Loss: 0.1367363 Test Loss: 0.0837695
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.1518825
	speed: 0.1121s/iter; left time: 2301.1727s
	iters: 200, epoch: 22 | loss: 0.1453250
	speed: 0.0181s/iter; left time: 370.3472s
Epoch: 22 cost time: 7.187598943710327
Epoch: 22, Steps: 261 | Train Loss: 0.1410299 Vali Loss: 0.1406872 Test Loss: 0.0834085
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.1459780
	speed: 0.1123s/iter; left time: 2276.0453s
	iters: 200, epoch: 23 | loss: 0.1239206
	speed: 0.0171s/iter; left time: 345.3753s
Epoch: 23 cost time: 7.0488057136535645
Epoch: 23, Steps: 261 | Train Loss: 0.1370113 Vali Loss: 0.1386426 Test Loss: 0.0835697
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.1445097
	speed: 0.1110s/iter; left time: 2219.4421s
	iters: 200, epoch: 24 | loss: 0.1300879
	speed: 0.0185s/iter; left time: 368.7962s
Epoch: 24 cost time: 6.916048288345337
Epoch: 24, Steps: 261 | Train Loss: 0.1331911 Vali Loss: 0.1384217 Test Loss: 0.0868226
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.1334922
	speed: 0.1125s/iter; left time: 2219.5553s
	iters: 200, epoch: 25 | loss: 0.1217737
	speed: 0.0195s/iter; left time: 382.5669s
Epoch: 25 cost time: 7.100165367126465
Epoch: 25, Steps: 261 | Train Loss: 0.1295333 Vali Loss: 0.1418370 Test Loss: 0.0848439
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.1256004
	speed: 0.1167s/iter; left time: 2273.7732s
	iters: 200, epoch: 26 | loss: 0.1231280
	speed: 0.0178s/iter; left time: 345.1714s
Epoch: 26 cost time: 7.0636818408966064
Epoch: 26, Steps: 261 | Train Loss: 0.1259798 Vali Loss: 0.1386943 Test Loss: 0.0845161
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.1195405
	speed: 0.1136s/iter; left time: 2182.1353s
	iters: 200, epoch: 27 | loss: 0.1225605
	speed: 0.0185s/iter; left time: 353.6834s
Epoch: 27 cost time: 7.4020304679870605
Epoch: 27, Steps: 261 | Train Loss: 0.1221267 Vali Loss: 0.1415834 Test Loss: 0.0878684
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_336_720_PatchTST_ETTm1_ftS_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.07446575909852982, mae:0.20722872018814087, rse:0.8209213614463806
