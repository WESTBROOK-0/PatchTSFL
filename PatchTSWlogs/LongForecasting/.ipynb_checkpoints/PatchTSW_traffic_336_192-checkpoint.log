Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=4, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='traffic.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTSW', model_id='traffic_336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
base legendre
>>>>>>>start training : traffic_336_192_PatchTSW_custom_ftM_sl336_ll48_pl192_dm128_nh16_el2_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.7306799
	speed: 1.1904s/iter; left time: 349608.6893s
	iters: 200, epoch: 1 | loss: 0.5859199
	speed: 1.1809s/iter; left time: 346715.6340s
	iters: 300, epoch: 1 | loss: 0.5531656
	speed: 1.1808s/iter; left time: 346575.2258s
	iters: 400, epoch: 1 | loss: 0.5229704
	speed: 1.1812s/iter; left time: 346577.4885s
	iters: 500, epoch: 1 | loss: 0.4156772
	speed: 1.1810s/iter; left time: 346384.5493s
	iters: 600, epoch: 1 | loss: 0.4523274
	speed: 1.1812s/iter; left time: 346330.6951s
	iters: 700, epoch: 1 | loss: 0.4737611
	speed: 1.1818s/iter; left time: 346378.1702s
	iters: 800, epoch: 1 | loss: 0.4511990
	speed: 1.1823s/iter; left time: 346424.0345s
	iters: 900, epoch: 1 | loss: 0.3754355
	speed: 1.1825s/iter; left time: 346345.8724s
	iters: 1000, epoch: 1 | loss: 0.3532068
	speed: 1.1822s/iter; left time: 346141.2018s
	iters: 1100, epoch: 1 | loss: 0.3923270
	speed: 1.1821s/iter; left time: 345993.4515s
	iters: 1200, epoch: 1 | loss: 0.3299089
	speed: 1.1819s/iter; left time: 345823.6236s
	iters: 1300, epoch: 1 | loss: 0.3661473
	speed: 1.1819s/iter; left time: 345719.2289s
	iters: 1400, epoch: 1 | loss: 0.4119571
	speed: 1.1818s/iter; left time: 345568.2378s
	iters: 1500, epoch: 1 | loss: 0.3526563
	speed: 1.1824s/iter; left time: 345611.5914s
	iters: 1600, epoch: 1 | loss: 0.3398106
	speed: 1.1823s/iter; left time: 345469.4409s
	iters: 1700, epoch: 1 | loss: 0.3496686
	speed: 1.1821s/iter; left time: 345289.1268s
	iters: 1800, epoch: 1 | loss: 0.3533283
	speed: 1.1817s/iter; left time: 345049.9998s
	iters: 1900, epoch: 1 | loss: 0.3163989
	speed: 1.1816s/iter; left time: 344922.5109s
	iters: 2000, epoch: 1 | loss: 0.3540527
	speed: 1.1817s/iter; left time: 344809.1686s
	iters: 2100, epoch: 1 | loss: 0.3907607
	speed: 1.1817s/iter; left time: 344693.7916s
	iters: 2200, epoch: 1 | loss: 0.3331976
	speed: 1.1821s/iter; left time: 344707.7597s
	iters: 2300, epoch: 1 | loss: 0.3292359
	speed: 1.1819s/iter; left time: 344536.6614s
	iters: 2400, epoch: 1 | loss: 0.2974412
	speed: 1.1815s/iter; left time: 344277.3823s
	iters: 2500, epoch: 1 | loss: 0.3162011
	speed: 1.1816s/iter; left time: 344213.8208s
	iters: 2600, epoch: 1 | loss: 0.2800047
	speed: 1.1816s/iter; left time: 344091.0590s
	iters: 2700, epoch: 1 | loss: 0.3247353
	speed: 1.1817s/iter; left time: 343980.6945s
	iters: 2800, epoch: 1 | loss: 0.3285940
	speed: 1.1815s/iter; left time: 343813.3199s
	iters: 2900, epoch: 1 | loss: 0.3385386
	speed: 1.1818s/iter; left time: 343773.7339s
Epoch: 1 cost time: 3472.996850967407
Epoch: 1, Steps: 2938 | Train Loss: 0.3986798 Vali Loss: 0.3711950 Test Loss: 0.4682252
Validation loss decreased (inf --> 0.371195).  Saving model ...
Updating learning rate to 4.590979724920557e-06
	iters: 100, epoch: 2 | loss: 0.2835369
	speed: 5.7739s/iter; left time: 1678850.8886s
	iters: 200, epoch: 2 | loss: 0.2770583
	speed: 1.1815s/iter; left time: 343420.6591s
	iters: 300, epoch: 2 | loss: 0.3654126
	speed: 1.1815s/iter; left time: 343298.6462s
	iters: 400, epoch: 2 | loss: 0.3463950
	speed: 1.1812s/iter; left time: 343092.2007s
	iters: 500, epoch: 2 | loss: 0.3451855
	speed: 1.1810s/iter; left time: 342920.6335s
	iters: 600, epoch: 2 | loss: 0.3445621
	speed: 1.1817s/iter; left time: 342990.6925s
	iters: 700, epoch: 2 | loss: 0.3402496
	speed: 1.1811s/iter; left time: 342709.9853s
	iters: 800, epoch: 2 | loss: 0.2688684
	speed: 1.1814s/iter; left time: 342688.4472s
	iters: 900, epoch: 2 | loss: 0.3348269
	speed: 1.1815s/iter; left time: 342582.1399s
	iters: 1000, epoch: 2 | loss: 0.3081657
	speed: 1.1811s/iter; left time: 342371.4745s
	iters: 1100, epoch: 2 | loss: 0.2448640
	speed: 1.1809s/iter; left time: 342172.3492s
	iters: 1200, epoch: 2 | loss: 0.3323928
	speed: 1.1810s/iter; left time: 342094.1498s
	iters: 1300, epoch: 2 | loss: 0.2711123
	speed: 1.1813s/iter; left time: 342069.9652s
	iters: 1400, epoch: 2 | loss: 0.2748627
	speed: 1.1815s/iter; left time: 341998.6445s
	iters: 1500, epoch: 2 | loss: 0.3342863
	speed: 1.1812s/iter; left time: 341803.4421s
	iters: 1600, epoch: 2 | loss: 0.2719622
	speed: 1.1815s/iter; left time: 341756.8113s
	iters: 1700, epoch: 2 | loss: 0.2826304
	speed: 1.1813s/iter; left time: 341596.7796s
	iters: 1800, epoch: 2 | loss: 0.2939999
	speed: 1.1812s/iter; left time: 341444.8300s
	iters: 1900, epoch: 2 | loss: 0.2757419
	speed: 1.1818s/iter; left time: 341484.3145s
	iters: 2000, epoch: 2 | loss: 0.2966166
	speed: 1.1819s/iter; left time: 341418.2955s
	iters: 2100, epoch: 2 | loss: 0.2521251
	speed: 1.1819s/iter; left time: 341291.5806s
	iters: 2200, epoch: 2 | loss: 0.2554841
	speed: 1.1817s/iter; left time: 341123.2317s
	iters: 2300, epoch: 2 | loss: 0.3066405
	speed: 1.1819s/iter; left time: 341055.6556s
	iters: 2400, epoch: 2 | loss: 0.3138667
	speed: 1.1818s/iter; left time: 340899.3550s
	iters: 2500, epoch: 2 | loss: 0.3009223
	speed: 1.1816s/iter; left time: 340731.8235s
	iters: 2600, epoch: 2 | loss: 0.2717689
	speed: 1.1817s/iter; left time: 340645.7089s
	iters: 2700, epoch: 2 | loss: 0.3189242
	speed: 1.1818s/iter; left time: 340552.1136s
	iters: 2800, epoch: 2 | loss: 0.2798397
	speed: 1.1818s/iter; left time: 340431.9992s
	iters: 2900, epoch: 2 | loss: 0.2998787
	speed: 1.1817s/iter; left time: 340279.4511s
Epoch: 2 cost time: 3472.5794529914856
Epoch: 2, Steps: 2938 | Train Loss: 0.3024774 Vali Loss: 0.3559854 Test Loss: 0.4439879
Validation loss decreased (0.371195 --> 0.355985).  Saving model ...
Updating learning rate to 6.349366523212784e-06
	iters: 100, epoch: 3 | loss: 0.2859314
	speed: 5.7822s/iter; left time: 1664250.7938s
	iters: 200, epoch: 3 | loss: 0.3092678
	speed: 1.1811s/iter; left time: 339833.9550s
	iters: 300, epoch: 3 | loss: 0.3445191
	speed: 1.1812s/iter; left time: 339747.9855s
	iters: 400, epoch: 3 | loss: 0.2625992
	speed: 1.1814s/iter; left time: 339694.4719s
	iters: 500, epoch: 3 | loss: 0.2942490
	speed: 1.1814s/iter; left time: 339561.2316s
	iters: 600, epoch: 3 | loss: 0.2805120
	speed: 1.1816s/iter; left time: 339517.5320s
	iters: 700, epoch: 3 | loss: 0.3276210
	speed: 1.1818s/iter; left time: 339454.0495s
	iters: 800, epoch: 3 | loss: 0.3165456
	speed: 1.1823s/iter; left time: 339456.8846s
	iters: 900, epoch: 3 | loss: 0.2979047
	speed: 1.1823s/iter; left time: 339355.8192s
	iters: 1000, epoch: 3 | loss: 0.3159068
	speed: 1.1823s/iter; left time: 339223.0585s
	iters: 1100, epoch: 3 | loss: 0.2802043
	speed: 1.1820s/iter; left time: 339018.3956s
	iters: 1200, epoch: 3 | loss: 0.2921090
	speed: 1.1821s/iter; left time: 338934.4685s
	iters: 1300, epoch: 3 | loss: 0.3442243
	speed: 1.1816s/iter; left time: 338689.2537s
	iters: 1400, epoch: 3 | loss: 0.2484568
	speed: 1.1819s/iter; left time: 338655.7793s
	iters: 1500, epoch: 3 | loss: 0.2573984
	speed: 1.1819s/iter; left time: 338536.1279s
	iters: 1600, epoch: 3 | loss: 0.2834113
	speed: 1.1819s/iter; left time: 338420.8178s
	iters: 1700, epoch: 3 | loss: 0.2748930
	speed: 1.1817s/iter; left time: 338240.7248s
	iters: 1800, epoch: 3 | loss: 0.2324758
	speed: 1.1812s/iter; left time: 337974.9864s
	iters: 1900, epoch: 3 | loss: 0.2513296
	speed: 1.1816s/iter; left time: 337954.3853s
	iters: 2000, epoch: 3 | loss: 0.3194734
	speed: 1.1815s/iter; left time: 337819.9440s
	iters: 2100, epoch: 3 | loss: 0.2597843
	speed: 1.1816s/iter; left time: 337731.2802s
	iters: 2200, epoch: 3 | loss: 0.2679662
	speed: 1.1817s/iter; left time: 337631.7889s
	iters: 2300, epoch: 3 | loss: 0.3177073
	speed: 1.1813s/iter; left time: 337400.8542s
	iters: 2400, epoch: 3 | loss: 0.2448599
	speed: 1.1811s/iter; left time: 337220.5273s
	iters: 2500, epoch: 3 | loss: 0.2652804
	speed: 1.1813s/iter; left time: 337159.5967s
	iters: 2600, epoch: 3 | loss: 0.2992178
	speed: 1.1815s/iter; left time: 337116.4088s
	iters: 2700, epoch: 3 | loss: 0.2589279
	speed: 1.1812s/iter; left time: 336906.0614s
	iters: 2800, epoch: 3 | loss: 0.2338489
	speed: 1.1814s/iter; left time: 336860.3812s
